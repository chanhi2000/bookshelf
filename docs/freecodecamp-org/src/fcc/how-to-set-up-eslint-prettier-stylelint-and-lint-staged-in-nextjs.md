---
lang: en-US
title: "How to Set Up ESLint, Prettier, StyleLint, and lint-staged in Next.js"
description: "Article(s) > How to Set Up ESLint, Prettier, StyleLint, and lint-staged in Next.js"
icon: iconfont icon-nextjs
category: 
  - Node.js
  - Next.js
  - Article(s)
tag: 
  - blog
  - freecodecamp.org
  - node
  - nodejs
  - node-js
  - next
  - nextjs
  - next-js
head:
  - - meta:
    - property: og:title
      content: "Article(s) > How to Set Up ESLint, Prettier, StyleLint, and lint-staged in Next.js"
    - property: og:description
      content: "How to Set Up ESLint, Prettier, StyleLint, and lint-staged in Next.js"
    - property: og:url
      content: https://chanhi2000.github.io/bookshelf/fcc/how-to-set-up-eslint-prettier-stylelint-and-lint-staged-in-nextjs.html
prev: /programming/js-next/articles/README.md
date: 2024-09-16
isOriginal: false
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1726515328917/f3ecbc80-6d06-45ee-b307-89ed1a7bc854.jpeg
---

# {{ $frontmatter.title }} 관련

```component VPCard
{
  "title": "Next.js > Article(s)",
  "desc": "Article(s)",
  "link": "/programming/js-next/articles/README.md",
  "logo": "https://chanhi2000.github.io/images/ico-wind.svg",
  "background": "rgba(10,10,10,0.2)"
}
```

<SiteInfo
  name="How to Set Up ESLint, Prettier, StyleLint, and lint-staged in Next.js"
  desc="A linter is a tool that scans code for potential issues. This is invaluable with a programming language like JavaScript which is so loosely typed. Even for TypeScript, which is a strongly typed language whose compiler does a great job of detecting er..."
  url="https://freecodecamp.org/news/how-to-set-up-eslint-prettier-stylelint-and-lint-staged-in-nextjs/"
  logo="https://cdn.freecodecamp.org/universal/favicons/favicon.ico"
  preview="https://cdn.hashnode.com/res/hashnode/image/upload/v1726515328917/f3ecbc80-6d06-45ee-b307-89ed1a7bc854.jpeg"/>

<!-- TODO: 작성 -->

<!-- 
<p>A <strong>linter</strong> is a tool that scans code for potential issues. This is invaluable with a programming language like JavaScript which is so loosely typed.</p>
<p>Even for TypeScript, which is a strongly typed language whose compiler does a great job of detecting errors at compile time, linters such as ESLint have plugins that catch problems not caught by the compiler.</p>
<p>When you generate a new app using the Next.js CLI (<code>npx create-next-app</code>), ESLint is configured by default. But there are several problems with the linting setup generated by <code>create-next-app</code>:</p>
<ul>
<li><p>If you choose SCSS for styling, you should use <a target="_blank" href="https://stylelint.io/">Stylelint</a> in the build process to lint CSS or SCSS stylesheets. But it’s not set up automatically.</p>
</li>
<li><p>If instead you opt for Tailwind for styling, you should set up the Tailwind plugin for ESLint. But again, this isn’t done in the generated ESLint configuration.</p>
</li>
<li><p>If you choose TypeScript, then in Next.js v14 and below, TypeScript-specific ESLint rules are not configured, contrary to <a target="_blank" href="https://nextjs.org/docs/pages/building-your-application/configuring/eslint#typescript">what the documentation states</a>. While a Next.js v15 app has these set up, I would still tweak the setup further with the more powerful linting rules provided by the <a target="_blank" href="https://typescript-eslint.io/">typescript-eslint project</a>.</p>
</li>
<li><p>And finally, Prettier is not set up. Prettier is a code formatting tool. It can prevent inconsistently formatted code from getting into the code repository, which would make comparisons between different versions of the same file difficult. Also, nicely formatted code is easier to work with. So this is a pretty big omission.</p>
</li>
</ul>
<p>In this tutorial, I'll show you how I set up linting and formatting in my Next.js projects in a way that addresses the issues above. I’ll also teach you how to install and configure some related VS Code extensions for coding assistance.</p>
<p>To follow along, you can either use a Next.js project you already have, or generate a new app by running <code>npx create-next-app</code> on the terminal.</p>
<p>If you’re scaffolding a new app, your choices are up to you (defaults are fine) but make sure to choose YES in response to the question about whether you’d like to use ESLint:</p>
<p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1725930860799/fb38b3b2-5592-4eb4-b8d0-153aeb2d749d.png" alt="Terminal window in which Next.js scaffolder, create-next-app, is showing code generation options to the user" class="image--center mx-auto" width="688" height="383" loading="lazy"></p>
<p>If you are following along with an existing app rather than a new one, upgrade it by running the <a target="_blank" href="https://nextjs.org/docs/pages/building-your-application/upgrading/version-14">following command</a> in app root:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token function">npm</span> i next@latest react@latest react-dom@latest eslint-config-next@latest
<span class="token function">npm</span> i --save-dev eslint
</code></pre>
<p>This will avoid versioning conflicts down the line.</p>
<p>If you cannot upgrade to the latest version, you’ll need to specify versions for packages that will be installed in this tutorial to get around any version conflicts. Be warned that this can be frustrating.</p>
<p>Now you’re ready to open up the app in your code editor and proceed as follows.</p>
<h2 id="heading-prerequisites">Prerequisites</h2>
<p>I assume that you know how to:</p>
<ul>
<li><p>write a basic Next.js app with two or more pages.</p>
</li>
<li><p>install additional NPM packages into your app</p>
</li>
</ul>
<h2 id="heading-table-of-contents">Table of Contents</h2>
<ul>
<li><p><a class="post-section-overview" href="#heading-introduction">Introduction</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-prerequisites">Prerequisites</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-table-of-contents">Table of Contents</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-set-up-prettier">Set Up Prettier</a></p>
<ul>
<li><a class="post-section-overview" href="#heading-a-note-on-line-endings-in-prettier">A note on line endings in Prettier</a></li>
</ul>
</li>
<li><p><a class="post-section-overview" href="#heading-set-up-eslint">Set Up ESLint</a></p>
<ul>
<li><p><a class="post-section-overview" href="#heading-basics-of-eslint-configuration">Basics of ESLint configuration</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-eslint-setup-for-typescript">ESLint Setup for TypeScript</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-eslint-setup-for-tailwind">ESLint Setup for Tailwind</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-eslint-setup-for-prettier">ESLint Setup for Prettier</a></p>
</li>
</ul>
</li>
<li><p><a class="post-section-overview" href="#heading-set-up-stylelint">Set Up Stylelint</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-set-up-packagejson-scripts">Set Up package.json Scripts</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-set-up-lint-staged">Set Up lint-staged</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-set-up-vs-code-extensions">Set UP VS Code Extensions</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-final-checks-and-troubleshooting">Final Checks and Troubleshooting</a></p>
</li>
<li><p><a class="post-section-overview" href="#heading-conclusion">Conclusion</a></p>
</li>
</ul>
<h2 id="heading-set-up-prettier">Set Up Prettier</h2>
<p><a target="_blank" href="https://prettier.io/">Prettier</a> is an opinionated code formatter that can format pretty much any file (<code>.html</code>, <code>.json</code>, <code>.js</code>, <code>.ts</code>, <code>.css</code>, <code>.scss</code> and so on).</p>
<p>Set it up in yuor app as follows:</p>
<ol>
<li><p>Install Prettier:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"> <span class="token function">npm</span> <span class="token function">install</span> --save-dev prettier
</code></pre>
</li>
<li><p>If you chose Tailwind for styling when generating the app, then install <code>prettier-plugin-tailwindcss</code>:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">   <span class="token function">npm</span> <span class="token function">install</span> --save-dev prettier-plugin-tailwindcss
</code></pre>
<p> This package is a Prettier plugin and provides rules for reordering of Tailwind classes used in a <code>class</code> or <code>className</code> attribute according to a canonical ordering. It helps keep the ordering of Tailwind classes used in the markup consistent.</p>
<p> %[https://youtu.be/tQkBJXwzY8A?autoplay=1] </p>
</li>
<li><p>Create <code>.prettierrc.json</code> in youyr project root. If you’re using SCSS for styling, paste the following snippet into this file:</p>
<pre class="language-json" tabindex="0"><code class="language-json"> <span class="token punctuation">{</span>
   <span class="token property">"singleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   <span class="token property">"jsxSingleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span>
 <span class="token punctuation">}</span>
</code></pre>
<p> If you’re using Tailwind instead, paste the following into <code>.prettierrc.json</code>:</p>
<pre class="language-json" tabindex="0"><code class="language-json"> <span class="token punctuation">{</span>
   <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"prettier-plugin-tailwindcss"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token property">"singleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   <span class="token property">"jsxSingleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span>
 <span class="token punctuation">}</span>
</code></pre>
</li>
<li><p>Create <code>.prettierignore</code> file in the app root, with the following content:</p>
<pre class="language-plaintext" tabindex="0"><code class="language-plaintext"> node_modules
 .next
 .husky
 coverage
 .prettierignore
 .stylelintignore
 .eslintignore
 stories
 storybook-static
 *.log
 playwright-report
 .nyc_output
 test-results
 junit.xml
 docs
</code></pre>
<p> This file ensure that files which are not app code (that is, those which are not <code>.js</code>, <code>.ts</code>, <code>.css</code> files and so on.) do not get formatted. Otherwise Prettier will end up spending too much time processing files whose formatting you don't really care about.</p>
<p> <code>'prettierignore</code> (the file we just created), <code>.eslintignore</code>, and <code>.stylelintignore</code> have been ignored because these are plain text files with no structure so Prettier would complain that it cannot format them.</p>
</li>
<li><p>Finally, <strong>I recommend</strong> that you follow the steps in <a target="_blank" href="https://nausaf.hashnode.dev/lf-vs-crlf-configure-git-and-vs-code-on-windows-to-use-unix-line-endings">this post</a> to set LF as the EOL character, both in the repo and in your VS Code settings. Reasoning for this is given in the following subsection.</p>
</li>
</ol>
<h3 id="heading-a-note-on-line-endings-in-prettier">A note on line endings in Prettier</h3>
<p>Prettier <a target="_blank" href="https://prettier.io/docs/en/options#end-of-line">defaults to LF (Line Feed character) for line endings</a>. This means that when it formats files, it will change all occurrences of the CRLF character sequence, if any, to LF.</p>
<p>LF is also the default in text editors and other tools in Unix-based systems (Linux, MacOS etc.). But on Windows, the default for line endings is CRLF (Carriage Return character, followed immediately by Line Feed character).</p>
<p>Windows tooling such as text and code editors can easily handle LF as line ending. But CRLF can be problematic for tools on Unix-based systems such as Linux and various flavours of Unix. Therefore it makes sense to only use LF as line endings in code as this would work on both Windows and Unix-based systems.</p>
<p>Configuring LF as the EOF character in Git repo and in code editors will bring your tooling in line with Prettier's default. It will also ensure that all files in the Git repo consistently have LF line endings. Thus if a contributor to your repo is on Windows which uses CRLF as EOL character, the code they add or modify in the repo would still use LF: the code editor would default new code files to LF; <code>git</code> commit` would convert any CRLFs to LF when committing.</p>
<p>Finally, setting LF as the line endings for the whole repo would avoid strange things that happen when on Windows, Prettier retains its default of LF but Git and your code editor continue to use their default of CRLF for line endings:</p>
<ul>
<li><p>When VS Code Prettier extension formats a file (for example, when the extension is set up to "autoformat on save"), it does not change CRLF line endings. But formatting the same file by running Prettier on the command line <strong>does change line endings to LF</strong>. This discrepancy can be annoying.</p>
</li>
<li><p>Git may show warnings like this when when you run <code>git add .</code>:</p>
<p>  <img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1725930986122/b5630966-e8dd-4f47-bb58-eed6eb023ea6.png" alt="Warnings shown by git add command when some of the files being added contain LF but the repo's line ending default is CRLF" class="image--center mx-auto" width="800" height="78" loading="lazy"></p>
</li>
</ul>
<h2 id="heading-set-up-eslint">Set Up ESLint</h2>
<h3 id="heading-basics-of-eslint-configuration">Basics of ESLint configuration</h3>
<p>ESLint comes with a number of linting rules out of the box. But you can also supplement these with ESLint plugins.</p>
<p>An <strong>ESLint plugin</strong> defines some linting rules. For example, if you look in the <a target="_blank" href="https://github.com/vercel/next.js/tree/canary/packages/eslint-plugin-next">GitHub repo for Next's ESLint plugin</a>, eslint-plugin-next, each file in the <a target="_blank" href="https://github.com/vercel/next.js/tree/canary/packages/eslint-plugin-next/src/rules"><code>src/rules</code></a> folder defines a linting rule as a TypeScript function. The <a target="_blank" href="https://github.com/vercel/next.js/blob/canary/packages/eslint-plugin-next/src/index.ts"><code>index.js</code></a> of the package then exports these rule functions in the <code>rules</code> object in its default export:</p>
<pre class="language-typescript" tabindex="0"><code class="language-typescript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'google-font-display'</span><span class="token operator">:</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./rules/google-font-display'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">'google-font-preconnect'</span><span class="token operator">:</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./rules/google-font-preconnect'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">'inline-script-id'</span><span class="token operator">:</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./rules/inline-script-id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
</code></pre>
<p>The basic way to use these rules in your app is to install the plugin package, then reference it in the ESLint configuration file in the app's root folder.</p>
<p>For example, we can use rules from the <code>eslint-plugin-next</code> mentioned above by running <code>npm install --save-dev eslint-plugin-next</code>, then placing the following content in the ESLint config file <code>.eslintrc.json</code> in the app root:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"next"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"google-font-display"</span><span class="token operator">:</span> <span class="token string">"warning"</span><span class="token punctuation">,</span>
        <span class="token property">"google-font-preconnect"</span><span class="token operator">:</span> <span class="token string">"warning"</span><span class="token punctuation">,</span>
        <span class="token property">"inline-script-id"</span><span class="token operator">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>If you now run <code>npx eslint .</code> in your app's root folder, ESLint will lint every JavaScript file in the app against each of the three rules configured above.</p>
<p>There are three severities you can assign to a rule when configuring it for use: <code>off</code>, <code>warning</code> and <code>error</code>. As the snippet above shows, you enable a rule by assigning to it a severity of <code>warning</code> or <code>error</code> in the app's <code>.eslintrc.json</code>.</p>
<p>When referencing a plugin in your app's ESLint configuration file, the prefix <code>eslint-plugin-</code> in the plugin's package name is omitted. This is why the package that contains linting rules for Next.js, <code>eslint-plugin-next</code>, is referenced only as <code>"next"</code> in the snippet above.</p>
<p>Since it is quite cumbersome to configure a severity level - <code>off</code>, <code>warning</code> or <code>error</code> - for every single rule from every plugin that you want to use, the norm is to reference an <strong>ESLint configuration object</strong>, or <strong>ESLint config</strong> for short, that is exported by an NPM package. This is a JavaScript object that declares plugins and configures rules from these with severity levels just as we did above.</p>
<p>For example, the default export from <code>eslint-plugin-next</code> also contains several ESLint configs. Here is a another snippet from <a target="_blank" href="https://github.com/vercel/next.js/blob/canary/packages/eslint-plugin-next/src/index.ts"><code>index.js</code> of the plugin</a>, this time showing exported ESLint configs in addition to the <code>rules</code> object for exporting rule functions:</p>
<pre class="language-typescript" tabindex="0"><code class="language-typescript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'google-font-display'</span><span class="token operator">:</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./rules/google-font-display'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">'google-font-preconnect'</span><span class="token operator">:</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./rules/google-font-preconnect'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string-property property">'inline-script-id'</span><span class="token operator">:</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./rules/inline-script-id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>    
configs<span class="token operator">:</span> <span class="token punctuation">{</span>
    recommended<span class="token operator">:</span> <span class="token punctuation">{</span>
      plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@next/next'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      rules<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// warnings</span>
        <span class="token string-property property">'@next/next/google-font-display'</span><span class="token operator">:</span> <span class="token string">'warn'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'@next/next/google-font-preconnect'</span><span class="token operator">:</span> <span class="token string">'warn'</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>

        <span class="token comment">// errors</span>
        <span class="token string-property property">'@next/next/inline-script-id'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'@next/next/no-assign-module-variable'</span><span class="token operator">:</span> <span class="token string">'error'</span>
        <span class="token operator">...</span>

      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">'core-web-vitals'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@next/next'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:@next/next/recommended'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      rules<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'@next/next/no-html-link-for-pages'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'@next/next/no-sync-scripts'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<p>As you can see, in addition to the rules (there are many more than those shown above), the plugin also exports two configs - <code>recommended</code> and <code>core-web-vitals</code> - that enable different selections of the rules defined in the plugin by assigning severity levels of <code>error</code> or <code>warning</code> to them.</p>
<p>The config that is normally used in Next.js projects is <code>core-web-vitals</code>. We can use this config object in our app’s ESLint configuration file (<code>.eslintrc.json</code> in app root) as follows:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"plugin:next/core-web-vitals"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Thus is much simpler than declaring the plugin in <code>plugins</code> object and then assigning a severity level of <code>error</code> or <code>warning</code> to each rule from the plugin that we want to use.</p>
<p>Notice the difference between the <em>configuration file</em> - this is <code>.eslintrc.json</code> - and <em>config</em> - this is an object that configures some rules from a plugin for use in a client project by assigning severities to selected rules.</p>
<p>Contents of the configuration file are themselves a config. But in configuration files, we do not typically import a plugin and configure all rules from it that we want to use. Instead we almost always import a well-known/trusted config object that is exported by an NPM package. Such a config object - one that is exported by an NPM package for use in ESLint configuration files (in other packages/apps) - is also known as a <a target="_blank" href="https://eslint.org/docs/latest/extend/shareable-configs">shareable config</a>.</p>
<p>Typically, plugins - these define ESLint rules as JavaScript/TypeScript functions - also bundle their rules into one or more shareable configs. The <code>recommended</code> config from plugin <code>eslint-plugin-next</code> that we used above is just one such config.</p>
<p>Shareable configs do not only come from plugin packages, although it is customary for plugins to also export one or more shareable configs composed of their own rules. Other packages, whose names begin with <code>eslint-config-</code> (as opposed to <code>eslint-plugin-</code>) can provide one or more named configs.</p>
<p>Next.js provides one such package named <code>eslint-config-next</code>. This re-exports configs <code>recommended</code> and <code>core-web-vitals</code> from the plugin. It also re-exports (in v15 and above of the package) a config of TypeScript linting rules from plugin <code>typescript-eslint/eslint-plugin</code>. So instead of using <code>recommended</code> config from the plugin like we have done above:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"plugin:next/core-web-vitals"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>we could have installed the package <code>eslint-config-next</code> and used that in <code>.eslintrc.json</code>:</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"next/core-web-vitals"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Since the package's name is not prefixed with <code>plugin:</code>, ESLint considers it to be a config package, reconstructing the name as <code>eslint-config-next</code> rather than as <code>eslint-plugin-next</code>. Notice how with config packages also, we delete the canonical prefix <code>eslint-config-</code> when referencing it in the ESLint configuration file.</p>
<p>It is possible to reference multiple shareable configs in <code>extends</code>. In this case, all the rules from all configs are used - except where there are multiple configs that each provide a rule with the same name. In this case the last config, proceeding left to right, wins. This is to say where there is a naming conflict, ESLint will use the rule from the last config on the list.</p>
<p>It is possible to use <a target="_blank" href="https://eslint.org/docs/latest/use/configure/configuration-files-deprecated">ESLint configuration file formats other than JSON</a>. You can provide the same information as in an <code>.eslintrc.json</code> file in a JavaScript (<code>.eslintrc.js</code> or <code>.eslintrc.cjs</code>) or yaml (<code>.eslintrc.yml</code> or <code>.eslintrc.yaml</code>) file instead.</p>
<p>Also, ESLint has a new configuration file format often called <a target="_blank" href="https://eslint.org/docs/latest/use/configure/configuration-files">flat config</a> (which I haven't used here) where the config files are either JavaScript or TypeScript files.</p>
<p>Armed with an understanding of how to configure ESLint for use, you are ready to set up ESLint in your Next.js project. The sections below shows you how to do this.</p>
<h3 id="heading-eslint-setup-for-typescript">ESLint Setup for TypeScript</h3>
<p><strong>If your app uses TypeScript</strong>, modify the ESLint configuration file (.esilntrc.json) as follows:</p>
<ol>
<li><p>On the terminal, in app's root folder, run the following command:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"> <span class="token function">npm</span> <span class="token function">install</span> --save-dev @typescript-eslint/parser @typescript-eslint/eslint-plugin typescript
</code></pre>
<p> <code>@typescript-eslint/eslint-plugin</code> provides a number of linting rules for TypeScript files, as well as shareable configs, that augment the checking that the TypeScript compiler does.  </p>
<p> <code>@typescript-eslint/parser</code> is a parser that allows ESLint to parse TypeScript files (by default it can only parser JavaScript files).</p>
</li>
</ol>
<p>    I am adding TypeScript compiler as a package - <code>typescript</code> - because <a target="_blank" href="https://typescript-eslint.io/getting-started"><code>typescript-eslint</code> Getting Started instructions</a> do the same.  </p>
<ol start="2">
<li><p>In app root folder, rename <code>.eslintrc.json</code> to <code>.eslintrc.js</code>. Then Replace contents of <code>.eslintrc.js</code> in app root with the following:</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"> <span class="token comment">/* eslint-env node */</span>
 module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token string">'next/core-web-vitals'</span><span class="token punctuation">,</span>
   <span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@typescript-eslint'</span><span class="token punctuation">,</span> <span class="token string">'tailwindcss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token string">'@typescript-eslint/parser'</span><span class="token punctuation">,</span>
   <span class="token literal-property property">overrides</span><span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span>
       <span class="token literal-property property">files</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'*.ts'</span><span class="token punctuation">,</span> <span class="token string">'*.tsx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token literal-property property">parserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token literal-property property">project</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./tsconfig.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token literal-property property">projectService</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
         <span class="token literal-property property">tsconfigRootDir</span><span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
         <span class="token string">'next/core-web-vitals'</span><span class="token punctuation">,</span>
         <span class="token string">'plugin:@typescript-eslint/recommended'</span><span class="token punctuation">,</span>
         <span class="token comment">//'plugin:@typescript-eslint/recommended-type-checked',</span>
         <span class="token comment">// 'plugin:@typescript-eslint/strict-type-checked',</span>
         <span class="token comment">// 'plugin:@typescript-eslint/stylistic-type-checked',</span>
       <span class="token punctuation">]</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p> <strong>This is what the various lines of this file do</strong>:  </p>
<p> <code>/* eslint-env node */</code> stops ESLint from complaining that this is a CommonJS module. We have had to put this in because ESLint, as we have configured it here, does not allow CommonJS modules (which <code>.eslintrc.js</code> is, see <code>module.exports = ...</code> at the top) and expects modules in the project to be ES6.</p>
</li>
</ol>
<p>    <code>root: true</code> says this is the topmost ESLint configuration file even though there may be nested ESLint configs in subfolders.</p>
<p>    <code>extends:</code> specifies various ESLint configs, each of which enables a collection of linting rules.</p>
<p>    <code>'next/core-web-vitals'</code> is a config provided by <code>eslint-config-next</code> that bundles Next.js-specific rules (both for JavaScript and TypeScript, from an inspection of its code on GitHub).</p>
<p>    The <code>recommended-type-checked</code> config (used in a nested <code>extends</code> within <code>overrides</code> object - this is explained shortly) is provided by <code>@typescript-eslint/eslint-plugin</code>. This plugin is part of the <a target="_blank" href="https://typescript-eslint.io/">typescript-eslint</a> project that publishes packages for linting rules and parsers to support linting of TypeScript files by ESLint.  </p>
<p>    The configs used is <a target="_blank" href="https://typescript-eslint.io/users/configs#recommended-configurations">described here</a>. It is a superset of the non-type checked versions of the config, <code>recommended</code>. It adds linting rules which use TypeScript's type checking API for additional type information. These rules are more powerful than those contained in the base, non-type-checked <code>recommended</code> config that only rely on the ESLint parser for TypeScript - package <code>@typescript-eslint/parser</code>.</p>
<p>    You might prefer to use the <code>strict-type-checked</code> and <code>stylistic-type-checked</code> configs, also provided by <code>@typescript-eslint/eslint-plugin</code>. These are stricter than what I have used.</p>
<p>    The least strict choice for TypeScript linting would probably be the <code>recommended</code> config. This is what is re-exported by <code>eslint-plugin-next</code> as config named <code>typescript</code> and is referenced in <a target="_blank" href="https://nextjs.org/docs/app/building-your-application/configuring/eslint#typescript">Next.js instructions for setting up ESLint with TypeScript</a> as <code>next/typescript</code> (at least as of the time of this writing, September 2024). I prefer the config I have used instead.</p>
<p>    <code>parser: '@typescript-eslint/parser'</code> specifies the ESLint TypeScript parser to be used instead of the default Espree parser which cannot parser TypeScript files.</p>
<p>    <code>parserOptions:</code> tells the parser where to find the <code>tsconfig.json</code> file. This information allows the rules in the type-checked config used above - <code>recommended-type-checked</code> - to use TypeScript type checking APIs.  </p>
<p>    If we were using non-type-checked rules contained in other configs exported by the plugin, such as the <code>recommended</code> config, we would not need to provide this information.</p>
<p>    <code>plugins: ['@typescript-eslint']</code> : I don't know what the purpose of this line is. It shouldn't be necessary and I have tested that the given ESLint configuration works fine without it. But it doesn't do any harm and was contained in <a target="_blank" href="https://typescript-eslint.io/getting-started/typed-linting">an example</a> in the plugin's documentation from which I adapted the above config. So I have kept it.</p>
<p>    The <code>overrides</code> section ensures that the TypeScript parser options that we’ve had to configure in order to support type-checked configs apply only to <code>.ts</code> and <code>.tsx</code> extensions (from <a target="_blank" href="https://stackoverflow.com/questions/58510287/parseroptions-project-has-been-set-for-typescript-eslint-parser">this excellent StackOverflow answer</a>). Otherwise, if <code>parser</code> and <code>parserOptions</code> objects had been at the top level, then running ESLint on the project would throw errors on <code>.js</code> files.  </p>
<p>    This is a problem as we have several <code>.js</code> config files including the <code>.eslintrc.js</code> itself, so there will be linting errors. We can avoid these errors by using the override.</p>
<h3 id="heading-eslint-setup-for-tailwind">ESLint Setup for Tailwind</h3>
<p><strong>If your app uses Tailwind,</strong> modify the config as follows:</p>
<ol>
<li><p>On the terminal, in app's root folder, run <code>npm install --save-dev eslint-plugin-tailwindcss</code></p>
</li>
<li><p>In ESLint config, add <code>"plugin:tailwindcss/recommended"</code> to the END of <code>extends</code>:</p>
<pre class="language-json" tabindex="0"><code class="language-json"> <span class="token punctuation">{</span>
   <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"next/core-web-vitals"</span><span class="token punctuation">,</span> ...<span class="token punctuation">,</span> <span class="token string">"plugin:tailwindcss/recommended"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

 <span class="token punctuation">}</span>
</code></pre>
</li>
<li><p>In the ESLint config, add <code>"tailwindcss"</code> to <code>plugins</code> and add a <code>rules</code> object as shown below:</p>
<pre class="language-json" tabindex="0"><code class="language-json"> <span class="token punctuation">{</span>
   <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">,</span> <span class="token string">"tailwindcss"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">"tailwindcss/classnames-order"</span><span class="token operator">:</span> <span class="token string">"off"</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>          
 <span class="token punctuation">}</span>
</code></pre>
</li>
<li><p><strong>If your app uses TYPESCRIPT,</strong> then also add <code>"plugin:tailwindcss/recommended"</code> to inner <code>extends</code> inside <code>overrides</code> and duplicate the <code>rules</code> object inside <code>overrides</code>:</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">   <span class="token punctuation">{</span>
     <span class="token operator">...</span>
     <span class="token literal-property property">overrides</span><span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span>
        <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"next/core-web-vitals"</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">,</span> <span class="token string">"plugin:tailwindcss/recommended"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">'tailwindcss/classnames-order'</span><span class="token operator">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<p>In the Tailwind setup steps above, we have installed the package for the ESLint plugin for Tailwind, <code>eslint-plugin-tailwindcss</code>, and used the config <code>recommended</code> provided by the plugin.</p>
<p><code>eslint-plugin-tailwind</code> provides some useful linting rules for Tailwind CSS classes used in HTML or JSX/TSX markup. The biggest one for me is that if a class used in code is not a Tailwind class, there would be a linting error. This makes sense as when I am using Tailwind, I only use Tailwind-generated classes and do not define my own CSS classes.</p>
<p>The plugin also has a rule that checks that the sequence of Tailwind class names used in the <code>class</code> or <code>className</code> attribute in markup follows a canonical ordering. But we installed <code>prettier-plugin-tailwindcss</code> in our Prettier configuration above which also reorders Tailwind class names. So we don’t need this rule in ESLint and it might conflict with what Prettier does in our workflow.</p>
<p>We’ll turn this rule off, which is named <code>tailwindcss/classnames-order</code>, in the configuration above by declaring the plugin in <code>plugins</code> object, then setting the rule to <code>off</code> in the <code>rules</code> object.</p>
<h3 id="heading-eslint-setup-for-prettier">ESLint Setup for Prettier</h3>
<ol>
<li><p>On the terminal run:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"> <span class="token function">npm</span> <span class="token function">install</span> --save-dev eslint-config-prettier
</code></pre>
</li>
<li><p>In ESLint config, add <code>"prettier"</code> to the END of <code>extends</code>:</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"> <span class="token punctuation">{</span>
   <span class="token string-property property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"next/core-web-vitals"</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">,</span> <span class="token string">"prettier"</span><span class="token punctuation">]</span>          
 <span class="token punctuation">}</span>
</code></pre>
</li>
<li><p><strong>If your app uses TypeScript</strong>, then also add <code>"plugin:tailwindcss/recommended"</code> to the inner <code>extends</code> inside <code>overrides</code> also:</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript">  <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">overrides</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
       <span class="token string-property property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"next/core-web-vitals"</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">,</span> <span class="token string">"prettier"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre>
<p> In the Prettier setup steps above, the config referenced as <code>prettier</code> is the name of the NPM package <a target="_blank" href="https://www.npmjs.com/package/eslint-config-prettier">eslint-config-prettier</a> with <code>eslint-config-</code> deleted. The default export from the package is an entire ESLint config object and this is the config we want to use.</p>
</li>
</ol>
<p>    So in this case, we do not suffix the name <code>prettier</code> with <code>/&lt;name of config&gt;</code> as we have done when referencing the named config <code>core-web-vitals</code> from package <code>eslint-config-next</code> when we referenced is as <code>next/core-web-vitals</code> (see step 1 above).</p>
<p>    This config switches off those rules in ESLint that conflict with the code formatting done by Prettier. This should be the last config in <code>extends</code>.  </p>
<ol start="4">
<li>Create <code>.eslintignore</code> in the project root. It doesn't need to have any content for now, but will come in handy in the future if ever you need to add folders or files that should be ignored by ESLint (see the final section of this post for an example).</li>
</ol>
<h2 id="heading-set-up-stylelint">Set Up Stylelint</h2>
<p>Stylelint is a linter for CSS and SCSS stylesheets.</p>
<p><strong>If you are using SCSS and NOT Tailwind,</strong> then set up Stylelint by following the instructions below. This set up will work for both CSS and SCSS files:</p>
<ol>
<li><p>On the terminal in project root run this command:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"> <span class="token function">npm</span> <span class="token function">install</span> --save-dev sass
</code></pre>
<p> Next.js has <a target="_blank" href="https://nextjs.org/docs/basic-features/built-in-css-support#sass-support">built-in SASS/SCSS support</a> (so the Webpack config knows how to handle <code>.scss</code> and <code>.sass</code> files). But you still need to install a version of the <code>sass</code> package yourself, which is what we did above.  </p>
</li>
<li><p>Next, install packages for Stylelint and its rule configs:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"> <span class="token function">npm</span> <span class="token function">install</span> --save-dev stylelint stylelint-config-standard-scss stylelint-config-prettier-scss
</code></pre>
<p> Of these three packages:</p>
<ul>
<li><p><a target="_blank" href="https://stylelint.io/"><code>stylelint</code></a> is the linter.</p>
</li>
<li><p><a target="_blank" href="https://github.com/stylelint-scss/stylelint-config-standard-scss"><code>stylelint-config-standard-scss</code></a> is a Stylelint config that provides linting rules. It uses the Stylelint plugin <a target="_blank" href="https://www.npmjs.com/package/stylelint-scss">stylelint-css</a> and extends configs <a target="_blank" href="https://github.com/stylelint/stylelint-config-standard">stylelint-config-standard</a> which defines rules for vanilla CSS, and <a target="_blank" href="https://github.com/stylelint-scss/stylelint-config-recommended-scss">stylelint-config-recommended-scss</a> which defines SCSS specific rules. As a result, extending from this one config is enough to get linting support for both CSS and SCSS files.</p>
</li>
<li><p><a target="_blank" href="https://www.npmjs.com/package/stylelint-config-prettier-scss"><code>stylelint-config-prettier-scss</code></a> extends <a target="_blank" href="https://www.npmjs.com/package/stylelint-config-prettier">stylelint-config-prettier</a> and turns off those Stylint rules that conflict with Prettier's code formatting. This should be declared last in <code>extends:</code> array in <code>.stylelintrc.json</code> (as shown below).</p>
</li>
</ul>
</li>
<li><p>Now, create <code>.stylelintrc.json</code> in project root with the following contents:</p>
<pre class="language-json" tabindex="0"><code class="language-json"> <span class="token punctuation">{</span>
   <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token string">"stylelint-config-standard-scss"</span><span class="token punctuation">,</span>
     <span class="token string">"stylelint-config-prettier-scss"</span>
   <span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">"selector-class-pattern"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre>
<p> The <code>"extends"</code> section declares the two Stylelint configs whose NPM packages we installed in the previous step.</p>
</li>
</ol>
<p>    The <code>"rules"</code> section is used to configure stylints rules. Here you can turn on or off, or configure the behavior of, individual Stylelint rules.</p>
<p>    You can turn off a rule by setting it to <code>null</code>, as I have done for <code>"selector-class-pattern"</code>. I turned it off because it insists on having CSS classes in the so called kebab case (for example, <code>.panel-quiz</code> instead of <code>.panelQuiz</code>). I find it inconvenient for various reasons so I turned it off.  </p>
<ol start="4">
<li><p>Next, create <code>.stylelintignore</code> in the project root with the following contents:</p>
<pre class="language-json" tabindex="0"><code class="language-json"> styles/globals.css
 styles/Home.module.css
 coverage
</code></pre>
<p> I created this file so that the two stylesheets generated by the Next.js CLI which do not comply with the linting rules can get ignored (there might be a better way of doing this but this works for me). Also, files in <code>coverage</code> folder do not need to be linted and would likely throw up errors.</p>
</li>
</ol>
<h2 id="heading-set-up-packagejson-scripts">Set Up <code>package.json</code> Scripts</h2>
<ol>
<li>The most important script is <code>"build"</code>. The default command for this script, <code>next build</code>, runs ESLint but not Prettier or (if you are using SCSS) Stylelint. So modify it in <code>package.json</code> file as follows:</li>
</ol>
<p>    <strong>If your app uses Tailwind, then:</strong></p>
<pre class="language-json" tabindex="0"><code class="language-json">    <span class="token punctuation">{</span>
      <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"prettier --check . &amp;&amp; next build"</span><span class="token punctuation">,</span>
        ...
</code></pre>
<p>    <strong>Otherwise, if your app uses SCSS, then:</strong></p>
<pre class="language-json" tabindex="0"><code class="language-json">    <span class="token punctuation">{</span>
      <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"prettier --check . &amp;&amp; stylelint --allow-empty-input \"**/*.{css,scss}\" &amp;&amp; next build"</span><span class="token punctuation">,</span>
        ...
</code></pre>
<p>    With this tweak to the existing <code>build</code> script, we can run <code>npm run build</code> either locally or in a CI/CD pipeline and it will fail not only on ESLint failure (this was the case before) but also on Prettier formatting or Stylelint failure.  </p>
<p>    Indeed if you <a target="_blank" href="https://nextjs.org/learn/basics/deploying-nextjs-app/deploy">deploy your app to Vercel</a>, the default pipeline there also calls <code>npm run build</code>. So when I introduced an error in one of my stylesheets, then deployed to Vercel, I got the following Stylelint error during deployment:</p>
<p>    <img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/om6228598f4pvb2iuwj9.png" alt="Stylelint errors when build script is run to build the app in Vercel's deployment pipeline" width="957" height="692" loading="lazy"></p>
<p>    Note that I used the <code>--check</code> flag with <code>prettier</code> in the script (that is, I used the command <code>prettier --check .</code>). This runs Prettier in check mode, so it only checks for correct formatting and does not change the formatting.</p>
<p>    I did this because the <code>build</code> script is what Vercel's deployment pipeline calls by default to build the code, and I don't want formatting to change during a CI build (nor do I want to tinker with Vercel defaults unless I absolutely have to).</p>
<p>    To run Prettier locally to actually format the codebase, I define a separate <code>build:local</code> script which is same as <code>build</code> but runs Prettier without the <code>--check</code> flag, as well as a separate <code>format</code> script just to format with Prettier (but not build). These are set up below.</p>
<ol start="2">
<li><p>Set up the <code>"format"</code> script in your <code>package.json</code>. This formats the codebase with Prettier and comes in handy every now and then:</p>
<pre class="language-json" tabindex="0"><code class="language-json"> <span class="token punctuation">{</span>
   <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     ...
     <span class="token property">"format"</span><span class="token operator">:</span> <span class="token string">"prettier --write ."</span>
</code></pre>
</li>
<li><p>I recommend setting up a <code>build:local</code> script as follows:</p>
</li>
</ol>
<p>    <strong>If your app uses Tailwind,</strong> then:</p>
<pre class="language-json" tabindex="0"><code class="language-json">    <span class="token property">"build:local"</span><span class="token operator">:</span> <span class="token string">"prettier --write . &amp;&amp; next build"</span>
</code></pre>
<p>    <strong>Otherwise, if your app uses SCSS,</strong> then:</p>
<pre class="language-json" tabindex="0"><code class="language-json">    <span class="token property">"build:local"</span><span class="token operator">:</span> <span class="token string">"prettier --write . &amp;&amp; stylelint --allow-empty-input \"**/*.{css,scss}\" &amp;&amp; next build"</span>
</code></pre>
<p>    Since we cannot format the code with Prettier prior to executing <code>next build</code> in the existing <code>build</code> script (for reasons described above), we can use this script locally to format code then lint and build in one go.</p>
<h2 id="heading-set-up-lint-staged">Set Up lint-staged</h2>
<p><a target="_blank" href="https://github.com/okonet/lint-staged">lint-staged</a> is a package that you can use to run formatting and linting commands on staged files in a Git repo. Staged files are those that have been added to the Git index using <code>git add .</code>. These are the files that have changed since the last commit and will get committed when you next run <code>git commit</code>.</p>
<p><a target="_blank" href="https://github.com/typicode/husky">Husky</a> is the typical choice in Node.js packages for registering commands to run in Git hooks. For example, registering the command <code>npx lint-staged</code> with Husky to run in the Git pre-commit hook means lint-staged will run automatically whenever you execute <code>git commit</code>.</p>
<p>At that time, the formatter (Prettier) and linters (ESLint or Stylelint) that have been configured to run in the lint-staged configuration file will run on the staged files. If there are any errors during formatting checks or linting, the commit will fail.</p>
<p>Whenever <code>git commit</code> fails due to linting errors, we can fix those, then run <code>git add .</code> and <code>git commit</code> again. Thus code only ever gets into the repo after it has been consistently formatted and verified to be free of linting errors. This is particularly advantageous in a team setting.</p>
<p>I prefer to only run <code>prettier --check .</code> on staged files. In particular, I do not change formatting of staged files and do not lint during a commit, for the following reasons:</p>
<p><strong>Reason for not formatting code:</strong> I almost always build and test my code before committing. Any code formatting should have happened prior to or during this local build and test.</p>
<p>I find the idea that code going into my repo should change automatically just as it is being committed <em>after</em> I have ascertained that any code changes are good to go, a little bit unappealing.</p>
<p><strong>Reason for not linting code:</strong> With TypeScript code, the compiler can catch a huge number of issues in code. The additional linting rules provided by <code>eslint-typescript/eslint-plugin</code> <a target="_blank" href="https://typescript-eslint.io/troubleshooting/faqs/typescript#why-dont-i-see-typescript-errors-in-my-eslint-output">only supplement the checks made by the TypeScript compiler</a>. So if I am linting code in staged files at commit time, I should build as well (so that the TypeScript compiler runs).</p>
<p>But building can be very time consuming on a large codebase. Besides, I almost always build and test (because of the way scripts in package.json have been set up above). Because of this, I don’t feel the need to repeat the lint and build process on staged files.</p>
<p>So, my personal preference is only to check for formatting on staged files, and neither reformat nor lint the code. This prevents inconsistently formatted code from getting into the Git repo where inconsistent formatting would make comparisons between different versions of the same file difficult.</p>
<p><strong>So now, set up lint-staged and Husky as follows:</strong></p>
<ol>
<li><p>Install the lint-staged package:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"> <span class="token function">npm</span> <span class="token function">install</span> --save-dev lint-staged
</code></pre>
</li>
<li><p>Create <code>lint-staged.config.js</code> in project root with the following contents:</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript"> <span class="token comment">/* eslint-env node */</span>
 <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">const</span> formatCommand <span class="token operator">=</span> <span class="token string">'prettier . --check'</span><span class="token punctuation">;</span>

 module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token string-property property">'*'</span><span class="token operator">:</span> formatCommand<span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li><p>Install the Husky NPM package.</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"> <span class="token function">npm</span> <span class="token function">install</span> --save-dev husky
</code></pre>
</li>
<li><p>Run the following on the terminal in app root to configure Husky to run <code>lint-staged</code> whenever <code>git commit</code> runs (in Git's pre-commit hook):</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"> npx husky init
 <span class="token builtin class-name">echo</span> <span class="token string">"npx lint-staged"</span> <span class="token operator">&gt;</span> .husky/pre-commit
</code></pre>
<p> You should now have a file <code>.husy/pre-commit</code> in your app's folder with only one line: <code>npx lint-staged</code>.</p>
</li>
</ol>
<h2 id="heading-set-up-vs-code-extensions">Set UP VS Code Extensions</h2>
<p>If you use VS Code as your code editor, you can install the following VS Code extensions to provide linting and formatting on file save and syntax highlight on linting errors:</p>
<ul>
<li><p><a target="_blank" href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint">ESLint extension</a></p>
</li>
<li><p><a target="_blank" href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode">Prettier extension</a></p>
</li>
<li><p><a target="_blank" href="https://marketplace.visualstudio.com/items?itemName=stylelint.vscode-stylelint">Stylelint extension</a> (if you're using SCSS and not Tailwind)</p>
</li>
<li><p><a target="_blank" href="https://marketplace.visualstudio.com/items?itemName=bradlc.vscode-tailwindcss">TaliwindCSS extension</a> (if you are using Tailwind and not SCSS)</p>
</li>
</ul>
<p><strong>Put the following in a</strong> <code>settings.json</code> <strong>file in the</strong> <code>.vscode</code> <strong>folder in the project</strong> (you can of course put these settings in you User Preferences file also. You can access it from Command Palette <strong>Ctrl + P</strong>).</p>
<pre class="language-json" tabindex="0"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"[javascript]"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"[typescript]"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"[typescriptreact]"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"[javascriptreact]"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"[scss]"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"editor.defaultFormatter"</span><span class="token operator">:</span> <span class="token string">"esbenp.prettier-vscode"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"stylelint.validate"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"css"</span><span class="token punctuation">,</span> <span class="token string">"scss"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"editor.formatOnSave"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre>
<p>As they’re set up, the extensions will lint and format on Save.</p>
<h2 id="heading-final-checks-and-troubleshooting">Final Checks and Troubleshooting</h2>
<p>Now it’s time to build and commit:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash"><span class="token function">npm</span> run <span class="token function">format</span>
<span class="token function">npm</span> run build
<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"fix: set up linting and formatting"</span>
</code></pre>
<p>Building and committing is a good sanity check for the setup we just did.</p>
<p>If anything had not been set up correctly, you might get errors either during build or at commit.</p>
<p>If you already had some code in the project, then there might be a few errors when you commit. Typically, these can be resolved by:</p>
<ul>
<li><p>Adding folders or files to one of the <code>*ignore</code> files. For example, I already had some code in my project with <a target="_blank" href="https://storybook.js.org/">Storybook</a> installed. So I had to add folders <code>.storybook</code> and <code>storybook-static</code> to each of <code>.stylelintignore</code>, <code>.eslintignore</code> and <code>.prettierignore</code> as all three tools complained about them.</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">  stories
  storybook-static
</code></pre>
</li>
<li><p>Adding plugins for specific file types. For example, I had Gherkin <code>.feature</code> files in my project to describe integration tests. Prettier couldn't format these. So I added the <a target="_blank" href="https://www.npmjs.com/package/prettier-plugin-gherkin?activeTab=readme">prettier-plugin-gherkin</a> by simply running:</p>
<pre class="language-plaintext" tabindex="0"><code class="language-plaintext">  npm install  prettier-plugin-gherkin --save-dev
</code></pre>
<p>  Note that <a target="_blank" href="https://prettier.io/docs/en/plugins.html">usually it is enough to install the package for a Prettier plugin</a> for Prettier to locate it and additional configuration is not required.  </p>
<p>  Likewise, ESLint complained when it encountered <code>.cy.ts</code> files containing Cypress interaction tests for my app. To resolve this linting error, I installed the NPM package for Cypress ESLint plugin and configured it <a target="_blank" href="https://github.com/cypress-io/eslint-plugin-cypress#installation">as described here</a> (unlike Prettier, to get this ESLint package to work, some configuration was required).  </p>
</li>
<li><p>The typescript config might be too strict and there might be a lot of errors when you build, such as:</p>
<p>  <img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1725931098287/9618aff2-844b-4b15-9b14-2c8d377bf8c8.png" alt="ESLint error that occur on build when an ESLint config for TypeScript is used that is too strict." width="725" height="478" loading="lazy"></p>
<p>  If you do not want to fix individual errors in your existing codebase, and they are too many to disable specific rules at error locations using ESLint comments (see below), then the simplest solution would be to disable the <code>@typescript-eslint/recommended-type-checked</code> config by commenting it out in <code>.eslintrc.js</code> and uncommenting <code>@typescript-eslint/recommended</code> which is less strict.  </p>
</li>
<li><p>Sometimes it is safe to turn off a linting rule at a specific line or for a whole file. While I am always wary of doing this, in a (deliberately bad) experimental code file, I had many instances of an error that VS Code ESLint extension pointed. This was not caught before but was now being pointed out because strict TypeScript linting rules had been enabled:</p>
<p>  <img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/sg2ne9v2w8dbquv9ytad.png" alt="Intellisense in VS Code showing an ESLint error on a lint of code in a file." width="865" height="217" loading="lazy"></p>
<p>  So I pressed <code>Ctrl + .</code> to Show Code Actions (I could instead have clicked the yellow lighbulb icon shown next to the issue), then selected “Disable <code>@typescript/no-non-null-assertion</code> for the entire file”.</p>
<p>  <img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/pqume7pod3jzflvblrus.png" alt="VS Code shows helpful tooltips when you click the bulb icon in the gutter. One of these allows y uoto disable an ESLint rule that is causing an error on the currently selected line of code." width="878" height="326" loading="lazy"></p>
<p>  This placed the comment <code>/* eslint-disable @typescript-eslint/no-non-null-assertion */</code> on top of my file to disable all instances of that particular error within the file:</p>
<p>  <img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/1d2kml4o11xpqaenk93b.png" alt="Special &quot;eslint-disable&quot; comment on top of a code file that disable a specific ESLint rule through the file." width="625" height="133" loading="lazy"></p>
</li>
</ul>
<h2 id="heading-conclusion">Conclusion</h2>
<p>This tutorial showed you how to configure linting and formatting tools in your Next.js app. I hope that it also gave you the background necessary both to understand the configurations given, and to customize them as needed.</p>
-->

