import{_ as m}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as v,d as n,f as s,b as h,a as k,t as g,n as i,g as c,w as p,e,r as o,o as b}from"./app-BVguHYKu.js";const f={},y={id:"frontmatter-title-관련",tabindex:"-1"},w={class:"header-anchor",href:"#frontmatter-title-관련"},j={class:"table-of-contents"},O={href:"https://en.wikipedia.org/wiki/Tony_Hoare",target:"_blank",rel:"noopener noreferrer"};function x(r,a){const l=o("VPCard"),t=o("router-link"),u=o("SiteInfo"),d=o("VPIcon");return b(),v("div",null,[n("h1",y,[n("a",w,[n("span",null,g(r.$frontmatter.title)+" 관련",1)])]),s(l,i(c({title:"Java > Article(s)",desc:"Article(s)",link:"/programming/java/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),n("nav",j,[n("ul",null,[n("li",null,[s(t,{to:"#optionals"},{default:p(()=>a[0]||(a[0]=[e("Optionals")])),_:1,__:[0]})]),n("li",null,[s(t,{to:"#the-old-way"},{default:p(()=>a[1]||(a[1]=[e("The Old Way")])),_:1,__:[1]})]),n("li",null,[s(t,{to:"#your-first-optional"},{default:p(()=>a[2]||(a[2]=[e("Your First Optional")])),_:1,__:[2]})]),n("li",null,[s(t,{to:"#using-your-optional"},{default:p(()=>a[3]||(a[3]=[e("Using Your Optional")])),_:1,__:[3]})]),n("li",null,[s(t,{to:"#using-optionals-effectively"},{default:p(()=>a[4]||(a[4]=[e("Using Optionals Effectively")])),_:1,__:[4]})]),n("li",null,[s(t,{to:"#getting-values-from-an-optional"},{default:p(()=>a[5]||(a[5]=[e("Getting Values from an Optional")])),_:1,__:[5]})]),n("li",null,[s(t,{to:"#optionals-of-optionals"},{default:p(()=>a[6]||(a[6]=[e("Optionals of Optionals")])),_:1,__:[6]})]),n("li",null,[s(t,{to:"#chaining-things-together"},{default:p(()=>a[7]||(a[7]=[e("Chaining Things Together")])),_:1,__:[7]})]),n("li",null,[s(t,{to:"#wrapping-up"},{default:p(()=>a[8]||(a[8]=[e("Wrapping up")])),_:1,__:[8]})])])]),a[12]||(a[12]=n("hr",null,null,-1)),s(u,{name:"Java Optionals",desc:"The post discusses the drawbacks of null references in programming and introduces the Optional type as a solution, particularly in Java. The Optional type helps avoid null reference exceptions by allowing safe interaction with absent values using methods like ifPresent, ifPresentOrElse, map, and flatMap.",url:"https://frontendmasters.com/blog/java-optionals/",logo:"https://frontendmasters.com/favicon.ico",preview:"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/3683"}),n("p",null,[a[10]||(a[10]=e("There’s an old saying in computer science that null was the “billion dollar mistake.” It’s actually a quote from")),n("a",O,[s(d,{icon:"fa-brands fa-wikipedia-w"}),a[9]||(a[9]=e("Tony Hoare"))]),a[11]||(a[11]=e(", the creator of the null reference."))]),a[13]||(a[13]=h(`<p>It’s easy to understand the hate for <code>null</code>. We’ve all run into null reference exceptions in just about any language we’ve used. But as annoying as they can be, it’s easy to wonder how they can be avoided. After all, it’s inevitable that sometimes you have a variable pending assignment. If not null, how would the absence of a value be represented in a way that prevents a developer from creating exceptions when interacting with that non-value?</p><hr><h2 id="optionals" tabindex="-1"><a class="header-anchor" href="#optionals"><span>Optionals</span></a></h2><p>This post is about the Optional type, which is a common way programming languages protect developers from null references. The idea is, the optional type gives you a box that can be empty (null) <em>or</em> have a value in it. Along with some APIs to safely deal with these possibilities.</p><p>This is a concept that exists in many languages. Swift has a particularly elegant implementation, which is integrated into various language-level features. But for this post, we’ll look at Java, which added an Optional type in version 8 of the language. Along the way we’ll run into a few other modern Java features.</p><hr><h2 id="the-old-way" tabindex="-1"><a class="header-anchor" href="#the-old-way"><span>The Old Way</span></a></h2><p>Let’s say we have a basic<code>Person</code>type:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">record</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Records were added to Java 14, and are essentially simplified classes for objects which are mainly carriers of data.</p><p>Let’s say we want to declare a variable of type<code>Person</code>. Normally we’d write:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Person</span> p<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then carefully check for null before referencing any properties.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you failed to check, you’d be greeted with something like:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="log"><span>log</span></div><div class="language-plaintext line-numbers-mode" data-highlighter="prismjs" data-ext="plaintext"><pre><code class="language-plaintext"><span class="line">Exception in thread &quot;main&quot; java.lang.NullPointerException: Cannot read field &quot;name&quot; because &quot;p&quot; is null  </span>
<span class="line">	at Main.main(Main.java:13)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><hr><h2 id="your-first-optional" tabindex="-1"><a class="header-anchor" href="#your-first-optional"><span>Your First Optional</span></a></h2><p>To use the Optional type, make sure to do the proper import:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Optional</span></span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then declare your variable:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> personMaybe<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If you don’t have a value to assign, you can indicate that by assigning<code>Optional.empty()</code></p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line">personMaybe <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Or, you can assign an actual value with the<code>of</code>static method.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line">personMaybe <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Mike&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If you try to get cute and assign null this way:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line">personMaybe <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You’ll be greeted by an error immediately.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="log"><span>log</span></div><div class="language-plaintext line-numbers-mode" data-highlighter="prismjs" data-ext="plaintext"><pre><code class="language-plaintext"><span class="line">Exception in thread &quot;main&quot; java.lang.NullPointerException</span>
<span class="line">	at java.base/java.util.Objects.requireNonNull(Objects.java:209)</span>
<span class="line">	at java.base/java.util.Optional.of(Optional.java:113)</span>
<span class="line">	at Main.main(Main.java:12)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>If you truly have a value that might be null, which you want to safely and correctly assign to an optional, you can use the <code>ofNullable</code> method:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token comment">// where x is of type Person that could be null</span></span>
<span class="line">personMaybe <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="using-your-optional" tabindex="-1"><a class="header-anchor" href="#using-your-optional"><span>Using Your Optional</span></a></h2><p>It’s one thing to have an optional type that can hold a value, but how do you<em>use</em> thevalue? The crudest, most dangerous way to access the value contained in your optional is with the<code>get</code>method</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>personMaybe<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The <code>get()</code>method returns the value that’s in the optional if there is one, or if the optional is empty, it will promptly error out.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="log"><span>log</span></div><div class="language-plaintext line-numbers-mode" data-highlighter="prismjs" data-ext="plaintext"><pre><code class="language-plaintext"><span class="line">Exception in thread &quot;main&quot; java.util.NoSuchElementException: No value present  </span>
<span class="line">	at java.base/java.util.Optional.get(Optional.java:143)  </span>
<span class="line">	at Main.main(Main.java:21)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>There’s an<code>isPresent()</code>you can call, to check for this.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>personMaybe<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>personMaybe<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here we’re no better off than we were before. These APIs allow you to (carefully) interact with other APIs that are not coded with Optional types. In general, using<code>get</code>should be avoided where possible.</p><p>Let’s see some of the better APIs Optional ships with.</p><hr><h2 id="using-optionals-effectively" tabindex="-1"><a class="header-anchor" href="#using-optionals-effectively"><span>Using Optionals Effectively</span></a></h2><p>If we want to use an optional, rather than carefully calling<code>get</code>(after verifying there’s a value) we can use the<code>ifPresent()</code>method.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line">personMaybe<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span>p <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>We pass in a lambda expression that will be invoked with the <code>person</code> value. If the optional is empty, nothing will be done. If you’d like to also handle the empty use case, we can use<code>ifPresentOrElse</code>.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line">personMaybe<span class="token punctuation">.</span><span class="token function">ifPresentOrElse</span><span class="token punctuation">(</span></span>
<span class="line">  p <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line">  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;No person&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It’s the same as before, except we now provide a lambda for when the optional is empty.</p><hr><h2 id="getting-values-from-an-optional" tabindex="-1"><a class="header-anchor" href="#getting-values-from-an-optional"><span>Getting Values from an Optional</span></a></h2><p>Let’s say we want to get a value from an Optional. Let’s first expand our<code>Person</code>type just a bit and add a<code>bestFriend</code>property of type<code>Optional&lt;Person&gt;</code>.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">record</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> bestFriend<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now let’s say we have a<code>Person</code>optional:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line">personMaybe <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Mike&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then let’s say we want to get that person’s name (and we don’t want to assume there’s a value in there). We want to store this as an<code>Optional&lt;String&gt;</code>. Obviously we could do something ridiculous like this</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> personsName <span class="token operator">=</span> personMaybe<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line">  <span class="token operator">?</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>personMaybe<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> </span>
<span class="line">  <span class="token operator">:</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It should come as no surprise that there’s a more direct API: <code>map</code>.The <code>map</code>API takes a lambda expression, from which you return whatever you want from the object. The type system will look at what you return and fit that into an Optional of that type. If there’s no value present in the Optional, the lambda will not be called, and you’ll be safely left with<code>Optional.empty()</code></p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> personsName <span class="token operator">=</span> personMaybe<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>p <span class="token operator">-&gt;</span> p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Since records automatically create getter methods for all properties, the following would also work:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> personsName <span class="token operator">=</span> personMaybe<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The<code>::</code>syntax is a method reference, which was added in Java 8. As of version 10 Java supports inferred typings, so you could also write:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">var</span> personsName <span class="token operator">=</span> personMaybe<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The <code>var</code>keyword takes the meaning from C#, not JavaScript. It does<em>not</em>represent a dynamically typed value. Rather, it’s merely a shortcut where, instead of typing out your type, you can tell the type system to infer the correct type based on what’s on the right hand side of the assignment, and pretend you typed that. Needless to say…</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">var</span> x<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>… produces a compiler error of:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="log"><span>log</span></div><div class="language-plaintext line-numbers-mode" data-highlighter="prismjs" data-ext="plaintext"><pre><code class="language-plaintext"><span class="line">java: cannot infer type for local variable x  </span>
<span class="line">  (cannot use &#39;var&#39; on variable without initializer)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><hr><h2 id="optionals-of-optionals" tabindex="-1"><a class="header-anchor" href="#optionals-of-optionals"><span>Optionals of Optionals</span></a></h2><p>So far we’ve added the<code>bestFriend</code>property to our Person record, which is of type <code>Optional&lt;Person&gt;</code>. Let’s put it to good use.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> personsBestFriend <span class="token operator">=</span> personMaybe<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>p <span class="token operator">-&gt;</span> p<span class="token punctuation">.</span>bestFriend<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Rather than use<code>var</code>, I explicitly typed out the type, so we’d know immediately what was wrong. IntelliJ highlights this line as an error, and when we hover, we’re greeted by this (surprisingly clear) error message.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Required</span> type<span class="token operator">:</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token class-name">Provided</span><span class="token operator">:</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Optional</span><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>The value we return from the<code>map</code>method is placed inside of an optional for us. But, here, the value we return is<em>already an</em>optional, so we’re left with an optional of an optional. If we want to “flatten” this optional of an optional into just an optional, we use <code>flatMap</code> (just like we use <code>flatMap</code> in JavaScript when we want to flatten an array of arrays from<code>Array.map</code>).</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> personsBestFriend <span class="token operator">=</span> personMaybe<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>p <span class="token operator">-&gt;</span> p<span class="token punctuation">.</span>bestFriend<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>We can use this optional now, as we did before.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line">personsBestFriend<span class="token punctuation">.</span><span class="token function">ifPresentOrElse</span><span class="token punctuation">(</span></span>
<span class="line">  s <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line">  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;No person&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="chaining-things-together" tabindex="-1"><a class="header-anchor" href="#chaining-things-together"><span>Chaining Things Together</span></a></h2><p>Rather than pulling the name off of the best friend, let’s clean the code above up a bit by extracting the best friend’s name directly, and then using that. Let’s also start to use method references more, to remove some of the bloat</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bestFriendsName <span class="token operator">=</span> personMaybe<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">bestFriend</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>We can use this as before:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line">bestFriendsName<span class="token punctuation">.</span><span class="token function">ifPresentOrElse</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Nothing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>For one final trick, let’s note that Optionals have an<code>orElse</code>method. If you have an<code>Optional&lt;T&gt;</code>, <code>orElse</code> takes a value (not an optional) of type T. If the optional had a value, that value is returned. If the optional was empty, the value you provided is returned. It’s a good way to convert an optional to a real value, while providing a default value if the optional was empty. Let’s see it in action with the code above, grabbing our person’s best friend’s name (if there is one).</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">String</span> bestFriendsName <span class="token operator">=</span> personMaybe</span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">bestFriend</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token operator">::</span><span class="token function">name</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token string">&quot;No friend found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>and now we can use this string, which is guaranteed to not be null.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>bestFriendsName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h2 id="wrapping-up" tabindex="-1"><a class="header-anchor" href="#wrapping-up"><span>Wrapping up</span></a></h2><p>I hope you enjoyed this introduction to Java’s Optional type. It’s a great tool to make your code safer and more clear.</p>`,90)),k(" TODO: add ARTICLE CARD "),s(l,i(c({title:"Java Optionals",desc:"The post discusses the drawbacks of null references in programming and introduces the Optional type as a solution, particularly in Java. The Optional type helps avoid null reference exceptions by allowing safe interaction with absent values using methods like ifPresent, ifPresentOrElse, map, and flatMap.",link:"https://chanhi2000.github.io/bookshelf/frontendmasters.com/java-optionals.html",logo:"https://frontendmasters.com/favicon.ico",background:"rgba(188,75,52,0.2)"})),null,16)])}const T=m(f,[["render",x]]),I=JSON.parse('{"path":"/frontendmasters.com/java-optionals.html","title":"Java Optionals","lang":"en-US","frontmatter":{"lang":"en-US","title":"Java Optionals","description":"Article(s) > Java Optionals","icon":"fa-brands fa-java","category":["Java","Article(s)"],"tag":["blog","frontendmasters.com","java"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Java Optionals\\",\\"image\\":[\\"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/3683\\"],\\"datePublished\\":\\"2024-08-30T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Adam Rackis\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/frontendmasters.com/java-optionals.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"Java Optionals"}],["meta",{"property":"og:description","content":"Article(s) > Java Optionals"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/3683"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/3683"}],["meta",{"name":"twitter:image:alt","content":"Java Optionals"}],["meta",{"property":"article:author","content":"Adam Rackis"}],["meta",{"property":"article:tag","content":"java"}],["meta",{"property":"article:tag","content":"frontendmasters.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2024-08-30T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Java Optionals"},{"property":"og:description","content":"Java Optionals"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/frontendmasters.com/java-optionals.html"}]],"prev":"/programming/java/articles/README.md","date":"2024-08-30T00:00:00.000Z","isOriginal":false,"author":"Adam Rackis","cover":"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/3683"},"git":{},"readingTime":{"minutes":5.64,"words":1691},"filePathRelative":"frontendmasters.com/java-optionals.md","copyright":{"author":"Adam Rackis"}}');export{T as comp,I as data};
