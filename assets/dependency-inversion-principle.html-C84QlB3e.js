import{_ as k}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as v,d as s,f as a,b as h,a as g,t as b,n as t,g as i,w as o,e,r as c,o as y}from"./app-BVguHYKu.js";const w="/bookshelf/assets/image/code-maze.com/dependency-inversion-principle/06-DIP-finished.png",f={},P={id:"frontmatter-title-관련",tabindex:"-1"},I={class:"header-anchor",href:"#frontmatter-title-관련"},E={class:"table-of-contents"},D={class:"hint-container info"},S={class:"hint-container info"},M={href:"https://github.com/CodeMazeBlog/solid-principles-csharp/tree/dependency-inversion-principle",target:"_blank",rel:"noopener noreferrer"};function C(d,n){const p=c("VPCard"),l=c("router-link"),r=c("SiteInfo"),m=c("VPIcon"),u=c("RouteLink");return y(),v("div",null,[s("h1",P,[s("a",I,[s("span",null,b(d.$frontmatter.title)+" 관련",1)])]),a(p,t(i({title:"C# > Article(s)",desc:"Article(s)",link:"/programming/cs/articles/README.md",logo:"https://chanhi2000.github.io/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",E,[s("ul",null,[s("li",null,[a(l,{to:"#what-are-the-high-level-and-low-level-modules"},{default:o(()=>n[0]||(n[0]=[e("What are the High-Level and Low-Level Modules")])),_:1,__:[0]})]),s("li",null,[a(l,{to:"#example-which-violates-dip"},{default:o(()=>n[1]||(n[1]=[e("Example Which Violates DIP")])),_:1,__:[1]})]),s("li",null,[a(l,{to:"#making-our-code-better-by-implementing-the-dependency-inversion-principle"},{default:o(()=>n[2]||(n[2]=[e("Making Our Code Better by implementing the Dependency Inversion Principle")])),_:1,__:[2]})]),s("li",null,[a(l,{to:"#benefits-of-implementing-the-dependency-inversion-principle"},{default:o(()=>n[3]||(n[3]=[e("Benefits of Implementing the Dependency Inversion Principle")])),_:1,__:[3]})]),s("li",null,[a(l,{to:"#conclusion"},{default:o(()=>n[4]||(n[4]=[e("Conclusion")])),_:1,__:[4]})])])]),n[17]||(n[17]=s("hr",null,null,-1)),a(r,{name:"SOLID Principles in C# – Dependency Inversion Principle",desc:"In this article you are going to learn about Dependency Inversion Principle, how to implement this principle and what are the benefits of implementation.",url:"https://code-maze.com/dependency-inversion-principle",logo:"/assets/image/code-maze.com/favicon.png",preview:"/assets/image/dependency-inversion-principle/banner.png"}),n[18]||(n[18]=s("p",null,"The basic idea behind the Dependency Inversion Principle is that we should create the higher-level modules with its complex logic in such a way to be reusable and unaffected by any change from the lower-level modules in our application. To achieve this kind of behavior in our apps, we introduce abstraction which decouples higher from lower-level modules.",-1)),n[19]||(n[19]=s("p",null,"Having this idea in mind the Dependency Inversion Principle states that",-1)),n[20]||(n[20]=s("ul",null,[s("li",null,"High-level modules should not depend on low-level modules, both should depend on abstractions."),s("li",null,"Abstractions should not depend on details. Details should depend on abstractions.")],-1)),n[21]||(n[21]=s("p",null,"We are going to make all of this easier to understand with an example and additional explanations.",-1)),s("div",D,[n[5]||(n[5]=s("p",{class:"hint-container-title"},"Series",-1)),a(p,t(i({title:"SOLID Principles in C# – Single Responsibility Principle",desc:"In this article you will learn how to implement Single Responsibility Principle (SRP) in your code thus making it better, readable and maintainable as well.",link:"/code-maze.com/single-responsibility-principle.md",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16),a(p,t(i({title:"SOLID Principles in C# – Open Closed Principle",desc:"In this article you will learn about Open Closed Principle, how to implement it step by step and why it is important while developing a project.",link:"/code-maze.com/open-closed-principle.md",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16),a(p,t(i({title:"SOLID Principles in C# – Liskov Substitution Principle",desc:"In this article you will learn more about Liskov Substitution Principle, how to achieve it in your code and why should we use it.",link:"/code-maze.com/liskov-substitution-principle.md",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16),a(p,t(i({title:"SOLID Principles in C# – Interface Segregation Principle",desc:"In this article you are going to learn about Interface Segregation Principle, how to implement it and what are the benefits of its implementation.",link:"/code-maze.com/interface-segregation-principle.md",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16),a(p,t(i({title:"SOLID Principles in C# – Dependency Inversion Principle",desc:"In this article you are going to learn about Dependency Inversion Principle, how to implement this principle and what are the benefits of implementation.",link:"/code-maze.com/dependency-inversion-principle.md",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16)]),s("div",S,[n[11]||(n[11]=s("p",{class:"hint-container-title"},"Info",-1)),s("p",null,[n[9]||(n[9]=e("To download the source code for this project, check out the ")),s("a",M,[n[6]||(n[6]=e("Dependency Inversion Principle Project Source Code (")),a(m,{icon:"iconfont icon-github"}),n[7]||(n[7]=s("code",null,"CodeMazeBlog/solid-principles-csharp",-1)),n[8]||(n[8]=e(")"))]),n[10]||(n[10]=e("."))]),a(r,{name:"CodeMazeBlog/solid-principles-csharp at dependency-inversion-principle",desc:"This repository contains source code for the SOLID principles in C# on Code Maze blog",url:"https://github.com/CodeMazeBlog/solid-principles-csharp/",logo:"https://github.githubassets.com/favicons/favicon-dark.svg",preview:"https://opengraph.githubassets.com/ea17b32ee72d286321112ce49503fb8ba1f177691cc01f5cf36da56bafc48bec/CodeMazeBlog/solid-principles-csharp"})]),s("p",null,[n[13]||(n[13]=e("To read about other SOLID principles, check out our ")),a(u,{to:"/code-maze.com/solid-principles.html"},{default:o(()=>n[12]||(n[12]=[s("strong",null,"SOLID Principles page",-1)])),_:1,__:[12]}),n[14]||(n[14]=e("."))]),n[22]||(n[22]=s("hr",null,null,-1)),n[23]||(n[23]=s("h2",{id:"what-are-the-high-level-and-low-level-modules",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#what-are-the-high-level-and-low-level-modules"},[s("span",null,"What are the High-Level and Low-Level Modules")])],-1)),n[24]||(n[24]=s("p",null,"The high-level modules describe those operations in our application that have more abstract nature and contain more complex logic. These modules orchestrate low-level modules in our application.",-1)),n[25]||(n[25]=s("p",null,"The low-level modules contain more specific individual components focusing on details and smaller parts of the application. These modules are used inside the high-level modules in our app.",-1)),n[26]||(n[26]=s("p",null,"What we need to understand when talking about DIP and these modules is that both, the high-level and low-level modules, depend on abstractions. We can find different opinions about if the DIP inverts dependency between high and low-level modules or not. Some agree with the first opinion and others prefer the second. But the common ground is that the DIP creates a decoupled structure between high and low-level modules by introducing abstraction between them.",-1)),s("p",null,[a(u,{to:"/code-maze.com/dependency-injection-aspnet.html"},{default:o(()=>n[15]||(n[15]=[s("strong",null,"Dependency Injection",-1)])),_:1,__:[15]}),n[16]||(n[16]=e(" is one way of implementing the Dependency Inversion Principle."))]),n[27]||(n[27]=h(`<hr><h2 id="example-which-violates-dip" tabindex="-1"><a class="header-anchor" href="#example-which-violates-dip"><span>Example Which Violates DIP</span></a></h2><p>Let’s start by creating two enumerations and one model class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Gender</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    Male<span class="token punctuation">,</span></span>
<span class="line">    Female</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Position</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    Administrator<span class="token punctuation">,</span></span>
<span class="line">    Manager<span class="token punctuation">,</span></span>
<span class="line">    Executive</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name">Gender</span> Gender <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name">Position</span> Position <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To continue, we are going to create one low-level class which keeps (in a simplified way) track of our employees:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeManager</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span> _employees<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">EmployeeManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _employees <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddEmployee</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _employees<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Furthermore, we are going to create a higher-level class to perform some kind of statistical analysis on our employees:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeStatistics</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">EmployeeManager</span> _empManager<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">EmployeeStatistics</span><span class="token punctuation">(</span><span class="token class-name">EmployeeManager</span> empManager<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _empManager <span class="token operator">=</span> empManager<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">CountFemaleManagers</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//logic goes here</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With this kind of structure in our EmployeeManager class, we can’t make use of the <code>_employess</code> list in the <code>EmployeeStatistics</code> class, so the obvious solution would be to expose that private list:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeManager</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span> _employees<span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">EmployeeManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _employees <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddEmployee</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _employees<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span> Employees <span class="token operator">=&gt;</span> _employees<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, we can complete the <code>Count</code> method logic:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeStatistics</span> </span>
<span class="line"><span class="token punctuation">{</span> </span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">EmployeeManager</span> _empManager<span class="token punctuation">;</span> </span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">EmployeeStatistics</span><span class="token punctuation">(</span><span class="token class-name">EmployeeManager</span> empManager<span class="token punctuation">)</span> </span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">       _empManager <span class="token operator">=</span> empManager<span class="token punctuation">;</span> </span>
<span class="line">    <span class="token punctuation">}</span> </span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> CountFemaleManagers <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> </span>
<span class="line">      _empManager<span class="token punctuation">.</span>Employees<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span>emp <span class="token operator">=&gt;</span> emp<span class="token punctuation">.</span>Gender <span class="token operator">==</span> Gender<span class="token punctuation">.</span>Female <span class="token operator">&amp;&amp;</span> emp<span class="token punctuation">.</span>Position <span class="token operator">==</span> Position<span class="token punctuation">.</span>Manager<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Even though this will work just fine, this is not what we consider a good code and it violates the DIP.</p><p>How is that?</p><p>Well, first of all, our <code>EmployeeStatistics</code> class has a strong relation (coupled) to the EmployeeManager class and we can’t send any other object in the <code>EmployeeStatistics</code> constructor except the <code>EmployeeManager</code> object. The second problem is that we are using the public property from the low-level class inside the high-level class. By doing so, our low-level class can’t change its way of keeping track of employees. If we want to change its behavior to use a dictionary instead of a list, we need to change the <code>EmployeeStatistics</code> class behavior for sure. And that’s something we want to avoid if possible.</p><hr><h2 id="making-our-code-better-by-implementing-the-dependency-inversion-principle" tabindex="-1"><a class="header-anchor" href="#making-our-code-better-by-implementing-the-dependency-inversion-principle"><span>Making Our Code Better by implementing the Dependency Inversion Principle</span></a></h2><p>What we want is to decouple our two classes so the both of them depend on abstraction.</p><p>So, the first thing we need to do is to create the <code>IEmployeeSearchable</code> interface:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IEmployeeSearchable</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span> <span class="token function">GetEmployeesByGenderAndPosition</span><span class="token punctuation">(</span><span class="token class-name">Gender</span> gender<span class="token punctuation">,</span> <span class="token class-name">Position</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then, let’s modify the <code>EmployeeManager</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeManager</span><span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IEmployeeSearchable</span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span> _employees<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">EmployeeManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _employees <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddEmployee</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _employees<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Employee<span class="token punctuation">&gt;</span></span> <span class="token function">GetEmployeesByGenderAndPosition</span><span class="token punctuation">(</span><span class="token class-name">Gender</span> gender<span class="token punctuation">,</span> <span class="token class-name">Position</span> position<span class="token punctuation">)</span></span>
<span class="line">        <span class="token operator">=&gt;</span> _employees<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>emp <span class="token operator">=&gt;</span> emp<span class="token punctuation">.</span>Gender <span class="token operator">==</span> gender <span class="token operator">&amp;&amp;</span> emp<span class="token punctuation">.</span>Position <span class="token operator">==</span> position<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally, we can modify the <code>EmployeeStatistics</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeStatistics</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">IEmployeeSearchable</span> _emp<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">EmployeeStatistics</span><span class="token punctuation">(</span><span class="token class-name">IEmployeeSearchable</span> emp<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _emp <span class="token operator">=</span> emp<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">CountFemaleManagers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> </span>
<span class="line">    _emp<span class="token punctuation">.</span><span class="token function">GetEmployeesByGenderAndPosition</span><span class="token punctuation">(</span>Gender<span class="token punctuation">.</span>Female<span class="token punctuation">,</span> Position<span class="token punctuation">.</span>Manager<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This looks much better now and it’s implemented by DIP rules. Now, our <code>EmployeeStatistics</code> class is not dependent on the lower-level class and the <code>EmployeeManager</code> class can change its behavior about storing employees as well.</p><p>Finally, we can check the result by modifying <code>Program.cs</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">class</span> <span class="token class-name">Program</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name"><span class="token keyword">var</span></span> empManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EmployeeManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        empManager<span class="token punctuation">.</span><span class="token function">AddEmployee</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Employee</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Leen&quot;</span><span class="token punctuation">,</span> Gender <span class="token operator">=</span> Gender<span class="token punctuation">.</span>Female<span class="token punctuation">,</span> Position <span class="token operator">=</span> Position<span class="token punctuation">.</span>Manager <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        empManager<span class="token punctuation">.</span><span class="token function">AddEmployee</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Employee</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Mike&quot;</span><span class="token punctuation">,</span> Gender <span class="token operator">=</span> Gender<span class="token punctuation">.</span>Male<span class="token punctuation">,</span> Position <span class="token operator">=</span> Position<span class="token punctuation">.</span>Administrator <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name"><span class="token keyword">var</span></span> stats <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EmployeeStatistics</span><span class="token punctuation">(</span>empManager<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Number of female managers in our company is: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">stats<span class="token punctuation">.</span><span class="token function">CountFemaleManagers</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+w+'" alt="finished example - Dependency Inversion Principle" tabindex="0" loading="lazy"><figcaption>finished example - Dependency Inversion Principle</figcaption></figure><hr><h2 id="benefits-of-implementing-the-dependency-inversion-principle" tabindex="-1"><a class="header-anchor" href="#benefits-of-implementing-the-dependency-inversion-principle"><span>Benefits of Implementing the Dependency Inversion Principle</span></a></h2><p>Reducing the number of dependencies among modules is an important part of the process of creating an application. This is something that we get if we implement DIP correctly. Our classes are not tightly coupled with the lower-tier objects and we can easily reuse the logic from the high-tier modules.</p><p>So, the main reason why DIP is so important is the modularity and reusability of the application modules.</p><p>It is also important to mention that changing already implemented modules is risky. By depending on abstraction and not on a concrete implementation, we can reduce that risk by not having to change high-level modules in our project.</p><p>Finally, DIP when applied correctly gives us the flexibility and stability at the level of the entire architecture of our application. Our application will be able to evolve more securely and become stable and robust.</p><hr><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2><p>So to sum up, the Dependency Inversion Principle is the last part of the SOLID principles which introduce an abstraction between high and low-level components inside our project to remove dependencies between them.</p><p>If someone asks: „Should I put an effort to implement the DIP into my code?“, our answer would be: „Yes you should“. Loosely coupled code and reusable components should be our goal and responsibility when developing software applications.</p>',40)),g(" TODO: add ARTICLE CARD "),a(p,t(i({title:"SOLID Principles in C# – Dependency Inversion Principle",desc:"In this article you are going to learn about Dependency Inversion Principle, how to implement this principle and what are the benefits of implementation.",link:"https://chanhi2000.github.io/bookshelf/code-maze.com/dependency-inversion-principle.html",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16)])}const z=k(f,[["render",C]]),O=JSON.parse('{"path":"/code-maze.com/dependency-inversion-principle.html","title":"SOLID Principles in C# – Dependency Inversion Principle","lang":"en-US","frontmatter":{"lang":"en-US","title":"SOLID Principles in C# – Dependency Inversion Principle","description":"Article(s) > SOLID Principles in C# – Dependency Inversion Principle","icon":"iconfont icon-csharp","category":["C#","DotNet","Article(s)"],"tag":["blog","code-maze.com","cs","c#","csharp","dotnet"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SOLID Principles in C# – Dependency Inversion Principle\\",\\"image\\":[\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/dependency-inversion-principle/06-DIP-finished.png\\"],\\"datePublished\\":\\"2019-01-28T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Marinko Spasojević\\",\\"url\\":\\"https://code-maze.com/author/marinko/\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/code-maze.com/dependency-inversion-principle.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"SOLID Principles in C# – Dependency Inversion Principle"}],["meta",{"property":"og:description","content":"Article(s) > SOLID Principles in C# – Dependency Inversion Principle"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/dependency-inversion-principle/banner.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/dependency-inversion-principle/banner.png"}],["meta",{"name":"twitter:image:alt","content":"SOLID Principles in C# – Dependency Inversion Principle"}],["meta",{"property":"article:author","content":"Marinko Spasojević"}],["meta",{"property":"article:tag","content":"dotnet"}],["meta",{"property":"article:tag","content":"csharp"}],["meta",{"property":"article:tag","content":"c#"}],["meta",{"property":"article:tag","content":"cs"}],["meta",{"property":"article:tag","content":"code-maze.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2019-01-28T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > SOLID Principles in C# – Dependency Inversion Principle"},{"property":"og:description","content":"SOLID Principles in C# – Dependency Inversion Principle"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/code-maze.com/dependency-inversion-principle.html"}]],"prev":"/programming/cs/articles/README.md","date":"2019-01-28T00:00:00.000Z","isOriginal":false,"author":[{"name":"Marinko Spasojević","url":"https://code-maze.com/author/marinko/"}],"cover":"/assets/image/code-maze.com/dependency-inversion-principle/banner.png"},"git":{},"readingTime":{"minutes":5.45,"words":1636},"filePathRelative":"code-maze.com/dependency-inversion-principle.md","copyright":{"author":"Marinko Spasojević"}}');export{z as comp,O as data};
