import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,d as a,f as s,b as c,t as d,n as u,g as m,r as n,o as k}from"./app-BItykJLQ.js";const v={},w={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},h={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"};function g(o,e){const l=n("VPCard"),r=n("SiteInfo"),t=n("KotlinPlayground");return k(),i("div",null,[a("h1",w,[a("a",h,[a("span",null,d(o.$frontmatter.title)+" ê´€ë ¨",1)])]),s(l,u(m({title:"Java > Article(s)",desc:"Article(s)",link:"/programming/java/articles/README.md",logo:"https://chanhi2000.github.io/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),e[0]||(e[0]=a("nav",{class:"table-of-contents"},[a("ul")],-1)),e[1]||(e[1]=a("hr",null,null,-1)),s(r,{name:"SharedFlow vs StateFlow",desc:"When to use SharedFlow and when to use StateFlow.",url:"https://kt.academy/article/sharedflow_vs_stateflow",logo:"https://kt.academy/logo.png",preview:"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2Fkt-academy-articles%2Fimages%2Fsharedflow_vs_stateflow_cover.png&w=1080&q=75"}),e[2]||(e[2]=a("p",null,"StateFlow and SharedFlow seem similar, but they are designed for different use cases, and they should not be confused. Let's discuss the key differences and usages.",-1)),e[3]||(e[3]=a("p",null,"Let's start with how they work. SharedFlow resembles a broadcast channelâ€”emitted values are delivered to all observers. It allows setting a replay parameter specifying how many past values should be emitted to new observers.",-1)),s(t,{title:"1",key:"3ed55f0e",settings:"%7B%7D",files:"eJyFkLFOwzAQQH/lFBgcJNI4bAjYQGIoDIUJM5jEaU4458g+U1DVf8cRCAVQWq/33tOdnzLsB+cZXh1bpPeidt5FRjKhOFE0P2yt24yEohDDYKiBNhL0Gknk5/BIyHAJG+TuAXuTpHt/F60VZ2VZ5rBVBOm9aQuhTdwysn6xZtVpb5qbVL5YsUdaXwlvBqs/EiLzLye0hemRhcqWJgS9NqdSZXOzcjpydK3rDrYwpDRbStiRhGPkBMGusDpS3d2S4A7Dt7VYQEJ+YvtK1eFS9afUmHSakOOPzOw/nvZ7CTnJyBmr+mdVE6tStFOUPX8C1Uyg3Q=="}),e[4]||(e[4]=a("p",null,"StateFlow behaves a lot like SharedFlow with reply = 1, but StateFlow must always have a value, so an initial value must be specified when a StateFlow is created. This value can be accessed or changed using value property.",-1)),s(t,{title:"2",key:"3ed48552",settings:"%7B%7D",files:"eJx9kLFOwzAQhl/lZBgchjQOWyVGkBgKAzBhBpM6xMI5R/GZgqq+OxdCk4LUevBgf//n+/0sXNuFnuA9kHf4mVehD4kc2phfaDx+WfuwGQiNMcXO4hrqhNAahzJbwhM6givYOGoeXWs5dN/fJe/lZVEUGWw1Aq8P4yHWzK0SmVdvH8iQvWGx1GJlYzRvttAiG+Fxj3Ue8NpUDWyh6x2SR4bP1BLO+UWGYZd7k7BqblFS42L2G1wsYKAm7Slbedw2yxiaZePx2nrzJdVQcfJzx2S54tRIafFvGHUoU1PSto7mjyiHaf7mysNcOeb2LfYv/2RmZKdRvHwDrAed0w=="}),e[5]||(e[5]=a("p",null,"But StateFlow was designed for a concrete use case: to represent an observable state. In Android, it is used to represent the state of our application, and views observe it and redraw whenever it changes. That is the key source of differences.",-1)),e[6]||(e[6]=a("figure",null,[a("img",{src:"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2Fkt-academy-articles%2Fimages%2Fsharedflow_vs_stateflow_viewmodel.png&w=1080&q=75",alt:"",tabindex:"0",loading:"lazy"}),a("figcaption")],-1)),e[7]||(e[7]=a("p",null,"Redrawing view can be expensive, and state changes can be frequent. That is why two optimizations were introduced. First, updates are only emitted when they are different from the previous state. This behavior can be achieved on SharedFlow using distinctUntilChanged.",-1)),s(t,{title:"3",key:"3ed37e8a",settings:"%7B%7D",files:"eJx9jj1rw0AMhv+KODqcOziGzh0SaKFD26Ht1OtwjS+xyFlnfLokEPLfI/syhHxpEAg9r/T8Kmy70DOsAnukbTkPfUiM5GL5aOj2cuHDZiAMxRQ7RzUsEkFrkXQBz7BBbr6xdYJ/9h/Je/1UVVUBO0MgtbYeIlt2gr4ntv/efQ3jq1zVRk2NKjKY+4iWgV7svIEddD0SexLwp6tlUwMHeECWFOxzYqhyjL2R5gZjAZMJnODTy/silQYho2ZGneGzu6CmID9omc1cfZTPtGuRRVXQ0eEKK87q7wD+IoCT"}),e[8]||(e[8]=a("p",null,"Second, StateFlow is conflated, meaning if observer is slower than value changes, it might lose some intermediate updates. That is appropriate for StateFlow, because we are not interested in drawing obsolete state.",-1)),s(t,{title:"3",key:"3ed2a4d0",settings:"%7B%7D",files:"eJx1j7FOAzEMhl/F6pIcQ3qImQGhsgEDDJU4hpDm1Aifc8o5FIR4d5wLhWOoFTmO/fv/lKdVGMaYGF4jY6B342KKmQP5yZx1dHrYYzwURUdTnkZPO+gzwWAD6QYu4RB4/xgGL/L7dJcR9UXbtg18dgQSbxZhYstepLeZ7Qv6h/K8EVettqopxkWINpPbH9dK9DGBdhAI1JUyRm3Ur+sxdh7tRwGKzbI/E42wc+G6/8P1GsS5SvwQWLvF9lct5apFlbmI6B0v8RV9Xv761xxTIEbSgX+a4iNHiNs5X89509Hq+Rtoi3e1"}),e[9]||(e[9]=a("p",null,"StateFlow also have some tools for state update, like update function, that lets us safely update state, bu creating a new one based on the current one.",-1)),s(t,{title:"3",key:"3ed1cb16",settings:"%7B%7D",files:"eJxdjs0KwjAQhF9l8ZQq1BTPXr2pB71ZkVi3GEw3IdlYofjuptBKdS77w7cze5rpxlnP8LBsNL3yynobWROGfF5SSSEGh3SDOhI0SpPIYA2t5vtRN5jIvd9FY8RKSplBVxIkPZWBUCduG1ldDR5YMW6MbYXMes+e+eYcKutwvOzl0aFiUcjL1HOUUZGq+/+2V6jz6G4pCTrQDAso4P1LTcahHYrzmtiQSBbp94gZLJdQpHhZUkJm5w98WFeB"}),e[10]||(e[10]=c(`<p>That is why StateFlow should be used concretely to represent the observable state of our application. It should not be used as a &quot;boradcast channel&quot;. For that we use SharedFlow.</p><p>Let&#39;s see an Android example: Things like a progress bar or data to display should be represented by StateFlow, but exceptions or messages to show to users as toasts should be represented as SharedFlow.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">private</span> <span class="token keyword">val</span> _usersList <span class="token operator">=</span> MutableStateFlow<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>User<span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">val</span> usersList<span class="token operator">:</span> StateFlow<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>User<span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token operator">=</span> _usersList</span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">val</span> _showProgress <span class="token operator">=</span> <span class="token function">MutableStateFlow</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">val</span> showLoading<span class="token operator">:</span> StateFlow<span class="token operator">&lt;</span>Boolean<span class="token operator">&gt;</span> <span class="token operator">=</span> _showProgress</span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">val</span> _errors <span class="token operator">=</span> MutableSharedFlow<span class="token operator">&lt;</span>Throwable<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">val</span> errors<span class="token operator">:</span> SharedFlow<span class="token operator">&lt;</span>Throwable<span class="token operator">&gt;</span> <span class="token operator">=</span> _errors</span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">val</span> _messages <span class="token operator">=</span> MutableSharedFlow<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">val</span> messages<span class="token operator">:</span> SharedFlow<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> <span class="token operator">=</span> _messages</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now let&#39;s see a backend example. On a backend service, updates received from some websocket should be represented using SharedFlow, but an observable cuter of application users can be represented using StateFlow.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">class</span> InventoryService <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">val</span> inventoryState <span class="token operator">=</span> MutableStateFlow<span class="token operator">&lt;</span>InventoryState<span class="token operator">&gt;</span><span class="token punctuation">(</span>InventoryState<span class="token punctuation">.</span>Loading<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">val</span> inventoryEvents <span class="token operator">=</span> MutableSharedFlow<span class="token operator">&lt;</span>InventoryEvent<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> StatusTrackingService <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">val</span> activeConnections <span class="token operator">=</span> <span class="token function">MutableStateFlow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">val</span> highTrafficEvents <span class="token operator">=</span> MutableSharedFlow<span class="token operator">&lt;</span>Int<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To sum up, StateFlow and SharedFlow are similar, but they are designed for different use cases. StateFlow is for representing observable state, and SharedFlow is for broadcasting events. Use them accordingly.</p>`,6))])}const F=p(v,[["render",g]]),f=JSON.parse('{"path":"/kt.academy/sharedflow-vs-stateflow.html","title":"SharedFlow vs StateFlow","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"SharedFlow vs StateFlow","description":"Article(s) > SharedFlow vs StateFlow","icon":"iconfont icon-kotlin","category":["Kotlin","Article(s)"],"tag":["blog","kt.academy","java","kotiln"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SharedFlow vs StateFlow\\",\\"image\\":[\\"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2Fkt-academy-articles%2Fimages%2Fsharedflow_vs_stateflow_viewmodel.png&w=1080&q=75\\"],\\"datePublished\\":\\"2024-06-27T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/kt.academy/sharedflow-vs-stateflow.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"SharedFlow vs StateFlow"}],["meta",{"property":"og:description","content":"Article(s) > SharedFlow vs StateFlow"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2Fkt-academy-articles%2Fimages%2Fsharedflow_vs_stateflow_cover.png&w=1080&q=75"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2Fkt-academy-articles%2Fimages%2Fsharedflow_vs_stateflow_cover.png&w=1080&q=75"}],["meta",{"name":"twitter:image:alt","content":"SharedFlow vs StateFlow"}],["meta",{"property":"article:tag","content":"kotiln"}],["meta",{"property":"article:tag","content":"java"}],["meta",{"property":"article:tag","content":"kt.academy"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2024-06-27T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > SharedFlow vs StateFlow"},{"property":"og:description","content":"SharedFlow vs StateFlow"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/kt.academy/sharedflow-vs-stateflow.html"}]],"prev":"/programming/java/articles/README.md","date":"2024-06-27T00:00:00.000Z","isOriginal":false,"cover":"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2Fkt-academy-articles%2Fimages%2Fsharedflow_vs_stateflow_cover.png&w=1080&q=75"},"git":{},"readingTime":{"minutes":2.79,"words":837},"filePathRelative":"kt.academy/sharedflow-vs-stateflow.md"}');export{F as comp,f as data};
