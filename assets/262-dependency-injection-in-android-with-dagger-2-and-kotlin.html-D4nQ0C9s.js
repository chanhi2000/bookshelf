import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as g,d as n,f as a,b as r,t as m,n as k,g as f,w as i,e as t,r as l,o as y}from"./app-BItykJLQ.js";const b={},w={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},v={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},j={class:"table-of-contents"},D={href:"https://github.com/google/guice",target:"_blank",rel:"noopener noreferrer"},x={href:"https://koenig-media.raywenderlich.com/uploads/2017/12/droidwiki-starter.zip",target:"_blank",rel:"noopener noreferrer"},A={href:"https://koenig-media.raywenderlich.com/uploads/2017/12/droidwiki-final.zip",target:"_blank",rel:"noopener noreferrer"};function I(d,e){const p=l("VPCard"),o=l("router-link"),c=l("SiteInfo"),s=l("VPIcon"),u=l("VidStack");return y(),g("div",null,[n("h1",w,[n("a",v,[n("span",null,m(d.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),a(p,k(f({title:"Android > Article(s)",desc:"Article(s)",link:"/programming/java-android/articles/README.md",logo:"https://chanhi2000.github.io/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),n("nav",j,[n("ul",null,[n("li",null,[a(o,{to:"#introduction"},{default:i(()=>[...e[0]||(e[0]=[t("Introduction",-1)])]),_:1}),n("ul",null,[n("li",null,[a(o,{to:"#what-is-dependency-injection"},{default:i(()=>[...e[1]||(e[1]=[t("What is Dependency Injection?",-1)])]),_:1})]),n("li",null,[a(o,{to:"#practical-example-of-dependency-injection"},{default:i(()=>[...e[2]||(e[2]=[t("Practical example of Dependency Injection",-1)])]),_:1})]),n("li",null,[a(o,{to:"#the-dependency-inversion-principle"},{default:i(()=>[...e[3]||(e[3]=[t("The Dependency Inversion Principle",-1)])]),_:1})]),n("li",null,[a(o,{to:"#how-can-dagger-2-help-with-di"},{default:i(()=>[...e[4]||(e[4]=[t("How can Dagger 2 help with DI",-1)])]),_:1})])])]),n("li",null,[a(o,{to:"#getting-started"},{default:i(()=>[...e[5]||(e[5]=[t("Getting Started",-1)])]),_:1}),n("ul",null,[n("li",null,[a(o,{to:"#mvp"},{default:i(()=>[...e[6]||(e[6]=[t("MVP",-1)])]),_:1})]),n("li",null,[a(o,{to:"#dependencies-in-droidwiki"},{default:i(()=>[...e[7]||(e[7]=[t("Dependencies in DroidWiki",-1)])]),_:1})])])]),n("li",null,[a(o,{to:"#configure-the-project-with-dagger-2"},{default:i(()=>[...e[8]||(e[8]=[t("Configure the Project With Dagger 2",-1)])]),_:1})]),n("li",null,[a(o,{to:"#dagger-2-public-apis"},{default:i(()=>[...e[9]||(e[9]=[t("Dagger 2 public APIs",-1)])]),_:1}),n("ul",null,[n("li",null,[a(o,{to:"#module"},{default:i(()=>[...e[10]||(e[10]=[t("Module",-1)])]),_:1})]),n("li",null,[a(o,{to:"#provides-and-singleton"},{default:i(()=>[...e[11]||(e[11]=[t("@Provides and @Singleton",-1)])]),_:1})]),n("li",null,[a(o,{to:"#component"},{default:i(()=>[...e[12]||(e[12]=[t("Component",-1)])]),_:1})])])]),n("li",null,[a(o,{to:"#your-first-dependency-injection"},{default:i(()=>[...e[13]||(e[13]=[t("Your first (dependency) injection",-1)])]),_:1}),n("ul",null,[n("li",null,[a(o,{to:"#update-homepageactivity"},{default:i(()=>[...e[14]||(e[14]=[t("Update HomepageActivity",-1)])]),_:1})]),n("li",null,[a(o,{to:"#the-general-pattern"},{default:i(()=>[...e[15]||(e[15]=[t("The General Pattern",-1)])]),_:1})])])]),n("li",null,[a(o,{to:"#injecting-the-network-graph"},{default:i(()=>[...e[16]||(e[16]=[t("Injecting the Network Graph",-1)])]),_:1}),n("ul",null,[n("li",null,[a(o,{to:"#networkmodule"},{default:i(()=>[...e[17]||(e[17]=[t("NetworkModule",-1)])]),_:1})]),n("li",null,[a(o,{to:"#simplifying-api-builder"},{default:i(()=>[...e[18]||(e[18]=[t("Simplifying API builder",-1)])]),_:1})]),n("li",null,[a(o,{to:"#wikimodule"},{default:i(()=>[...e[19]||(e[19]=[t("WikiModule",-1)])]),_:1})]),n("li",null,[a(o,{to:"#update-presentermodule"},{default:i(()=>[...e[20]||(e[20]=[t("Update PresenterModule",-1)])]),_:1})]),n("li",null,[a(o,{to:"#update-wikiapi"},{default:i(()=>[...e[21]||(e[21]=[t("Update WikiApi",-1)])]),_:1})])])]),n("li",null,[a(o,{to:"#where-to-go-from-here"},{default:i(()=>[...e[22]||(e[22]=[t("Where to Go From Here?",-1)])]),_:1})])])]),e[60]||(e[60]=n("hr",null,null,-1)),a(c,{name:"Dependency Injection in Android with Dagger 2 and Kotlin",desc:"In this Android with Kotlin tutorial, you‚Äôll learn about dependency injection and how to make use of the Dagger 2 Java/Android framework for this purpose.",url:"https://kodeco.com/262-dependency-injection-in-android-with-dagger-2-and-kotlin",logo:"https://assets.carolus.kodeco.com/assets/murakami/category-icons/category-tools-libraries-android-ac31fd227119039e3e4b8fe5b5ca86abdf928764640b62fe05286565f238b802.svg",preview:"https://koenig-media.raywenderlich.com/uploads/2017/12/Dagger-twitter2.png"}),e[61]||(e[61]=r(`<div class="hint-container note"><p class="hint-container-title">Update</p><p>This Dagger 2 tutorial is now up to date with the latest version of Android Studio, version 3.0.1, and uses Kotlin for app development. Update by Dario Coletto. Original tutorial by Joe Howard.</p></div><p>It turns out that Dependency Injection is nowhere near as complex as its name implies. And it is a key tool for building software systems that are maintainable and testable. In the end, relying on dependency injection will simplify your code quite a bit and also allow for a clearer path to writing testable code.</p><p>In this tutorial, you‚Äôll update an existing app named DroidWiki to use DI. The <strong>DroidWiki</strong> app is a simple wikipedia client for android, based on <strong>Dagger 2</strong> and <strong>OkHttp 3</strong>. The Wikipedia API is based on MediaWiki, and you can find the documentation <a href="https://www.mediawiki.org/wiki/API:Main_page" target="_blank" rel="noopener noreferrer">here</a>. These API are public and there is no need to get API keys or other stuff. But you should definitely check out <a href="https://www.mediawiki.org/wiki/API:Etiquette" target="_blank" rel="noopener noreferrer">MediaWiki Etiquette</a>.</p><p>Here‚Äôs a quick peek at the search result screen in DroidWiki:</p><figure><img src="https://koenig-media.raywenderlich.com/uploads/2017/09/DroidWiki-SearchActivity-333x500.png" alt="DroidWiki app" tabindex="0" loading="lazy"><figcaption>DroidWiki app</figcaption></figure><hr><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h2><p>Before we begin, if you don‚Äôt know what Dependency Injection is, here‚Äôs some great news: you‚Äôre probably already using it without knowing it!</p><h3 id="what-is-dependency-injection" tabindex="-1"><a class="header-anchor" href="#what-is-dependency-injection"><span>What is Dependency Injection?</span></a></h3><p>First, what is a dependency? Any non-trivial software program is going to contain components that pass information and send message calls back and forth between one another.</p><p>For example, when using an Object Oriented Programming language (such as Java/Kotlin on Android), objects will call methods on other objects that they have references to. A <em>dependency</em> is when one of the objects depends on the concrete implementation of another object.</p><h3 id="practical-example-of-dependency-injection" tabindex="-1"><a class="header-anchor" href="#practical-example-of-dependency-injection"><span>Practical example of Dependency Injection</span></a></h3><p>Consider a practical example in Kotlin code. You can identify a dependency in your code whenever you instantiate an object within another. In such a case, you are responsible for creating and configuring the object that is being created. For example, consider the following class <code>Parent</code>:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">class</span> Parent <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">val</span> child <span class="token operator">=</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A <code>Parent</code> instance creates its <code>child</code> field when it‚Äôs instantiated. The <code>Parent</code> instance is dependent on the concrete implementation of <code>Child</code> and on configuring the <code>child</code> field to use it.</p><p>This presents a coupling or dependency of the <code>Parent</code> class on the <code>Child</code> class. If the setup of a <code>Child</code> object is complex, all that complexity will be reflected within the <code>Parent</code> class as well. You will need to edit <code>Parent</code> to configure a <code>Child</code> object.</p><p>If the <code>Child</code> class itself depends on a class <code>C</code>, which in turn depends on class <code>D</code>, then all that complexity will propagate throughout the code base and hence result in a tight coupling between the components of the application.</p><p><strong>Dependency Injection</strong> is the term used to describe the technique of loosening the coupling just described. In the simple example above, only one tiny change is needed:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">class</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">val</span> child<span class="token operator">:</span> Child<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Voil√† ‚Äî that‚Äôs dependency injection at its core!</p><p>Rather than creating the child object inside the <code>Parent</code> class, the <code>child</code> object is passed into or <em>injected</em> into <code>Parent</code>‚Äòs constructor. The responsibility for configuring <code>child</code> is elsewhere, and the <code>Parent</code> class is a consumer of the <code>Child</code> class.</p><h3 id="the-dependency-inversion-principle" tabindex="-1"><a class="header-anchor" href="#the-dependency-inversion-principle"><span>The Dependency Inversion Principle</span></a></h3><p>Dependency injection is often discussed in conjunction with one of the five <strong>SOLID principles</strong> of Object-Oriented Design: the <strong>Dependency Inversion principle</strong>. For a great introduction to the SOLID principles, particularly on Android, check out this <a href="https://realm.io/news/donn-felker-solid-part-5/" target="_blank" rel="noopener noreferrer">post from Realm on Dependency Inversion</a>.</p><p>The gist of the Dependency Inversion principle is that it is important to depend on abstractions rather than concrete implementations.</p><p>In the simple example above, this means changing <code>Child</code> to a Kotlin <code>interface</code> rather than a Kotlin <code>class</code>. With this change, many different types of concrete <code>Child</code> type objects that adhere to the <code>Child</code> interface can be passed into the <code>Parent</code> constructor. This presents several key benefits:</p><ul><li>Allows for the <code>Parent</code> class to be tested with various kinds of <code>Child</code> objects.</li><li>Mock <code>Child</code> objects can be used as needed in certain test scenarios.</li><li>Testing of <code>Parent</code> is independent of the implementation of <code>Child</code>.</li></ul><h3 id="how-can-dagger-2-help-with-di" tabindex="-1"><a class="header-anchor" href="#how-can-dagger-2-help-with-di"><span>How can Dagger 2 help with DI</span></a></h3>`,27)),n("p",null,[e[24]||(e[24]=n("a",{href:"https://google.github.io/dagger/",target:"_blank",rel:"noopener noreferrer"},"Dagger 2",-1)),e[25]||(e[25]=t(" is the result of a collaboration between the team behind ",-1)),n("a",D,[a(s,{icon:"iconfont icon-github"}),e[23]||(e[23]=n("code",null,"google/guice",-1))]),e[26]||(e[26]=t(" (developed by Google) and Dagger (the predecessor of Dagger 2, created by Square).",-1))]),e[62]||(e[62]=r('<p>They fixed a lot of problems from their previous work, and Dagger 2 is the faster framework for DI (since it works at compile time rather than at runtime with reflection).</p><div class="hint-container tip"><p class="hint-container-title">Note</p><p>Dagger 2 is written in Java, but it works with Kotlin without any modification. However, the code generated by the annotation processor will be Java code (that is 100% interoperable with Kotlin).</p></div><p>The name ‚ÄúDagger‚Äù is inspired in part by the nature of dependencies in software development. The web of dependencies that occur between objects such as <code>Parent</code>, <code>Child</code>, <code>OtherClass</code>, etc., create a structure called a <strong>Directed Acyclic Graph</strong>. Dagger 2 is used to simplify the creation of such graphs in your Java and Android projects.</p><p>Enough theory! Time to start writing some code.</p><hr><h2 id="getting-started" tabindex="-1"><a class="header-anchor" href="#getting-started"><span>Getting Started</span></a></h2>',6)),n("p",null,[e[28]||(e[28]=t("Download the starter project ",-1)),n("a",x,[a(s,{icon:"iconfont icon-select"}),e[27]||(e[27]=n("code",null,"[here]",-1))]),e[29]||(e[29]=t(".",-1))]),e[63]||(e[63]=r('<p>Open the starter app in Android Studio 3.0.1 or greater and if it prompts you to update your gradle version, go ahead and do so.</p><p>![Run the starter app in either an emulator or on a device, and you should see a screen like the following](https://koenig-media.raywenderlich.com/uploads/2017/09/DroidWiki-HomepageActivity.png =240x)</p><p>The app consists of three screens. The first one is just a splashscreen.</p><p>In the second one you‚Äôll see an HTML version of the Wikipedia homepage, obtained through the WikiMedia API. The <code>Toolbar</code> at the top of the page contains a magnifier that, when tapped, will lead you to the third screen.</p><p>From there, you can type something to search on Wikipedia and press the search button to run a query. Results will be displayed as a list of <code>CardViews</code> inside a <code>RecyclerView</code>.</p><p>Examine the app project structure and existing classes. You‚Äôll see that the app uses the <strong>Model-View-Presenter</strong> (MVP) pattern to structure the code. Besides Dagger 2, the app uses common Android libraries such as:</p><ul><li><a href="http://square.github.io/okhttp/" target="_blank" rel="noopener noreferrer">OkHttp 3</a></li><li><code>RecyclerView</code></li><li><a href="https://kotlinlang.org/docs/tutorials/android-plugin.html" target="_blank" rel="noopener noreferrer">Kotlin synthetic properties</a></li></ul><p>The subpackages in the main package are <code>application</code>, <code>model</code>, <code>network</code>, <code>ui</code> and <code>utils</code>. If you explore the <code>ui</code> package, you‚Äôll see subpackages for the three screens.</p><figure><img src="https://koenig-media.raywenderlich.com/uploads/2017/12/Screenshot-from-2017-12-04-14-54-59.png" alt="Except for the splashscreen, each other package has classes for the view and presenter classes for the screen." tabindex="0" loading="lazy"><figcaption>Except for the splashscreen, each other package has classes for the view and presenter classes for the screen.</figcaption></figure>',9)),n("p",null,[e[30]||(e[30]=t("By examining the app ",-1)),a(s,{icon:"iconfont icon-engine"}),e[31]||(e[31]=n("code",null,"build.gradle",-1)),e[32]||(e[32]=t(" file, you‚Äôll also see that the app applies the plugin ",-1)),e[33]||(e[33]=n("code",null,"kotlin-android-extensions",-1)),e[34]||(e[34]=t(". It is used to implement view binding and ",-1)),e[35]||(e[35]=n("code",null,"kotlin-kapt",-1)),e[36]||(e[36]=t(" for annotation processing.",-1))]),e[64]||(e[64]=r(`<h3 id="mvp" tabindex="-1"><a class="header-anchor" href="#mvp"><span>MVP</span></a></h3><p>In case you‚Äôre unfamiliar with the MVP pattern, there are many good online resources for getting started.</p><p>MVP is similar to other structural patterns for implementing separation of concerns. Examples are <strong>Model-View-Controller</strong> and <strong>Model-View-ViewModel</strong>. In MVP on Android, your activities and fragments typically act as the view objects. They do so by implementing a view interface and handling interaction of the app with the user.</p><p>The view passes on user actions to the <strong>presenter</strong>, which handles the business logic and interaction with data repositories, such as a server API or database. The <strong>model</strong> layer consists of the objects that make up the content of the app.</p><p>In the case of DroidWiki, the <code>HomepageActivity</code> class implements the <code>HomepageView</code> interface. <code>HomepageActivity</code> has a reference to a <code>HomepagePresenter</code> interface. This controls access to model objects of type <code>Homepage</code></p><p>The use of OkHttp 3 is found in the <code>WikiApi</code> class in the <code>network</code> package. This class defines the interface to the WikiMedia API required by the app. There are two calls of type <strong>GET</strong> defined and the <code>JSONObject</code> will let you parse the obtained responses. The parsing will be executed in the <code>HomepageResult</code> and the <code>SearchResult</code> classes. And you will get a <code>WikiHomepage</code> object and a list of <code>Entry</code> objects.</p><div class="hint-container tip"><p class="hint-container-title">Note</p><p>Since Kotlin doesn‚Äôt need you to write getters and setters, you can replace POJO classes with a <code>data class</code>. For more information, see <a href="https://kotlinlang.org/docs/reference/data-classes.html" target="_blank" rel="noopener noreferrer">the official kotlin data classes documentation</a>.</p></div><h3 id="dependencies-in-droidwiki" tabindex="-1"><a class="header-anchor" href="#dependencies-in-droidwiki"><span>Dependencies in DroidWiki</span></a></h3><p>Open the <code>HomepageActivity</code> class in the <code>ui.homepage</code> package. In its <code>onCreate()</code> method, there are several calls to configure a <code>HomepagePresenter</code>:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">private</span> <span class="token keyword">val</span> presenter<span class="token operator">:</span> HomepagePresenter <span class="token operator">=</span> <span class="token function">HomepagePresenterImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token operator">..</span><span class="token punctuation">.</span></span>
<span class="line">presenter<span class="token punctuation">.</span><span class="token function">setView</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span></span>
<span class="line">presenter<span class="token punctuation">.</span><span class="token function">loadHomepage</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here, you create a concrete implementation of a <code>HomepagePresenter</code> when the activity is instantiated.</p>`,11)),n("p",null,[e[37]||(e[37]=t("Open ",-1)),a(s,{icon:"iconfont icon-java"}),e[38]||(e[38]=r("<code>HomepagePresenterImpl.kt</code> and take a look at <code>loadHomepage()</code>. Both an <code>OkHttpClient</code> object and a <code>WikiApi</code> object are created and configured in the <code>loadHomepage()</code> method. The same happens for the <code>SearchActivity</code> with an <code>EntryPresenter</code> and a list of <code>EntryView</code>.",16))]),e[65]||(e[65]=r('<p>This creation of dependencies couple the model, view, and presenter layers too tightly. Swapping in a mock presenter for the view is impossible as written without updating the view code. The code for creating the <code>OkHttpClient</code> and <code>WikiApi</code> objects is repeated between the two presenter implementations in the app: <code>HomepagePresenterImpl</code> and <code>EntryPresenterImpl</code>.</p><p>Finally, it‚Äôs time to start writing some code to remove code duplication and some coupling between layers!</p><hr><h2 id="configure-the-project-with-dagger-2" tabindex="-1"><a class="header-anchor" href="#configure-the-project-with-dagger-2"><span>Configure the Project With Dagger 2</span></a></h2><p>Configuring Dagger with Kotlin is a little bit different from how you may have done with Java. Dagger requires an <strong>annotation processor</strong>, and thus the main difference is which one you are going to use. In fact with Java you used the Groovy methods <code>apt</code> or the newer <code>annotationProcessor</code>, while with Kotlin you need to use <code>kapt</code>.</p>',5)),n("p",null,[e[39]||(e[39]=t("By default kapt is not enabled in Kotlin, and to enable it you must apply its plugin to your app ",-1)),a(s,{icon:"iconfont icon-engine"}),e[40]||(e[40]=n("code",null,"build.gradle",-1)),e[41]||(e[41]=t(", so add the line ",-1)),e[42]||(e[42]=n("code",null,"apply plugin: 'kotlin-kapt'",-1)),e[43]||(e[43]=t(":",-1))]),e[66]||(e[66]=r(`<div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy"><pre><code class="language-groovy"><span class="line">plugins <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">id</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;com.android.application&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">id</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;kotlin-android&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">id</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;kotlin-kapt&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then add these dependencies to actually ‚Äúinstall‚Äù dagger</p><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy"><pre><code class="language-groovy"><span class="line">dependencies <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ...</span></span>
<span class="line">  implementation <span class="token string">&#39;com.google.dagger:dagger:2.11&#39;</span></span>
<span class="line">  kapt <span class="token string">&#39;com.google.dagger:dagger-compiler:2.11&#39;</span></span>
<span class="line">  provided <span class="token string">&#39;javax.annotation:jsr250-api:1.0&#39;</span></span>
<span class="line">  <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here we‚Äôre using Dagger 2.11, you can check the latest version in the <a href="https://mvnrepository.com/artifact/com.google.dagger/dagger" target="_blank" rel="noopener noreferrer">Maven repository</a>.</p><p>Android Studio will prompt you to sync your gradle files on this change, so please go ahead and do so to ensure that you‚Äôre including Dagger correctly. Notice that you are including an annotation library from <code>javax</code>, because many of the features of Dagger are provided by <strong>Java annotations</strong>.</p><hr><h2 id="dagger-2-public-apis" tabindex="-1"><a class="header-anchor" href="#dagger-2-public-apis"><span>Dagger 2 public APIs</span></a></h2><p>Dagger 2 can seem complex at the beginning, but it‚Äôs really not so hard. In fact, the <em>complete</em> public API of Dagger is composed by less than 30 lines of code. And from these lines you can remove a pair of interfaces that are rarely used (Lazy and MapKey), so the most used public APIs are composed of 3 annotations:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">public</span> @<span class="token keyword">interface</span> Component <span class="token punctuation">{</span></span>
<span class="line">  Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">modules</span><span class="token punctuation">(</span><span class="token punctuation">)</span> default <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> default <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">public</span> @<span class="token keyword">interface</span> Module <span class="token punctuation">{</span></span>
<span class="line">  Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">includes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> default <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">public</span> @<span class="token keyword">interface</span> Provides <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now let‚Äôs see how these annotations are used to bring dependency injection to your projects!</p><h3 id="module" tabindex="-1"><a class="header-anchor" href="#module"><span>Module</span></a></h3><p>The first annotation you‚Äôll use is the <code>@Module</code> annotation.</p>`,12)),n("figure",null,[e[48]||(e[48]=n("img",{src:"https://koenig-media.raywenderlich.com/uploads/2017/12/Screenshot-from-2017-12-04-15-27-13-650x167.png",alt:'Start by creating a new package named  under the app main package, by right-clicking the main package and selecting <VPIcon icon="iconfont icon-select"/>',tabindex:"0",loading:"lazy"},null,-1)),n("figcaption",null,[e[44]||(e[44]=t("Start by creating a new package named ",-1)),e[45]||(e[45]=n("code",null,"dagger",-1)),e[46]||(e[46]=t(" under the app main package, by right-clicking the main package and selecting ",-1)),a(s,{icon:"iconfont icon-select"}),e[47]||(e[47]=n("code",null,"[New/Package]",-1))])]),e[67]||(e[67]=n("p",null,[t("Next, create a new file in the "),n("code",null,"dagger"),t(" package.")],-1)),n("figure",null,[e[56]||(e[56]=n("img",{src:"https://koenig-media.raywenderlich.com/uploads/2017/09/DroidWiki-NewKotlinClass-480x122.png",alt:'Right-click  and select <VPIcon icon="iconfont icon-select"/>. Name the class .',tabindex:"0",loading:"lazy"},null,-1)),n("figcaption",null,[e[49]||(e[49]=t("Right-click ",-1)),e[50]||(e[50]=n("code",null,"dagger",-1)),e[51]||(e[51]=t(" and select ",-1)),a(s,{icon:"iconfont icon-select"}),e[52]||(e[52]=n("code",null,"[New/Kotlin File/Class]",-1)),e[53]||(e[53]=t(". Name the class ",-1)),e[54]||(e[54]=n("code",null,"AppModule",-1)),e[55]||(e[55]=t(".",-1))])]),e[68]||(e[68]=r(`<p>Add the following empty class to the new file:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Module</span></span>
<span class="line"><span class="token keyword">class</span> AppModule <span class="token punctuation">{</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here, you‚Äôve created a class named <code>AppModule</code> and annotated it with the Dagger <code>@Module</code> annotation. Android Studio should automatically create any necessary import statements for you. But if not, hit <kbd>option</kbd>+<kbd>return</kbd> on Mac or <kbd>Alt</kbd>+<kbd>Enter</kbd> on PC to create them as needed.</p><p>The <code>@Module</code> annotation tells Dagger that the <code>AppModule</code> class will provide dependencies for a part of the application. It is normal to have multiple Dagger modules in a project, and it is typical for one of them to provide app-wide dependencies.</p><p>Add that capability now by inserting the following code within the body of the <code>AppModule</code> class:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Module</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token function">AppModule</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">val</span> app<span class="token operator">:</span> Application<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token annotation builtin">@Provides</span></span>
<span class="line">  <span class="token annotation builtin">@Singleton</span></span>
<span class="line">  <span class="token keyword">fun</span> <span class="token function">provideContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Context <span class="token operator">=</span> app</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You‚Äôve added a private field to hold a reference to the <code>app</code> object, a constructor to configure <code>app</code>, and a <code>provideContext()</code> method that returns the <code>app</code> object. Notice that there are two more Dagger annotations on that method: <code>@Provides</code> and <code>@Singleton</code>.</p><h3 id="provides-and-singleton" tabindex="-1"><a class="header-anchor" href="#provides-and-singleton"><span><code>@Provides</code> and <code>@Singleton</code></span></a></h3><p>The <code>@Provides</code> annotation tells Dagger that the method provides a certain type of dependency, in this case, a <code>Context</code> object. When a part of the app requests that Dagger inject a <code>Context</code>, the <code>@Provides</code> annotation tells Dagger where to find it.</p><div class="hint-container tip"><p class="hint-container-title">Note</p><p>The method names for the providers, such as <code>provideContext()</code>, are not important and can be named anything you like. Dagger only looks at the return type. Using <code>provide</code> as a prefix is a common convention.</p></div><p>The <code>@Singleton</code> annotation is not part of the Dagger API. It‚Äôs contained inside the javax package you added to your build.gradle at the beginning. It tells Dagger that there should only be a single instance of that dependency. So when generating the code Dagger will handle all the logic for you, and you won‚Äôt write all the boilerplate code to check if another instance of the object is already available.</p><h3 id="component" tabindex="-1"><a class="header-anchor" href="#component"><span>Component</span></a></h3><hr><h2 id="your-first-dependency-injection" tabindex="-1"><a class="header-anchor" href="#your-first-dependency-injection"><span>Your first (dependency) injection</span></a></h2><h3 id="update-homepageactivity" tabindex="-1"><a class="header-anchor" href="#update-homepageactivity"><span>Update HomepageActivity</span></a></h3><h3 id="the-general-pattern" tabindex="-1"><a class="header-anchor" href="#the-general-pattern"><span>The General Pattern</span></a></h3><hr><h2 id="injecting-the-network-graph" tabindex="-1"><a class="header-anchor" href="#injecting-the-network-graph"><span>Injecting the Network Graph</span></a></h2><h3 id="networkmodule" tabindex="-1"><a class="header-anchor" href="#networkmodule"><span>NetworkModule</span></a></h3><h3 id="simplifying-api-builder" tabindex="-1"><a class="header-anchor" href="#simplifying-api-builder"><span>Simplifying API builder</span></a></h3><h3 id="wikimodule" tabindex="-1"><a class="header-anchor" href="#wikimodule"><span>WikiModule</span></a></h3><h3 id="update-presentermodule" tabindex="-1"><a class="header-anchor" href="#update-presentermodule"><span>Update PresenterModule</span></a></h3><h3 id="update-wikiapi" tabindex="-1"><a class="header-anchor" href="#update-wikiapi"><span>Update WikiApi</span></a></h3><hr><h2 id="where-to-go-from-here" tabindex="-1"><a class="header-anchor" href="#where-to-go-from-here"><span>Where to Go From Here?</span></a></h2>`,25)),n("p",null,[e[58]||(e[58]=t("You can download the final project ",-1)),n("a",A,[a(s,{icon:"fas fa-file-zipper"}),e[57]||(e[57]=t("here",-1))]),e[59]||(e[59]=t(".",-1))]),e[69]||(e[69]=n("p",null,"A lot of developers asks themselves if all the changes you‚Äôve applied to the DroidWiki app are useful or not. Especially since everything was already working before implementing dependency injection. The utility of dependency injection and a framework like Dagger 2 become most evident in real-world production apps, where the dependency graph can get very complex.",-1)),e[70]||(e[70]=n("p",null,"Dagger 2 and dependency injection become especially useful when implementing proper testing into your app, allowing mock implementations of back-end APIs and data repositories to be used in testing.",-1)),e[71]||(e[71]=n("p",null,"There‚Äôs much more to learn about in Dagger 2 and its usage, including:",-1)),e[72]||(e[72]=n("ul",null,[n("li",null,"Scopes"),n("li",null,"Subcomponents"),n("li",null,"Testing with Mockito")],-1)),e[73]||(e[73]=n("p",null,[t("There are many great resources out there on the interwebs to dive into these topics and one I must suggest is a "),n("strong",null,"talk by Jake Wharton at DevOxx"),t(", where you can get some more information about the history of DI on Android, some theory and some nice examples. As you do, happy injecting!")],-1)),a(u,{src:"youtube/plK0zyRLIP8"}),e[74]||(e[74]=n("p",null,"If you have any questions or comments, please join the discussion below!",-1))])}const C=h(b,[["render",I]]),M=JSON.parse('{"path":"/kodeco.com/262-dependency-injection-in-android-with-dagger-2-and-kotlin.html","title":"Dependency Injection in Android with Dagger 2 and Kotlin","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Dependency Injection in Android with Dagger 2 and Kotlin","description":"Article(s) > Dependency Injection in Android with Dagger 2 and Kotlin","icon":"fa-brands fa-android","category":["Java","Kotlin","Android","Gradle","Article(s)"],"tag":["blog","kodeco.com","java","kotiln","android","gradle"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Dependency Injection in Android with Dagger 2 and Kotlin\\",\\"image\\":[\\"https://koenig-media.raywenderlich.com/uploads/2017/09/DroidWiki-SearchActivity-333x500.png\\",\\"https://koenig-media.raywenderlich.com/uploads/2017/09/DroidWiki-HomepageActivity.png =240x\\",\\"https://koenig-media.raywenderlich.com/uploads/2017/12/Screenshot-from-2017-12-04-14-54-59.png\\",\\"https://koenig-media.raywenderlich.com/uploads/2017/12/Screenshot-from-2017-12-04-15-27-13-650x167.png\\",\\"https://koenig-media.raywenderlich.com/uploads/2017/09/DroidWiki-NewKotlinClass-480x122.png\\"],\\"datePublished\\":\\"2017-12-13T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/kodeco.com/262-dependency-injection-in-android-with-dagger-2-and-kotlin.html"}],["meta",{"property":"og:site_name","content":"üìöBookshelf"}],["meta",{"property":"og:title","content":"Dependency Injection in Android with Dagger 2 and Kotlin"}],["meta",{"property":"og:description","content":"Article(s) > Dependency Injection in Android with Dagger 2 and Kotlin"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://koenig-media.raywenderlich.com/uploads/2017/12/Dagger-twitter2.png"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://koenig-media.raywenderlich.com/uploads/2017/12/Dagger-twitter2.png"}],["meta",{"name":"twitter:image:alt","content":"Dependency Injection in Android with Dagger 2 and Kotlin"}],["meta",{"property":"article:tag","content":"gradle"}],["meta",{"property":"article:tag","content":"android"}],["meta",{"property":"article:tag","content":"kotiln"}],["meta",{"property":"article:tag","content":"java"}],["meta",{"property":"article:tag","content":"kodeco.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2017-12-13T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Dependency Injection in Android with Dagger 2 and Kotlin"},{"property":"og:description","content":"Dependency Injection in Android with Dagger 2 and Kotlin"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/kodeco.com/262-dependency-injection-in-android-with-dagger-2-and-kotlin.html"}]],"prev":"/programming/java-android/articles/README.md","date":"2017-12-13T00:00:00.000Z","isOriginal":false,"cover":"https://koenig-media.raywenderlich.com/uploads/2017/12/Dagger-twitter2.png"},"git":{},"readingTime":{"minutes":9.1,"words":2731},"filePathRelative":"kodeco.com/262-dependency-injection-in-android-with-dagger-2-and-kotlin.md"}');export{C as comp,M as data};
