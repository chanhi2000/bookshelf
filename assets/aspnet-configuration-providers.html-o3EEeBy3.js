import{_ as v}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as k,d as s,f as e,b as l,a as f,t as h,n as u,g as d,w as t,e as a,r,o as b}from"./app-BItykJLQ.js";const y="/bookshelf/assets/image/code-maze.com/aspnet-configuration-providers/single-configuration-provider.png",w={},C={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},A={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},S={class:"table-of-contents"},P={href:"https://github.com/CodeMazeBlog/aspnet-core-configuration",target:"_blank",rel:"noopener noreferrer"},x={href:"https://github.com/CodeMazeBlog/aspnet-core-configuration/tree/options-validation",target:"_blank",rel:"noopener noreferrer"},T={href:"https://github.com/CodeMazeBlog/aspnet-core-configuration/tree/configuration-providers",target:"_blank",rel:"noopener noreferrer"},N={href:"https://docs.microsoft.com/en-us/aspnet/core/security/app-secrets?view=aspnetcore-3.1&tabs=windows",target:"_blank",rel:"noopener noreferrer"};function E(m,n){const c=r("VPCard"),o=r("router-link"),g=r("SiteInfo"),i=r("VPIcon"),p=r("RouteLink");return b(),k("div",null,[s("h1",C,[s("a",A,[s("span",null,h(m.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),e(c,u(d({title:"C# > Article(s)",desc:"Article(s)",link:"/programming/cs/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",S,[s("ul",null,[s("li",null,[e(o,{to:"#what-are-the-configuration-providers"},{default:t(()=>[...n[0]||(n[0]=[a("What are the Configuration Providers?",-1)])]),_:1})]),s("li",null,[e(o,{to:"#which-configuration-providers-are-available-by-default"},{default:t(()=>[...n[1]||(n[1]=[a("Which Configuration Providers are Available by Default?",-1)])]),_:1})]),s("li",null,[e(o,{to:"#default-order-of-execution-of-configuration-providers-in-asp-net-core-application"},{default:t(()=>[...n[2]||(n[2]=[a("Default Order of Execution of Configuration Providers in ASP.NET Core Application",-1)])]),_:1}),s("ul",null,[s("li",null,[e(o,{to:"#adding-a-simple-ini-configuration-file"},{default:t(()=>[...n[3]||(n[3]=[a("Adding a Simple ini Configuration File",-1)])]),_:1})])])]),s("li",null,[e(o,{to:"#using-default-configuration-providers"},{default:t(()=>[...n[4]||(n[4]=[a("Using Default Configuration Providers",-1)])]),_:1}),s("ul",null,[s("li",null,[e(o,{to:"#user-secrets"},{default:t(()=>[...n[5]||(n[5]=[a("User Secrets",-1)])]),_:1})]),s("li",null,[e(o,{to:"#environment-variables"},{default:t(()=>[...n[6]||(n[6]=[a("Environment Variables",-1)])]),_:1})]),s("li",null,[e(o,{to:"#command-line-arguments"},{default:t(()=>[...n[7]||(n[7]=[a("Command-line Arguments",-1)])]),_:1})])])]),s("li",null,[e(o,{to:"#conclusion"},{default:t(()=>[...n[8]||(n[8]=[a("Conclusion",-1)])]),_:1})])])]),n[48]||(n[48]=s("hr",null,null,-1)),e(g,{name:"ASP.NET Core Configuration - Configuration Providers",desc:"In this article, we're going to talk about different configuration providers in ASP.NET Core applications.",url:"https://code-maze.com/aspnet-configuration-providers/",logo:"/assets/image/code-maze.com/favicon.png",preview:"/assets/image/code-maze.com/aspnet-configuration-providers/banner.png"}),n[49]||(n[49]=s("p",null,"In this article, we‚Äôre going to talk about different configuration providers in ASP.NET Core. We‚Äôve got used to using JSON as a default format for our configuration and it‚Äôs the most commonly used format for configuring ASP.NET Core applications.",-1)),n[50]||(n[50]=s("p",null,"But there‚Äôs much more to it.",-1)),s("p",null,[n[18]||(n[18]=a("The source code for this article can be found on the ",-1)),s("a",P,[n[9]||(n[9]=a("ASP.NET Core Configuration repo on GitHub (",-1)),e(i,{icon:"iconfont icon-github"}),n[10]||(n[10]=s("code",null,"CodeMazeBlog/aspnet-core-configuration",-1)),n[11]||(n[11]=a(")",-1))]),n[19]||(n[19]=a(". If you wish to follow along, use the ",-1)),s("a",x,[n[12]||(n[12]=a("options-validation (",-1)),e(i,{icon:"iconfont icon-github"}),n[13]||(n[13]=s("code",null,"CodeMazeBlog/aspnet-core-configuration",-1)),n[14]||(n[14]=a(")",-1))]),n[20]||(n[20]=a(" branch. To check out the finished source code, check out the ",-1)),s("a",T,[n[15]||(n[15]=a("configuration-providers (",-1)),e(i,{icon:"iconfont icon-github"}),n[16]||(n[16]=s("code",null,"CodeMazeBlog/aspnet-core-configuration",-1)),n[17]||(n[17]=a(")",-1))]),n[21]||(n[21]=a(" branch.",-1))]),n[51]||(n[51]=s("p",null,"Let‚Äôs dive in.",-1)),n[52]||(n[52]=s("hr",null,null,-1)),n[53]||(n[53]=s("h2",{id:"what-are-the-configuration-providers",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#what-are-the-configuration-providers"},[s("span",null,"What are the Configuration Providers?")])],-1)),n[54]||(n[54]=s("p",null,[a("When we create an ASP.NET Core application from a template we‚Äôre presented by a configuration in form of a JSON file appsetting.json. "),s("strong",null,"This file is commonly used"),a(" to configure ASP.NET Core applications and there‚Äôs "),s("strong",null,"absolutely nothing wrong with it"),a(".")],-1)),s("p",null,[n[24]||(n[24]=a("We can even extend it to override its values depending on the environment our application is running in. So, for example, we can create an ",-1)),s("strong",null,[n[23]||(n[23]=a("apsettings.Production.json file to override a connection string for the ",-1)),e(p,{to:"/code-maze.com/multiple-environments-in-asp-net-core.html"},{default:t(()=>[...n[22]||(n[22]=[a("production environment",-1)])]),_:1})]),n[25]||(n[25]=a(".",-1))]),n[55]||(n[55]=l('<p>But there are more ways to configure our application. We can even use multiple configuration sources.</p><p>We can also configure both the host and the application itself, but in this case, we‚Äôre going to focus on application configuration.</p><p>That said, it‚Äôs important to know that <strong>different configuration providers can override each other.</strong> The order in which they are executed is important!</p><p>So which configuration providers are available to us?</p><hr><h2 id="which-configuration-providers-are-available-by-default" tabindex="-1"><a class="header-anchor" href="#which-configuration-providers-are-available-by-default"><span>Which Configuration Providers are Available by Default?</span></a></h2><p>Here‚Äôs the list of all the configuration providers in ASP.NET Core:</p><ul><li>File configuration provider <em>(default)</em></li><li>Secret Manager <em>(default)</em></li><li>Environment Variables configuration provider <em>(default)</em></li><li>Command-line configuration provider <em>(default)</em></li><li>Memory configuration provider</li><li>Azure Key Vault configuration provider</li><li>Azure App configuration provider</li><li>Key-per-file configuration provider</li><li>Custom configuration provider</li></ul><p>The <strong>first four providers</strong> from this list <strong>are the providers we get by default</strong>. These are <strong>implemented by the host builder</strong>. Others, we need to implement ourselves.</p><p>The custom configuration provider is a very powerful mechanism. It gives us the freedom to implement whichever configuration provider we want. Say, for example, we want to keep our configuration in a database table. No problem, a few lines of code, and we can add our custom provider to the application.</p><p>A file configuration provider is by far the most used one, but there are some cases where we need to use others. It‚Äôs not uncommon for developers to work in big development teams on large projects, where even <strong>putting the sensitive information in the apsettings.json file can cause problems for others</strong> and commit rollbacks.</p><p>We‚Äôve all been there. Environment variables and user secrets can help us with that.</p>',12)),s("p",null,[n[27]||(n[27]=a("There‚Äôs also the issue of ",-1)),e(p,{to:"/code-maze.com/multiple-environments-in-asp-net-core.html"},{default:t(()=>[...n[26]||(n[26]=[s("strong",null,"production environment",-1)])]),_:1}),n[28]||(n[28]=a(" configuration values sensitivity. ",-1)),n[29]||(n[29]=s("strong",null,"We just can‚Äôt use sensitive information in files in production",-1)),n[30]||(n[30]=a(". Azure key vault might be just the perfect solution for us in that case.",-1))]),n[56]||(n[56]=l(`<p>We‚Äôve mentioned that configuration providers are executed in a specific order.</p><p>Let‚Äôs learn in which order they are executed in.</p><hr><h2 id="default-order-of-execution-of-configuration-providers-in-asp-net-core-application" tabindex="-1"><a class="header-anchor" href="#default-order-of-execution-of-configuration-providers-in-asp-net-core-application"><span>Default Order of Execution of Configuration Providers in ASP.NET Core Application</span></a></h2><p>You know that simple method <code>CreateDefaultBuilder()</code> in Program.cs?</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IHostBuilder</span> <span class="token function">CreateHostBuilder</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line">    Host<span class="token punctuation">.</span><span class="token function">CreateDefaultBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">ConfigureWebHostDefaults</span><span class="token punctuation">(</span>webBuilder <span class="token operator">=&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            webBuilder<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">UseStartup</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Startup<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It turns out that it does a lot of things for us. Including the initial configuration of our host and application.</p><p>Since we‚Äôre talking about application configuration this time, let‚Äôs focus on that part of the implementation:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IHostBuilder</span> <span class="token function">CreateDefaultBuilder</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HostBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">//trimmed</span></span>
<span class="line"></span>
<span class="line">    builder<span class="token punctuation">.</span><span class="token function">ConfigureAppConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hostingContext<span class="token punctuation">,</span> config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name"><span class="token keyword">var</span></span> env <span class="token operator">=</span> hostingContext<span class="token punctuation">.</span>HostingEnvironment<span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        config<span class="token punctuation">.</span><span class="token function">AddJsonFile</span><span class="token punctuation">(</span><span class="token string">&quot;appsettings.json&quot;</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">optional</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">reloadOnChange</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">AddJsonFile</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;appsettings.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">env<span class="token punctuation">.</span>EnvironmentName</span><span class="token punctuation">}</span></span><span class="token string">.json&quot;</span></span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">optional</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">reloadOnChange</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                </span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">IsDevelopment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>ApplicationName<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name"><span class="token keyword">var</span></span> appAssembly <span class="token operator">=</span> Assembly<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssemblyName</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>ApplicationName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            </span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>appAssembly <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                config<span class="token punctuation">.</span><span class="token function">AddUserSecrets</span><span class="token punctuation">(</span>appAssembly<span class="token punctuation">,</span> <span class="token named-parameter punctuation">optional</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        </span>
<span class="line">        config<span class="token punctuation">.</span><span class="token function">AddEnvironmentVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>args <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            config<span class="token punctuation">.</span><span class="token function">AddCommandLine</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">//trimmed</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> builder<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>From this implementation, we can see the configuration providers order of execution. The host builder uses the <code>ConfigureAppConfiguration()</code> method to define the order in which our providers are loaded.</p>`,10)),s("p",null,[n[32]||(n[32]=a("First, the file configuration provider adds both appsettings.json and appsettings.{EnvironmentName}.json files. Next, if we‚Äôre in the ",-1)),e(p,{to:"/code-maze.com/multiple-environments-in-asp-net-core.html"},{default:t(()=>[...n[31]||(n[31]=[s("strong",null,"development environment",-1)])]),_:1}),n[33]||(n[33]=a(", the host builder adds user secrets. After that, it applies environment variables, and finally, command-line arguments are used if we need to override anything else.",-1))]),n[57]||(n[57]=l(`<p>Understanding this implementation will help us later on when we try to implement our custom provider.</p><p>We can also use this knowledge to our benefit if we want to <strong>remove certain configuration providers or even reorder them</strong>. Also, calling the <code>ConfigureAppConfiguration()</code> method multiple times <strong>will have an additive effect</strong>.</p><h3 id="adding-a-simple-ini-configuration-file" tabindex="-1"><a class="header-anchor" href="#adding-a-simple-ini-configuration-file"><span>Adding a Simple ini Configuration File</span></a></h3><p>We can demonstrate this by adding another configuration source by creating a simple ini file in the solution root, <code>appsettings.ini</code>:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="appsettings.ini"><span>appsettings.ini</span></div><div class="language-ini line-numbers-mode" data-highlighter="prismjs" data-ext="ini"><pre><code class="language-ini"><span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Logging:Level</span><span class="token punctuation">]</span></span></span>
<span class="line"><span class="token key attr-name">Default</span><span class="token punctuation">=</span><span class="token value attr-value">Information</span></span>
<span class="line"><span class="token key attr-name">Microsoft</span><span class="token punctuation">=</span><span class="token value attr-value">Warning</span></span>
<span class="line"><span class="token key attr-name">Microsoft.Hosting.Lifetime</span><span class="token punctuation">=</span><span class="token value attr-value">Information</span></span>
<span class="line"></span>
<span class="line"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">ConnectionStrings</span><span class="token punctuation">]</span></span></span>
<span class="line"><span class="token key attr-name">sqlConnection</span><span class="token punctuation">=</span><span class="token value attr-value">server=.; database=CodeMazeCommerce; Integrated Security=true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Now we can simply extend the host builder:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IHostBuilder</span> <span class="token function">CreateHostBuilder</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line">    Host<span class="token punctuation">.</span><span class="token function">CreateDefaultBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">ConfigureWebHostDefaults</span><span class="token punctuation">(</span>webBuilder <span class="token operator">=&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            webBuilder<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">UseStartup</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Startup<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">ConfigureAppConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hostingContext<span class="token punctuation">,</span> config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name"><span class="token keyword">var</span></span> env <span class="token operator">=</span> hostingContext<span class="token punctuation">.</span>HostingEnvironment<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">            config<span class="token punctuation">.</span><span class="token function">AddIniFile</span><span class="token punctuation">(</span><span class="token string">&quot;appsettings.ini&quot;</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">optional</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">reloadOnChange</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">AddIniFile</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;appsettings.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">env<span class="token punctuation">.</span>EnvironmentName</span><span class="token punctuation">}</span></span><span class="token string">.ini&quot;</span></span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">optional</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">reloadOnChange</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If we run the application now, we‚Äôll see two more sources added to our existing ones.</p><p>But what if we want to use just a single source and not worry about overriding our values with different providers, like environment or command-line?</p><p>We can simply do that by clearing the sources before we add our provider:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token punctuation">.</span><span class="token function">ConfigureAppConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hostingContext<span class="token punctuation">,</span> config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name"><span class="token keyword">var</span></span> env <span class="token operator">=</span> hostingContext<span class="token punctuation">.</span>HostingEnvironment<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    config<span class="token punctuation">.</span>Sources<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    config<span class="token punctuation">.</span><span class="token function">AddIniFile</span><span class="token punctuation">(</span><span class="token string">&quot;appsettings.ini&quot;</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">optional</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">reloadOnChange</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">AddIniFile</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;appsettings.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">env<span class="token punctuation">.</span>EnvironmentName</span><span class="token punctuation">}</span></span><span class="token string">.ini&quot;</span></span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">optional</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">reloadOnChange</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now if we run the application we‚Äôll only see appsettings.ini and appsettings.{EnvironmentName}.ini as the sources of configuration:</p><figure><img src="`+y+'" alt="single configuration provider" tabindex="0" loading="lazy"><figcaption>single configuration provider</figcaption></figure><p>Awesome.</p><p>But, other configuration providers exist and we should not discard them, so let‚Äôs revert that <code>Clear()</code> command. Let‚Äôs see how we can use them. They might come in handy.</p><hr><h2 id="using-default-configuration-providers" tabindex="-1"><a class="header-anchor" href="#using-default-configuration-providers"><span>Using Default Configuration Providers</span></a></h2><p>We‚Äôve seen how to add a simple ini configuration file by using the file configuration provider and the host builder. But we have three more ways to set the configuration values out-of-the-box.</p><h3 id="user-secrets" tabindex="-1"><a class="header-anchor" href="#user-secrets"><span>User Secrets</span></a></h3><p>User secrets are a convenient mechanism to store sensitive configuration data while in development. They are easy to use and you won‚Äôt have to create environment variables for each project you develop locally. It‚Äôs a good way to keep things clean and simple.</p>',20)),s("p",null,[n[34]||(n[34]=a("By default, the application uses secrets after the ",-1)),e(i,{icon:"iconfont icon-json"}),n[35]||(n[35]=s("code",null,"appsetting.json",-1)),n[36]||(n[36]=a(" and ",-1)),e(i,{icon:"iconfont icon-json"}),n[37]||(n[37]=s("code",null,"appsettings.{Environment}.json",-1)),n[38]||(n[38]=a(" files, and right before environment variables and command-line arguments by default. If you find yourself wondering why your secret isn‚Äôt working, it might be worthwhile to check your environment variables.",-1))]),n[58]||(n[58]=l(`<p>To be able to use secrets we can initialize the secret manager by navigating to the project root (<code>ProjectConfigurationDemo</code>) and typing:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">dotnet user-secrets init</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This will create UserSecretsId element in our <code>csproj</code> file within the PropertyGroup element:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="ProjectConfigurationDemo.csproj"><span>ProjectConfigurationDemo.csproj</span></div><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml"><pre><code class="language-xml"><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PropertyGroup</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TargetFramework</span><span class="token punctuation">&gt;</span></span>netcoreapp3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TargetFramework</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UserSecretsId</span><span class="token punctuation">&gt;</span></span>06219bf2-6545-49db-b255-908d1fabd932<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>UserSecretsId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PropertyGroup</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Now we can set a user secret to set a connection string:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">dotnet user-secrets <span class="token builtin class-name">set</span> <span class="token string">&quot;ConnectionStrings:sqlConnection&quot;</span> <span class="token string">&quot;server=.; database=CodeMazeCommerce; Integrated Security=true&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Once we see the ‚ÄúSuccessfully saved ‚Ä¶ to the secret store‚Äù, we can check out all our secrets by typing:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">dotnet user-secrets list</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Or we can remove it by typing:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">dotnet user-secrets remove <span class="token string">&quot;ConnectionStrings:sqlConnection&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>We can also right-click on the project itself inside the Visual Studio and then go to the ‚ÄúManage User Secrets‚Äù option to open the secrets.json file and check or modify our secrets:</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;ConnectionStrings:sqlConnection&quot;</span><span class="token operator">:</span> <span class="token string">&quot;server=.; database=CodeMazeCommerce; Integrated Security=true&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now if we run our application, our configuration values will be available at runtime.</p>`,13)),s("p",null,[n[40]||(n[40]=a("There are more useful commands for user secrets, so if you‚Äôre interested, you can check out the ",-1)),s("a",N,[e(i,{icon:"fa-brands fa-microsoft"}),n[39]||(n[39]=a("documentation pages",-1))]),n[41]||(n[41]=a(".",-1))]),n[59]||(n[59]=l(`<p>Just remember, we should use user secrets just for the development environment. We should not use them in other environments.</p><h3 id="environment-variables" tabindex="-1"><a class="header-anchor" href="#environment-variables"><span>Environment Variables</span></a></h3><p>We can do the same thing using environment variables. Environment variables although less convenient to use, are more appropriate for any environment, and therefore we can use them in production. However, they are unencrypted and if the machine gets compromised they are free for all to see.</p><p>The only thing we should be aware of is that when defining hierarchical configuration data we need to use double underscore __ instead of ‚Äú:‚Äù as we do in a JSON file.</p><p>For example, we can define the connection string:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">set</span> ConnectionStrings__sqlConnection <span class="token string">&quot;server=.; database=CodeMazeCommerce; Integrated Security=true&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And we can check if the variable is set by typing ‚Ä¶ you‚Äôve guessed it <code>set</code>.</p><h3 id="command-line-arguments" tabindex="-1"><a class="header-anchor" href="#command-line-arguments"><span>Command-line Arguments</span></a></h3><p>We can use command-line arguments to set configuration values too. It‚Äôs not that common thing to do though. We can use it to test if certain values work correctly.</p><p>We can set the configuration via command-line in three different ways:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">dotnet run ConnectionStrings:sqlConnection<span class="token operator">=</span>server<span class="token operator">=</span>.<span class="token punctuation">;</span> <span class="token assign-left variable">database</span><span class="token operator">=</span>CodeMazeCommerce<span class="token punctuation">;</span> Integrated <span class="token assign-left variable">Security</span><span class="token operator">=</span>true  </span>
<span class="line"><span class="token comment"># or </span></span>
<span class="line">dotnet run /ConnectionStrings:sqlConnection<span class="token operator">=</span>server<span class="token operator">=</span>.<span class="token punctuation">;</span> <span class="token assign-left variable">database</span><span class="token operator">=</span>CodeMazeCommerce<span class="token punctuation">;</span> Integrated <span class="token assign-left variable">Security</span><span class="token operator">=</span>true  </span>
<span class="line"><span class="token comment"># or </span></span>
<span class="line">dotnet run <span class="token parameter variable">--ConnectionStrings:sqlConnection</span><span class="token operator">=</span>server<span class="token operator">=</span>.<span class="token punctuation">;</span> <span class="token assign-left variable">database</span><span class="token operator">=</span>CodeMazeCommerce<span class="token punctuation">;</span> Integrated <span class="token assign-left variable">Security</span><span class="token operator">=</span>true\`</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>These commands are the same but we should mix them together.</p><hr><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2>`,14)),s("p",null,[n[43]||(n[43]=a("In this article, we‚Äôve learned what configuration providers are. We‚Äôve learned about the default ones, and how to use them to configure our application. In the next part, we‚Äôre going to implement a ",-1)),e(p,{to:"/code-maze.com/aspnet-configuration-creating-custom-provider.html"},{default:t(()=>[...n[42]||(n[42]=[s("strong",null,"custom configuration provider",-1)])]),_:1}),n[44]||(n[44]=a(" that reads our configuration values from the database.",-1))]),s("p",null,[n[46]||(n[46]=a("You can find other parts of this series on the ",-1)),e(p,{to:"/code-maze.com/net-core-series.html#configuration"},{default:t(()=>[...n[45]||(n[45]=[s("strong",null,"ASP.NET Core Web API page",-1)])]),_:1}),n[47]||(n[47]=a(".",-1))]),f(" TODO: add ARTICLE CARD "),e(c,u(d({title:"ASP.NET Core Configuration - Configuration Providers",desc:"In this article, we're going to talk about different configuration providers in ASP.NET Core applications.",link:"https://chanhi2000.github.io/bookshelf/code-maze.com/https:code-maze.comaspnet-configuration-providers.html",logo:"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16)])}const I=v(w,[["render",E]]),q=JSON.parse('{"path":"/code-maze.com/aspnet-configuration-providers.html","title":"ASP.NET Core Configuration - Configuration Providers","lang":"en-US","frontmatter":{"lang":"en-US","title":"ASP.NET Core Configuration - Configuration Providers","description":"Article(s) > ASP.NET Core Configuration - Configuration Providers","icon":"iconfont icon-csharp","category":["C#","DotNet","Article(s)"],"tag":["blog","code-maze.com","cs","c#","csharp","dotnet"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ASP.NET Core Configuration - Configuration Providers\\",\\"image\\":[\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/aspnet-configuration-providers/single-configuration-provider.png\\"],\\"datePublished\\":\\"2020-09-08T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Vladimir Pecanac\\",\\"url\\":\\"https://code-maze.com/author/codemaze_blog/\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/code-maze.com/aspnet-configuration-providers.html"}],["meta",{"property":"og:site_name","content":"üìöBookshelf"}],["meta",{"property":"og:title","content":"ASP.NET Core Configuration - Configuration Providers"}],["meta",{"property":"og:description","content":"Article(s) > ASP.NET Core Configuration - Configuration Providers"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/aspnet-configuration-providers/banner.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/aspnet-configuration-providers/banner.png"}],["meta",{"name":"twitter:image:alt","content":"ASP.NET Core Configuration - Configuration Providers"}],["meta",{"property":"article:author","content":"Vladimir Pecanac"}],["meta",{"property":"article:tag","content":"dotnet"}],["meta",{"property":"article:tag","content":"csharp"}],["meta",{"property":"article:tag","content":"c#"}],["meta",{"property":"article:tag","content":"cs"}],["meta",{"property":"article:tag","content":"code-maze.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2020-09-08T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > ASP.NET Core Configuration - Configuration Providers"},{"property":"og:description","content":"ASP.NET Core Configuration - Configuration Providers"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/code-maze.com/aspnet-configuration-providers.html"}]],"prev":"/programming/cs/articles/README.md","date":"2020-09-08T00:00:00.000Z","isOriginal":false,"author":[{"name":"Vladimir Pecanac","url":"https://code-maze.com/author/codemaze_blog/"}],"cover":"/assets/image/code-maze.com/aspnet-configuration-providers/banner.png"},"git":{},"readingTime":{"minutes":6.38,"words":1913},"filePathRelative":"code-maze.com/aspnet-configuration-providers.md","copyright":{"author":"Vladimir Pecanac"}}');export{I as comp,q as data};
