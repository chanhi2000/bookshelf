import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as g,d as e,f as t,b as c,t as b,n as k,g as f,w as a,e as n,r as d,o as y}from"./app-BVguHYKu.js";const w={},K={id:"frontmatter-title-관련",tabindex:"-1"},S={class:"header-anchor",href:"#frontmatter-title-관련"},T={class:"table-of-contents"};function R(u,s){const m=d("VPCard"),l=d("router-link"),v=d("SiteInfo"),p=d("Tabs"),r=d("VPIcon");return y(),g("div",null,[e("h1",K,[e("a",S,[e("span",null,b(u.$frontmatter.title)+" 관련",1)])]),t(m,k(f({title:"Kubernetes > Article(s)",desc:"Article(s)",link:"/devops/k8s/articles/README.md",logo:"https://chanhi2000.github.io/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),e("nav",T,[e("ul",null,[e("li",null,[t(l,{to:"#introduction"},{default:a(()=>s[0]||(s[0]=[n("Introduction")])),_:1,__:[0]})]),e("li",null,[t(l,{to:"#step-1-—-launching-the-digitalocean-kubernetes-cluster"},{default:a(()=>s[1]||(s[1]=[n("Step 1 — Launching the DigitalOcean Kubernetes Cluster")])),_:1,__:[1]})]),e("li",null,[t(l,{to:"#step-2-—-installing-knative-serving"},{default:a(()=>s[2]||(s[2]=[n("Step 2 — Installing Knative Serving")])),_:1,__:[2]})]),e("li",null,[t(l,{to:"#step-3-—-deploying-a-serverless-workload"},{default:a(()=>s[3]||(s[3]=[n("Step 3 — Deploying a Serverless Workload")])),_:1,__:[3]}),e("ul",null,[e("li",null,[t(l,{to:"#option-1-—-using-the-knative-cli"},{default:a(()=>s[4]||(s[4]=[n("Option 1 — Using the Knative CLI")])),_:1,__:[4]})]),e("li",null,[t(l,{to:"#option-2-—-creating-a-service-resource-using-yaml-files"},{default:a(()=>s[5]||(s[5]=[n("Option 2 — Creating a Service Resource Using YAML Files")])),_:1,__:[5]})])])]),e("li",null,[t(l,{to:"#step-4-—-accessing-the-application-workload"},{default:a(()=>s[6]||(s[6]=[n("Step 4 — Accessing the Application Workload")])),_:1,__:[6]})]),e("li",null,[t(l,{to:"#conclusion"},{default:a(()=>s[7]||(s[7]=[n("Conclusion")])),_:1,__:[7]})])])]),s[32]||(s[32]=e("hr",null,null,-1)),t(v,{name:"How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes | DigitalOcean",desc:"Knative is a Kubernetes-based platform that provides components to deploy and manage serverless workloads. Knative offers open-source Kubernetes integration,… ",url:"https://digitalocean.com/community/tutorials/how-to-run-serverless-workloads-with-knative-on-digitalocean-kubernetes",logo:"https://digitalocean.com/_next/static/media/favicon.594d6067.ico",preview:"https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg"}),s[33]||(s[33]=c(`<hr><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h2><p><a href="https://kubernetes.io" target="_blank" rel="noopener noreferrer">Kubernetes</a> is a powerful container orchestration tool that allows you to deploy and manage containerized applications, but it can sometimes take time to manage the underlying infrastructure. The <em><a href="https://digitalocean.com/community/tutorials/what-is-serverless" target="_blank" rel="noopener noreferrer">serverless</a></em> paradigm helps users deploy applications without having to worry about the underlying infrastructure. With the advent of Serverless 2.0, many platforms and tools now allow you to deploy serverless applications on Kubernetes.</p><p><a href="https://knative.dev/docs" target="_blank" rel="noopener noreferrer">Knative</a> is a Kubernetes-based platform that provides components to deploy and manage serverless workloads. Knative offers open-source Kubernetes integration, cloud-agnosticism, building blocks, and extensibility. Tools like Red Hat’s <a href="https://www.redhat.com/en/technologies/cloud-computing/openshift" target="_blank" rel="noopener noreferrer">Openshift</a> also use Knative for users to deploy their serverless workloads on top of Kubernetes.</p><p>Knative features two main components: <a href="https://knative.dev/docs/eventing" target="_blank" rel="noopener noreferrer">Eventing</a> and <a href="https://knative.dev/docs/serving" target="_blank" rel="noopener noreferrer">Serving</a>. Eventing manages events that trigger serverless workloads. Serving is a set of components to deploy and manage serverless workloads. Knative Serving enables developers to deploy and manage serverless applications on top of Kubernetes. With Knative Serving, developers can quickly and easily deploy new services, scale them up and down, and connect them to other services and event sources. This feature enables developers to build and deploy modern, cloud-native applications that are flexible, scalable, and easy to maintain.</p><p>In this tutorial, you will use Knative Serving to deploy a Node.js application as a serverless workload on a DigitalOcean Kubernetes cluster. You will use doctl (the DigitalOcean CLI) and kn (the Knative CLI) to create the Kubernetes cluster and deploy the application.</p><div class="hint-container note"><p class="hint-container-title">Prerequisites</p><p>To complete this tutorial, you will need the following:</p><ul><li>A DigitalOcean account that you will use to start a Kubernetes cluster with at least 4GB RAM and 2 CPU cores. If you do not have one, <a href="https://cloud.digitalocean.com/projects" target="_blank" rel="noopener noreferrer">sign up for a new account</a>. This setup will use a <a href="https://digitalocean.com/products/kubernetes" target="_blank" rel="noopener noreferrer">DigitalOcean Kubernetes</a> cluster. To create a Kubernetes cluster in the DigitalOcean Cloud Panel, see our <a href="https://digitalocean.com/docs/kubernetes/quickstart" target="_blank" rel="noopener noreferrer">Kubernetes Quickstart</a>.</li><li>To follow this tutorial from a remote server, you can set up an Ubuntu 22.04 server with a non-root user and a firewall by following our <a href="https://digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-22-04" target="_blank" rel="noopener noreferrer">Initial Server Setup</a>. To get started with a DigitalOcean Droplet, you can use our <a href="https://docs.digitalocean.com/products/droplets/quickstart" target="_blank" rel="noopener noreferrer">Droplet Quickstart</a>.</li><li>The DigitalOcean command-line client, <a href="https://docs.digitalocean.com/reference/doctl/how-to/install" target="_blank" rel="noopener noreferrer"><code>doctl</code></a>, installed on your machine. The <strong>GitHub Download</strong> option is recommended. See <a href="https://digitalocean.com/community/tutorials/how-to-use-doctl-the-official-digitalocean-command-line-client" target="_blank" rel="noopener noreferrer">How To Use doctl</a> for more information on using <code>doctl</code>.</li><li><a href="https://kubernetes.io/docs/tasks/tools" target="_blank" rel="noopener noreferrer"><code>kubectl</code></a> installed on your machine, which you can set up with the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-linux" target="_blank" rel="noopener noreferrer">Kubernetes installation docs</a>.</li><li>Docker installed on your machine, which you can set up by following Steps 1 and 2 of our tutorial on <a href="https://digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-22-04" target="_blank" rel="noopener noreferrer">How To Install and Use Docker</a>.</li><li>A sample Node.js application set up by following the <a href="https://digitalocean.com/community/tutorials/how-to-build-a-node-js-application-with-docker" target="_blank" rel="noopener noreferrer">How To Build a Node.js Application with Docker</a> tutorial for creating the application and pushing its container image to Docker Hub.</li><li>An account at <a href="https://hub.docker.com" target="_blank" rel="noopener noreferrer">Docker Hub</a> for storing Docker images you’ll create during this tutorial.</li></ul></div><hr><h2 id="step-1-—-launching-the-digitalocean-kubernetes-cluster" tabindex="-1"><a class="header-anchor" href="#step-1-—-launching-the-digitalocean-kubernetes-cluster"><span>Step 1 — Launching the DigitalOcean Kubernetes Cluster</span></a></h2><p>Since Knative is a Kubernetes-based platform, you will use it with a Kubernetes cluster on DigitalOcean. There are multiple ways to launch a Kubernetes cluster on DigitalOcean. You can use the <a href="https://digitalocean.com/docs/kubernetes/quickstart" target="_blank" rel="noopener noreferrer">DigitalOcean Cloud interface</a>, the DigitalOcean CLI, or the Terraform provider.</p><p>In this tutorial, you will use doctl, the DigitalOcean command-line client, to launch the Kubernetes cluster. If you have not yet installed doctl, follow the steps in the <a href="https://docs.digitalocean.com/reference/doctl/how-to/install" target="_blank" rel="noopener noreferrer">official installation guide</a>.</p><p>To effectively use Knative in this tutorial, you will need a Kubernetes cluster with at least <strong>4GB RAM</strong> and <strong>2 CPU cores</strong> available. You can launch a cluster named <code>knative-tutorial</code> with these specifications by running the <code>doctl</code> command with the following flags:</p><ul><li><code>--size</code> specifies the size of the remote server.</li><li><code>--count</code> specifies the number of nodes that will be created as part of the cluster.</li></ul><p>To create the DigitalOcean Kubernetes cluster, run the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">doctl kubernetes cluster create knative-tutorial <span class="token parameter variable">--size</span> s-2vcpu-4gb <span class="token parameter variable">--count</span> <span class="token number">3</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>In this command, you create a cluster named <code>knative-tutorial</code> with the size set to <strong>4GB RAM</strong> and <strong>2 CPU cores</strong> and with a count of <code>3</code> nodes.</p><p>::: Note</p><p>You can also use the <code>--region</code> flag to specify in which region the server will be located, though that option is not used in this tutorial. If you are using a remote server, such as a Droplet, you might wish to have your cluster in the same region as the server. If you use the DigitalOcean Control Panel to <a href="https://docs.digitalocean.com/products/kubernetes/how-to/create-clusters/#choose-a-datacenter-region" target="_blank" rel="noopener noreferrer">create your cluster</a>, you can <a href="https://docs.digitalocean.com/products/kubernetes/how-to/create-clusters/#choose-a-datacenter-region" target="_blank" rel="noopener noreferrer">choose a datacenter region and VPC network</a>. For more on DigitalOcean’s regional availability, you can refer to our <a href="https://docs.digitalocean.com/products/platform/availability-matrix" target="_blank" rel="noopener noreferrer">Regional Availability Matrix</a>.</p><p>:::</p><p>This command will take a few minutes to complete. Once it finishes, you will receive a message similar to the following:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Output</span></span>
<span class="line"><span class="token comment"># Notice: Cluster is provisioning, waiting for cluster to be running</span></span>
<span class="line"><span class="token comment"># ...........................................................</span></span>
<span class="line"><span class="token comment"># Notice: Cluster created, fetching credentials</span></span>
<span class="line"><span class="token comment"># Notice: Adding cluster credentials to kubeconfig file found in &quot;/home/sammy/.kube/config&quot;</span></span>
<span class="line"><span class="token comment"># Notice: Setting current-context to do-nyc1-knative-tutorial</span></span>
<span class="line"><span class="token comment"># ID                                      Name                Region    Version        Auto Upgrade    Status     Node Pools</span></span>
<span class="line"><span class="token comment"># d2d1f9bc-114b-45e7-b109-104137f9ab62    knative-tutorial    nyc1      1.24.4-do.0    false           running    knative-tutorial-default-pool</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The cluster is now ready to use.</p><p>You can now verify if <code>kubectl</code> has been set up in your system and can reach the DigitalOcean Kubernetes Cluster with the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl cluster-info</span>
<span class="line"><span class="token comment"># Output</span></span>
<span class="line"><span class="token comment"># Kubernetes control plane is running at https://69de217e-0284-4e18-a6d7-5606915a4e88.k8s.ondigitalocean.com</span></span>
<span class="line"><span class="token comment"># CoreDNS is running at https://69de217e-0284-4e18-a6d7-5606915a4e88.k8s.ondigitalocean.com/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Since the output lists the URLs of the <code>control plane</code> and the <code>CoreDNS</code> service (highlighted in the output block), you know that <code>kubectl</code> is configured correctly in your system and can reach the cluster.</p><p>As part of the cluster creation process, <code>doctl</code> automatically configures the <code>kubectl</code> context to use the new cluster. You can verify this by running the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl config current-context</span>
<span class="line"><span class="token comment"># Output</span></span>
<span class="line"><span class="token comment"># o-nyc1-knative-tutorial</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This command will return the name of the current context.</p><p>The output indicates that the current context is <code>do-nyc1-knative-tutorial</code>, which is the name of the cluster you created with the region in which it is located (<code>nyc1</code>).</p><p>You can also verify that the cluster is running and the nodes are ready to accept workloads with this command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl get nodes</span>
<span class="line"><span class="token comment"># NAME                                       STATUS   ROLES    AGE     VERSION</span></span>
<span class="line"><span class="token comment"># do-nyc1-knative-tutorial-159783000-0v9k5   Ready    &lt;none&gt;   2m52s   v1.24.4</span></span>
<span class="line"><span class="token comment"># do-nyc1-knative-tutorial-159783000-1h4qj   Ready    &lt;none&gt;   2m52s   v1.24.4</span></span>
<span class="line"><span class="token comment"># do-nyc1-knative-tutorial-159783000-1q9qf   Ready    &lt;none&gt;   2m52s   v1.24.4</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>kubectl get nodes</code> command lists all the nodes in the cluster along with their status and other information.</p><p>The output states that the cluster has three nodes ready to accept workloads.</p><p>In this step, you launched a Kubernetes cluster on DigitalOcean. You can now install Knative to deploy your serverless workload on Kubernetes.</p><hr><h2 id="step-2-—-installing-knative-serving" tabindex="-1"><a class="header-anchor" href="#step-2-—-installing-knative-serving"><span>Step 2 — Installing Knative Serving</span></a></h2><p>In this step, you will install <a href="https://knative.dev/docs/serving" target="_blank" rel="noopener noreferrer">Knative Serving</a> on your Kubernetes cluster. Knative Serving is responsible for deploying and managing your serverless workloads.</p><p>To install Knative Serving, you will need the Knative core components and custom resources. Run these commands to install the core components:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-f</span> https://github.com/knative/serving/releases/download/knative-v1.8.0/serving-crds.yaml</span>
<span class="line">kubectl apply <span class="token parameter variable">-f</span> https://github.com/knative/serving/releases/download/knative-v1.8.0/serving-core.yaml</span>
<span class="line"><span class="token comment"># customresourcedefinition.apiextensions.k8s.io/certificates.networking.internal.knative.dev created</span></span>
<span class="line"><span class="token comment"># customresourcedefinition.apiextensions.k8s.io/clusteringresses.networking.internal.knative.dev created</span></span>
<span class="line"><span class="token comment"># customresourcedefinition.apiextensions.k8s.io/configurations.serving.knative.dev created</span></span>
<span class="line"><span class="token comment"># customresourcedefinition.apiextensions.k8s.io/images.caching.internal.knative.dev created</span></span>
<span class="line"><span class="token comment"># customresourcedefinition.apiextensions.k8s.io/ingresses.networking.internal.knative.dev created</span></span>
<span class="line"><span class="token comment"># ...</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This output indicates that the Knative core components and custom resources are on your cluster. All of the components are in the <code>knative-serving</code> namespace.</p><p>Once they have finished downloading, you can verify that Knative Serving is installed:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl get pods <span class="token parameter variable">--namespace</span> knative-serving</span>
<span class="line"><span class="token comment"># NAME                                      READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span class="token comment"># activator-5f6b4bf5c8-kfxrv                1/1     Running   0          4m37s</span></span>
<span class="line"><span class="token comment"># autoscaler-bc7d6c9c9-v5jqt                1/1     Running   0          4m34s</span></span>
<span class="line"><span class="token comment"># controller-687d88ff56-9g4gz               1/1     Running   0          4m32s</span></span>
<span class="line"><span class="token comment"># domain-mapping-69cc86d8d5-kr57g           1/1     Running   0          4m29s</span></span>
<span class="line"><span class="token comment"># domainmapping-webhook-65dfdd9b96-nzs9c    1/1     Running   0          4m27s</span></span>
<span class="line"><span class="token comment"># net-kourier-controller-55c99987b4-hkfpl   1/1     Running   0          3m49s</span></span>
<span class="line"><span class="token comment"># webhook-587cdd8dd7-qbb9b                  1/1     Running   0          4m22s</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>kubectl get pods</code> command will retrieve a list of all the pods launched in the cluster in the namespace <code>knative-serving</code>. This command identifies the pods in your cluster, their current status, the number of containers in the pod, and the names of the containers in a particular namespace.</p><p>The output displays all the pods running in the knative-serving namespace. The pods are responsible for the different components of Knative Serving.</p><p>Knative requires a networking layer to route incoming traffic to your services. The networking layer in Knative enables the deployment and communication of microservices in a distributed environment. Knative Serving supports Istio, Contour, and Kourier as the networking layer.</p><p>In this tutorial, you will use Kourier as the networking layer because it integrates seamlessly with Knative. Kourier uses the same APIs and standards as the rest of the Knative ecosystem, making it a good option for developers and organizations already using Knative who want to benefit from its powerful networking capabilities.</p><p>Install Kourier with this command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-f</span> https://github.com/knative/net-kourier/releases/download/knative-v1.8.0/kourier.yaml</span>
<span class="line"><span class="token comment"># namespace/kourier-system configured</span></span>
<span class="line"><span class="token comment"># configmap/kourier-bootstrap configured</span></span>
<span class="line"><span class="token comment"># configmap/config-kourier configured</span></span>
<span class="line"><span class="token comment"># serviceaccount/net-kourier configured</span></span>
<span class="line"><span class="token comment"># clusterrole.rbac.authorization.k8s.io/net-kourier configured</span></span>
<span class="line"><span class="token comment"># clusterrolebinding.rbac.authorization.k8s.io/net-kourier configured</span></span>
<span class="line"><span class="token comment"># deployment.apps/net-kourier-controller configured</span></span>
<span class="line"><span class="token comment"># service/net-kourier-controller configured</span></span>
<span class="line"><span class="token comment"># deployment.apps/3scale-kourier-gateway configured</span></span>
<span class="line"><span class="token comment"># service/kourier configured</span></span>
<span class="line"><span class="token comment"># service/kourier-internal configured</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The output lists all the resources, like <code>Namespaces</code> and <code>ConfigMaps</code>, created as part of the Kourier installation process in the Kubernetes cluster.</p><p>To configure Knative to use Kourier as the networking layer, you will edit the <code>config-network</code> ConfigMap.</p><p>For this, you need to use the <code>kubectl patch</code> command to update the fields of an object in a Kubernetes cluster. You will have to also include some flags with this command:</p><ul><li><code>--namespace</code> specifies where you can find the object you want to patch.</li><li><code>--type</code> specifies which patch to perform when applying configs with the <code>patch</code> command. The available types are <code>json</code>, <code>merge</code>, and <code>strategic</code>.</li><li><code>--patch</code> specifies the patch data directly on the command line rather than in a file.</li></ul><p>Run this command with the associated flags:</p>`,53)),t(p,{data:[{id:"Shell"},{id:"Powershell"},{id:"Cmd"}],active:0},{title0:a(({value:i,isActive:o})=>s[8]||(s[8]=[n("Shell")])),title1:a(({value:i,isActive:o})=>s[9]||(s[9]=[n("Powershell")])),title2:a(({value:i,isActive:o})=>s[10]||(s[10]=[n("Cmd")])),tab0:a(({value:i,isActive:o})=>s[11]||(s[11]=[e("div",{class:"language-bash line-numbers-mode","data-highlighter":"prismjs","data-ext":"sh"},[e("pre",null,[e("code",{class:"language-bash"},[e("span",{class:"line"},[n("kubectl patch configmap/config-network "),e("span",{class:"token punctuation"},"\\")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter variable"},"--namespace"),n(" knative-serving "),e("span",{class:"token punctuation"},"\\")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter variable"},"--type"),n(" merge "),e("span",{class:"token punctuation"},"\\")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter variable"},"--patch"),n(),e("span",{class:"token string"},`'{"data":{"ingress-class":"kourier.ingress.networking.knative.dev"}}'`)]),n(`
`),e("span",{class:"line"}),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# configmap/config-network patched")]),n(`
`),e("span",{class:"line"})])]),e("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1)])),tab1:a(({value:i,isActive:o})=>s[12]||(s[12]=[e("div",{class:"language-powershell line-numbers-mode","data-highlighter":"prismjs","data-ext":"powershell"},[e("pre",null,[e("code",{class:"language-powershell"},[e("span",{class:"line"},"kubectl patch configmap/config-network `"),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token operator"},"--"),n("namespace knative-serving `")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token operator"},"--"),e("span",{class:"token function"},"type"),n(" merge `")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token operator"},"--"),n("patch "),e("span",{class:"token string"},`'{"data":{"ingress-class":"kourier.ingress.networking.knative.dev"}}'`)]),n(`
`),e("span",{class:"line"}),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# configmap/config-network patched  ")]),n(`
`),e("span",{class:"line"})])]),e("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1)])),tab2:a(({value:i,isActive:o})=>s[13]||(s[13]=[e("div",{class:"language-batch line-numbers-mode","data-highlighter":"prismjs","data-ext":"batch"},[e("pre",null,[e("code",{class:"language-batch"},[e("span",{class:"line"},[e("span",{class:"token command"},[e("span",{class:"token keyword"},"kubectl"),n(" patch configmap/config-network "),e("span",{class:"token operator"},"^")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter attr-name"},"--namespace"),n(" knative-serving "),e("span",{class:"token operator"},"^")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter attr-name"},"--type"),n(" merge "),e("span",{class:"token operator"},"^")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter attr-name"},"--patch"),n(" '{"),e("span",{class:"token string"},'"data"'),e("span",{class:"token label property"},":{"),e("span",{class:"token string"},'"ingress-class"'),n(":"),e("span",{class:"token string"},'"kourier.ingress.networking.knative.dev"'),n("}}'")])]),n(`
`),e("span",{class:"line"}),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM configmap/config-network patched  ")]),n(`
`),e("span",{class:"line"})])]),e("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1)])),_:1}),s[34]||(s[34]=c(`<p>The <code>kubectl patch</code> command patches <code>configmap/config-network</code> with the <code>namespace</code> set to <code>knative-serving</code> and the <code>type</code> set to <code>merge</code>.</p><p>The <code>merge</code> patch type allows for more targeted updates, while the <code>json</code> or <code>strategic</code> patch types allow for more comprehensive updates. The <code>merge</code> patch type specifies individual fields to update without including the entire resource configuration in the patch command, which is the case for the other types. The data being patched is identified with the <code>patch</code> flag.</p><p>The output of this command ensures Kourier is properly set up in the cluster.</p><p>Finally, fetch the external IP address of the Kourier load balancer with the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl get svc kourier <span class="token parameter variable">--namespace</span> kourier-system</span>
<span class="line"><span class="token comment"># NAME      TYPE           CLUSTER-IP       EXTERNAL-IP      PORT(S)                      AGE</span></span>
<span class="line"><span class="token comment"># kourier   LoadBalancer   10.245.186.153   138.197.231.61   80:31245/TCP,443:30762/TCP   2m33s</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>kubectl get svc</code> command retrieves information about the services running in a Kubernetes cluster in the mentioned namespace (in this case, <code>kourier-system</code>). This command will list all the services in the cluster with their associated IP addresses and port numbers.</p><p>The output of the command includes the name of the service, the type of service (such as <code>ClusterIP</code>, <code>NodePort</code>, and so on), the cluster IP address and port number, and the external IP address and port number. The numbers listed here are examples, so your output will display different numbers.</p><p>It may take a few minutes for the load balancer to be provisioned. You may see an empty value or <code>&lt;pending&gt;</code> for the <code>EXTERNAL-IP</code> field. If that is the case, wait a few minutes and rerun the command.</p><div class="hint-container note"><p class="hint-container-title">Note</p><p><strong>Note</strong>: You will need the load balancer to be provisioned before continuing in this tutorial. Once the <code>EXTERNAL-IP</code> field for the <code>LoadBalancer</code> is populated, you can continue. Otherwise, you may experience issues while setting up the DNS service.</p></div><p>You can also configure DNS for your domain name to point to the external IP address of the load balancer. Knative provides a Kubernetes job called default-domain that will automatically configure Knative Serving to use sslip.io as the default DNS suffix.</p><p>sslip.io is a dynamic DNS (Domain Name System) service that allows users to access their devices using a custom domain name instead of the IP address. Using sslip.io improves user access to their devices remotely without needing to remember complex IP addresses.</p><p>To configure the default DNS suffix, you will need to run the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-f</span> https://github.com/knative/serving/releases/download/knative-v1.8.0/serving-default-domain.yaml</span>
<span class="line"><span class="token comment"># job.batch/default-domain configured</span></span>
<span class="line"><span class="token comment"># service/default-domain-service configured</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The resources required to run the Magic DNS service have been configured successfully.</p><div class="hint-container note"><p class="hint-container-title">Note</p><p><strong>Note</strong>: You can also add a domain if you prefer, though that is beyond the scope of this article. You need to set up a DNS provider (such as Cloud DNS or Route53) and create an A record for the Knative ingress gateway that is mapped to the IP address of your Knative cluster. You would then update the Knative ingress gateway configuration to use the DNS zone and A record you created. You can test the DNS configuration by accessing the Knative serving domain and ensuring it resolves to the ingress gateway.</p></div><p>You have now successfully installed Knative Serving on your Kubernetes cluster. You can now deploy the Serverless workload with Knative Serving on your Kubernetes cluster.</p><hr><h2 id="step-3-—-deploying-a-serverless-workload" tabindex="-1"><a class="header-anchor" href="#step-3-—-deploying-a-serverless-workload"><span>Step 3 — Deploying a Serverless Workload</span></a></h2><p>In this step, you will deploy a serverless workload on top of Knative, which is currently running in your Kubernetes cluster. You will use the Node.js application that you created as part of the prerequisites.</p><p>Before you proceed, you will create a new <code>namespace</code> to deploy your serverless workload. You can do this by running the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl create namespace serverless-workload</span>
<span class="line"><span class="token comment"># namespace/serverless-workload configured</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>This command will create a new namespace called serverless-workload.</p><p>The output ensures that the namespace has been created successfully.</p><p>Knative Serving uses a custom resource called <code>Service</code> to deploy and manage your serverless workloads. The <code>Service</code> resource is defined by the <a href="https://knative.dev/docs/serving" target="_blank" rel="noopener noreferrer">Knative Serving API</a>.</p><p>Once you create or modify the <code>Service</code> resource, Knative Serving will automatically create a new <code>Revision</code>. A <code>Revision</code> is a point-in-time snapshot of your workload.</p><p>Whenever a new <code>Revision</code> is created, traffic will be routed to the new <code>Revision</code> by a <code>Route</code>. Knative Serving automatically creates a <code>Route</code> for each Service. You can access your workload using the domain name from the <code>Route</code>.</p><p>To deploy a serverless workload on Knative, you must create a <code>Service</code> resource. You can achieve this in two different ways:</p><ul><li>Using the <code>kn</code>, the official Knative CLI tool.</li><li>Using the <code>kubectl</code> command line tool for applying YAML files to your Kubernetes cluster.</li></ul><p>In the subsections that follow, you will use each of these methods.</p><h3 id="option-1-—-using-the-knative-cli" tabindex="-1"><a class="header-anchor" href="#option-1-—-using-the-knative-cli"><span>Option 1 — Using the Knative CLI</span></a></h3><p>The Knative CLI, <code>kn</code>, is a command-line interface that allows you to interact with Knative.</p><p>First, install <code>kn</code> by downloading the latest version of the Knative CLI binary:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">wget</span> https://github.com/knative/client/releases/download/knative-v1.8.1/kn-linux-amd64</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The <code>wget</code> command will retrieve the tool.</p><p>Then, move the binary to a folder called <code>kn</code>:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">mv</span> kn-linux-amd64 kn</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Next, make it executable with the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">chmod</span> +x kn</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Finally, move the executable binary file to a directory on your <code>PATH</code>:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">cp</span> kn /usr/local/bin/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Verify that kn is installed:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kn version</span>
<span class="line"><span class="token comment"># Version:      v1.8.1</span></span>
<span class="line"><span class="token comment"># Build Date:   2022-10-20 16:09:37</span></span>
<span class="line"><span class="token comment"># Git Revision: 1db36698</span></span>
<span class="line"><span class="token comment"># Supported APIs:</span></span>
<span class="line"><span class="token comment"># * Serving</span></span>
<span class="line"><span class="token comment">#   - serving.knative.dev/v1 (knative-serving v1.8.0)</span></span>
<span class="line"><span class="token comment"># * Eventing</span></span>
<span class="line"><span class="token comment">#   - sources.knative.dev/v1 (knative-eventing v1.8.0)</span></span>
<span class="line"><span class="token comment">#   - eventing.knative.dev/v1 (knative-eventing v1.8.0)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The output of this command states that <code>kn</code> was installed.</p><p>To deploy the Node.js application using <code>kn</code>, you will use the <code>kn service create</code> command. You will include some flags with this command:</p><ul><li><code>--image</code> specifies the image of the container you want to deploy.</li><li><code>--port</code> specifies the port that your application listens on.</li><li><code>--name</code> specifies the name of the <code>Service</code> you want to create.</li><li><code>--namespace</code> specifies the namespace to which you want to deploy the workload.</li></ul><p>To deploy your Node.js application, run the following command and update the highlighted portion with your DockerHub username:</p>`,46)),t(p,{data:[{id:'<VPIcon icon="iconfont icon-shell"/>Shell'},{id:'<VPIcon icon="iconfont icon-powershell"/>Powershell'},{id:'<VPIcon icon="fas fa-gears"/>Cmd'}],active:0},{title0:a(({value:i,isActive:o})=>[t(r,{icon:"iconfont icon-shell"}),s[14]||(s[14]=n("Shell"))]),title1:a(({value:i,isActive:o})=>[t(r,{icon:"iconfont icon-powershell"}),s[15]||(s[15]=n("Powershell"))]),title2:a(({value:i,isActive:o})=>[t(r,{icon:"fas fa-gears"}),s[16]||(s[16]=n("Cmd"))]),tab0:a(({value:i,isActive:o})=>s[17]||(s[17]=[e("div",{class:"language-bash line-numbers-mode","data-highlighter":"prismjs","data-ext":"sh"},[e("pre",null,[e("code",{class:"language-bash"},[e("span",{class:"line"},[n("kn "),e("span",{class:"token function"},"service"),n(" create node-service "),e("span",{class:"token punctuation"},"\\")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter variable"},"--image"),n(" your_dockerhub_username/nodejs-image-demo "),e("span",{class:"token punctuation"},"\\")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter variable"},"--port"),n(),e("span",{class:"token number"},"8080"),n(),e("span",{class:"token punctuation"},"\\")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter variable"},"--namespace"),n(" serverless-workload")]),n(`
`),e("span",{class:"line"}),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# Creating service 'node-service' in namespace 'serverless-workload':")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# ")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},'#   0.236s Configuration "node-service" is waiting for a Revision to become ready.')]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"#   2.230s ...")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"#   2.311s Ingress has not yet been reconciled.")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"#   2.456s Waiting for load balancer to be ready")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"#   2.575s Ready to serve.")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# ")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# Service 'node-service' created to latest revision 'node-service-00001' is available at URL:")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# http://node-service.serverless-workload.138.197.231.61.sslip.io")]),n(`
`),e("span",{class:"line"})])]),e("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1)])),tab1:a(({value:i,isActive:o})=>s[18]||(s[18]=[e("div",{class:"language-powershell line-numbers-mode","data-highlighter":"prismjs","data-ext":"powershell"},[e("pre",null,[e("code",{class:"language-powershell"},[e("span",{class:"line"},"kn service create node-service `"),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token operator"},"--"),n("image your_dockerhub_username/nodejs-image-demo `")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token operator"},"--"),n("port 8080 `")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token operator"},"--"),n("namespace serverless-workload")]),n(`
`),e("span",{class:"line"}),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# Creating service 'node-service' in namespace 'serverless-workload':")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# ")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},'#   0.236s Configuration "node-service" is waiting for a Revision to become ready.')]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"#   2.230s ...")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"#   2.311s Ingress has not yet been reconciled.")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"#   2.456s Waiting for load balancer to be ready")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"#   2.575s Ready to serve.")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# ")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# Service 'node-service' created to latest revision 'node-service-00001' is available at URL:")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"# http://node-service.serverless-workload.138.197.231.61.sslip.io")]),n(`
`),e("span",{class:"line"})])]),e("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1)])),tab2:a(({value:i,isActive:o})=>s[19]||(s[19]=[e("div",{class:"language-batch line-numbers-mode","data-highlighter":"prismjs","data-ext":"batch"},[e("pre",null,[e("code",{class:"language-batch"},[e("span",{class:"line"},[e("span",{class:"token command"},[e("span",{class:"token keyword"},"kn"),n(" service create node-service "),e("span",{class:"token operator"},"^")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter attr-name"},"--image"),n(" your_dockerhub_username/nodejs-image-demo "),e("span",{class:"token operator"},"^")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter attr-name"},"--port"),n(),e("span",{class:"token number"},"8080"),n(),e("span",{class:"token operator"},"^")]),n(`
`),e("span",{class:"line"},[n("  "),e("span",{class:"token parameter attr-name"},"--namespace"),n(" serverless-workload")])]),n(`
`),e("span",{class:"line"}),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM Creating service 'node-service' in namespace 'serverless-workload':")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM ")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},'REM   0.236s Configuration "node-service" is waiting for a Revision to become ready.')]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM   2.230s ...")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM   2.311s Ingress has not yet been reconciled.")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM   2.456s Waiting for load balancer to be ready")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM   2.575s Ready to serve.")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM ")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM Service 'node-service' created to latest revision 'node-service-00001' is available at URL:")]),n(`
`),e("span",{class:"line"},[e("span",{class:"token comment"},"REM http://node-service.serverless-workload.138.197.231.61.sslip.io")]),n(`
`),e("span",{class:"line"})])]),e("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1)])),_:1}),s[35]||(s[35]=c(`<p>This output provides the status of the Knative <code>Service</code> creation. Once the <code>Service</code> gets created, you will find the URL of the <code>Route</code> linked to the <code>Service</code>.</p><p>Run the following command to verify that the <code>Service</code> resource was created:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kn <span class="token function">service</span> list <span class="token parameter variable">--namespace</span> serverless-workload</span>
<span class="line"><span class="token comment"># NAME           URL                                                               LATEST               AGE   CONDITIONS   READY   REASON</span></span>
<span class="line"><span class="token comment"># node-service   http://node-service.serverless-workload.138.197.231.61.sslip.io   node-service-00001   88s   3 OK / 3     True    </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>kn service list</code> command lists all the services currently deployed with Knative Serving in a particular namespace in the Kubernetes cluster. This command enables you to access details about each Service, including its name, status, and URL.</p><p>From this output, you can verify that a new Knative <code>Service</code> has been created by the <code>kn service</code> command you executed earlier. You also find the URL for the <code>Route</code> and the <code>Age</code> and <code>Status</code> of the Service.</p><p>In this section, you installed the Knative CLI and used it to deploy a serverless workload for your Node.js app.</p><h3 id="option-2-—-creating-a-service-resource-using-yaml-files" tabindex="-1"><a class="header-anchor" href="#option-2-—-creating-a-service-resource-using-yaml-files"><span>Option 2 — Creating a Service Resource Using YAML Files</span></a></h3><p>You can also deploy a <code>Service</code> resource by creating a YAML file that defines the resource. This method is useful to ensure version control of your workloads.</p><p>First, you will create a subdirectory in the directory containing your <code>Dockerfile</code>. This tutorial uses the name <code>knative</code> for the subdirectory. Create the folder:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">mkdir</span> knative</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,10)),e("p",null,[s[20]||(s[20]=n("Next, you will create a YAML file called ")),t(r,{icon:"iconfont icon-yaml"}),s[21]||(s[21]=e("code",null,"service.yaml",-1)),s[22]||(s[22]=n(" in the ")),s[23]||(s[23]=e("code",null,"knative",-1)),s[24]||(s[24]=n(" directory:"))]),s[36]||(s[36]=c(`<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">nano</span> knative/service.yaml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,1)),e("p",null,[s[25]||(s[25]=n("In the newly created ")),t(r,{icon:"iconfont icon-yaml"}),s[26]||(s[26]=e("code",null,"service.yaml",-1)),s[27]||(s[27]=n(" file, add the following lines to define a ")),s[28]||(s[28]=e("code",null,"Service",-1)),s[29]||(s[29]=n(" that will deploy your Node.js app:"))]),e("blockquote",null,[t(r,{icon:"fas fa-folder-open"}),s[30]||(s[30]=e("code",null,"~/node_project/knative/",-1)),t(r,{icon:"iconfont icon-yaml"}),s[31]||(s[31]=e("code",null,"service.yaml",-1))]),s[37]||(s[37]=c(`<div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> serving.knative.dev/v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Service</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span>yaml<span class="token punctuation">-</span>service</span>
<span class="line">  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> serverless<span class="token punctuation">-</span>workload</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">template</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">name</span><span class="token punctuation">:</span> node<span class="token punctuation">-</span>yaml<span class="token punctuation">-</span>service<span class="token punctuation">-</span>v1</span>
<span class="line">    <span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> docker.io/your_dockerhub_username/nodejs<span class="token punctuation">-</span>image<span class="token punctuation">-</span>demo</span>
<span class="line">          <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The Knative Service YAML file specifies the following information:</p><ul><li><code>name</code> in the first <code>metadata</code> section specifies the <code>name</code> of the <code>Service</code> resource.</li><li><code>namespace</code> specifies the <code>namespace</code> to which you want to deploy the workload.</li><li><code>name</code> in the first <code>spec</code> section specifies the <code>name</code> of the <code>Revision</code>.</li><li><code>image</code> in the second <code>spec</code> section specifies the <code>image</code> of the container you want to deploy.</li><li><code>containerPort</code> specifies the <code>port</code> your application listens on.</li></ul><p>Be sure to update the highlighted text with the information you’ve selected for your app and system, as well as your DockerHub username.</p><p>Save and close the file.</p><p>You can now deploy the <code>Service</code> resource by running the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-f</span> knative/service.yaml</span>
<span class="line"><span class="token comment"># service.serving.knative.dev/node-yaml-service created</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>The output indicates that the <code>Service</code> resource has been created successfully.</p><p>Run the following command to verify that the <code>Service</code> resource has been created:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kn <span class="token function">service</span> list <span class="token parameter variable">--namespace</span> serverless-workload</span>
<span class="line"><span class="token comment"># NAME                URL                                                                     LATEST                 AGE   CONDITIONS   READY   REASON</span></span>
<span class="line"><span class="token comment"># node-service        http://node-service.serverless-workload.174.138.127.211.sslip.io        node-service-00001     9d    3 OK / 3     True    </span></span>
<span class="line"><span class="token comment"># node-yaml-service   http://node-yaml-service.serverless-workload.174.138.127.211.sslip.io   node-yaml-service-v1   9d    3 OK / 3     True    </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>kn service list</code> command lists all the services currently deployed with Knative Serving in a particular namespace. This command enables you to access details about each Service.</p><p>You can verify that a new Knative <code>Service</code> has been created based on the Knative Service YAML file that you executed previously. You created the <code>node-yaml-service</code> in this section. You can also find the URL of the Knative <code>Route</code>.</p><p>You used a YAML file in this section to create a serverless workload for your Node.js app.</p><p>In this step, you created the Knative <code>Service</code> resource using both the <code>kn</code> CLI tool and a YAML file. Next, you will access the application workload you deployed with Knative.</p><hr><h2 id="step-4-—-accessing-the-application-workload" tabindex="-1"><a class="header-anchor" href="#step-4-—-accessing-the-application-workload"><span>Step 4 — Accessing the Application Workload</span></a></h2><p>Now that you have deployed the serverless workload, you can access it with the URL from the Knative <code>Route</code> created as part of the Serverless workload. The Knative Route defines how incoming HTTP traffic should route to a specific service or application.</p><p>To get the list of all Knative routes, run the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kn route list <span class="token parameter variable">--namespace</span> serverless-workload</span>
<span class="line"><span class="token comment"># </span></span>
<span class="line"><span class="token comment"># NAME                URL                                                                    READY</span></span>
<span class="line"><span class="token comment"># node-service        http://node-service.serverless-workload.138.197.231.61.sslip.io        True</span></span>
<span class="line"><span class="token comment"># node-yaml-service   http://node-yaml-service.serverless-workload.138.197.231.61.sslip.io   True</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>kn route list</code> command lists all the Knative routes at a particular namespace in the Kubernetes cluster.</p><p>You will use the URLs generated for the Knative Routes to confirm that everything is working as expected.</p><p>Open either of the URLs in your browser. When you access the site in your browser, the landing page from your Node app will load:</p><figure><img src="https://deved-images.nyc3.digitaloceanspaces.com/CART-68820/PgxjNoW.png" alt="The Serverless workload" tabindex="0" loading="lazy"><figcaption>The Serverless workload</figcaption></figure><p>You have successfully deployed a serverless workload using Knative on your Kubernetes cluster.</p><hr><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2><p>In this tutorial, you deployed a serverless workload using Knative. You created a Knative <code>Service</code> resource using the <code>kn</code> CLI tool and via YAML files. This resource deployed a Node.js application on your Kubernetes cluster, which you accessed using the <code>Route</code> URL.</p><p>For more about the features that Knative offers, like <a href="https://knative.dev/docs/serving/autoscaling/" target="_blank" rel="noopener noreferrer">Autoscaling</a> of pods, <a href="https://knative.dev/docs/serving/rolling-out-latest-revision" target="_blank" rel="noopener noreferrer">gradual rollout</a> of traffic to revision, and the <a href="https://knative.dev/docs/eventing" target="_blank" rel="noopener noreferrer">Eventing</a> component, visit the official <a href="https://knative.dev/docs" target="_blank" rel="noopener noreferrer">Knative documentation</a>.</p><p>To continue building with DigitalOcean Kubernetes (DOKS), refer to our <a href="https://docs.digitalocean.com/products/kubernetes" target="_blank" rel="noopener noreferrer">Kubernetes How-To documentation</a>. You can also <a href="https://docs.digitalocean.com/products/kubernetes/details" target="_blank" rel="noopener noreferrer">learn more about DOKS</a>, such as <a href="https://docs.digitalocean.com/products/kubernetes/details/features" target="_blank" rel="noopener noreferrer">features</a> and <a href="https://docs.digitalocean.com/products/kubernetes/details/availability" target="_blank" rel="noopener noreferrer">availability</a>. For DOKS troubleshooting, you can refer to our <a href="https://docs.digitalocean.com/products/kubernetes/support" target="_blank" rel="noopener noreferrer">Kubernetes Support guides</a>.</p>`,29))])}const D=h(w,[["render",R]]),I=JSON.parse('{"path":"/digitalocean.com/how-to-run-serverless-workloads-with-knative-on-digitalocean-kubernetes.html","title":"How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes","description":"Article(s) > How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes","icon":"iconfont icon-k8s","category":["DevOps","VM","Kubernetes","Article(s)"],"tag":["blog","digitalocean.com","kubernetes","k8s","kubctl","kn","serverless"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes\\",\\"image\\":[\\"https://deved-images.nyc3.digitaloceanspaces.com/CART-68820/PgxjNoW.png\\"],\\"datePublished\\":\\"2022-12-16T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/digitalocean.com/how-to-run-serverless-workloads-with-knative-on-digitalocean-kubernetes.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes"}],["meta",{"property":"og:description","content":"Article(s) > How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg"}],["meta",{"name":"twitter:image:alt","content":"How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes"}],["meta",{"property":"article:tag","content":"serverless"}],["meta",{"property":"article:tag","content":"kn"}],["meta",{"property":"article:tag","content":"kubctl"}],["meta",{"property":"article:tag","content":"k8s"}],["meta",{"property":"article:tag","content":"kubernetes"}],["meta",{"property":"article:tag","content":"digitalocean.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2022-12-16T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes"},{"property":"og:description","content":"How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/digitalocean.com/how-to-run-serverless-workloads-with-knative-on-digitalocean-kubernetes.html"}]],"prev":"/devops/k8s/articles/README.md","date":"2022-12-16T00:00:00.000Z","isOriginal":false,"cover":"https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg"},"git":{},"readingTime":{"minutes":14.01,"words":4202},"filePathRelative":"digitalocean.com/how-to-run-serverless-workloads-with-knative-on-digitalocean-kubernetes.md"}');export{D as comp,I as data};
