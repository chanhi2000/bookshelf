import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as k,d as n,f as a,b as l,a as v,t as g,n as c,g as d,w as o,e as s,r,o as b}from"./app-BItykJLQ.js";const w={},f={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},y={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},q={class:"table-of-contents"},D={href:"http://blog.arungupta.me/docker-multi-host-networking-couchbase-wildfly/",target:"_blank",rel:"noopener noreferrer"},I={href:"https://medium.com/on-docker/docker-overlay-networks-that-was-easy-8f24baebb698",target:"_blank",rel:"noopener noreferrer"},x={href:"https://medium.com/@yoanis_gil/running-an-elasticsearch-cluster-on-docker-1-9-with-swarm-and-compose-efabe110c675#.nja48ka4t",target:"_blank",rel:"noopener noreferrer"},T={href:"https://github.com/docker/libnetwork/blob/master/docs/design.md",target:"_blank",rel:"noopener noreferrer"},P={href:"https://github.com/docker/go-plugins-helpers/network",target:"_blank",rel:"noopener noreferrer"},A={href:"https://github.com/docker/go-plugins-helpers/tree/master/ipam",target:"_blank",rel:"noopener noreferrer"},N={href:"https://github.com/contiv/netplugin",target:"_blank",rel:"noopener noreferrer"},S={href:"https://github.com/docker/libnetwork",target:"_blank",rel:"noopener noreferrer"},C={href:"https://docs.docker.com/compose/extends/",target:"_blank",rel:"noopener noreferrer"};function j(u,e){const p=r("VPCard"),i=r("router-link"),m=r("SiteInfo"),t=r("VPIcon");return b(),k("div",null,[n("h1",f,[n("a",y,[n("span",null,g(u.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),a(p,c(d({title:"Docker > Article(s)",desc:"Article(s)",link:"/devops/docker/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),n("nav",q,[n("ul",null,[n("li",null,[a(i,{to:"#users-first"},{default:o(()=>[...e[0]||(e[0]=[s("Users First",-1)])]),_:1})]),n("li",null,[a(i,{to:"#users-application-developers"},{default:o(()=>[...e[1]||(e[1]=[s("Users: Application developers",-1)])]),_:1})]),n("li",null,[a(i,{to:"#users-network-it"},{default:o(()=>[...e[2]||(e[2]=[s("Users: Network IT",-1)])]),_:1})]),n("li",null,[a(i,{to:"#docker-api-and-user-interaction"},{default:o(()=>[...e[3]||(e[3]=[s("Docker API and User Interaction",-1)])]),_:1})]),n("li",null,[a(i,{to:"#application-is-still-the-king"},{default:o(()=>[...e[4]||(e[4]=[s("Application is Still the King",-1)])]),_:1})])])]),e[47]||(e[47]=n("hr",null,null,-1)),a(m,{name:"Docker Networking Design PhilosophyDocker",desc:"Learn from Docker experts to simplify and advance your app development and management with Docker. Stay up to date on Docker events and new version",url:"https://docker.com/blog/docker-networking-design-philosophy",logo:"https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png",preview:"https://docker.com/app/uploads/docker_networking.png"}),e[48]||(e[48]=n("p",null,"From the experimental networking in Docker 1.7 to the initial release in Docker 1.9, the reception from the community has been fantastic! First of all we want to thank you for all the discussions, evaluations, PRs and filed issues. As the networking capabilitiesevolving with every release, we wanted to spend some time explaining the guiding principles behind the design.",-1)),e[49]||(e[49]=n("hr",null,null,-1)),e[50]||(e[50]=n("h2",{id:"users-first",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#users-first"},[n("span",null,"Users First")])],-1)),n("figure",null,[e[6]||(e[6]=n("a",{href:"https://docs.docker.com/engine/userguide/networking/dockernetworks/",target:"_blank",rel:"noopener noreferrer"},[n("img",{src:"https://docker.com/app/uploads/docker_networking-300x300.png",alt:'<VPIcon icon="fa-brands fa-docker"/>docker networking',tabindex:"0",loading:"lazy"})],-1)),n("figcaption",null,[a(t,{icon:"fa-brands fa-docker"}),e[5]||(e[5]=s("docker networking",-1))])]),e[51]||(e[51]=n("p",null,"Docker‚Äôs philosophy is to build tools that have a great user experience and seamless application portability across infrastructure. New features are always continuously refined and iterated upon so that the end product delivers the best possible user experience. Networking follows the same philosophy and we iterated several times to find the right abstractions for the user.",-1)),e[52]||(e[52]=n("p",null,"When it comes to networking, there are two kinds of users:",-1)),e[53]||(e[53]=n("ul",null,[n("li",null,"The application developer who wants to create and deploy a distributed application stack on the Docker platform"),n("li",null,"The network IT team who configures and manages the infrastructure")],-1)),n("p",null,[e[12]||(e[12]=s("We wanted to give the right kind of tools to both these kinds of users so that they are empowered to easily accomplish their goals and you can read about some of the experiences from the Docker community like ",-1)),n("a",D,[a(t,{icon:"fas fa-globe"}),e[7]||(e[7]=s("@arungupta",-1))]),e[13]||(e[13]=s(", ",-1)),n("a",I,[e[8]||(e[8]=s("@allingeek (",-1)),a(t,{icon:"fa-brands fa-medium"}),e[9]||(e[9]=n("code",null,"on-docker",-1)),e[10]||(e[10]=s(")",-1))]),e[14]||(e[14]=s(" and ",-1)),n("a",x,[a(t,{icon:"fa-brands fa-medium"}),e[11]||(e[11]=n("code",null,"@yoanis_gil",-1))]),e[15]||(e[15]=s(".",-1))]),e[54]||(e[54]=n("p",null,"Docker‚Äôs primary focus is on the user, whether they are from the application team or IT operations. That also means supporting ecosystem partners that support the same architecture goals of user experience AND seamless application portability. With that in mind, it is our belief that all APIs and UI must be exposed to end users and anything else would compromise on the core values. Anyone in the ecosystem claiming to support or include Docker must adhere to maintaining user experience and portability otherwise it simply isn‚Äôt Docker.",-1)),e[55]||(e[55]=n("hr",null,null,-1)),e[56]||(e[56]=n("h2",{id:"users-application-developers",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#users-application-developers"},[n("span",null,"Users: Application developers")])],-1)),e[57]||(e[57]=n("p",null,"As much as application developers want their applications to communicate with each other, most don‚Äôt want to understand or get involved in the details of how exactly that is achieved. In fact they don‚Äôt even want to know what IP addresses their applications are bound to. The application developer‚Äôs concern generally ends at the Layer4 service layer that their applications are bound to.",-1)),e[58]||(e[58]=n("p",null,"One of the guiding principles in the Docker Networking design is to relieve the application developer from worrying about the network plumbing details. Our belief is that by hiding the gory details of how network connectivity and service discovery is achieved behind a simple API and UI, we enable the application developers to develop their distributed application stack more freely. We should eliminate the connectivity/discoverability headaches and portability concerns that hinders an application developer from converting a monolithic application to a set of microservices. We want developers to be able to bind their microservices into a single distributed application using a few simple ‚Äúnetwork creation‚Äù and ‚Äúnetwork connection‚Äù commands.",-1)),e[59]||(e[59]=n("p",null,"The other guiding principle is to extend the same portable experience of Docker containers to networks. A Docker container created using an image works the same regardless of where it runs as long as the same image is used. Similarly, when the application developer defines their application stack as a set of distributed applications, it should work just the same whatever infrastructure it runs on. This heavily depends on what abstractions we expose to the application developer and more importantly what abstractions we do not expose to the application developer.",-1)),n("p",null,[e[19]||(e[19]=s("This is how the Docker ‚Äúnetwork‚Äù abstraction (",-1)),n("a",T,[e[16]||(e[16]=s("CNM (",-1)),a(t,{icon:"iconfont icon-github"}),e[17]||(e[17]=n("code",null,"docker/libnetwork",-1)),e[18]||(e[18]=s(")",-1))]),e[20]||(e[20]=s(") was born. It provides the right reference for the application developer to think and reason about the connectivity and discoverability needs of their application services without distracting them with all the complexities of how exactly this is achieved. In some ways, the ‚Äúnetwork‚Äù abstraction is declarative because the user is allowed to tell ‚Äúwhat‚Äù kind of topology the application needs instead of telling ‚Äúhow‚Äù to physically build that topology.",-1))]),n("figure",null,[e[24]||(e[24]=n("a",{href:"https://github.com/docker/libnetwork/blob/master/docs/design.md",target:"_blank",rel:"noopener noreferrer"},[n("img",{src:"https://raw.githubusercontent.com/docker/libnetwork/master/docs/cnm-model.jpg",alt:'cnm-model (<VPIcon icon="iconfont icon-github"/>)',tabindex:"0",loading:"lazy"})],-1)),n("figcaption",null,[e[21]||(e[21]=s("cnm-model (",-1)),a(t,{icon:"iconfont icon-github"}),e[22]||(e[22]=n("code",null,"docker/libnetwork",-1)),e[23]||(e[23]=s(")",-1))])]),e[60]||(e[60]=l('<p>For example, a classic three-tier web application stack is where the web server and the app server are in one network and then the same app server is connected to another network which also has the database server. The app developer should not have to bother with how that is implemented with the physical networks, firewalls, etc. Decoupling the infrastructure from the application significantly increases the portability of the distributed application. This also means developers have more freedom in how exactly the application topology is defined.</p><hr><h2 id="users-network-it" tabindex="-1"><a class="header-anchor" href="#users-network-it"><span>Users: Network IT</span></a></h2><p>While the application developer wants to be free of infrastructure details and wants a portable application deployment experience, the network IT team wants to make sure all applications deployed in the infrastructure run smoothly and complies with the application‚Äôs SLAs and business rules. This means the ability to change network configurations and even providers without disrupting the application‚Äôs functionality and intent. Agile means speed for developers and a different kind of speed for network IT, the kind where they are able to respond quickly to changing needs and make adjustments without breaking something else.</p><p>The ‚Äúhow‚Äù part of the equation is accomplished with a ‚Äúdriver‚Äù abstraction. Given a definition of an abstract network topology, how that topology is achieved in concrete terms depends on the driver that is used. By defining the Docker Networking plugin API that every driver can easily conform to, one can simply deploy the exact same application-driven network topology in any infrastructure by replacing one driver with another.</p><p>The plugin API provides a hook to the driver when:</p><ul><li>a network is created</li><li>a container is connected to a network</li><li>a container needs an IP address</li></ul><p>These are the most essential hooks to achieve network connectivity for any application network topology. Docker provides the same network connectivity guarantees to the application regardless of the driver used. At the same time, the network IT team is free to choose any driver which facilitates the application topologies in their infrastructure.</p><p>There are some special kinds of drivers called ‚Äúplugins‚Äù. All plugins are drivers. But plugins are not built into the Docker Engine binary. They are independent external programs (in most cases, they are docker containers themselves) that use the same driver API as the built-in drivers. So in essence one can swap out a built-in driver for an external plugin to achieve any network topology. This reflects Docker‚Äôs philosophy of ‚ÄúBatteries included but swappable‚Äù. Plugins are critical in supporting portability and choice for network IT.</p><p>When we first started thinking about enhancing Docker Networking it was clear that plugins should be a first class citizen. In any infrastructure the connectivity and discoverability needs of applications are wide and varied. There is no single solution for that problem that will satisfy every user and application. Therefore plugins have been an important part of Docker Networking design from the very beginning. We decided that when we release the first version of new Docker Networking the ability to ‚Äúswap the battery‚Äù was available to the users. In the end that is exactly how we released Docker Networking in Docker 1.9. ### Plugin API Design</p><p>While application network topology and network abstraction is more focused on the application developer, the driver/plugin configuration is focused on IT administrators. Network IT is more focused on the infrastructure and related service levels on which the application is going to be deployed. However, they do want to ensure that they can meet the application‚Äôs network connectivity intent.</p><p>They want to ensure that:</p><ul><li>the right solution to plumb the networking path is used</li><li>the right solution to manage networking resources is used</li><li>the right solution to discover application services is used</li><li>they can make separate and independent choices on all of the above</li></ul><p>Providing the flexibility to network IT to pick and choose various solutions for the various elements of network configuration gives the best operations experience.</p><p>Instead of providing one all-encompassing plugin API/extension-point, we segmented the plugin API into separate extension points corresponding to logical configuration groupings:</p>',15)),n("ul",null,[n("li",null,[e[28]||(e[28]=s("The ",-1)),n("a",P,[e[25]||(e[25]=s("network driver extension point (",-1)),a(t,{icon:"iconfont icon-github"}),e[26]||(e[26]=n("code",null,"docker/go-plugins-helpers",-1)),e[27]||(e[27]=s(")",-1))]),e[29]||(e[29]=s(" provides the API needed to configure and achieve network connectivity",-1))]),n("li",null,[e[33]||(e[33]=s("The ",-1)),n("a",A,[e[30]||(e[30]=s("IPAM extension point (",-1)),a(t,{icon:"iconfont icon-github"}),e[31]||(e[31]=n("code",null,"docker/go-plugins-helpers",-1)),e[32]||(e[32]=s(")",-1))]),e[34]||(e[34]=s(" to configure, discover and manage IP address ranges",-1))])]),e[61]||(e[61]=n("p",null,"The design gets its inspiration from the golang interface philosophy, which advocates defining one ‚Äúinterface‚Äù per function to encourage composability. This is a powerful facility for network IT to compose different solutions for different needs.",-1)),e[62]||(e[62]=n("p",null,"Another aspect of the plugin API design is to make sure that Docker Networking remains the broker to resolve conflicts that can arise when a container joins multiple networks backed by different plugins. For example two different drivers may want to plumb a static route with the same route prefix but with a different next hop IP. When this happens it is simply not possible for these drivers to independently choose whose route wins without sacrificing the user experience. Therefore, as part of the plugin API libnetwork doesn‚Äôt provide driver‚Äôs access to the container‚Äôs network namespace since there is no way a particular driver will be able to resolve these conflicts by itself. This is true for built-in drivers and plugins. Other plugin frameworks like CNI provide namespace access to its drivers and hence they may have to deal with these drivers stomping over each other inside the container namespace. When that happens user experience and portability suffers.",-1)),n("p",null,[e[37]||(e[37]=s("Another reason for this plugin design is to provide granular network plugability at various layers (such as IP Address management, Service Discovery, Load Balancing, etc‚Ä¶) which lets the user choose the best driver to satisfy a feature instead of depending on an all-encompassing and opinionated network plugin. For example, a scenario where a network operator might want to use a specific IPAM solution (such as ",-1)),e[38]||(e[38]=n("a",{href:"https://hub.docker.com/r/infoblox/ipam-driver/",target:"_blank",rel:"noopener noreferrer"},"Infoblox",-1)),e[39]||(e[39]=s(") in combination with a different network plugin (such as Cisco‚Äôs ",-1)),n("a",N,[a(t,{icon:"iconfont icon-github"}),e[35]||(e[35]=n("code",null,"contiv/netplugin",-1))]),e[40]||(e[40]=s("). Because ",-1)),n("a",S,[a(t,{icon:"iconfont icon-github"}),e[36]||(e[36]=n("code",null,"docker/libnetwork",-1))]),e[41]||(e[41]=s(" manages the container‚Äôs network namespace, we could implement the necessary Docker UX and guarantee such combinations of different plugins. Thus providing the necessary guarantees to the network operator to take control over the network design.",-1))]),e[63]||(e[63]=l(`<hr><h2 id="docker-api-and-user-interaction" tabindex="-1"><a class="header-anchor" href="#docker-api-and-user-interaction"><span>Docker API and User Interaction</span></a></h2><p>Docker Networking allows for separation of concerns for two different users and it was only natural to design two distinct commands in Docker UI. The UI and API are designed in a way that network IT can configure the infrastructure with as little coordination with the application developers as possible. It avoids the lock-stepped workflow between the application developers and Network IT team.</p><p>For example, if the application developer requests that network IT just create networks with certain names, then the network IT can go independently and start creating those networks applying configuration options that are appropriate for the given infrastructure. At the same time, the application developer can work on composing the application assuming that those networks with the referenced names will be available to achieve the network topology that the application needs.</p><p>With that in mind the branch in UI and API roughly looks as follows:</p><ul><li>Network IT can create, administer and precisely control which network driver and IPAM driver combination is used for the network. They can also specify various network specific configurations like subnets, gateway, IP ranges etc. and also pass on driver specific configuration, if any.</li><li>A configuration is to connect any container to the created network. This one has application developer focus since their concern is mainly one of connectivity and discoverability.</li></ul><p>A typical way an application developer can compose the application is using a ‚ÄúDocker Compose‚Äù file where one can specify all the application services which are part of the application and how they connect to each other in an application defined topology referencing networks which may be pre-provisioned by the network IT.</p><p>In fact, the developer builds an application using Docker Compose file which inherently defines the application topology. The exact same compose file can now be used to deploy the application in any infrastructure and the network IT team could pre-provision the network (that is referenced in the Compose file) based on the infrastructure requirements. The key aspect of it is that the application developer does not need to revisit the Compose file every time it is deployed to a different environment.</p><p>This separation of concern enables a workflow where developers and network IT can work independently in provisioning networks and deploying applications, using different plugins if needed.</p><p>As an example, let‚Äôs consider the following Compose v2 application:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="docker-compose.yml"><span>docker-compose.yml</span></div><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;2&quot;</span></span>
<span class="line">  <span class="token key atrule">services</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">voting-app</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> docker/example<span class="token punctuation">-</span>voting<span class="token punctuation">-</span>app<span class="token punctuation">-</span>voting<span class="token punctuation">-</span>app</span>
<span class="line">      <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token string">&quot;80&quot;</span></span>
<span class="line">      <span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> votenet</span>
<span class="line">    <span class="token key atrule">result-app</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> docker/example<span class="token punctuation">-</span>voting<span class="token punctuation">-</span>app<span class="token punctuation">-</span>result<span class="token punctuation">-</span>app</span>
<span class="line">      <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token string">&quot;80&quot;</span></span>
<span class="line">      <span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> votenet</span>
<span class="line">    <span class="token key atrule">worker</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> docker/example<span class="token punctuation">-</span>voting<span class="token punctuation">-</span>app<span class="token punctuation">-</span>worker</span>
<span class="line">      <span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> votenet</span>
<span class="line">    <span class="token key atrule">redis</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> redis</span>
<span class="line">      <span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> votenet</span>
<span class="line">    <span class="token key atrule">db</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres<span class="token punctuation">:</span><span class="token number">9.4</span></span>
<span class="line">      <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token string">&quot;db-data:/var/lib/postgresql/data&quot;</span></span>
<span class="line">      <span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> votenet</span>
<span class="line"></span>
<span class="line"><span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">db-data</span><span class="token punctuation">:</span></span>
<span class="line"><span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">votenet</span><span class="token punctuation">:</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>By default, compose v2 will create a docker network for this application using the default driver. When run against docker-engine, the default driver is the bridge driver. Hence, when the application is launched, we can see that the network is created using the ‚Äúdefault driver‚Äù.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># Creating network &quot;voteapp_votenet&quot; with the default driver</span></span>
<span class="line"><span class="token comment"># Starting db</span></span>
<span class="line"><span class="token comment"># Starting redis</span></span>
<span class="line"><span class="token comment"># Starting voteapp_worker_1</span></span>
<span class="line"><span class="token comment"># Starting voteapp_voting-app_1</span></span>
<span class="line"><span class="token comment"># Starting voteapp_result-app_1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The application works just fine in a single-host and the application dev can get the work done without having to deal with any network specific configurations.</p><p>Looking into the details,</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker</span> network inspect - voteapp_votenet</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># [</span></span>
<span class="line"><span class="token comment">#   {</span></span>
<span class="line"><span class="token comment">#     &quot;Name&quot;: &quot;- voteapp_votenet&quot;,</span></span>
<span class="line"><span class="token comment">#     &quot;Id&quot;: &quot;7be1879036b217c072c824157e82403081ec60edfc4f34599674444ba01f0c57&quot;,</span></span>
<span class="line"><span class="token comment">#     &quot;Scope&quot;: &quot;local&quot;,</span></span>
<span class="line"><span class="token comment">#     &quot;Driver&quot;: &quot;bridge&quot;,</span></span>
<span class="line"><span class="token comment">#     &quot;IPAM&quot;: {</span></span>
<span class="line"><span class="token comment">#       &quot;Driver&quot;: &quot;default&quot;,</span></span>
<span class="line"><span class="token comment">#       &quot;Options&quot;: null,</span></span>
<span class="line"><span class="token comment">#       &quot;Config&quot;: [</span></span>
<span class="line"><span class="token comment">#         {</span></span>
<span class="line"><span class="token comment">#           &quot;Subnet&quot;: &quot;172.19.0.0/16&quot;,</span></span>
<span class="line"><span class="token comment">#           &quot;Gateway&quot;: &quot;172.19.0.1/16&quot;</span></span>
<span class="line"><span class="token comment">#         }</span></span>
<span class="line"><span class="token comment">#       ]</span></span>
<span class="line"><span class="token comment">#     },</span></span>
<span class="line"><span class="token comment">#     ...</span></span>
<span class="line"><span class="token comment">#     ...</span></span>
<span class="line"><span class="token comment">#     ...</span></span>
<span class="line"><span class="token comment">#   }</span></span>
<span class="line"><span class="token comment"># ]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Lets bring down the application.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker-compose</span> down</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now, Let us assume that the application is handed over to the operations team to be deployed in staging. Network IT manages the networks by either pre-provisioning the networks ahead of time using the <code>docker network</code> commands. For example:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker</span> network create <span class="token parameter variable">-d</span> overlay <span class="token punctuation">\\</span></span>
<span class="line"><span class="token parameter variable">--subnet</span><span class="token operator">=</span><span class="token number">70.28</span>.0.0/16 <span class="token punctuation">\\</span></span>
<span class="line"><span class="token parameter variable">--gateway</span><span class="token operator">=</span><span class="token number">70.28</span>.5.254 voteapp_votenet</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># 6d215748f300a0eda3878e76fe99e717c8ef85a87de0779e379c92af5d615b88</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,20)),n("p",null,[e[43]||(e[43]=s("Alternatively, network IT can take control over the network configurations of the above docker-compose application using the extension feature (",-1)),n("a",C,[a(t,{icon:"fa-brands fa-docker"}),e[42]||(e[42]=s("Read more about this compose functionality",-1))]),e[44]||(e[44]=s(") by adding another compose file:",-1)),e[45]||(e[45]=n("br",null,null,-1)),e[46]||(e[46]=s(" ‚Äúdocker-compose.override.yml‚Äù without having to change anything on the application.",-1))]),e[64]||(e[64]=l(`<div class="code-block-with-title"><div class="code-block-title-bar" data-title="docker-compose.override.yml"><span>docker-compose.override.yml</span></div><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">version</span> <span class="token punctuation">:</span> <span class="token string">&quot;2&quot;</span></span>
<span class="line">  <span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">votenet</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">driver</span><span class="token punctuation">:</span> overlay</span>
<span class="line">      <span class="token key atrule">ipam</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">config</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">subnet</span><span class="token punctuation">:</span> 70.28.0.0/16</span>
<span class="line">        <span class="token key atrule">gateway</span><span class="token punctuation">:</span> 70.28.5.254</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>In this example, the network driver used in staging is ‚Äúoverlay‚Äù, which provides multi-host network connectivity and the network IT team can use preferred IPAM settings for this network.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># Creating network &quot;- voteapp_votenet&quot; with driver &quot;overlay&quot;</span></span>
<span class="line"><span class="token comment"># Starting voteapp_worker_1</span></span>
<span class="line"><span class="token comment"># Starting redis</span></span>
<span class="line"><span class="token comment"># Starting db</span></span>
<span class="line"><span class="token comment"># Starting voteapp_voting-app_1</span></span>
<span class="line"><span class="token comment"># Starting voteapp_result-app_1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When the same application is run, this time, the network created is with a different driver named ‚Äúoverlay‚Äù, which provides multi-host network connectivity. Now when we dig deeper into the network using the ‚Äúdocker network inspect‚Äù command, we can also see the configured IPAM being used to configure the network and all the containers in this network will have ip-address in this subnet.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker</span> network inspect - voteapp_votenet</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># [</span></span>
<span class="line"><span class="token comment">#   {</span></span>
<span class="line"><span class="token comment">#     &quot;Name&quot;: &quot;- voteapp_votenet&quot;,</span></span>
<span class="line"><span class="token comment">#     &quot;Id&quot;: &quot;b510c0affb2289548a07af7cc7e3f778987fc43812ac0603c5d01b7acf6c12be&quot;,</span></span>
<span class="line"><span class="token comment">#     &quot;Scope&quot;: &quot;global&quot;,</span></span>
<span class="line"><span class="token comment">#     &quot;Driver&quot;: &quot;overlay&quot;,</span></span>
<span class="line"><span class="token comment">#     &quot;IPAM&quot;: {</span></span>
<span class="line"><span class="token comment">#       &quot;Driver&quot;: &quot;default&quot;,</span></span>
<span class="line"><span class="token comment">#       &quot;Options&quot;: null,</span></span>
<span class="line"><span class="token comment">#       &quot;Config&quot;: [</span></span>
<span class="line"><span class="token comment">#         {</span></span>
<span class="line"><span class="token comment">#           &quot;Subnet&quot;: &quot;70.28.0.0/16&quot;,</span></span>
<span class="line"><span class="token comment">#           &quot;Gateway&quot;: &quot;70.28.5.254&quot;</span></span>
<span class="line"><span class="token comment">#         }</span></span>
<span class="line"><span class="token comment">#       ]</span></span>
<span class="line"><span class="token comment">#     },</span></span>
<span class="line"><span class="token comment">#   ...</span></span>
<span class="line"><span class="token comment">#   ...</span></span>
<span class="line"><span class="token comment">#   ...</span></span>
<span class="line"><span class="token comment">#   }</span></span>
<span class="line"><span class="token comment"># ]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When this Compose application is running on Docker Swarm, the containers are scheduled across the hosts, while the overlay driver provides seamless connectivity between the containers. All of this is made possible by the Docker Networking design principles explained in this blog post.</p><hr><h2 id="application-is-still-the-king" tabindex="-1"><a class="header-anchor" href="#application-is-still-the-king"><span>Application is Still the King</span></a></h2><p>If we did not mention before, with all operations focused configuration knobs, application still remains the king. So, as stated in the beginning we wanted to hide as many networking artifacts as possible, one last thing that needed hiding is the IP addresses themselves. IP addresses expose something about the underlying infrastructure and this reduces the portability experience for the application. If applications can discover each other using names that they know at compile time, then it completes the portability story. This is exactly what we achieved by providing implicit container discovery using embedded DNS server. The container ‚Äúlinking‚Äù and ‚Äúaliasing‚Äù capabilities, ensures that containers can discover their peer containers with the name they knew at the compile time.</p><hr>`,10)),v(" TODO: add ARTICLE CARD "),a(p,c(d({title:"Docker Networking Design PhilosophyDocker",desc:"Learn from Docker experts to simplify and advance your app development and management with Docker. Stay up to date on Docker events and new version",link:"https://chanhi2000.github.io/bookshelf/docker.com/docker-networking-design-philosophy.html",logo:"https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png",background:"rgba(29,99,237,0.2)"})),null,16)])}const R=h(w,[["render",j]]),M=JSON.parse('{"path":"/docker.com/docker-networking-design-philosophy.html","title":"Docker Networking Design PhilosophyDocker","lang":"en-US","frontmatter":{"lang":"en-US","title":"Docker Networking Design PhilosophyDocker","description":"Article(s) > Docker Networking Design PhilosophyDocker","icon":"fa-brands fa-docker","category":["DevOps","Docker","Article(s)"],"tag":["blog","docker.com","devops","docker"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Docker Networking Design PhilosophyDocker\\",\\"image\\":[\\"https://docker.com/app/uploads/docker_networking-300x300.png\\",\\"https://raw.githubusercontent.com/docker/libnetwork/master/docs/cnm-model.jpg\\"],\\"datePublished\\":\\"2016-03-02T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jana Radhakrishnan\\",\\"url\\":\\"https://docker.com/author/jana/\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/docker.com/docker-networking-design-philosophy.html"}],["meta",{"property":"og:site_name","content":"üìöBookshelf"}],["meta",{"property":"og:title","content":"Docker Networking Design PhilosophyDocker"}],["meta",{"property":"og:description","content":"Article(s) > Docker Networking Design PhilosophyDocker"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://docker.com/app/uploads/docker_networking.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://docker.com/app/uploads/docker_networking.png"}],["meta",{"name":"twitter:image:alt","content":"Docker Networking Design PhilosophyDocker"}],["meta",{"property":"article:author","content":"Jana Radhakrishnan"}],["meta",{"property":"article:tag","content":"docker"}],["meta",{"property":"article:tag","content":"devops"}],["meta",{"property":"article:tag","content":"docker.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2016-03-02T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Docker Networking Design PhilosophyDocker"},{"property":"og:description","content":"Docker Networking Design PhilosophyDocker"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/docker.com/docker-networking-design-philosophy.html"}]],"prev":"/devops/docker/articles/README.md","date":"2016-03-02T00:00:00.000Z","isOriginal":false,"author":[{"name":"Jana Radhakrishnan","url":"https://docker.com/author/jana/"}],"cover":"https://docker.com/app/uploads/docker_networking.png"},"git":{},"readingTime":{"minutes":10.05,"words":3016},"filePathRelative":"docker.com/docker-networking-design-philosophy.md","copyright":{"author":"Jana Radhakrishnan"}}');export{R as comp,M as data};
