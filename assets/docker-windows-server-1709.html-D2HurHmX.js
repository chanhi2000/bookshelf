import{_ as k}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as g,d as n,f as a,b as c,a as h,t as w,n as l,g as d,w as t,e as s,r as p,o as v}from"./app-BItykJLQ.js";const b={},f={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},y={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},D={class:"table-of-contents"},x={href:"https://docs.docker.com/engine/swarm/services/#publish-ports",target:"_blank",rel:"noopener noreferrer"},W={href:"https://docs.docker.com/engine/swarm/ingress/",target:"_blank",rel:"noopener noreferrer"},S={href:"https://docs.docker.com/engine/swarm/networking/#configure-service-discovery",target:"_blank",rel:"noopener noreferrer"},E={href:"https://blogs.technet.microsoft.com/virtualization/2017/09/26/dockers-ingress-routing-mesh-available-with-windows-server-version-1709/",target:"_blank",rel:"noopener noreferrer"},P={href:"https://docker.com/enterprise-edition",target:"_blank",rel:"noopener noreferrer"},q={href:"https://github.com/jenkinsci/docker/pull/582",target:"_blank",rel:"noopener noreferrer"};function A(u,e){const r=p("VPCard"),i=p("router-link"),m=p("SiteInfo"),o=p("VPIcon");return v(),g("div",null,[n("h1",f,[n("a",y,[n("span",null,w(u.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),a(r,l(d({title:"Docker > Article(s)",desc:"Article(s)",link:"/devops/docker/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),a(r,l(d({title:"Windows > Article(s)",desc:"Article(s)",link:"/devops/win/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),a(r,l(d({title:"Powershell > Article(s)",desc:"Article(s)",link:"/programming/pwsh/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),n("nav",D,[n("ul",null,[n("li",null,[a(i,{to:"#docker-enterprise-edition-preview"},{default:t(()=>[...e[0]||(e[0]=[s("Docker Enterprise Edition Preview",-1)])]),_:1})]),n("li",null,[a(i,{to:"#docker-ingress-mode-service-publishing-on-windows"},{default:t(()=>[...e[1]||(e[1]=[s("Docker ingress mode service publishing on Windows",-1)])]),_:1})]),n("li",null,[a(i,{to:"#named-pipes-in-windows-containers"},{default:t(()=>[...e[2]||(e[2]=[s("Named pipes in Windows containers",-1)])]),_:1})]),n("li",null,[a(i,{to:"#smaller-windows-base-images"},{default:t(()=>[...e[3]||(e[3]=[s("Smaller Windows base images",-1)])]),_:1})]),n("li",null,[a(i,{to:"#summary"},{default:t(()=>[...e[4]||(e[4]=[s("Summary",-1)])]),_:1})])])]),e[27]||(e[27]=n("hr",null,null,-1)),a(m,{name:"Exciting new things for Docker with Windows Server 1709",desc:"Learn from Docker experts to simplify and advance your app development and management with Docker. Stay up to date on Docker events and new version",url:"https://docker.com/blog/docker-windows-server-1709",logo:"https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png",preview:"https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png"}),e[28]||(e[28]=c(`<p>What a difference a year makes‚Ä¶ last September, Microsoft and Docker launched Docker Enterprise Edition (EE), a Containers-as-a-Service platform for IT that manages and secures diverse applications across disparate infrastructures, for Windows Server 2016. Since then we‚Äôve continued to work together and Windows Server 1709 contains several enhancements for Docker customers.</p><hr><h2 id="docker-enterprise-edition-preview" tabindex="-1"><a class="header-anchor" href="#docker-enterprise-edition-preview"><span>Docker Enterprise Edition Preview</span></a></h2><p>To experiment with the new Docker and Windows features, a preview build of Docker is required. Here‚Äôs how to install it on Windows Server 1709 (this will also work on Insider builds):</p><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code class="language-powershell"><span class="line"><span class="token function">Install-Module</span> DockerProvider</span>
<span class="line">    <span class="token function">Install-Package</span> Docker <span class="token operator">-</span>ProviderName DockerProvider <span class="token operator">-</span>RequiredVersion preview</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>To run Docker Windows containers in production on any Windows Server version, please stick to Docker EE 17.06. ### Docker Linux Containers on Windows</p><p>A key focus of Windows Server version 1709 is support for Linux containers on Windows. We‚Äôve already blogged about how we‚Äôre supporting Linux containers on Windows with the LinuxKit project.</p><p>To try Linux Containers on Windows Server 1709, install the preview Docker package and enable the feature. The preview Docker EE package includes a full LinuxKit system (all 13MB of it) for use when running Docker Linux containers.</p><div class="language-pwsh line-numbers-mode" data-highlighter="prismjs" data-ext="pwsh"><pre><code class="language-pwsh"><span class="line">[Environment]::SetEnvironmentVariable(&quot;LCOW_SUPPORTED&quot;, &quot;1&quot;, &quot;Machine&quot;)</span>
<span class="line">    Restart-Service Docker</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>To disable, just remove the environment variable:</p><div class="language-pwsh line-numbers-mode" data-highlighter="prismjs" data-ext="pwsh"><pre><code class="language-pwsh"><span class="line">[Environment]::SetEnvironmentVariable(&quot;LCOW_SUPPORTED&quot;, $null, &quot;Machine&quot;)</span>
<span class="line">    Restart-Service Docker</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Docker Linux containers on Windows is in preview, with ongoing joint development by Microsoft and Docker. Linux Containers is also available on Windows 10 version 1709 (‚ÄúCreators Update 2‚Äù).</p><hr><h2 id="docker-ingress-mode-service-publishing-on-windows" tabindex="-1"><a class="header-anchor" href="#docker-ingress-mode-service-publishing-on-windows"><span>Docker ingress mode service publishing on Windows</span></a></h2>`,14)),n("p",null,[e[7]||(e[7]=s("Parity with Linux service publishing options has been highly requested by Windows customers. Adding support for ",-1)),a(o,{icon:"fa-brands fa-docker"}),n("a",x,[a(o,{icon:"fa-brands fa-docker"}),e[5]||(e[5]=s("service publishing using ingress mode",-1))]),e[8]||(e[8]=s(" in Windows Server 1709 enables use of Docker‚Äôs ",-1)),n("a",W,[a(o,{icon:"fa-brands fa-docker"}),e[6]||(e[6]=s("routing mesh",-1))]),e[9]||(e[9]=s(", allowing external endpoints to access a service via any node in the swarm regardless of which nodes are running tasks for the service.",-1))]),n("p",null,[e[11]||(e[11]=s("These networking improvements also unlock ",-1)),n("a",S,[a(o,{icon:"fa-brands fa-docker"}),e[10]||(e[10]=s("VIP-based service discovery when using overlay networks",-1))]),e[12]||(e[12]=s(" so that Windows users are not limited to DNS Round Robin.",-1))]),n("p",null,[e[14]||(e[14]=s("Check out the corresponding post on the Microsoft Virtualization blog for ",-1)),n("a",E,[a(o,{icon:"fa-brands fa-windows"}),e[13]||(e[13]=s("details on the improvements",-1))]),e[15]||(e[15]=s(".",-1))]),e[29]||(e[29]=n("hr",null,null,-1)),e[30]||(e[30]=n("h2",{id:"named-pipes-in-windows-containers",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#named-pipes-in-windows-containers"},[n("span",null,"Named pipes in Windows containers")])],-1)),n("p",null,[e[17]||(e[17]=s("A common and powerful Docker pattern is to run Docker containers that use the Docker API of the host that the container is running on, for example to start more Docker containers or to visualize the containers, networks and volumes on the Docker host. This pattern lets you ship, in a container, software that manages or visualizes what‚Äôs going on with Docker. This is great for building software like ",-1)),n("a",P,[a(o,{icon:"fa-brands fa-docker"}),e[16]||(e[16]=s("Docker Universal Control Plane",-1))]),e[18]||(e[18]=s(".",-1))]),e[31]||(e[31]=n("p",null,"Running Docker on Linux, the Docker API is usually hosted on Unix domain socket, and since these are in the filesystem namespace, sockets can be bind-mounted easily into containers. On Windows, the Docker API is available on a named pipe. Previously, named pipes where not bind-mountable into Docker Windows containers, but starting with Windows 10 and Windows Server 1709, named pipes can now bind-mounted.",-1)),e[32]||(e[32]=n("p",null,"Jenkins CI is a neat way to demonstrate this. With Docker and Windows Server 1709, you can now:",-1)),e[33]||(e[33]=n("ol",null,[n("li",null,"Run Jenkins in a Docker Windows containers (no more hand-installing and maintaining Java, Git and Jenkins on CI machines)"),n("li",null,[s("Have that Jenkins container build Docker images and run Docker CI/CD jobs "),n("em",null,"on the same host")])],-1)),n("p",null,[e[22]||(e[22]=s("I‚Äôve built a ",-1)),n("a",q,[e[19]||(e[19]=s("Jenkins sample image (",-1)),a(o,{icon:"iconfont icon-github"}),e[20]||(e[20]=n("code",null,"jenkinsci/docker",-1)),e[21]||(e[21]=s(")",-1))]),e[23]||(e[23]=s(" (Windows Server 1709 required) that uses the new named-pipe mounting feature. To run it, simple start a container, grab the initial password and visit port 8080. You don‚Äôt have to setup any Jenkins plugins or extra users:",-1))]),e[34]||(e[34]=c(`<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080 <span class="token parameter variable">-v</span> <span class="token punctuation">\\</span>.<span class="token punctuation">\\</span>pipe<span class="token punctuation">\\</span>docker_engine:<span class="token punctuation">\\</span>.<span class="token punctuation">\\</span>pipe<span class="token punctuation">\\</span>docker_engine friism/jenkins</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># 3c90fdf4ff3f5b371de451862e02f2b7e16be4311903649b3fc8ec9e566774ed</span></span>
<span class="line"><span class="token function">docker</span> <span class="token builtin class-name">exec</span> 3c cmd /c <span class="token builtin class-name">type</span> c:.jenkins<span class="token punctuation">\\</span>secrets<span class="token punctuation">\\</span>initialAdminPassword</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># &lt;PASSWORD&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now create a simple freestyle project and use the ‚ÄúWindows Batch Command‚Äù build step. We‚Äôll build my fork of the Jenkins Docker project itself:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">git</span> clone <span class="token parameter variable">--depth</span> <span class="token number">1</span> --single-branch <span class="token parameter variable">--branch</span> add-windows-dockerfile https://github.com/friism/docker-3 %BUILD_NUMBER%</span>
<span class="line"><span class="token builtin class-name">cd</span> %BUILD_NUMBER%</span>
<span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-f</span> Dockerfile-windows <span class="token parameter variable">-t</span> jenkins-%BUILD_NUMBER% <span class="token builtin class-name">.</span></span>
<span class="line"><span class="token builtin class-name">cd</span> <span class="token punctuation">..</span></span>
<span class="line">rd /s /q %BUILD_NUMBER%</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Hit ‚ÄúBuild Now‚Äù and see Jenkins (running in a container) start to build a CI job to build a container image on the very host it‚Äôs running on!</p><hr><h2 id="smaller-windows-base-images" tabindex="-1"><a class="header-anchor" href="#smaller-windows-base-images"><span>Smaller Windows base images</span></a></h2><p>When Docker and Microsoft launched Windows containers last year, some people noticed that Windows container base images are not as small as typical Linux ones. Microsoft has worked very hard to winnow down the base images, and with 1709, the Nanoserver download is now about 70MB (200MB expanded on the filesystem).</p>`,7)),n("p",null,[e[24]||(e[24]=s("One of the things that‚Äôs gone from the Nanoserver Docker image is PowerShell. This can present some challenges when authoring Dockerfiles, but ",-1)),a(o,{icon:"fa-brands fa-docekr"}),e[25]||(e[25]=n("a",{href:"https://docs.docker.com/engine/userguide/eng-image/multistage-build/",target:"_blank",rel:"noopener noreferrer"},"multi-stage builds",-1)),e[26]||(e[26]=s(" make it fairly easy to do all the build and component assembly in a Windows Server Core image, and then move just the results into a nanoserver image. Here‚Äôs an example showing how to build a minimal Docker image containing just the Docker CLI:",-1))]),e[35]||(e[35]=c(`<div class="code-block-with-title"><div class="code-block-title-bar" data-title="Dockerfile"><span>Dockerfile</span></div><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code class="language-docker"><span class="line"><span class="token instruction"><span class="token keyword">FROM</span> microsoft/windowsservercore <span class="token keyword">as</span> builder</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">SHELL</span> [<span class="token string">&quot;powershell&quot;</span>, <span class="token string">&quot;-Command&quot;</span>, <span class="token string">&quot;$ErrorActionPreference = &#39;Stop&#39;; $ProgressPreference = &#39;SilentlyContinue&#39;;&quot;</span>]</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> Invoke-WebRequest -Uri https://download.docker.com/win/static/test/x86_64/docker-17.09.0-ce-rc1.zip -OutFile <span class="token string">&#39;docker.zip&#39;</span></span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> Expand-Archive -Path docker.zip -DestinationPath .</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">FROM</span> microsoft/nanoserver</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> [<span class="token string">&quot;docker\\\\docker.exe&quot;</span>, <span class="token string">&quot;C:\\\\Program Files\\\\docker\\\\docker.exe&quot;</span>]</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> setx PATH <span class="token string">&quot;%PATH%;C:\\Program Files\\docker&quot;</span></span></span>
<span class="line"><span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;docker&quot;</span>]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>You now get the best of both worlds: Easy-to-use, full-featured build environment and ultra-small and minimal runtime images that deploy and start quickly, and have minimal exploit surface area. Another good example of this pattern in action are the .NET Core base images maintained by the Microsoft .NET team.</p><hr><h2 id="summary" tabindex="-1"><a class="header-anchor" href="#summary"><span>Summary</span></a></h2><p>It‚Äôs hard to believe that Docker Windows containers GA‚Äôd on Windows Server 2016 and Windows 10 just one year ago. In those 12 months, we‚Äôve seen lots of adoption by the Docker community and lots of uptake with customers and partners. The latest release only adds more functionality to smooth the user experience and brings Windows overlay networking up to par with Linux, with smaller container images and with support for bind-mounting named pipes into containers.</p>`,5)),h(" TODO: add ARTICLE CARD "),a(r,l(d({title:"Exciting new things for Docker with Windows Server 1709",desc:"Learn from Docker experts to simplify and advance your app development and management with Docker. Stay up to date on Docker events and new version",link:"https://chanhi2000.github.io/bookshelf/docker.com/docker-windows-server-1709.html",logo:"https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png",background:"rgba(29,99,237,0.2)"})),null,16)])}const I=k(b,[["render",A]]),M=JSON.parse('{"path":"/docker.com/docker-windows-server-1709.html","title":"Exciting new things for Docker with Windows Server 1709","lang":"en-US","frontmatter":{"lang":"en-US","title":"Exciting new things for Docker with Windows Server 1709","description":"Article(s) > Exciting new things for Docker with Windows Server 1709","icon":"fa-brands fa-docker","category":["DevOps","Docker","Windows","Powershell","Article(s)"],"tag":["blog","docker.com","devops","docker","windows","powershell"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Exciting new things for Docker with Windows Server 1709\\",\\"image\\":[\\"https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png\\"],\\"datePublished\\":\\"2017-09-26T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Michael Friis\\",\\"url\\":\\"https://docker.com/author/friism/\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/docker.com/docker-windows-server-1709.html"}],["meta",{"property":"og:site_name","content":"üìöBookshelf"}],["meta",{"property":"og:title","content":"Exciting new things for Docker with Windows Server 1709"}],["meta",{"property":"og:description","content":"Article(s) > Exciting new things for Docker with Windows Server 1709"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png"}],["meta",{"name":"twitter:image:alt","content":"Exciting new things for Docker with Windows Server 1709"}],["meta",{"property":"article:author","content":"Michael Friis"}],["meta",{"property":"article:tag","content":"powershell"}],["meta",{"property":"article:tag","content":"windows"}],["meta",{"property":"article:tag","content":"docker"}],["meta",{"property":"article:tag","content":"devops"}],["meta",{"property":"article:tag","content":"docker.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2017-09-26T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Exciting new things for Docker with Windows Server 1709"},{"property":"og:description","content":"Exciting new things for Docker with Windows Server 1709"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/docker.com/docker-windows-server-1709.html"}]],"prev":"/devops/docker/articles/README.md","date":"2017-09-26T00:00:00.000Z","isOriginal":false,"author":[{"name":"Michael Friis","url":"https://docker.com/author/friism/"}],"cover":"https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png"},"git":{},"readingTime":{"minutes":4.68,"words":1403},"filePathRelative":"docker.com/docker-windows-server-1709.md","copyright":{"author":"Michael Friis"}}');export{I as comp,M as data};
