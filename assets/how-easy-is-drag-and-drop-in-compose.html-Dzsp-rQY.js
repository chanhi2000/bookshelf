import{_ as k}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as v,d as s,f as a,b as m,a as b,t as h,n as u,g as r,w as p,e,r as o,o as g}from"./app-BItykJLQ.js";const f={},w={id:"frontmatter-title-관련",tabindex:"-1"},y={class:"header-anchor",href:"#frontmatter-title-관련"},D={class:"table-of-contents"},T={href:"https://github.com/MustafaKhaled/DragAndDropBoard",target:"_blank",rel:"noopener noreferrer"},x={class:"hint-container info"},C={href:"https://proandroiddev.com/how-easy-is-drag-and-drop-in-compose-e66d47ae8e5f",target:"_blank",rel:"noopener noreferrer"};function S(d,n){const i=o("VPCard"),t=o("router-link"),l=o("SiteInfo"),c=o("VPIcon");return g(),v("div",null,[s("h1",w,[s("a",y,[s("span",null,h(d.$frontmatter.title)+" 관련",1)])]),a(i,u(r({title:"Android > Article(s)",desc:"Article(s)",link:"/programming/java-android/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",D,[s("ul",null,[s("li",null,[a(t,{to:"#build-the-jetpack-compose-ui"},{default:p(()=>[...n[0]||(n[0]=[e("Build the Jetpack Compose UI",-1)])]),_:1})]),s("li",null,[a(t,{to:"#enable-drag-feature-for-ticketcard"},{default:p(()=>[...n[1]||(n[1]=[e("Enable drag feature for TicketCard",-1)])]),_:1})]),s("li",null,[a(t,{to:"#enable-the-drop-feature-for-the-column"},{default:p(()=>[...n[2]||(n[2]=[e("Enable the Drop feature for the Column",-1)])]),_:1})]),s("li",null,[a(t,{to:"#drag-and-drop-logic-in-details-viewmodel"},{default:p(()=>[...n[3]||(n[3]=[e("Drag and Drop logic in details(ViewModel)",-1)])]),_:1})]),s("li",null,[a(t,{to:"#ui-customization-for-drag-and-drop"},{default:p(()=>[...n[4]||(n[4]=[e("UI Customization for Drag and Drop",-1)])]),_:1}),s("ul",null,[s("li",null,[a(t,{to:"#ticketcard-ui-customizations"},{default:p(()=>[...n[5]||(n[5]=[e("TicketCard UI Customizations",-1)])]),_:1})])])])])]),n[14]||(n[14]=s("hr",null,null,-1)),a(l,{name:"How easy is drag-and-drop in Compose?",desc:"In Android, whenever you have a drag-and-drop feature, we usually expect that it will be a complex task. To be honest, I agree. However, the drag-and-drop feature is now easier in Compose.",url:"https://droidcon.com/how-easy-is-drag-and-drop-in-compose",logo:"https://droidcon.com/wp-content/uploads/2021/07/favicon-300x300.png",preview:"https://droidcon.com/wp-content/uploads/2024/12/1_zexRkeCe48fsa66RhC-zcQ-1024x659.webp"}),n[15]||(n[15]=m(`<figure><img src="https://droidcon.com/wp-content/uploads/2024/12/1_zexRkeCe48fsa66RhC-zcQ-1024x659.webp" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>In Android, whenever you have a drag-and-drop feature, we usually expect that it will be a complex task. To be honest, I agree. However, the drag-and-drop feature is now easier in Compose.</p><p>To make it clear and easy to understand, we will build a Scrum/Kanban board that contains tickets. These tickets should be dragged and dropped into different columns.</p><p>In this example, the user can:</p><ol><li>create a ticket which should be placed on the TODO column by default</li><li>Using a bottom sheet, the user can add the ticket description, ticket estimation, and tags</li><li>When the ticket moves to the Done column, a delete option becomes available, allowing the user to remove it from the board.</li><li>The user can move the ticket from any column to another.</li></ol><figure><img src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*eh5JJv1Pemz0F7dFTVqWww.gif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>For technical understanding, we are going to have 6 different parts to this article. We are going to talk about each in detail.</p><ul><li>Build the Jetpack Compose UI</li><li>Enable drag feature for TicketCard</li><li>Enable the Drop feature for the Column</li><li>Drag and Drop logic in details(ViewModel)</li><li>UI Customization for Drag and Drop</li><li>Clarify the drag-drop process</li></ul><hr><h2 id="build-the-jetpack-compose-ui" tabindex="-1"><a class="header-anchor" href="#build-the-jetpack-compose-ui"><span>Build the Jetpack Compose UI</span></a></h2><p>Starting with the Board UI, as per the screenshot below, we have 3 titled equal columns, where each column can accept a list of tickets.</p><p>With the help of the floating button on the bottom right, we can add a new ticket to the board. these new tickets should be added by default to the TODO column(we will discuss it in the<strong>Add/Delete ticket</strong>section).</p><p>When the ticket moves to the Done column, a delete IconButton is available to delete the ticket, otherwise we would have an infinite number of tickets in the Done column.</p><p>Adding and deleting option opens a BottomSheet, where its content depends on the feature(we will discuss it in the<strong>Add/Delete ticket</strong>section).</p><figure><img src="https://droidcon.com/wp-content/uploads/2024/12/1_yf2X-s5vw-dscMoc6Ox_iw-1024x461.webp" alt="Overview of the Board UI" tabindex="0" loading="lazy"><figcaption>Overview of the Board UI</figcaption></figure><div class="code-block-with-title"><div class="code-block-title-bar" data-title="DragAndDropCompose.kt"><span>DragAndDropCompose.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Composable</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">DragAndDropCompose</span><span class="token punctuation">(</span></span>
<span class="line">        modifier<span class="token operator">:</span> Modifier<span class="token punctuation">,</span></span>
<span class="line">        uiState<span class="token operator">:</span> UiState<span class="token punctuation">,</span></span>
<span class="line">        onNewTicketSubmitted<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">,</span></span>
<span class="line">        onDeleteConfirmed<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">,</span></span>
<span class="line">        onTicketDropped<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">,</span> Column<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit</span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> showAddTicketDialog <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// A Box contains 3 equal weight DragAndDropBox() separated by a VerticalDivider()</span></span>
<span class="line">    <span class="token function">Box</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> modifier<span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Row</span><span class="token punctuation">(</span></span>
<span class="line">                modifier <span class="token operator">=</span> Modifier</span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">DragAndDropBox</span><span class="token punctuation">(</span></span>
<span class="line">                    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">weight</span><span class="token punctuation">(</span><span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    list <span class="token operator">=</span> uiState<span class="token punctuation">.</span>list<span class="token punctuation">.</span>listOne<span class="token punctuation">,</span></span>
<span class="line">                    column <span class="token operator">=</span> Column<span class="token punctuation">.</span>TODO<span class="token punctuation">,</span></span>
<span class="line">                    onTicketDropped <span class="token operator">=</span> onTicketDropped<span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">            <span class="token function">VerticalDivider</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token function">DragAndDropBox</span><span class="token punctuation">(</span></span>
<span class="line">                    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">weight</span><span class="token punctuation">(</span><span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    list <span class="token operator">=</span> uiState<span class="token punctuation">.</span>list<span class="token punctuation">.</span>listTwo<span class="token punctuation">,</span></span>
<span class="line">                    column <span class="token operator">=</span> Column<span class="token punctuation">.</span>IN_PROGRESS<span class="token punctuation">,</span></span>
<span class="line">                    onTicketDropped <span class="token operator">=</span> onTicketDropped<span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">            <span class="token function">VerticalDivider</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token function">DragAndDropBox</span><span class="token punctuation">(</span></span>
<span class="line">                    modifier <span class="token operator">=</span> Modifier</span>
<span class="line">                            <span class="token punctuation">.</span><span class="token function">weight</span><span class="token punctuation">(</span><span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    list <span class="token operator">=</span> uiState<span class="token punctuation">.</span>list<span class="token punctuation">.</span>listThree<span class="token punctuation">,</span></span>
<span class="line">                    column <span class="token operator">=</span> Column<span class="token punctuation">.</span>DONE<span class="token punctuation">,</span></span>
<span class="line">                    onTicketDropped <span class="token operator">=</span> onTicketDropped<span class="token punctuation">,</span></span>
<span class="line">                    onDeleteConfirmed <span class="token operator">=</span> onDeleteConfirmed</span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">        <span class="token function">FloatingActionButton</span><span class="token punctuation">(</span></span>
<span class="line">                modifier <span class="token operator">=</span> Modifier</span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">align</span><span class="token punctuation">(</span>Alignment<span class="token punctuation">.</span>BottomEnd<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                onClick <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                    showAddTicketDialog <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">Icon</span><span class="token punctuation">(</span>Icons<span class="token punctuation">.</span>Filled<span class="token punctuation">.</span>Add<span class="token punctuation">,</span> contentDescription <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    <span class="token function">InputDialog</span><span class="token punctuation">(</span></span>
<span class="line">            showDialog <span class="token operator">=</span> showAddTicketDialog<span class="token punctuation">,</span></span>
<span class="line">            estimationsList <span class="token operator">=</span> uiState<span class="token punctuation">.</span>list<span class="token punctuation">.</span>estimations<span class="token punctuation">,</span></span>
<span class="line">            tagsList <span class="token operator">=</span> uiState<span class="token punctuation">.</span>list<span class="token punctuation">.</span>tags<span class="token punctuation">,</span></span>
<span class="line">            onNewTicketSubmitted <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">onNewTicketSubmitted</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            onDismiss <span class="token operator">=</span> <span class="token punctuation">{</span> showAddTicketDialog <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p><code>DragAndDropCompose()</code> is the parent content of the composable function. it contains the following:</p><ul><li>A**<code>modifier</code>**to customize the UI</li><li>A**<code>uiState</code>**holds the state of the UI, it contains the data that should be displayed.</li><li><code>onNewTicketSubmitted: (BoardTicket) -&gt;Unit</code>** is a callback when a new ticket is added to the boardit accepts BoardTicket as a param. BoardTicket is a data class that contains information about each ticket on the board, which we will discuss later.</li><li><code>onDeleteConfirmed: (BoardTicket) -&gt; Unit</code>**is a callback when a ticket deleted from the boa</li><li><code>onTicketDropped(BoardTicket, Column) -&gt;Unit</code>** is a callback when a ticket is dropped to a column. Iaccepts BoardTicket and Column parameters. Where Column is a data class that describes which column is affected.</li></ul><p>Another essential component is**<code>DragAndDropBox()</code>**</p><p><code>DragAndDropBox()</code> accepts 4 required and 1 optional params.</p><p>Using state hoisting, we are passing all callbacks to the parent composable function <code>DragAndDropCompose()</code>. <code>DragAndDropBox()</code> contains a list param, where it contains a list of <code>List&lt;BoardTicket&gt;</code>.</p><hr><h2 id="enable-drag-feature-for-ticketcard" tabindex="-1"><a class="header-anchor" href="#enable-drag-feature-for-ticketcard"><span>Enable drag feature for <code>TicketCard</code></span></a></h2><p>As you may expect, enabling the drag feature should be applied to the ticket. Inside**<code>DragAndDropBox()</code>** we have a title on the top and a list of tickets on each column.</p><p>**<code>LazyColumn</code><strong>contains a sticky header that holds the column name.</strong><code>items(list)</code><strong>contains a list of</strong><code>BoardTicket</code>****<code>List&lt;BoardTicket&gt;</code>**which is a data class that describes the ticket.</p><p>From each**<code>BoardTicket</code><strong>, we have</strong><code>TicketCard</code>**, which is a composable function that draws the ticket on each column</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token function">LazyColumn</span><span class="token punctuation">(</span></span>
<span class="line">        modifier <span class="token operator">=</span> Modifier</span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">        stickyHeader <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">Text</span><span class="token punctuation">(</span></span>
<span class="line">                text <span class="token operator">=</span> column<span class="token punctuation">.</span>name<span class="token punctuation">,</span></span>
<span class="line">                modifier <span class="token operator">=</span> Modifier</span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">graphicsLayer</span> <span class="token punctuation">{</span></span>
<span class="line">                        scaleX <span class="token operator">=</span> scale</span>
<span class="line">                        scaleY <span class="token operator">=</span> scale</span>
<span class="line">                        transformOrigin <span class="token operator">=</span> TransformOrigin<span class="token punctuation">.</span>Center</span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                textAlign <span class="token operator">=</span> TextAlign<span class="token punctuation">.</span>Center<span class="token punctuation">,</span></span>
<span class="line">                fontWeight <span class="token operator">=</span> titleStyle<span class="token punctuation">.</span>value<span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token function">items</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token punctuation">{</span> boardTicket <span class="token operator">-&gt;</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">TicketCard</span><span class="token punctuation">(</span></span>
<span class="line">                    ticket <span class="token operator">=</span> boardTicket<span class="token punctuation">,</span></span>
<span class="line">                    onDeleteConfirmed <span class="token operator">=</span> onDeleteConfirmed<span class="token punctuation">,</span></span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To enable the drag feature for**<code>TicketCard()</code><strong>we need to add a modifier extension function</strong><code>dragAndDropSource</code>**. we can enable the drag by enabling a long-press using <code>onLongPress()</code></p><p>The main concept behind the drag and drop is to transfer data from the drag part to the target drop part.***startTransfer()*<strong>is a method that accepts</strong><code>DragAndDropTransferData</code>**that accepts<code>ClipData</code>.</p><p><code>ClipData</code> could have 5 different types, <code>PlainText</code>, <code>HtmlText</code>, <code>Intent</code>, <code>Uri</code>, and <code>RawUri</code>.</p><p>Since we want the whole object to be transferred from one column to another, we will ClipData.newIntent type with the help of the<code>Gson</code>library. The <code>newIntent()</code>accepts 2 arguments, a<code>label</code>which is a String that usually describes the data to be transferred, and usually, it’s needed for accessibility. the second argument, is the<code>Intent()</code>, where it contains the data.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line">Modifier</span>
<span class="line"><span class="token punctuation">.</span><span class="token function">dragAndDropSource</span><span class="token punctuation">(</span>block <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">detectTapGestures</span><span class="token punctuation">(</span></span>
<span class="line">                    onLongPress <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token function">startTransfer</span><span class="token punctuation">(</span></span>
<span class="line">                            <span class="token function">DragAndDropTransferData</span><span class="token punctuation">(</span></span>
<span class="line">                                clipData <span class="token operator">=</span> ClipData<span class="token punctuation">.</span><span class="token function">newIntent</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;ticket&quot;</span></span><span class="token punctuation">,</span> <span class="token function">Intent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{</span></span>
<span class="line">                                    <span class="token function">putExtra</span><span class="token punctuation">(</span>ARG_TICKET<span class="token punctuation">,</span> gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>ticket<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                                <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">                            <span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="enable-the-drop-feature-for-the-column" tabindex="-1"><a class="header-anchor" href="#enable-the-drop-feature-for-the-column"><span>Enable the Drop feature for the Column</span></a></h2><p>After successfully adding the Drag feature, by filling an Intent with the data, now it’s time to receive/accept that data when the drop happened.</p><p>The core part behind receiving the data is a<code>DragAndDropTarget</code>. It’s an interface where it contains some methods</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">fun</span> <span class="token function">onDrop</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span><span class="token operator">:</span> Boolean</span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">onStarted</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token operator">=</span> Unit</span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">onEntered</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token operator">=</span> Unit</span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">onMoved</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token operator">=</span> Unit</span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">onExited</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token operator">=</span> Unit</span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">onChanged</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token operator">=</span> Unit</span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">onEnded</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token operator">=</span> Unit</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We would focus on three of these methods,<code>onDrop()</code>,<code>onEntered()</code>,<code>onExited()</code>,<code>onEnded()</code>.</p><ul><li><code>onDrop()</code>is called whenever the item dragged has been dropped on the target.</li><li><code>onEntered()</code>is called whenever the dragged item has entered the target bounds</li><li><code>onExited()</code>is called whenever the dragged item has exited the bounds where the item was placed.</li></ul><p>Inside<code>DragAndBox()</code>function, we added the implementation of the DragAndroidDropTarget interface.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="DragAndDropBox.kt"><span>DragAndDropBox.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Composable</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">DragAndDropBox</span><span class="token punctuation">(</span></span>
<span class="line">    modifier<span class="token operator">:</span> Modifier<span class="token punctuation">,</span></span>
<span class="line">    list<span class="token operator">:</span> List<span class="token operator">&lt;</span>BoardTicket<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    column<span class="token operator">:</span> Column<span class="token punctuation">,</span></span>
<span class="line">    onTicketDropped<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">,</span> Column<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">,</span></span>
<span class="line">    onDeleteConfirmed<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// ......</span></span>
<span class="line">    <span class="token comment">// ......</span></span>
<span class="line">    <span class="token keyword">val</span> dragAndDropTarget <span class="token operator">=</span> remember <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">object</span> <span class="token operator">:</span> DragAndDropTarget <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onDrop</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">val</span> <span class="token keyword">data</span> <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">toAndroidDragEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clipData<span class="token punctuation">.</span><span class="token function">getItemAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>intent</span>
<span class="line">                <span class="token keyword">val</span> ticket <span class="token operator">=</span> gson<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span>ARG_TICKET<span class="token punctuation">)</span><span class="token punctuation">,</span> BoardTicket<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">onTicketDropped</span><span class="token punctuation">(</span></span>
<span class="line">                    ticket<span class="token punctuation">,</span> column</span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onEntered</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onEntered</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">// .....</span></span>
<span class="line">                <span class="token comment">// .....</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onExited</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onExited</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">                <span class="token comment">// .....</span></span>
<span class="line">                <span class="token comment">// .....</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">Box</span><span class="token punctuation">(</span></span>
<span class="line">        modifier <span class="token operator">=</span> modifier</span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span>color <span class="token operator">=</span> backgroundColor<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">dragAndDropTarget</span><span class="token punctuation">(</span></span>
<span class="line">                shouldStartDragAndDrop <span class="token operator">=</span> <span class="token punctuation">{</span> event <span class="token operator">-&gt;</span></span>
<span class="line">                    event</span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">mimeTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>ClipDescription<span class="token punctuation">.</span>MIMETYPE_TEXT_INTENT<span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                target <span class="token operator">=</span> dragAndDropTarget</span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// .....</span></span>
<span class="line">        <span class="token comment">// .....</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Let’s break down<code>onDrop()</code>implementation, to receive the clipData sent, we use<code>toAndroidDragEvent()</code>extension function that returns DragEvent where we can extract all the clipData sent. Since we have a single clipData we would use <code>getItemAt(0).intent</code>.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">val</span> <span class="token keyword">data</span> <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">toAndroidDragEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clipData<span class="token punctuation">.</span><span class="token function">getItemAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>intent</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>After that we would retrieve the intent, we would need the extra sent which contains a serialized JSON</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">val</span> ticket <span class="token operator">=</span> gson<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span>ARG_TICKET<span class="token punctuation">)</span><span class="token punctuation">,</span> BoardTicket<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>After implementing the interface, we would use another Modifier extension function to make the DragAndDropBox() composable function configured for drag and drop using<code>Modifier.dragAndDropTarget()</code>.</p><p>Let’s break it down,<code>dragAndDropTarget</code>has 2 arguments. First,<code>shouldStartDragAndDrop</code>where it describes the type of the event, in this case, we need to make sure that the<code>dragAndDropTarget</code>accepts Intent. Second, the<code>target</code>is the interface implementation we did earlier.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token function">Box</span><span class="token punctuation">(</span></span>
<span class="line">    modifier <span class="token operator">=</span> modifier</span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span>color <span class="token operator">=</span> backgroundColor<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">dragAndDropTarget</span><span class="token punctuation">(</span></span>
<span class="line">            shouldStartDragAndDrop <span class="token operator">=</span> <span class="token punctuation">{</span> event <span class="token operator">-&gt;</span></span>
<span class="line">                event</span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">mimeTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>ClipDescription<span class="token punctuation">.</span>MIMETYPE_TEXT_INTENT<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            target <span class="token operator">=</span> dragAndDropTarget</span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="drag-and-drop-logic-in-details-viewmodel" tabindex="-1"><a class="header-anchor" href="#drag-and-drop-logic-in-details-viewmodel"><span>Drag and Drop logic in details(ViewModel)</span></a></h2><p>After the discussion about enabling the drag and drop feature for the Composable functions, we need to make it clear how can we handle the business logic to make sure the board acts as a Kanban/Agile board.</p><p>We have a viewModel that contains 3 StateFlow for the 3 lists that match 3 columns we have todos, inProgress, and done list. These 3 lists are wrapped in a uiState.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="MainViewModel.kt"><span>MainViewModel.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">class</span> MainViewModel <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">val</span> todos <span class="token operator">=</span> MutableStateFlow<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>BoardTicket<span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">val</span> inProgress <span class="token operator">=</span> MutableStateFlow<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>BoardTicket<span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">val</span> done <span class="token operator">=</span> MutableStateFlow<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>BoardTicket<span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">val</span> _uiState <span class="token operator">=</span> MutableStateFlow<span class="token operator">&lt;</span>UiState<span class="token operator">&gt;</span><span class="token punctuation">(</span></span>
<span class="line">        UiState<span class="token punctuation">.</span><span class="token function">Success</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token function">SuccessState</span><span class="token punctuation">(</span></span>
<span class="line">                todos<span class="token punctuation">.</span>value<span class="token punctuation">,</span></span>
<span class="line">                inProgress<span class="token punctuation">.</span>value<span class="token punctuation">,</span></span>
<span class="line">                done<span class="token punctuation">.</span>value</span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">val</span> uiState <span class="token operator">=</span> _uiState<span class="token punctuation">.</span><span class="token function">asStateFlow</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>There are 3 actions on the board, Add, Delete, and Move. Each action has a method inside the ViewModel. we used State Hoisting when the ticket, was added, deleted, or moved.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="DragAndDropCompose.kt"><span>DragAndDropCompose.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token comment">// Main Composable function</span></span>
<span class="line"><span class="token annotation builtin">@Composable</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">DragAndDropCompose</span><span class="token punctuation">(</span></span>
<span class="line">        modifier<span class="token operator">:</span> Modifier<span class="token punctuation">,</span></span>
<span class="line">        uiState<span class="token operator">:</span> UiState<span class="token punctuation">,</span></span>
<span class="line">        onNewTicketSubmitted<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">,</span></span>
<span class="line">        onDeleteConfirmed<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">,</span></span>
<span class="line">        onTicketDropped<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">,</span> Column<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit</span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Activity</span></span>
<span class="line"><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">val</span> viewModel<span class="token operator">:</span> MainViewModel <span class="token keyword">by</span> <span class="token function">viewModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span></span>
<span class="line">        setContent <span class="token punctuation">{</span></span>
<span class="line">            DDBoardTheme <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">val</span> uiState <span class="token operator">=</span> viewModel<span class="token punctuation">.</span>uiState<span class="token punctuation">.</span><span class="token function">collectAsState</span><span class="token punctuation">(</span>MainViewModel<span class="token punctuation">.</span>UiState<span class="token punctuation">.</span>Loading<span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">Scaffold</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> innerPadding <span class="token operator">-&gt;</span></span>
<span class="line">                    <span class="token function">DragAndDropCompose</span><span class="token punctuation">(</span></span>
<span class="line">                        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span>paddingValues <span class="token operator">=</span> innerPadding<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                        uiState <span class="token operator">=</span> uiState<span class="token punctuation">.</span>value<span class="token punctuation">,</span></span>
<span class="line">                        onTicketDropped <span class="token operator">=</span> <span class="token punctuation">{</span> boardTicket<span class="token punctuation">,</span> type <span class="token operator">-&gt;</span></span>
<span class="line">                            viewModel<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>boardTicket <span class="token operator">=</span> boardTicket<span class="token punctuation">,</span> <span class="token keyword">to</span> <span class="token operator">=</span> type<span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                        onNewTicketSubmitted <span class="token operator">=</span> <span class="token punctuation">{</span> viewModel<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                        onDeleteConfirmed <span class="token operator">=</span> <span class="token punctuation">{</span> viewModel<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">                        <span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>As you can see, we are passing the callbacks using state hoisting from the Composable function the Activity to call the proper method on the ViewModel. For example, if we are looking for adding a new ticket, <code>onNewTicketSubmitted = { viewModel.add(it) }</code> should be invoked.</p><p>We have a data class that contains the business logic of each ticket.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="BoardTicket.kt"><span>BoardTicket.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">BoardTicket</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token keyword">val</span> text<span class="token operator">:</span> String<span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">val</span> estimation<span class="token operator">:</span> String<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">val</span> tag<span class="token operator">:</span> String<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">val</span> column<span class="token operator">:</span> Column</span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>The data class contains<code>text</code>that corresponds to the title of the ticket, an<code>estimation</code>that corresponds to the estimation of the ticket, a<code>tag</code>that categorizes the ticket, and a column which is an enum that describes the column type</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="Column.kt"><span>Column.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">enum</span> <span class="token keyword">class</span> <span class="token function">Column</span><span class="token punctuation">(</span><span class="token keyword">val</span> columnName<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;TODO&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">IN_PROGRESS</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;In Progress&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">DONE</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Done&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Let’s break down the add method. when we add a ticket<code>onNewTicketSubmitted: (BoardTicket) -&gt; Unit</code> callback passed to the <code>MainActivity</code> where we call<code>{ viewModel.add(it) }</code>.</p><p>Since when we add a ticket it by default is added to the TODO column, that makes it a very straightforward method. We used<code>+=</code>operator to add the ticket to the todos List.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">fun</span> <span class="token function">add</span><span class="token punctuation">(</span>boardTicket<span class="token operator">:</span> BoardTicket<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    todos<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token function">BoardTicket</span><span class="token punctuation">(</span>text <span class="token operator">=</span> boardTicket<span class="token punctuation">.</span>text<span class="token punctuation">,</span> estimation <span class="token operator">=</span> boardTicket<span class="token punctuation">.</span>estimation<span class="token punctuation">,</span> tag <span class="token operator">=</span> boardTicket<span class="token punctuation">.</span>tag<span class="token punctuation">,</span> column <span class="token operator">=</span>  Column<span class="token punctuation">.</span>TODO<span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">updateUiState</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Let’s break down the delete method. when we delete a ticket. we enable ticket deletion only on the done column. that makes it straightforward as well. using<code>-=</code>operator, we delete the ticket from the done List.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">fun</span> <span class="token function">delete</span><span class="token punctuation">(</span>boardTicket<span class="token operator">:</span> BoardTicket<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    done<span class="token punctuation">.</span>value <span class="token operator">-=</span> boardTicket</span>
<span class="line">    <span class="token function">updateUiState</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Let’s break down the move method. As we mentioned earlier, any ticket can move from any column to another without restrictions, that is why the signature of the move method contains a BoardTicket instance and a<code>target</code>column. The move method is also straightforward, we want to know what is the source and destination columns. Because we would delete the ticket from the source list and add it to the destination list. For example, if we move a ticket from inProgress column to the done column, we will remove it from the inProgress list and it to the done List.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">fun</span> <span class="token function">move</span><span class="token punctuation">(</span>boardTicket<span class="token operator">:</span> BoardTicket<span class="token punctuation">,</span> target<span class="token operator">:</span> Column<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">when</span> <span class="token punctuation">(</span>boardTicket<span class="token punctuation">.</span>column<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    Column<span class="token punctuation">.</span>DONE <span class="token operator">-&gt;</span> done<span class="token punctuation">.</span>value <span class="token operator">-=</span> boardTicket</span>
<span class="line">    Column<span class="token punctuation">.</span>IN_PROGRESS <span class="token operator">-&gt;</span> inProgress<span class="token punctuation">.</span>value <span class="token operator">-=</span> boardTicket</span>
<span class="line">    Column<span class="token punctuation">.</span>TODO <span class="token operator">-&gt;</span> todos<span class="token punctuation">.</span>value <span class="token operator">-=</span> boardTicket</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">when</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    Column<span class="token punctuation">.</span>DONE <span class="token operator">-&gt;</span> done<span class="token punctuation">.</span>value <span class="token operator">+=</span> boardTicket<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>column <span class="token operator">=</span> target<span class="token punctuation">)</span></span>
<span class="line">    Column<span class="token punctuation">.</span>IN_PROGRESS <span class="token operator">-&gt;</span> inProgress<span class="token punctuation">.</span>value <span class="token operator">+=</span> boardTicket<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>column <span class="token operator">=</span> target<span class="token punctuation">)</span></span>
<span class="line">    Column<span class="token punctuation">.</span>TODO <span class="token operator">-&gt;</span> todos<span class="token punctuation">.</span>value <span class="token operator">+=</span> boardTicket<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>column <span class="token operator">=</span> target<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">updateUiState</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">Note</p><p>we have a method<code>updateUiState()</code> that updates the _uiState to update the UI state and reflect the updates happen.</p></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">updateUiState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    _uiState<span class="token punctuation">.</span>value <span class="token operator">=</span></span>
<span class="line">        UiState<span class="token punctuation">.</span><span class="token function">Success</span><span class="token punctuation">(</span><span class="token function">SuccessState</span><span class="token punctuation">(</span>todos<span class="token punctuation">.</span>value<span class="token punctuation">,</span> inProgress<span class="token punctuation">.</span>value<span class="token punctuation">,</span> done<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="ui-customization-for-drag-and-drop" tabindex="-1"><a class="header-anchor" href="#ui-customization-for-drag-and-drop"><span>UI Customization for Drag and Drop</span></a></h2><p>We need to polish the UI to make look great. we are going to polish the following:</p><ul><li>TicketCard UI Customization</li><li>Column UI Customization</li><li>BottomSheet for ticket addition and deletion</li></ul><h3 id="ticketcard-ui-customizations" tabindex="-1"><a class="header-anchor" href="#ticketcard-ui-customizations"><span>TicketCard UI Customizations</span></a></h3><p>as per the screen below, we have made some UI customization on the TicketCard, the background color and add a delete icon to any ticket on the Done column.</p><p>For the background, it’s straightforward, we decide the containerColor of the card using a when statement with column type.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="TicketCard.kt"><span>TicketCard.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Composable</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">TicketCard</span><span class="token punctuation">(</span></span>
<span class="line">    ticket<span class="token operator">:</span> BoardTicket<span class="token punctuation">,</span></span>
<span class="line">    onDeleteConfirmed<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit</span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">val</span> showDeleteTicketDialog <span class="token operator">=</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">Card</span><span class="token punctuation">(</span></span>
<span class="line">        <span class="token comment">// .....</span></span>
<span class="line">        <span class="token comment">// .....</span></span>
<span class="line">        shape <span class="token operator">=</span> CardDefaults<span class="token punctuation">.</span>outlinedShape<span class="token punctuation">,</span></span>
<span class="line">        colors <span class="token operator">=</span> CardDefaults<span class="token punctuation">.</span><span class="token function">cardColors</span><span class="token punctuation">(</span></span>
<span class="line">            containerColor <span class="token operator">=</span> <span class="token keyword">when</span> <span class="token punctuation">(</span>ticket<span class="token punctuation">.</span>column<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                Column<span class="token punctuation">.</span>IN_PROGRESS <span class="token operator">-&gt;</span> MaterialTheme<span class="token punctuation">.</span>colorScheme<span class="token punctuation">.</span>onSecondary</span>
<span class="line">                Column<span class="token punctuation">.</span>DONE <span class="token operator">-&gt;</span> MaterialTheme<span class="token punctuation">.</span>colorScheme<span class="token punctuation">.</span>onTertiary</span>
<span class="line">                Column<span class="token punctuation">.</span>TODO <span class="token operator">-&gt;</span> MaterialTheme<span class="token punctuation">.</span>colorScheme<span class="token punctuation">.</span>onPrimary</span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// .....</span></span>
<span class="line">        <span class="token comment">// .....</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>For the delete icon on the Done TicketCard columns, we also check the type of the ticket, if it’s done we add a delete icon on the top right.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="TicketCard"><span>TicketCard</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Composable</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">TicketCard</span><span class="token punctuation">(</span></span>
<span class="line">    ticket<span class="token operator">:</span> BoardTicket<span class="token punctuation">,</span></span>
<span class="line">    onDeleteConfirmed<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit</span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line">    <span class="token comment">// .....</span></span>
<span class="line">    <span class="token function">Column</span><span class="token punctuation">(</span></span>
<span class="line">        modifier <span class="token operator">=</span> Modifier</span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        Row <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">Text</span><span class="token punctuation">(</span></span>
<span class="line">                text <span class="token operator">=</span> ticket<span class="token punctuation">.</span>text<span class="token punctuation">,</span></span>
<span class="line">                modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">weight</span><span class="token punctuation">(</span><span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                fontWeight <span class="token operator">=</span> FontWeight<span class="token punctuation">.</span>Bold</span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>ticket<span class="token punctuation">.</span>column <span class="token operator">==</span> Column<span class="token punctuation">.</span>DONE<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">Icon</span><span class="token punctuation">(</span></span>
<span class="line">                    Icons<span class="token punctuation">.</span>Filled<span class="token punctuation">.</span>Delete<span class="token punctuation">,</span></span>
<span class="line">                    contentDescription <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span></span>
<span class="line">                    modifier <span class="token operator">=</span> Modifier</span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">clickable</span> <span class="token punctuation">{</span></span>
<span class="line">                            showDeleteTicketDialog<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">                        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// .....</span></span>
<span class="line">        <span class="token comment">// .....</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h4 id="column-ui-customization" tabindex="-1"><a class="header-anchor" href="#column-ui-customization"><span>Column UI Customization</span></a></h4><p>We will do some customization for the Column, in the title and the background of the column.<br> Our mission is to make the title scale increase when a ticket enters the column and returns to its original scale when the ticket leaves the column</p><p>Also, to change the background color of the column whenever a ticket moves in/out of a specific columns</p><p>To achieve that we would need <code>onEntered()</code> and <code>onExited()</code> callbacks.</p><p>For the title scale, we use<code>animateFloatAsState()</code> that switches between font-weight and scale based on a<code>titleStyle</code>mutableState.</p><p>For the background, we use a <code>backgroundColor</code> mutableState to switch between 2 colors.</p><p>in the <code>onEntered()</code>, <code>onExited()</code> callback, we will change the color and also change the <code>FontWeight</code>, also change the column background.</p><figure><img src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*phCM9iy6HLA_KahThucMxQ.gif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="code-block-with-title"><div class="code-block-title-bar" data-title="DragAndDropBox.kt"><span>DragAndDropBox.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Composable</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">DragAndDropBox</span><span class="token punctuation">(</span></span>
<span class="line">    modifier<span class="token operator">:</span> Modifier<span class="token punctuation">,</span></span>
<span class="line">    list<span class="token operator">:</span> List<span class="token operator">&lt;</span>BoardTicket<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    column<span class="token operator">:</span> Column<span class="token punctuation">,</span></span>
<span class="line">    onTicketDropped<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">,</span> Column<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">,</span></span>
<span class="line">    onDeleteConfirmed<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> backgroundColor <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token function">Color</span><span class="token punctuation">(</span><span class="token number">0xffE5E4E2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">val</span> titleStyle <span class="token operator">=</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span>FontWeight<span class="token punctuation">.</span>Normal<span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">val</span> scale <span class="token keyword">by</span> <span class="token function">animateFloatAsState</span><span class="token punctuation">(</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>titleStyle<span class="token punctuation">.</span>value <span class="token operator">==</span> FontWeight<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span> <span class="token number">1.4f</span> <span class="token keyword">else</span> <span class="token number">1f</span><span class="token punctuation">,</span></span>
<span class="line">        label <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;scale&quot;</span></span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">val</span> dragAndDropTarget <span class="token operator">=</span> remember <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">object</span> <span class="token operator">:</span> DragAndDropTarget <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onDrop</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">{</span></span>
<span class="line">                <span class="token operator">..</span><span class="token operator">..</span><span class="token punctuation">.</span></span>
<span class="line">                <span class="token operator">..</span><span class="token operator">..</span><span class="token punctuation">.</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onEntered</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onEntered</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">                backgroundColor <span class="token operator">=</span> <span class="token function">Color</span><span class="token punctuation">(</span><span class="token number">0xffD3D3D3</span><span class="token punctuation">)</span></span>
<span class="line">                titleStyle<span class="token punctuation">.</span>value <span class="token operator">=</span> FontWeight<span class="token punctuation">.</span>Bold</span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onExited</span><span class="token punctuation">(</span>event<span class="token operator">:</span> DragAndDropEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onExited</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line">                backgroundColor <span class="token operator">=</span> <span class="token function">Color</span><span class="token punctuation">(</span><span class="token number">0xffE5E4E2</span><span class="token punctuation">)</span></span>
<span class="line">                titleStyle<span class="token punctuation">.</span>value <span class="token operator">=</span> FontWeight<span class="token punctuation">.</span>Normal</span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token operator">..</span><span class="token operator">..</span><span class="token punctuation">.</span></span>
<span class="line">    <span class="token operator">..</span><span class="token operator">..</span><span class="token punctuation">.</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h4 id="bottomsheet-for-ticket-addition-and-deletion" tabindex="-1"><a class="header-anchor" href="#bottomsheet-for-ticket-addition-and-deletion"><span><code>BottomSheet</code> for ticket addition and deletion</span></a></h4><p>We will use the bottom sheet twice, for the addition and deletion of a ticket.</p><p>For deletion, it’s straightforward, it’s just a bottom sheet with a message and 2 buttons, one responsible for propagating the <code>onDelete()</code> to the MainActivity by state hoisting to perform the <code>viewModel.delete()</code> method. The second is just to hide the bottom sheet.</p><p>For adding a ticket, it’s a detailed bottom sheet, that contains a TextField with a maximum of 100 characters.</p><p>the second and third is a single selection component, where the user can select a tag and an estimation for the ticket and two buttons for adding a ticket by propagating<code>onNewTicketsubmitted()</code>to call<code>viewModel.add()</code>by state hoisting. We are using a<code>FlowRow</code>to achieve the single selection.</p><figure><img src="https://droidcon.com/wp-content/uploads/2024/12/1_qwecJahPL-9xw7x_JjSNMA-1024x461.webp" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="code-block-with-title"><div class="code-block-title-bar" data-title="SingleSelectionSection.kt"><span>SingleSelectionSection.kt</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">SingleSelectionSection</span><span class="token punctuation">(</span></span>
<span class="line">    title<span class="token operator">:</span> String<span class="token punctuation">,</span></span>
<span class="line">    list<span class="token operator">:</span> List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    selectedIndex<span class="token operator">:</span> Int<span class="token punctuation">,</span></span>
<span class="line">    badgeType<span class="token operator">:</span> BadgeType<span class="token punctuation">,</span></span>
<span class="line">    onItemSelected<span class="token operator">:</span> <span class="token punctuation">(</span>Int<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    hasError<span class="token operator">:</span> Boolean <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">Row</span><span class="token punctuation">(</span>verticalAlignment <span class="token operator">=</span> Alignment<span class="token punctuation">.</span>CenterVertically<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> title<span class="token punctuation">,</span> modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span>end <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token function">FlowRow</span><span class="token punctuation">(</span>horizontalArrangement <span class="token operator">=</span> Arrangement<span class="token punctuation">.</span><span class="token function">spacedBy</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            list<span class="token punctuation">.</span><span class="token function">forEachIndexed</span> <span class="token punctuation">{</span> index<span class="token punctuation">,</span> text <span class="token operator">-&gt;</span></span>
<span class="line">                <span class="token function">CardContainer</span><span class="token punctuation">(</span></span>
<span class="line">                    text <span class="token operator">=</span> text<span class="token punctuation">,</span></span>
<span class="line">                    isSelected <span class="token operator">=</span> selectedIndex <span class="token operator">==</span> index<span class="token punctuation">,</span></span>
<span class="line">                    badgeType <span class="token operator">=</span> badgeType<span class="token punctuation">,</span></span>
<span class="line">                    onClick <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token function">onItemSelected</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                    hasError <span class="token operator">=</span> hasError</span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>we have also multiple mutableStateFlow to remember the selection of the tags, estimation, and color of the single selection component, because we have a validation on the single selection and <code>TextField</code>, if the user click on save button without filling all required fields.</p><figure><img src="https://droidcon.com/wp-content/uploads/2024/12/1_ri1OCyUJi2Nm2VmsFz8SWA-1024x461.webp" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>You may notice that the mutableStateFlow that saves the value of the chosen value takes <code>sheetState</code>.<code>isVisible</code> as a param, for example, the reason behind that is to reset the state each time we open the bottom sheet. so old value disappears.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="InputDialog"><span>InputDialog</span></div><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Composable</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">InputDialog</span><span class="token punctuation">(</span></span>
<span class="line">    showDialog<span class="token operator">:</span> Boolean<span class="token punctuation">,</span></span>
<span class="line">    estimationsList<span class="token operator">:</span> List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    tagsList<span class="token operator">:</span> List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">    onNewTicketSubmitted<span class="token operator">:</span> <span class="token punctuation">(</span>BoardTicket<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">,</span></span>
<span class="line">    onDismiss<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit</span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">val</span> colorScheme <span class="token operator">=</span> MaterialTheme<span class="token punctuation">.</span>colorScheme</span>
<span class="line">    <span class="token keyword">val</span> sheetState <span class="token operator">=</span> <span class="token function">rememberModalBottomSheetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">val</span> scope <span class="token operator">=</span> <span class="token function">rememberCoroutineScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">var</span> text <span class="token keyword">by</span> <span class="token function">remember</span><span class="token punctuation">(</span>sheetState<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">val</span> selectedEstimationIndex <span class="token operator">=</span> <span class="token function">remember</span><span class="token punctuation">(</span>sheetState<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mutableIntStateOf</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">val</span> textError <span class="token operator">=</span> <span class="token function">remember</span><span class="token punctuation">(</span>sheetState<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span>  <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">val</span> selectedTagIndex <span class="token operator">=</span> <span class="token function">remember</span><span class="token punctuation">(</span>sheetState<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">mutableIntStateOf</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">var</span> supportTextColor <span class="token keyword">by</span> remember <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span>colorScheme<span class="token punctuation">.</span>onSurface<span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">var</span> estimationError <span class="token keyword">by</span> <span class="token function">remember</span><span class="token punctuation">(</span>sheetState<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span>  <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">var</span> tagError <span class="token keyword">by</span> <span class="token function">remember</span><span class="token punctuation">(</span>sheetState<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span>  <span class="token punctuation">{</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>showDialog<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">        <span class="token function">ModalBottomSheet</span><span class="token punctuation">(</span></span>
<span class="line">            onDismissRequest <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">onDismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            sheetState <span class="token operator">=</span> sheetState</span>
<span class="line">        <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">Column</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span>horizontal <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">.</span>dp<span class="token punctuation">,</span> vertical <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Add a new Ticket&quot;</span></span><span class="token punctuation">,</span> fontWeight <span class="token operator">=</span> FontWeight<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">Spacer</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">TextField</span><span class="token punctuation">(</span></span>
<span class="line">                    value <span class="token operator">=</span> text<span class="token punctuation">,</span></span>
<span class="line">                    placeholder <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Write your ticket title/details&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                    onValueChange <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                        text <span class="token operator">=</span> it</span>
<span class="line">                        supportTextColor <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>text<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                            Color<span class="token punctuation">.</span>Red</span>
<span class="line">                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">                            colorScheme<span class="token punctuation">.</span>onSurface</span>
<span class="line">                        <span class="token punctuation">}</span></span>
<span class="line">                        <span class="token keyword">if</span> <span class="token punctuation">(</span>textError<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> it<span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                            textError<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">                        <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    supportingText <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token function">Text</span><span class="token punctuation">(</span></span>
<span class="line">                            text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">text<span class="token punctuation">.</span>length</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> / 100&quot;</span></span><span class="token punctuation">,</span></span>
<span class="line">                            textAlign <span class="token operator">=</span> TextAlign<span class="token punctuation">.</span>End<span class="token punctuation">,</span></span>
<span class="line">                            modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                            color <span class="token operator">=</span> supportTextColor</span>
<span class="line">                        <span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                    colors <span class="token operator">=</span> TextFieldDefaults<span class="token punctuation">.</span><span class="token function">colors</span><span class="token punctuation">(</span></span>
<span class="line">                        focusedIndicatorColor <span class="token operator">=</span> Color<span class="token punctuation">.</span>Transparent<span class="token punctuation">,</span></span>
<span class="line">                        unfocusedIndicatorColor <span class="token operator">=</span> Color<span class="token punctuation">.</span>Transparent</span>
<span class="line">                    <span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    isError <span class="token operator">=</span> textError<span class="token punctuation">.</span>value</span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">Spacer</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">SingleSelectionSection</span><span class="token punctuation">(</span></span>
<span class="line">                    title <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Estimation&quot;</span></span><span class="token punctuation">,</span></span>
<span class="line">                    list <span class="token operator">=</span> estimationsList<span class="token punctuation">,</span></span>
<span class="line">                    badgeType <span class="token operator">=</span> BadgeType<span class="token punctuation">.</span>ESTIMATION<span class="token punctuation">,</span></span>
<span class="line">                    selectedIndex <span class="token operator">=</span> selectedEstimationIndex<span class="token punctuation">.</span>intValue<span class="token punctuation">,</span></span>
<span class="line">                    onItemSelected <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                        selectedEstimationIndex<span class="token punctuation">.</span>intValue <span class="token operator">=</span> it</span>
<span class="line">                        estimationError <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                    hasError <span class="token operator">=</span> estimationError</span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">Spacer</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">SingleSelectionSection</span><span class="token punctuation">(</span></span>
<span class="line">                    title <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Tags&quot;</span></span><span class="token punctuation">,</span></span>
<span class="line">                    list <span class="token operator">=</span> tagsList<span class="token punctuation">,</span></span>
<span class="line">                    badgeType <span class="token operator">=</span> BadgeType<span class="token punctuation">.</span>TAG<span class="token punctuation">,</span></span>
<span class="line">                    selectedIndex <span class="token operator">=</span> selectedTagIndex<span class="token punctuation">.</span>intValue<span class="token punctuation">,</span></span>
<span class="line">                    onItemSelected <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                        selectedTagIndex<span class="token punctuation">.</span>intValue <span class="token operator">=</span> it</span>
<span class="line">                        tagError <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                    hasError <span class="token operator">=</span> tagError</span>
<span class="line">                <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">                <span class="token function">Spacer</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token function">Button</span><span class="token punctuation">(</span>onClick <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token keyword">val</span> hasError <span class="token operator">=</span></span>
<span class="line">                        text<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> selectedTagIndex<span class="token punctuation">.</span>intValue <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> selectedEstimationIndex<span class="token punctuation">.</span>intValue <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">                    <span class="token keyword">if</span> <span class="token punctuation">(</span>hasError<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                        textError<span class="token punctuation">.</span>value <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        estimationError <span class="token operator">=</span> selectedEstimationIndex<span class="token punctuation">.</span>intValue <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">                        tagError <span class="token operator">=</span> selectedTagIndex<span class="token punctuation">.</span>intValue <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">                        <span class="token keyword">return</span><span class="token label symbol">@Button</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                    scope<span class="token punctuation">.</span><span class="token function">launch</span> <span class="token punctuation">{</span></span>
<span class="line">                        sheetState<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">invokeOnCompletion</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sheetState<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                            <span class="token function">onDismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                    <span class="token function">onNewTicketSubmitted</span><span class="token punctuation">(</span></span>
<span class="line">                        <span class="token function">BoardTicket</span><span class="token punctuation">(</span></span>
<span class="line">                            text <span class="token operator">=</span> text<span class="token punctuation">,</span></span>
<span class="line">                            estimation <span class="token operator">=</span> estimationsList\\<span class="token punctuation">[</span>selectedEstimationIndex<span class="token punctuation">.</span>intValue\\<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">                            tag <span class="token operator">=</span> tagsList\\<span class="token punctuation">[</span>selectedTagIndex<span class="token punctuation">.</span>intValue\\<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">                            column <span class="token operator">=</span> Column<span class="token punctuation">.</span>TODO</span>
<span class="line">                        <span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span> modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;Create&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">                <span class="token function">Spacer</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>So, that’s it. with a real-life example, we were able to:</p><ul><li>Understand how drag-and-drop API works in compose</li><li>Adapt some UI customization to make it similar to the Agile/Kanban board</li><li>handle the business logic using ViewModel.</li></ul>`,101)),s("p",null,[n[9]||(n[9]=e("You can find the full repository on",-1)),s("a",T,[n[6]||(n[6]=e("GitHub (",-1)),a(c,{icon:"iconfont icon-github"}),n[7]||(n[7]=s("code",null,"MustafaKhaled/DragAndDropBoard",-1)),n[8]||(n[8]=e(")",-1))]),n[10]||(n[10]=e(".",-1))]),s("div",x,[n[13]||(n[13]=s("p",{class:"hint-container-title"},"Info",-1)),s("p",null,[n[12]||(n[12]=e("This article is previously published on ",-1)),s("a",C,[a(c,{icon:"fa-brands fa-medium"}),n[11]||(n[11]=s("code",null,"proandroiddev",-1))])]),a(l,{name:"How easy is drag-and-drop in Compose?",desc:"Drag-and-Drop is straightforward and easy to implement in Jetpack Compose",url:"https://proandroiddev.com/how-easy-is-drag-and-drop-in-compose-e66d47ae8e5f/",logo:"https://miro.medium.com/v2/resize:fill:256:256/1*A8VytPZQhvUf_MG6hm_Dlw.png",preview:"https://miro.medium.com/v2/resize:fit:1200/1*yf2X-s5vw-dscMoc6Ox_iw.png"})]),b(" TODO: add ARTICLE CARD "),a(i,u(r({title:"How easy is drag-and-drop in Compose?",desc:"In Android, whenever you have a drag-and-drop feature, we usually expect that it will be a complex task. To be honest, I agree. However, the drag-and-drop feature is now easier in Compose.",link:"https://chanhi2000.github.io/bookshelf/droidcon.com/how-easy-is-drag-and-drop-in-compose.html",logo:"https://droidcon.com/wp-content/uploads/2021/07/favicon-300x300.png",background:"rgba(4,20,221,0.2)"})),null,16)])}const M=k(f,[["render",S]]),I=JSON.parse('{"path":"/droidcon.com/how-easy-is-drag-and-drop-in-compose.html","title":"How easy is drag-and-drop in Compose?","lang":"en-US","frontmatter":{"lang":"en-US","title":"How easy is drag-and-drop in Compose?","description":"Article(s) > How easy is drag-and-drop in Compose?","icon":"fa-brands fa-android","category":["Java","Kotlin","Android","Article(s)"],"tag":["blog","droidcon.com","java","kotlin","android"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"How easy is drag-and-drop in Compose?\\",\\"image\\":[\\"https://droidcon.com/wp-content/uploads/2024/12/1_zexRkeCe48fsa66RhC-zcQ-1024x659.webp\\",\\"https://miro.medium.com/v2/resize:fit:1200/format:webp/1*eh5JJv1Pemz0F7dFTVqWww.gif\\",\\"https://droidcon.com/wp-content/uploads/2024/12/1_yf2X-s5vw-dscMoc6Ox_iw-1024x461.webp\\",\\"https://miro.medium.com/v2/resize:fit:1200/format:webp/1*phCM9iy6HLA_KahThucMxQ.gif\\",\\"https://droidcon.com/wp-content/uploads/2024/12/1_qwecJahPL-9xw7x_JjSNMA-1024x461.webp\\",\\"https://droidcon.com/wp-content/uploads/2024/12/1_ri1OCyUJi2Nm2VmsFz8SWA-1024x461.webp\\"],\\"datePublished\\":\\"2024-12-11T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mustafa Khaled\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/droidcon.com/how-easy-is-drag-and-drop-in-compose.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"How easy is drag-and-drop in Compose?"}],["meta",{"property":"og:description","content":"Article(s) > How easy is drag-and-drop in Compose?"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://droidcon.com/wp-content/uploads/2024/12/1_zexRkeCe48fsa66RhC-zcQ-1024x659.webp"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://droidcon.com/wp-content/uploads/2024/12/1_zexRkeCe48fsa66RhC-zcQ-1024x659.webp"}],["meta",{"name":"twitter:image:alt","content":"How easy is drag-and-drop in Compose?"}],["meta",{"property":"article:author","content":"Mustafa Khaled"}],["meta",{"property":"article:tag","content":"android"}],["meta",{"property":"article:tag","content":"kotlin"}],["meta",{"property":"article:tag","content":"java"}],["meta",{"property":"article:tag","content":"droidcon.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2024-12-11T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > How easy is drag-and-drop in Compose?"},{"property":"og:description","content":"How easy is drag-and-drop in Compose?"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/droidcon.com/how-easy-is-drag-and-drop-in-compose.html"}]],"prev":"/programming/java-android/articles/README.md","date":"2024-12-11T00:00:00.000Z","isOriginal":false,"author":"Mustafa Khaled","cover":"https://droidcon.com/wp-content/uploads/2024/12/1_zexRkeCe48fsa66RhC-zcQ-1024x659.webp"},"git":{},"readingTime":{"minutes":10.97,"words":3292},"filePathRelative":"droidcon.com/how-easy-is-drag-and-drop-in-compose.md","copyright":{"author":"Mustafa Khaled"}}');export{M as comp,I as data};
