import{_ as u}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as d,d as s,f as e,b as m,t as k,n as h,g as v,w as o,e as a,r as i,o as b}from"./app-BItykJLQ.js";const f={},g={id:"frontmatter-title-관련",tabindex:"-1"},w={class:"header-anchor",href:"#frontmatter-title-관련"},y={class:"table-of-contents"},T={class:"hint-container note"},x={href:"https://kt.academy/book/effectivekotlin",target:"_blank",rel:"noopener noreferrer"},D={href:"https://leanpub.com/effectivekotlin",target:"_blank",rel:"noopener noreferrer"},F={href:"https://www.amazon.com/Effective-Kotlin-Best-Practices-Developers-ebook/dp/B0CHBR5XPF/",target:"_blank",rel:"noopener noreferrer"};function I(l,n){const c=i("VPCard"),t=i("router-link"),r=i("SiteInfo"),p=i("VPIcon");return b(),d("div",null,[s("h1",g,[s("a",w,[s("span",null,k(l.$frontmatter.title)+" 관련",1)])]),e(c,h(v({title:"Java > Article(s)",desc:"Article(s)",link:"/programming/java/articles/README.md",logo:"https://chanhi2000.github.io/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",y,[s("ul",null,[s("li",null,[e(t,{to:"#contracts"},{default:o(()=>[...n[0]||(n[0]=[a("Contracts",-1)])]),_:1})]),s("li",null,[e(t,{to:"#defining-a-contract"},{default:o(()=>[...n[1]||(n[1]=[a("Defining a contract",-1)])]),_:1})]),s("li",null,[e(t,{to:"#do-we-need-comments"},{default:o(()=>[...n[2]||(n[2]=[a("Do we need comments?",-1)])]),_:1})]),s("li",null,[e(t,{to:"#the-kdoc-format"},{default:o(()=>[...n[3]||(n[3]=[a("The KDoc format",-1)])]),_:1})]),s("li",null,[e(t,{to:"#the-type-system-and-expectations"},{default:o(()=>[...n[4]||(n[4]=[a("The type system and expectations",-1)])]),_:1})]),s("li",null,[e(t,{to:"#leaking-implementation"},{default:o(()=>[...n[5]||(n[5]=[a("Leaking implementation",-1)])]),_:1})]),s("li",null,[e(t,{to:"#summary"},{default:o(()=>[...n[6]||(n[6]=[a("Summary",-1)])]),_:1})])])]),n[15]||(n[15]=s("hr",null,null,-1)),e(r,{name:"Item 30: Define contracts with documentation",desc:"How do we express our library or module contracts and why are they so important.",url:"https://kt.academy/article/ek-contracts-documentation",logo:"https://kt.academy/logo.png",preview:"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2FEffectiveKotlin-Book%2Fpromotion%2Fcontracts_documentation.jpg&w=828&q=75"}),n[16]||(n[16]=s("figure",null,[s("img",{src:"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2FEffectiveKotlin-Book%2Fpromotion%2Fcontracts_documentation.jpg&w=828&q=75",alt:"",tabindex:"0",loading:"lazy"}),s("figcaption")],-1)),s("div",T,[n[14]||(n[14]=s("p",{class:"hint-container-title"},"Note",-1)),s("p",null,[n[10]||(n[10]=a("This is a chapter from the book ",-1)),s("a",x,[e(p,{icon:"fas fa-globe"}),n[7]||(n[7]=a("Effective Kotlin",-1))]),n[11]||(n[11]=a(". You can find it on ",-1)),s("a",D,[e(p,{icon:"fas fa-globe"}),n[8]||(n[8]=a("LeanPub",-1))]),n[12]||(n[12]=a(" or ",-1)),s("a",F,[e(p,{icon:"fa-brands fa-amazon"}),n[9]||(n[9]=a("Amazon",-1))]),n[13]||(n[13]=a(".",-1))])]),n[17]||(n[17]=m(`<p>Think again about the function to display a message from <em>Item 26: Use abstraction to protect code against changes</em>:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">fun</span> Context<span class="token punctuation">.</span><span class="token function">showMessage</span><span class="token punctuation">(</span></span>
<span class="line">   message<span class="token operator">:</span> String<span class="token punctuation">,</span></span>
<span class="line">   length<span class="token operator">:</span> MessageLength <span class="token operator">=</span> MessageLength<span class="token punctuation">.</span>LONG</span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">val</span> toastLength <span class="token operator">=</span> <span class="token keyword">when</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      SHORT <span class="token operator">-&gt;</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT</span>
<span class="line">      LONG <span class="token operator">-&gt;</span> Toast<span class="token punctuation">.</span>LENGTH_LONG</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> toastLength<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">enum</span> <span class="token keyword">class</span> MessageLength <span class="token punctuation">{</span> SHORT<span class="token punctuation">,</span> LONG <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We extracted the <code>showMessage</code> function to give ourselves the freedom to change how the message is displayed. However, this function is not well documented. Another developer might read its code and assume that this function always displays a toast. This is the opposite of what we wanted to achieve by naming this function <code>showMessage</code>, so in a way that does not suggest a concrete message type. To make our intention clear, it would be better to add a meaningful KDoc comment explaining what should be expected from this function.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token comment">/**</span>
<span class="line">* Universal way for the project to display a short</span>
<span class="line">* message to a user.</span>
<span class="line">* @param message The text that should be shown to</span>
<span class="line">* the user</span>
<span class="line">* @param length How long to display the message.</span>
<span class="line">*/</span></span>
<span class="line"><span class="token keyword">fun</span> Context<span class="token punctuation">.</span><span class="token function">showMessage</span><span class="token punctuation">(</span></span>
<span class="line">   message<span class="token operator">:</span> String<span class="token punctuation">,</span></span>
<span class="line">   duration<span class="token operator">:</span> MessageLength <span class="token operator">=</span> MessageLength<span class="token punctuation">.</span>LONG</span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">val</span> toastDuration <span class="token operator">=</span> <span class="token keyword">when</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      SHORT <span class="token operator">-&gt;</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT</span>
<span class="line">      LONG <span class="token operator">-&gt;</span> Toast<span class="token punctuation">.</span>LENGTH_LONG</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> toastDuration<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">enum</span> <span class="token keyword">class</span> MessageLength <span class="token punctuation">{</span> SHORT<span class="token punctuation">,</span> LONG <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In many cases, there are details that are not clearly inferred by the name at all. For instance, <em>powerset</em>, even though it is a well-defined mathematical concept, needs an explanation since it is not well known:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token comment">/**</span>
<span class="line">* Powerset returns a set of all subsets of the receiver</span>
<span class="line">* including itself and the empty set</span>
<span class="line">*/</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Collection<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">powerset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Set<span class="token operator">&lt;</span>Set<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token operator">=</span></span>
<span class="line">   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">setOf</span><span class="token punctuation">(</span><span class="token function">emptySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">   <span class="token keyword">else</span> <span class="token function">take</span><span class="token punctuation">(</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">       <span class="token punctuation">.</span><span class="token function">powerset</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">       <span class="token punctuation">.</span><span class="token function">let</span> <span class="token punctuation">{</span> it <span class="token operator">+</span> it<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it <span class="token operator">+</span> <span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Notice that this description gives us some freedom as it does not specify the order of these elements. As a user, we should not depend on how these elements are ordered. The implementation hidden behind this abstraction can be optimized without changing how this function looks from the outside:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line">       <span class="token comment">/**</span>
<span class="line">* Powerset returns a set of all subsets of the receiver</span>
<span class="line">* including itself and empty set</span>
<span class="line">*/</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Collection<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">powerset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Set<span class="token operator">&lt;</span>Set<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token operator">=</span></span>
<span class="line">     <span class="token function">powerset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">setOf</span><span class="token punctuation">(</span><span class="token function">setOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">tailrec</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">powerset</span><span class="token punctuation">(</span></span>
<span class="line">   left<span class="token operator">:</span> Collection<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">   acc<span class="token operator">:</span> Set<span class="token operator">&lt;</span>Set<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> Set<span class="token operator">&lt;</span>Set<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">when</span> <span class="token punctuation">{</span></span>
<span class="line">  left<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> acc</span>
<span class="line">  <span class="token keyword">else</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">     <span class="token keyword">val</span> head <span class="token operator">=</span> left<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">     <span class="token keyword">val</span> tail <span class="token operator">=</span> left<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">     <span class="token function">powerset</span><span class="token punctuation">(</span>tail<span class="token punctuation">,</span> acc <span class="token operator">+</span> acc<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it <span class="token operator">+</span> head <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The general problem is that <strong>when a behavior is not documented and an element name is not clear, developers will depend on the current implementation instead of on the abstraction we intended to create</strong>. We solve this problem by describing the behavior that can be expected.</p><hr><h2 id="contracts" tabindex="-1"><a class="header-anchor" href="#contracts"><span>Contracts</span></a></h2><p>Whenever we describe a behavior, users treat it as a promise and on this basis they adjust their expectations. We call any such expected behavior a contract of an element. Just like in a real-life contract, the other side expects us to honor it. The same is true here: users will expect us to honor this contract once it is stable (<em>Item 27: Specify API stability</em>).</p><p>At this point, defining a contract might sound scary, but actually it is great for both sides. <strong>When a contract is well specified, creators do not need to worry about how the class is used, and users do not need to worry about how something is implemented under the hood.</strong> Users can rely on this contract without knowing anything about the actual implementation. For creators, a contract gives the freedom to change everything as long as the contract is satisfied. <strong>Both users and creators depend on the abstractions defined in the contract, therefore they can work independently.</strong> Everything will work perfectly fine as long as the contract is respected. This is reassurance and freedom for both sides.</p><p>What if we don’t define a contract? <strong>Without users knowing what they can and cannot do, they’ll depend on implementation details instead. A creator who doesn’t know what users depend on would be either blocked or would risk breaking users implementations.</strong> As you can see, it is important to define a contract.</p><hr><h2 id="defining-a-contract" tabindex="-1"><a class="header-anchor" href="#defining-a-contract"><span>Defining a contract</span></a></h2><p>How do we define a contract? There are various ways, including:</p><ul><li><strong>Names</strong> - when a name is connected to a more general concept, we expect this element to be consistent with this concept. For instance, when you see the <code>sum</code> method, you don’t need to read its comment to know how it will behave. This is because summation is a well-defined mathematical concept.</li><li><strong>Comments and documentation</strong>: this is the most powerful way as it can describe everything that is needed.</li><li><strong>Types</strong> - Types say a lot about objects. Each type specifies a set of often well-defined methods, and some types also have set-up responsibilities in their documentation. When we see a function, information about the return type and argument types are very meaningful.</li></ul><hr><h2 id="do-we-need-comments" tabindex="-1"><a class="header-anchor" href="#do-we-need-comments"><span>Do we need comments?</span></a></h2><p>Looking back, it is amazing to see how opinions in the community fluctuate. When Java was still young, there was a very popular concept called literate programming that suggested explaining everything in comments<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup>. A decade later, comments are widely criticized and many say that we should omit them completely and concentrate on writing readable code instead (I believe that the most influential book that suggested that was the Clean Code by Robert C. Martin).</p><p>No extreme is healthy. I absolutely agree that we should first concentrate on writing readable code. However, it should also be understood that comments before elements can describe them at a higher level and define their contracts. <strong>Additionally, comments are now often used to automatically generate documentation, which generally is treated as a source of truth in projects.</strong></p><p>Sure, we often do not need comments. For instance, many functions are self-explanatory and don’t need any special description. We might, for instance, assume that a product is a clear mathematical concept that is known by programmers therefore no comments are needed:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">fun</span> List<span class="token operator">&lt;</span>Int<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">fold</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> acc<span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> acc <span class="token operator">*</span> i <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Obvious comments are noise that only distracts us. Do not write comments that only describe what is clearly expressed by a function name and parameters. The following example demonstrates an unnecessary comment because its meaning can be inferred from the method&#39;s name and parameter type:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token comment">// Product of all numbers in a list</span></span>
<span class="line"><span class="token keyword">fun</span> List<span class="token operator">&lt;</span>Int<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">fold</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> acc<span class="token punctuation">,</span> i <span class="token operator">-&gt;</span> acc <span class="token operator">*</span> i <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>I also agree that when we just need to organize our code, instead of writing comments in the implementation, we should rather extract a function. Take a look at the example below:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">fun</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// Update users</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span>user <span class="token keyword">in</span> users<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      user<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// Update books</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span>book <span class="token keyword">in</span> books<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">updateBook</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>update</code> function is clearly composed of extractable parts, and comment suggests that these parts can be described with a different explanation. Therefore, it is better to extract these parts into separate abstractions such as methods, whose names should be clear enough to explain what they mean (just like in <em>Item 25: Each function should be written in terms of a single level of abstraction</em>).</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">fun</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">updateUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">updateBooks</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">updateBooks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span>book <span class="token keyword">in</span> books<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">updateBook</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">updateUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span>user <span class="token keyword">in</span> users<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      user<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>However, comments are often useful and important. To find examples, take a look at nearly any public function from the Kotlin standard library. They have well-defined contracts that give a lot of freedom. For instance, take a look at the <code>listOf</code> function:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token comment">/**</span>
<span class="line">* Returns a new read-only list of given elements.</span>
<span class="line">* The returned list is serializable (JVM).</span>
<span class="line">* @sample samples.collections.Collections.Lists.</span>
<span class="line">readOnlyList</span>
<span class="line">*/</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">listOf</span><span class="token punctuation">(</span><span class="token keyword">vararg</span> elements<span class="token operator">:</span> T<span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token operator">=</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>elements<span class="token punctuation">.</span>size <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> elements<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">else</span> <span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It only promises to return a <code>List</code> that is read-only and serializable on JVM. Nothing else. The list does not need to be immutable. No concrete class is promised. This contract is minimalistic but it’s enough for the needs of most Kotlin developers. You can also see that it points to sample uses, which are also useful when we are learning how to use an element.</p><hr><h2 id="the-kdoc-format" tabindex="-1"><a class="header-anchor" href="#the-kdoc-format"><span>The KDoc format</span></a></h2><p>When we document functions using comments, the official format in which we present these comments is called KDoc. All KDoc comments start with <code>/**</code> and end with <code>*/</code>, and all internal lines generally start with <code>*</code>. Descriptions there are written in KDoc markdown.</p><p>The structure of a KDoc comment is the following:</p><ul><li>The first paragraph of the documentation text is the summary description of the element.</li><li>The second part is the detailed description.</li><li>Every next line begins with a tag. These tags are used to reference an element to describe it.</li></ul><p>Here are the supported tags:</p><ul><li><code>@param</code>: Documents a value parameter of a function or a type parameter of a class, property or function.</li><li><code>@return</code>: Documents the return value of a function.</li><li><code>@constructor</code>: Documents the primary constructor of a class.</li><li><code>@receiver</code>: Documents the receiver of an extension function.</li><li><code>@property</code>: Documents the property of the specified class. Used for properties defined in the primary constructor.</li><li><code>@throws</code>, <code>@exception</code>: - Documents an exception which can be thrown by a method.</li><li><code>@sample</code>: Embeds the body of the specified function into the documentation for the current element in order to show an example of how the element could be used.</li><li><code>@see</code>: Adds a link to the specified class or method.</li><li><code>@author</code>: Specifies the author of the documented element.</li><li><code>@since</code>: Specifies the version of the software in which the documented element was introduced.</li><li><code>@suppress</code>: Excludes the element from the generated documentation. Can be used for elements which are not part of the official API of a module but still have to be visible externally.</li></ul><p>In both descriptions and in text that describes tags we can link classes, methods, properties or parameters. Links are in square brackets, or double square brackets when we want to have a different description than the name of the linked element.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token comment">/**</span>
<span class="line"> * This is an example descriptions linking to [element1],</span>
<span class="line"> * [com.package.SomeClass.element2] and</span>
<span class="line"> * [this element with custom description][element3]</span>
<span class="line"> */</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>All these tags will be understood by Kotlin documentation generation tools. The official one is called Dokka. They generate documentation files that can be published online and presented to outside users. Here is an example documentation with a shortened description:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token comment">/**</span>
<span class="line"> * Immutable tree data structure.</span>
<span class="line"> *</span>
<span class="line"> * Class represents an immutable tree with from 1 to</span>
<span class="line"> * an infinite number of elements. In the tree we hold</span>
<span class="line"> * elements on each node, and nodes can have left and</span>
<span class="line"> * right subtrees...</span>
<span class="line"> *</span>
<span class="line"> * @param T the type of elements this tree holds.</span>
<span class="line"> * @property value the value kept in this node of the tree.</span>
<span class="line"> * @property left the left subtree.</span>
<span class="line"> * @property right the right subtree.</span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">class</span> Tree<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">(</span></span>
<span class="line">   <span class="token keyword">val</span> value<span class="token operator">:</span> T<span class="token punctuation">,</span></span>
<span class="line">   <span class="token keyword">val</span> left<span class="token operator">:</span> Tree<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span></span>
<span class="line">   <span class="token keyword">val</span> right<span class="token operator">:</span> Tree<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span></span>
<span class="line"><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">   <span class="token comment">/**</span>
<span class="line">   * Creates a new tree based on the current but with</span>
<span class="line">   * [element] added.</span>
<span class="line">   * @return newly created tree with additional element.</span>
<span class="line">   */</span></span>
<span class="line">   <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token function">plus</span><span class="token punctuation">(</span>element<span class="token operator">:</span> T<span class="token punctuation">)</span><span class="token operator">:</span> Tree <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Notice that not everything needs to be described. The best documentation is short and precisely describes what might be unclear.</p><hr><h2 id="the-type-system-and-expectations" tabindex="-1"><a class="header-anchor" href="#the-type-system-and-expectations"><span>The type system and expectations</span></a></h2><p>Type hierarchy is an important source of information about an object. An interface is more than just a list of methods we promise to implement. Classes and interfaces can also have some expectations. If a class promises something, all of its subclasses should guarantee that too. This principle is known as <em>the Liskov substitution principle</em>, and it is one of the most important rules in <em>object-oriented programming</em>. It is generally translated to &quot;if S is a subtype of T, then objects of type T may be replaced with objects of type S without altering any of the desirable properties of the program&quot;. A simple explanation of why this is important is that every class can be used as a superclass; so, if a class does not behave as we expect its superclass to behave, we might end up with unexpected failure. In programming, children should always satisfy parents&#39; contracts.</p><p>One important implication of this rule is that we should properly specify contracts for open functions. For instance, coming back to our car metaphor, we could represent a car in our code using the following interface:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">interface</span> Car <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">fun</span> <span class="token function">setWheelPosition</span><span class="token punctuation">(</span>angle<span class="token operator">:</span> Float<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">fun</span> <span class="token function">setBreakPedal</span><span class="token punctuation">(</span>pressure<span class="token operator">:</span> Double<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">fun</span> <span class="token function">setGasPedal</span><span class="token punctuation">(</span>pressure<span class="token operator">:</span> Double<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> GasolineCar<span class="token operator">:</span> Car <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> GasCar<span class="token operator">:</span> Car <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> ElectricCar<span class="token operator">:</span> Car <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The problem with this interface is that it leaves a lot of questions. What does <code>angle</code> in the <code>setWheelPosition</code> function mean? In which units is it measured? What if it is not clear for someone what the gas and brake pedals do? People using instances of type <code>Car</code> need to know how to use them, and all the classes that implement this interface should behave similarly when they are used as a <code>Car</code>. We can address these concerns with documentation:</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">interface</span> Car <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">/**</span>
<span class="line">   * Changes car direction.</span>
<span class="line">   *</span>
<span class="line">   * @param angle Represents position of wheels in</span>
<span class="line">   * radians relatively to car axis. 0 means driving</span>
<span class="line">   * straight, pi/2 means driving maximally right,</span>
<span class="line">   * -pi/2 maximally left.</span>
<span class="line">   * Value needs to be in (-pi/2, pi/2)</span>
<span class="line">   */</span></span>
<span class="line">  <span class="token keyword">fun</span> <span class="token function">setWheelPosition</span><span class="token punctuation">(</span>angle<span class="token operator">:</span> Float<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">/**</span>
<span class="line">   * Decelerates vehicle speed until 0.</span>
<span class="line">   *</span>
<span class="line">   * @param pressure The percentage of brake pedal use.</span>
<span class="line">   * Number from 0 to 1 where 0 means not using break</span>
<span class="line">   * at all, and 1 means maximal pedal pedal use.</span>
<span class="line">   */</span></span>
<span class="line">  <span class="token keyword">fun</span> <span class="token function">setBreakPedal</span><span class="token punctuation">(</span>pressure<span class="token operator">:</span> Double<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">/**</span>
<span class="line">   * Accelerates vehicle speed until max speed possible</span>
<span class="line">   * for the user.</span>
<span class="line">   *</span>
<span class="line">   * @param pressure The percentage of gas pedal use.</span>
<span class="line">   * Number from 0 to 1 where 0 means not using gas at</span>
<span class="line">   * all, and 1 means maximal gas pedal use.</span>
<span class="line">   */</span></span>
<span class="line">  <span class="token keyword">fun</span> <span class="token function">setGasPedal</span><span class="token punctuation">(</span>pressure<span class="token operator">:</span> Double<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, all cars have a defined standard that describes how they all should behave.</p><p>Most classes in the stdlib and in popular libraries have well-defined and well-described contracts and expectancies for their children. We should also define contracts for our elements because they will make these interfaces truly useful. They will give us the freedom to use classes that implement these interfaces in the way their contract guarantees.</p><hr><h2 id="leaking-implementation" tabindex="-1"><a class="header-anchor" href="#leaking-implementation"><span>Leaking implementation</span></a></h2><p>Implementation details always leak. In cars, different kinds of engines behave a bit differently. We are still able to drive all cars, but we can feel a difference. This is fine even though it is not described in the contract.</p><p>In programming languages, implementation details leak as well. For instance, calling a function using reflection works, but it is significantly slower than a normal function call (unless it is optimized by the compiler). We will see more examples in the chapter about performance optimization. As long as a language works as it promises, everything is fine. We just need to remember and apply good practices.</p><p>In our abstractions, implementations will also leak, but we should still protect them as much as we can. We protect them by encapsulation, which can be described as &quot;You can do what I allow, and nothing more&quot;. The more we encapsulate our classes and functions, the more freedom we have inside them because we don’t need to think about how someone else might depend on our implementation.</p><hr><h2 id="summary" tabindex="-1"><a class="header-anchor" href="#summary"><span>Summary</span></a></h2><p>When we define an element, especially part of an external API, we should define a contract. We do this using names, documentation, comments, and types. The contract specifies what these elements’ expectations are. It can also describe how an element should be used.</p><p>A contract gives users confidence about how elements behave now and will behave in the future; it gives creators the freedom to change what is not specified in the contract. The contract is a kind of agreement, and it works well as long as both sides respect it.</p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p>Read more about this concept in the book Literate Programming by Donald Knuth. <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li></ol></section>`,65))])}const A=u(f,[["render",I]]),C=JSON.parse('{"path":"/kt.academy/ek-contracts-documentation.html","title":"Item 30: Define contracts with documentation","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Item 30: Define contracts with documentation","description":"Article(s) > Item 30: Define contracts with documentation","icon":"iconfont icon-kotlin","category":["Kotlin","Article(s)"],"tag":["blog","kt.academy","kotlin","kdoc"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Item 30: Define contracts with documentation\\",\\"image\\":[\\"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2FEffectiveKotlin-Book%2Fpromotion%2Fcontracts_documentation.jpg&w=828&q=75\\"],\\"datePublished\\":\\"2024-07-08T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Marcin Moskała\\",\\"url\\":\\"https://kt.academy/user/marcinmoskala\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/kt.academy/ek-contracts-documentation.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"Item 30: Define contracts with documentation"}],["meta",{"property":"og:description","content":"Article(s) > Item 30: Define contracts with documentation"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2FEffectiveKotlin-Book%2Fpromotion%2Fcontracts_documentation.jpg&w=828&q=75"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2FEffectiveKotlin-Book%2Fpromotion%2Fcontracts_documentation.jpg&w=828&q=75"}],["meta",{"name":"twitter:image:alt","content":"Item 30: Define contracts with documentation"}],["meta",{"property":"article:author","content":"Marcin Moskała"}],["meta",{"property":"article:tag","content":"kdoc"}],["meta",{"property":"article:tag","content":"kotlin"}],["meta",{"property":"article:tag","content":"kt.academy"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2024-07-08T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Item 30: Define contracts with documentation"},{"property":"og:description","content":"Item 30: Define contracts with documentation"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/kt.academy/ek-contracts-documentation.html"}]],"prev":"/programming/java/articles/README.md","date":"2024-07-08T00:00:00.000Z","isOriginal":false,"author":[{"name":"Marcin Moskała","url":"https://kt.academy/user/marcinmoskala"}],"cover":"https://kt.academy/_next/image?url=https%3A%2F%2Fmarcinmoskala.com%2FEffectiveKotlin-Book%2Fpromotion%2Fcontracts_documentation.jpg&w=828&q=75"},"git":{},"readingTime":{"minutes":9.52,"words":2855},"filePathRelative":"kt.academy/ek-contracts-documentation.md","copyright":{"author":"Marcin Moskała"}}');export{A as comp,C as data};
