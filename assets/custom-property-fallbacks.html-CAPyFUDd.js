import{_ as v}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as k,d as n,f as e,b as r,a as b,t as g,n as d,g as m,w as o,e as a,r as i,o as f}from"./app-BItykJLQ.js";const y={},w={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},C={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},S={class:"table-of-contents"},x={href:"https://w3.org/TR/css-variables/#animation-tainted",target:"_blank",rel:"noopener noreferrer"},P={class:"hint-container note"},j={href:"https://css-tricks.com/the-surprising-behavior-of-important-in-css-custom-property-values/",target:"_blank",rel:"noopener noreferrer"},F={href:"https://github.com/w3c/csswg-drafts/issues/10443",target:"_blank",rel:"noopener noreferrer"},T={href:"https://github.com/w3c/csswg-drafts/issues/5055",target:"_blank",rel:"noopener noreferrer"},A={class:"hint-container info"};function M(c,s){const u=i("VPCard"),t=i("router-link"),l=i("SiteInfo"),p=i("VPIcon"),h=i("CodePen");return f(),k("div",null,[n("h1",w,[n("a",C,[n("span",null,g(c.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),e(u,d(m({title:"CSS > Article(s)",desc:"Article(s)",link:"/programming/css/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),n("nav",S,[n("ul",null,[n("li",null,[e(t,{to:"#var-fallbacks"},{default:o(()=>[...s[0]||(s[0]=[a("var() Fallbacks",-1)])]),_:1})]),n("li",null,[e(t,{to:"#fallback-declarations"},{default:o(()=>[...s[1]||(s[1]=[a("Fallback Declarations",-1)])]),_:1})]),n("li",null,[e(t,{to:"#what-we-can-do-instead"},{default:o(()=>[...s[2]||(s[2]=[a("What We Can Do Instead",-1)])]),_:1}),n("ul",null,[n("li",null,[e(t,{to:"#property"},{default:o(()=>[...s[3]||(s[3]=[a("@property",-1)])]),_:1})]),n("li",null,[e(t,{to:"#supports"},{default:o(()=>[...s[4]||(s[4]=[a("@supports",-1)])]),_:1})])])]),n("li",null,[e(t,{to:"#the-future"},{default:o(()=>[...s[5]||(s[5]=[a("The Future",-1)])]),_:1})])])]),s[28]||(s[28]=n("hr",null,null,-1)),e(l,{name:"Custom Property Fallbacks",desc:"This post starts with quite a tricky little quiz about what a color value resolves to be.",url:"https://frontendmasters.com/blog/custom-property-fallbacks/",logo:"https://frontendmasters.com/favicon.ico",preview:"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/5257"}),s[29]||(s[29]=r(`<p>Look at this CSS and take a guess what color our text will be. No tricks, this is the only relevant code:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">:root</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--color</span><span class="token punctuation">:</span> notacolor<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--color<span class="token punctuation">,</span> blue<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Perhaps surprisingly, the answer is the default text color, usually black. Let‚Äôs figure out why that‚Äôs the case and how to write a fallback that works.</p><hr><h2 id="var-fallbacks" tabindex="-1"><a class="header-anchor" href="#var-fallbacks"><span><code>var()</code> Fallbacks</span></a></h2><p>The value <code>blue</code> seems a likely candidate to be our color, doesn‚Äôt it? After all, we often call the 2nd parameter of <code>var()</code> its ‚Äúfallback‚Äù value. However, this type of fallback is only used in the following circumstances:</p>`,6)),n("ul",null,[s[9]||(s[9]=n("li",null,"The custom property isn‚Äôt defined.",-1)),s[10]||(s[10]=n("li",null,[a("The custom property‚Äôs value is the "),n("code",null,"initial"),a(" keyword.")],-1)),n("li",null,[s[7]||(s[7]=a("The custom property is ",-1)),n("a",x,[e(p,{icon:"iconfont icon-w3c"}),s[6]||(s[6]=a("animation-tainted",-1))]),s[8]||(s[8]=a(" and is used in an animation property.",-1))])]),s[30]||(s[30]=r(`<p><em>and</em>‚Ä¶</p><ul><li>The custom property isn‚Äôt registered with <code>@property</code>.</li></ul><p>Since a registered custom property <em>must</em> be given an initial value, it‚Äôll always have a valid value and will <em>never</em> use its fallback.</p><p>Our custom property is defined, not animated tainted, and its value isn‚Äôt a keyword, so we can throw away <code>blue</code> and keep looking.</p><hr><h2 id="fallback-declarations" tabindex="-1"><a class="header-anchor" href="#fallback-declarations"><span>Fallback Declarations</span></a></h2><p>Usually in CSS, we can rely on the cascade to fallback to a previous valid value, leading to a common pattern where we declare the property twice:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span>
<span class="line"><span class="token property">overflow</span><span class="token punctuation">:</span> clip<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Browsers that don‚Äôt support the <code>clip</code> keyword will discard the entire declaration and use <code>hidden</code> instead.</p><p>Unfortunately, custom properties don‚Äôt work like this.</p><p>When parsing a custom property or its matching <code>var()</code> function, the browser doesn‚Äôt know if it‚Äôs valid until it comes time to compute its value. So instead they are treated as <em>always</em> valid, and any previous declarations get discarded.</p>`,11)),n("div",P,[s[14]||(s[14]=n("p",{class:"hint-container-title"},"Note",-1)),n("p",null,[s[12]||(s[12]=a("If you want to prevent a custom property from being overwritten, you‚Äôll have to ",-1)),n("a",j,[e(p,{icon:"fas fa-globe"}),s[11]||(s[11]=a("mark it as important",-1))]),s[13]||(s[13]=a(".",-1))])]),s[31]||(s[31]=r(`<p>That means <code>--color: green;</code> gets discarded immediately upon discovering <code>--color: notacolor;</code>, and <code>color: red;</code> is discarded when we get to <code>color: var(--notacolor, blue);</code>.</p><p>In the end, our CSS computes to:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token property">color</span><span class="token punctuation">:</span> notacolor<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Unsurprisingly, this isn‚Äôt valid, and that‚Äôs why we get black as our color.</p>`,4)),e(h,{user:"matthewmorete","slug-hash":"wBvzxab",title:"Custom Property Broken Fallbacks","default-tab":["css","result"],theme:c.dark},null,8,["theme"]),s[32]||(s[32]=r(`<hr><h2 id="what-we-can-do-instead" tabindex="-1"><a class="header-anchor" href="#what-we-can-do-instead"><span>What We Can Do Instead</span></a></h2><p>That all sounds bad but we actually have several options for writing fallbacks that work.</p><h3 id="property" tabindex="-1"><a class="header-anchor" href="#property"><span><code>@property</code></span></a></h3><p>As mentioned before, if a registered custom property is invalid, it‚Äôll always use its initial-value, which means we can use that as our fallback:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@property</span> --color</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&#39;&lt;color&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> purple<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">:root</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--color</span><span class="token punctuation">:</span> notacolor<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--color<span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Exactly what we want, though:</p><ul><li>We can only define a single fallback for the entire document (which can be good enough depending on how your custom properties are organised).</li><li>The intent isn‚Äôt very obvious, registering a property is a roundabout way of setting a fallback.</li></ul><p>If that‚Äôs not a problem for you and/or you‚Äôre registering your properties anyway, this is a great option.</p><h3 id="supports" tabindex="-1"><a class="header-anchor" href="#supports"><span><code>@supports</code></span></a></h3><p>Using <code>@supports</code> lets us check our value is valid before declaring it and that gives us even more flexibility in how we define our fallbacks. Let‚Äôs look at two ways to use it:</p><p>Set a safe value first, and then inside an <code>@supports</code> block we can redeclare the property:</p><div class="language-scss line-numbers-mode" data-highlighter="prismjs" data-ext="scss"><pre><code class="language-scss"><span class="line"><span class="token selector">:root </span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@supports</span> <span class="token punctuation">(</span><span class="token property">color</span><span class="token punctuation">:</span> notacolor<span class="token punctuation">)</span></span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token selector">:root </span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">--color</span><span class="token punctuation">:</span> notacolor<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then we can just use it anywhere we like, without having to think about the fallback:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">p</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--color<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We can set it and forget it, confident that when our value isn‚Äôt supported we‚Äôll still have our previous declaration to fall back on. 9 out of 10 times this is what I reach for.</p><p>Alternatively, let‚Äôs skip setting a safe value, and only define the property inside <code>@supports</code>:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@supports</span> <span class="token punctuation">(</span><span class="token property">color</span><span class="token punctuation">:</span> notacolor<span class="token punctuation">)</span></span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token selector">:root</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">--color</span><span class="token punctuation">:</span> notacolor<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Where‚Äôs our fallback? Well, since our property only gets declared when it‚Äôs supported, we can use the 2nd parameter of <code>var()</code> to write our fallback inline:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">p</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--color<span class="token punctuation">,</span> red<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you find yourself wanting to use different fallbacks for the same custom property, this could be a better option.</p><hr><h2 id="the-future" tabindex="-1"><a class="header-anchor" href="#the-future"><span>The Future</span></a></h2><p>Eventually, we‚Äôll have even more options for dealing with invalid values.</p><p>New CSS goodies like like the keyword <code>revert-rule</code> and the <code>first-valid()</code> function will let us do away with <code>@supports</code> and write our fallbacks wherever we want:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">:root</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">/* Multiple inline fallbacks when declaring the property */</span></span>
<span class="line">  <span class="token property">--color</span><span class="token punctuation">:</span> <span class="token function">first-valid</span><span class="token punctuation">(</span>notacolor<span class="token punctuation">,</span> maybeacolor<span class="token punctuation">,</span> red<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">p</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">/* Fallback to a different rule when using the variable */</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">first-valid</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--color<span class="token punctuation">)</span><span class="token punctuation">,</span> revert-rule<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can follow their progress on GitHub:</p>`,27)),n("ul",null,[n("li",null,[n("a",F,[s[15]||(s[15]=a("Discussion (",-1)),e(p,{icon:"iconfont icon-github"}),s[16]||(s[16]=n("code",null,"w3c/csswg-drafts",-1)),s[17]||(s[17]=a(")",-1))]),s[18]||(s[18]=a(" resulting in the ",-1)),s[19]||(s[19]=n("code",null,"revert-rule",-1)),s[20]||(s[20]=a(" keyword resolution.",-1))]),n("li",null,[n("a",T,[s[21]||(s[21]=a("Discussion (",-1)),e(p,{icon:"iconfont icon-github"}),s[22]||(s[22]=n("code",null,"w3c/csswg-drafts",-1)),s[23]||(s[23]=a(")",-1))]),s[24]||(s[24]=a(" resulting in ",-1)),s[25]||(s[25]=n("code",null,"first-valid()",-1)),s[26]||(s[26]=a(" resolution.",-1))])]),n("div",A,[s[27]||(s[27]=n("p",{class:"hint-container-title"},"Further Learning",-1)),e(l,{name:"Master CSS Custom Properties (CSS Variables)",desc:"Create reusable components without any JavaScript dependencies needed - with only vanilla CSS! Master CSS custom properties AKA CSS variables. ",url:"https://frontendmasters.com/courses/css-variables/",logo:"https://frontendmasters.com/favicon-16x16.png",preview:"https://static.frontendmasters.com/assets/courses/2021-11-09-css-variables/posterframe.jpg"}),e(l,{name:"CSS Custom Properties Fail Without Fallback ¬∑ Matthias Ott",desc:"Matthias Ott is an independent user experience designer and developer from Stuttgart, Germany. Besides design practice he teaches Interface Prototyping at the Muthesius Academy of Fine Arts and Design, Kiel.",url:"https://matthiasott.com/notes/css-custom-properties-fail-without-fallback/",logo:"https://matthiasott.com//favicon.ico?v=00rKnA7O762",preview:"https://matthiasott.com//android-chrome-384x384.png?v=00rKnA7O762"}),e(l,{name:"CSS Custom Properties Guide | CSS-Tricks",desc:"Everything important and useful to know about CSS Custom Properties. Like that they are often referred to as ‚ÄùCSS Variables‚Äù but that's not their real name.",url:"https://css-tricks.com/a-complete-guide-to-custom-properties/",logo:"https://i0.wp.com/css-tricks.com/wp-content/uploads/2021/07/star.png?fit=180%2C180&ssl=1",preview:"https://i0.wp.com/css-tricks.com/wp-content/uploads/2019/09/custom-properties-code.png"}),e(l,{name:"Josh W. Comeau (@joshwcomeau.com)",desc:"üå† The linear() timing function allows us to embed lush spring physics inside vanilla CSS. It‚Äôs one of my favourite modern features. But: providing a fallback for older browsers has been pretty painful. I just discovered a lovely pattern for this. ‚ú®Here‚Äôs the code. Description in thread. üßµ",url:"https://bsky.app/profile/joshwcomeau.com/post/3li3r6i7dac2w/",logo:"https://web-cdn.bsky.app/static/favicon-16x16.png",preview:"https://cdn.bsky.app/img/feed_thumbnail/plain/did:plc:zivbusxwcsom5o6mf7kljzms/bafkreibrhjiu6ufbtj33o26kscopineht7l5cmmpuczysmr5fipfkycktu@jpeg"})]),b(" TODO: add ARTICLE CARD "),e(u,d(m({title:"Custom Property Fallbacks",desc:"This post starts with quite a tricky little quiz about what a color value resolves to be.",link:"https://chanhi2000.github.io/bookshelf/frontendmasters.com/custom-property-fallbacks.html",logo:"https://frontendmasters.com/favicon.ico",background:"rgba(188,75,52,0.2)"})),null,16)])}const V=v(y,[["render",M]]),W=JSON.parse('{"path":"/frontendmasters.com/custom-property-fallbacks.html","title":"Custom Property Fallbacks","lang":"en-US","frontmatter":{"lang":"en-US","title":"Custom Property Fallbacks","description":"Article(s) > Custom Property Fallbacks","icon":"fa-brands fa-css3-alt","category":["CSS","Article(s)"],"tag":["blog","frontendmasters.com","css"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Custom Property Fallbacks\\",\\"image\\":[\\"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/5257\\"],\\"datePublished\\":\\"2025-02-28T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Matthew Morete\\",\\"url\\":\\"https://frontendmasters.com/blog/author/matthewmorete/\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/frontendmasters.com/custom-property-fallbacks.html"}],["meta",{"property":"og:site_name","content":"üìöBookshelf"}],["meta",{"property":"og:title","content":"Custom Property Fallbacks"}],["meta",{"property":"og:description","content":"Article(s) > Custom Property Fallbacks"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/5257"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/5257"}],["meta",{"name":"twitter:image:alt","content":"Custom Property Fallbacks"}],["meta",{"property":"article:author","content":"Matthew Morete"}],["meta",{"property":"article:tag","content":"css"}],["meta",{"property":"article:tag","content":"frontendmasters.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2025-02-28T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Custom Property Fallbacks"},{"property":"og:description","content":"Custom Property Fallbacks"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/frontendmasters.com/custom-property-fallbacks.html"}]],"prev":"/programming/css/articles/README.md","date":"2025-02-28T00:00:00.000Z","isOriginal":false,"author":[{"name":"Matthew Morete","url":"https://frontendmasters.com/blog/author/matthewmorete/"}],"cover":"https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/5257"},"git":{},"readingTime":{"minutes":4.23,"words":1270},"filePathRelative":"frontendmasters.com/custom-property-fallbacks.md","copyright":{"author":"Matthew Morete"}}');export{V as comp,W as data};
