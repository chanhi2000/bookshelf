import{_ as m}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as h,d as s,f as a,b as g,t as v,n as c,g as i,w as t,e,r as l,o as y}from"./app-BVguHYKu.js";const b="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/07-Context.Source.png",f="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/08-Added-accounts-to-the-owner-type.gif",w="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/09-Enumeration-type.png",q="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/10-Added-enumeration-to-the-query.gif",A="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/11-Not-optimized-query.png",x="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/12-Optimized-query.png",G="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/13-Arguments-and-Error-Handling.gif",T="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/14-Aliases.gif",Q="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/15-Fragments.gif",L="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/16-Named-Queries.gif",I="/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/17-Directives.gif",z={},O={id:"frontmatter-title-관련",tabindex:"-1"},E={class:"header-anchor",href:"#frontmatter-title-관련"},D={class:"table-of-contents"},C={class:"hint-container info"},_={href:"https://github.com/CodeMazeBlog/graphql-series/tree/graphql-queries",target:"_blank",rel:"noopener noreferrer"};function j(d,n){const o=l("VPCard"),p=l("router-link"),r=l("SiteInfo"),u=l("RouteLink"),k=l("VPIcon");return y(),h("div",null,[s("h1",O,[s("a",E,[s("span",null,v(d.$frontmatter.title)+" 관련",1)])]),a(o,c(i({title:"C# > Article(s)",desc:"Article(s)",link:"/programming/cs/articles/README.md",logo:"https://chanhi2000.github.io/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),a(o,c(i({title:"GraphQL > Article(s)",desc:"Article(s)",link:"/data-science/graphql/articles/README.md",logo:"https://chanhi2000.github.io/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",D,[s("ul",null,[s("li",null,[a(p,{to:"#creating-complex-types-for-graphql-queries"},{default:t(()=>n[0]||(n[0]=[e("Creating Complex Types for GraphQL Queries")])),_:1,__:[0]})]),s("li",null,[a(p,{to:"#adding-enumerations-in-graphql-queries"},{default:t(()=>n[1]||(n[1]=[e("Adding Enumerations in GraphQL Queries")])),_:1,__:[1]})]),s("li",null,[a(p,{to:"#implementing-a-cache-in-the-graphql-queries-with-data-loader"},{default:t(()=>n[2]||(n[2]=[e("Implementing a Cache in the GraphQL Queries with Data Loader")])),_:1,__:[2]})]),s("li",null,[a(p,{to:"#using-arguments-in-queries-and-handling-errors"},{default:t(()=>n[3]||(n[3]=[e("Using Arguments in Queries and Handling Errors")])),_:1,__:[3]})]),s("li",null,[a(p,{to:"#aliases-fragments-named-queries-variables-directives"},{default:t(()=>n[4]||(n[4]=[e("Aliases, Fragments, Named Queries, Variables, Directives")])),_:1,__:[4]})]),s("li",null,[a(p,{to:"#conclusion"},{default:t(()=>n[5]||(n[5]=[e("Conclusion")])),_:1,__:[5]})])])]),n[20]||(n[20]=s("hr",null,null,-1)),a(r,{name:"Advanced GraphQL Queries, Error Handling, Data Loader",desc:"In this article we are going to learn how to write advanced GraphQL Queries, how to handle erros and optimize queries by using data loader.",url:"https://code-maze.com/advanced-graphql-queries/",logo:"/assets/image/code-maze.com/favicon.png",preview:"/assets/image/code-maze.com/advanced-graphql-queries/banner.png"}),s("p",null,[n[7]||(n[7]=e("In the ")),a(u,{to:"/code-maze.com/graphql-aspnetcore-basics.html"},{default:t(()=>n[6]||(n[6]=[e("previous article")])),_:1,__:[6]}),n[8]||(n[8]=e(", we have learned about the GraphQL integration with the ASP.NET Core application. We have created our first GraphQL query and fetched some data from the server-side application."))]),n[21]||(n[21]=s("p",null,"But we won’t stop on just basic queries. In this article, we are going to learn how to write advanced GraphQL queries and while doing that, we are going to show you how to handle errors and how to cache data inside a query.",-1)),n[22]||(n[22]=s("p",null,"Furthermore, we are going to learn how to enhance our query (from a client side) with the named queries, aliases, arguments, and fragments.",-1)),a(o,c(i({title:"Getting Started with GraphQL in ASP.NET Core",desc:"In this article we are going to learn about GraphQL in ASP.NET Core integration, how to start with the project and how to create a first GraphQL query.",link:"/code-maze.com/graphql-aspnetcore-basics.md",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16),n[23]||(n[23]=s("ul",null,[s("li",null,"Advanced GraphQL Queries, Error Handling, Data Loader (Current article)")],-1)),a(o,c(i({title:"GraphQL Mutations in ASP.NET Core",desc:"In this article, we are going to learn about GraphQL Mutations. We will learn how to create POST, PUT and DELETE mutations.",link:"/code-maze.com/graphql-mutations.md",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16),a(o,c(i({title:"Consuming a GraphQL API with ASP.NET Core",desc:"In this article, we are going to learn how to Consume GraphQL API with the ASP.NET Core application by using the GraphQL.Client library.",link:"/code-maze.com/consume-graphql-api-with-asp-net-core.md",logo:"/assets/image/code-maze.com/favicon.png",background:"rgba(22,22,22,0.2)"})),null,16),s("ul",null,[s("li",null,[a(u,{to:"/code-maze.com/consuming-graphql-api-angular.html"},{default:t(()=>n[9]||(n[9]=[e("Consuming a GraphQL API with Angular")])),_:1,__:[9]})])]),s("div",C,[n[14]||(n[14]=s("p",{class:"hint-container-title"},"Info",-1)),s("p",null,[n[13]||(n[13]=e("To download the source code, visit the ")),s("a",_,[n[10]||(n[10]=e("Advanced GraphQL Queries Source Code. (")),a(k,{icon:"iconfont icon-github"}),n[11]||(n[11]=s("code",null,"CodeMazeBlog/graphql-series",-1)),n[12]||(n[12]=e(")"))])]),a(r,{name:"CodeMazeBlog/graphql-series",desc:"This repository contains the code for the GraphQL series on Code Maze",url:"https://github.com/CodeMazeBlog/graphql-series/tree/graphql-queries",logo:"https://avatars.githubusercontent.com/u/29179238?v=4",preview:"https://opengraph.githubassets.com/968afff6669b65f13efd3582c29aa2956236b358a538accd7194ca6e0e1506cc/CodeMazeBlog/graphql-series"})]),s("p",null,[n[16]||(n[16]=e("For the complete navigation of this tutorial visit ")),a(u,{to:"/code-maze.com/graphql-asp-net-core-tutorial.html"},{default:t(()=>n[15]||(n[15]=[e("GraphQL ASP.NET Core Tutorial.")])),_:1,__:[15]})]),n[24]||(n[24]=g(`<hr><h2 id="creating-complex-types-for-graphql-queries" tabindex="-1"><a class="header-anchor" href="#creating-complex-types-for-graphql-queries"><span>Creating Complex Types for GraphQL Queries</span></a></h2><p>If we take a look at our „owners“ query, we are going to see it returns the <code>ListGraphType&lt;OwnerType&gt;</code> result. Furthermore, if we inspect the <code>OwnerType</code> class, we are going to see it contains the <code>Id</code>, <code>Name</code> and <code>Address</code> fields. But a single Owner can have multiple accounts related to it, this can be confirmed by inspecting the Owner model class in the Entities folder. So, this is exactly what we want to add to the <code>OwnerType</code> class as well.</p><p>But, before we start with adding additional <code>Accounts</code> field into the <code>OwnerType</code> class, we need to create the <code>AccountType</code> class first. So let’s do that inside the <code>GraphQLTypes</code> folder:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType<span class="token punctuation">&lt;</span>Account<span class="token punctuation">&gt;</span></span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">AccountType</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Id property from the account object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Description property from the account object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>OwnerId<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;OwnerId property from the account object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Yes, we are missing the <code>Type</code> property from the <code>Account</code> class, but we will get to that.</p><p>Now, that we have <code>AccountType</code>, we can add a list of accounts to our „owners“ query result. So, let’s start by modifying the <code>IAccountRepository</code> interface first and then the <code>AccountRepository</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IAccountRepository</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Account<span class="token punctuation">&gt;</span></span> <span class="token function">GetAllAccountsPerOwner</span><span class="token punctuation">(</span><span class="token class-name">Guid</span> ownerId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountRepository</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IAccountRepository</span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">ApplicationContext</span> _context<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">AccountRepository</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">       _context <span class="token operator">=</span> context<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Account<span class="token punctuation">&gt;</span></span> <span class="token function">GetAllAccountsPerOwner</span><span class="token punctuation">(</span><span class="token class-name">Guid</span> ownerId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> _context<span class="token punctuation">.</span>Accounts</span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>OwnerId<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>ownerId<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, we can modify the <code>OwnerType</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OwnerType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType<span class="token punctuation">&lt;</span>Owner<span class="token punctuation">&gt;</span></span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">OwnerType</span><span class="token punctuation">(</span><span class="token class-name">IAccountRepository</span> repository<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Id property from the owner object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Name property from the owner object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Address property from the owner object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ListGraphType<span class="token punctuation">&lt;</span>AccountType<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token string">&quot;accounts&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token named-parameter punctuation">resolve</span><span class="token punctuation">:</span> context <span class="token operator">=&gt;</span> repository<span class="token punctuation">.</span><span class="token function">GetAllAccountsPerOwner</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Source<span class="token punctuation">.</span>Id<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So, there is nothing in this code, that we haven’t seen so far. In the same way that we have created a field in the <code>AppQuery</code> class, we create a field in the <code>OwnerType</code> class. One interesting thing is that the <code>GetAllAccountsPerOwner</code> method requires an id parameter but we provide <code>context.Source.Id</code>.</p><p>That’s because the context contains the <code>Source</code> property which is of the <code>Owner</code> type in this specific case:</p><figure><img src="`+b+'" alt="Source property in context object - Queries in GraphQL" tabindex="0" loading="lazy"><figcaption>Source property in context object - Queries in GraphQL</figcaption></figure><p>Finally, we can modify the „owners“ query in the UI.Playground:</p><figure><img src="'+f+`" alt="Modified query - GraphQL Queries" tabindex="0" loading="lazy"><figcaption>Modified query - GraphQL Queries</figcaption></figure><hr><h2 id="adding-enumerations-in-graphql-queries" tabindex="-1"><a class="header-anchor" href="#adding-enumerations-in-graphql-queries"><span>Adding Enumerations in GraphQL Queries</span></a></h2><p>In the <code>AccountType</code> class, we are missing the <code>Type</code> field. We left it out deliberately, and now it’s the right time to add it. To add enumeration to the <code>AccountType</code> class, we need to invest just a little bit more effort than with the regular scalar types in GraphQL.</p><p>The first thing we are going to do is to create a new class <code>AccountTypeEnumType</code> in the <code>GraphQLTypes</code> folder:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountTypeEnumType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EnumerationGraphType<span class="token punctuation">&lt;</span>TypeOfAccount<span class="token punctuation">&gt;</span></span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">AccountTypeEnumType</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        Name <span class="token operator">=</span> <span class="token string">&quot;Type&quot;</span><span class="token punctuation">;</span></span>
<span class="line">        Description <span class="token operator">=</span> <span class="token string">&quot;Enumeration for the account type object.&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We can see that the <code>AccountTypeEnumType</code> class must inherit from the generic <code>EnumerationGraphType</code> which for the generic parameter has the enumeration that we have created in our starter project. One important thing to mention is that the value for the <code>Name</code> property must mache the name of the same enumeration property inside the <code>Account</code> class:</p><figure><img src="`+w+`" alt="Enumeration type - GraphQL Queries" tabindex="0" loading="lazy"><figcaption>Enumeration type - GraphQL Queries</figcaption></figure><p>After this modification, let’s add this enumeration type in the <code>AccountType</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType<span class="token punctuation">&lt;</span>Account<span class="token punctuation">&gt;</span></span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">AccountType</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Id property from the account object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Description<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Description property from the account object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>OwnerId<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;OwnerId property from the account object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AccountTypeEnumType<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Enumeration for the account type object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally, we can add the enumeration type to our client query:</p><figure><img src="`+q+'" alt="Enumeration in the query - GraphQL Queries" tabindex="0" loading="lazy"><figcaption>Enumeration in the query - GraphQL Queries</figcaption></figure><hr><h2 id="implementing-a-cache-in-the-graphql-queries-with-data-loader" tabindex="-1"><a class="header-anchor" href="#implementing-a-cache-in-the-graphql-queries-with-data-loader"><span>Implementing a Cache in the GraphQL Queries with Data Loader</span></a></h2><p>Our query is returning the expected result, we’ve seen that, but it is not that optimized enough yet.</p><p>So, what is the problem?</p><p>Well, the problem is that our query is working in such a way that it extracts id’s from all the owners and then for every single id sends the additional SQL query to the database to fetch related accounts. We can see that from the logs:</p><figure><img src="'+A+`" alt="Not optimized query" tabindex="0" loading="lazy"><figcaption>Not optimized query</figcaption></figure><p>Of course, this is not a problem when we have only two owner entities, but what if we have a thousand?</p><p>We can optimize this query by using <code>DataLoader</code> which is provided by GraphQL, with a couple of modifications.</p><p>Let’s start by modifying the <code>IAccountRepository</code> file:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IAccountRepository</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Account<span class="token punctuation">&gt;</span></span> <span class="token function">GetAllAccountsPerOwner</span><span class="token punctuation">(</span><span class="token class-name">Guid</span> ownerId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>ILookup<span class="token punctuation">&lt;</span>Guid<span class="token punctuation">,</span> Account<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">GetAccountsByOwnerIds</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span> ownerIds<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We need to have a method that returns <code>Task&lt;ILookup&lt;TKey, T&gt;</code> because <code>DataLoader</code> requires a method with that return type in its signature.</p><p>Then, we need to implement this additional method inside the <code>AccountRepository</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountRepository</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IAccountRepository</span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">ApplicationContext</span> _context<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">AccountRepository</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _context <span class="token operator">=</span> context<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Account<span class="token punctuation">&gt;</span></span> <span class="token function">GetAllAccountsPerOwner</span><span class="token punctuation">(</span><span class="token class-name">Guid</span> ownerId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> _context<span class="token punctuation">.</span>Accounts</span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>OwnerId<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>ownerId<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>ILookup<span class="token punctuation">&lt;</span>Guid<span class="token punctuation">,</span> Account<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">GetAccountsByOwnerIds</span><span class="token punctuation">(</span><span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span> ownerIds<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name"><span class="token keyword">var</span></span> accounts <span class="token operator">=</span> <span class="token keyword">await</span> _context<span class="token punctuation">.</span>Accounts<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> ownerIds<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>OwnerId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToListAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> accounts<span class="token punctuation">.</span><span class="token function">ToLookup</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>OwnerId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To continue on, we are going to modify the <code>OwnerType</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OwnerType</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType<span class="token punctuation">&lt;</span>Owner<span class="token punctuation">&gt;</span></span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">OwnerType</span><span class="token punctuation">(</span><span class="token class-name">IAccountRepository</span> repository<span class="token punctuation">,</span> <span class="token class-name">IDataLoaderContextAccessor</span> dataLoader<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Id property from the owner object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Name property from the owner object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">Field</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Address<span class="token punctuation">,</span> <span class="token named-parameter punctuation">type</span><span class="token punctuation">:</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IdGraphType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Description</span><span class="token punctuation">(</span><span class="token string">&quot;Address property from the owner object.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ListGraphType<span class="token punctuation">&lt;</span>AccountType<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token string">&quot;accounts&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token named-parameter punctuation">resolve</span><span class="token punctuation">:</span> context <span class="token operator">=&gt;</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name"><span class="token keyword">var</span></span> loader <span class="token operator">=</span> dataLoader<span class="token punctuation">.</span>Context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetOrAddCollectionBatchLoader</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Guid<span class="token punctuation">,</span> Account<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;GetAccountsByOwnerIds&quot;</span><span class="token punctuation">,</span> repository<span class="token punctuation">.</span>GetAccountsByOwnerIds<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">return</span> loader<span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>Source<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Great job.</p><p>As you can see, we inject the <code>IDataLoaderContextAccessor</code> in the constructor and use it with the <code>Context.GetOrAddCollectionBatchLoader</code> method with the name of the loader key as a first parameter and our created method as the second parameter.</p><p>The final thing to do is to register <code>DataLoader</code> in the <code>Startup</code> class, by attaching it to the <code>AddGraphQL</code> method:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line">services<span class="token punctuation">.</span><span class="token function">AddGraphQL</span><span class="token punctuation">(</span>o <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> o<span class="token punctuation">.</span>ExposeExceptions <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">AddGraphTypes</span><span class="token punctuation">(</span>ServiceLifetime<span class="token punctuation">.</span>Scoped<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">AddDataLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, as soon as we send the same query again, we can inspect our logs:</p><figure><img src="`+x+`" alt="Optimized query" tabindex="0" loading="lazy"><figcaption>Optimized query</figcaption></figure><p>As we can see, we have only one query for all the accounts per each owner.</p><hr><h2 id="using-arguments-in-queries-and-handling-errors" tabindex="-1"><a class="header-anchor" href="#using-arguments-in-queries-and-handling-errors"><span>Using Arguments in Queries and Handling Errors</span></a></h2><p>Until now, we’ve been returning all the owners with their accounts in a single query. But we want to return a single owner by provided id parameter as well. So to do that, we need to include arguments in our queries.</p><p>Let’s do that by modifying the <code>IOwnerRepository</code> interface first:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IOwnerRepository</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Owner<span class="token punctuation">&gt;</span></span> <span class="token function">GetAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token return-type class-name">Owner</span> <span class="token function">GetById</span><span class="token punctuation">(</span><span class="token class-name">Guid</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next, we are going to implement the <code>GetById</code> method:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OwnerRepository</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IOwnerRepository</span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">ApplicationContext</span> _context<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">OwnerRepository</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        _context <span class="token operator">=</span> context<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>Owner<span class="token punctuation">&gt;</span></span> <span class="token function">GetAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> _context<span class="token punctuation">.</span>Owners<span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token return-type class-name">Owner</span> <span class="token function">GetById</span><span class="token punctuation">(</span><span class="token class-name">Guid</span> id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> _context<span class="token punctuation">.</span>Owners<span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span>o <span class="token operator">=&gt;</span> o<span class="token punctuation">.</span>Id<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally, we can modify the <code>AppQuery</code> class:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppQuery</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ObjectGraphType</span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">AppQuery</span><span class="token punctuation">(</span><span class="token class-name">IOwnerRepository</span> repository<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ListGraphType<span class="token punctuation">&lt;</span>OwnerType<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span></span>
<span class="line">           <span class="token string">&quot;owners&quot;</span><span class="token punctuation">,</span></span>
<span class="line">           <span class="token named-parameter punctuation">resolve</span><span class="token punctuation">:</span> context <span class="token operator">=&gt;</span> repository<span class="token punctuation">.</span><span class="token function">GetAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>OwnerType<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token string">&quot;owner&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token named-parameter punctuation">arguments</span><span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryArguments</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryArgument<span class="token punctuation">&lt;</span>NonNullGraphType<span class="token punctuation">&lt;</span>IdGraphType<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;ownerId&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token named-parameter punctuation">resolve</span><span class="token punctuation">:</span> context <span class="token operator">=&gt;</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name"><span class="token keyword">var</span></span> id <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetArgument</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;ownerId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">return</span> repository<span class="token punctuation">.</span><span class="token function">GetById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So, we create a new field with the <code>OwnerType</code> return value. The name is „owner“ and we use the <code>arguments</code> part to create an argument for this query. Our argument can’t be null (NonNullGraphType) and it must be of the <code>IdGraphType</code> type with the „ownerId“ name. The resolve part is pretty self-explanatory.</p><p>But what if the <code>id</code> parameter is not of the <code>Guid</code> type, then, we would like to return a message to the client. So let’s add a slight modification in the resolve part:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token generic-method"><span class="token function">Field</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>OwnerType<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&quot;owner&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token named-parameter punctuation">arguments</span><span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryArguments</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryArgument<span class="token punctuation">&lt;</span>NonNullGraphType<span class="token punctuation">&lt;</span>IdGraphType<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;ownerId&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token named-parameter punctuation">resolve</span><span class="token punctuation">:</span> context <span class="token operator">=&gt;</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Guid</span> id<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Guid<span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetArgument</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;ownerId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">out</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            context<span class="token punctuation">.</span>Errors<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ExecutionError</span><span class="token punctuation">(</span><span class="token string">&quot;Wrong value for guid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">         <span class="token keyword">return</span> repository<span class="token punctuation">.</span><span class="token function">GetById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">     <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>After these changes, we can use our UI tool to send a new query:</p><figure><img src="`+G+'" alt="Arguments and error handling - GraphQL queries" tabindex="0" loading="lazy"><figcaption>Arguments and error handling - GraphQL queries</figcaption></figure><hr><h2 id="aliases-fragments-named-queries-variables-directives" tabindex="-1"><a class="header-anchor" href="#aliases-fragments-named-queries-variables-directives"><span>Aliases, Fragments, Named Queries, Variables, Directives</span></a></h2><p>We can modify our queries, on the client side, by introducing the aliases. They are very useful when we want to change the name of our result, or any field in the result. Furthermore, if we have two same queries but with a different argument, we can use aliases to differentiate those queries.</p><p>To use them, all we have to do is to type the required word in front of the query or field:</p><figure><img src="'+T+'" alt="Aliases in GraphQL Queries" tabindex="0" loading="lazy"><figcaption>Aliases in GraphQL Queries</figcaption></figure><p>As we can see from a previous example, we have two queries with the same fields.</p><p>Now, let’s imagine if we need 10 of them with the same fields just different arguments, that would be a bit hard to read, wouldn’t it? Well, we can solve this by using fragments. Fragments allow us to separate common fields, for different queries, into a separate section and then just reuse that section in all the queries:</p><figure><img src="'+Q+'" alt="Fragments in GraphQL Queries" tabindex="0" loading="lazy"><figcaption>Fragments in GraphQL Queries</figcaption></figure><p>To create a named query, we have to use a „query“ keyword in front of the entire query with the query name as well. Then we can pass arguments for the query if we have some. The important thing with the named queries is if a query has an argument we need to use the QUERY VARIABLES window to assign a value for that argument:</p><figure><img src="'+L+'" alt="Named GraphQL Queries" tabindex="0" loading="lazy"><figcaption>Named GraphQL Queries</figcaption></figure><p>Finally, we can add or remove some fields conditionally from our result by using directives in our queries. There are two directives we can use, include and skip:</p><figure><img src="'+I+'" alt="Directives in GraphQL Quereis" tabindex="0" loading="lazy"><figcaption>Directives in GraphQL Quereis</figcaption></figure><hr><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2><p>Excellent. We did a great job here.</p><p>To sum up the article, we have learned:</p><ul><li>How to add complex types in GraphQL</li><li>How to write GraphQL queries with arguments</li><li>The way to work with enumerations</li><li>To cache some data by using DataLoader</li><li>How to modify client queries with aliases, names, and fragments</li></ul>',80)),s("p",null,[n[18]||(n[18]=e("In ")),a(u,{to:"/code-maze.com/graphql-mutations.html"},{default:t(()=>n[17]||(n[17]=[e("the next article")])),_:1,__:[17]}),n[19]||(n[19]=e(", we are going to learn about mutations in GraphQL."))])])}const F=m(z,[["render",j]]),R=JSON.parse('{"path":"/code-maze.com/advanced-graphql-queries.html","title":"Advanced GraphQL Queries, Error Handling, Data Loader","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Advanced GraphQL Queries, Error Handling, Data Loader","description":"Article(s) > Advanced GraphQL Queries, Error Handling, Data Loader","icon":"iconfont icon-csharp","category":["C#","GraphQL","Article(s)"],"tag":["blog","code-maze.com","csharp","graphql"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Advanced GraphQL Queries, Error Handling, Data Loader\\",\\"image\\":[\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/07-Context.Source.png\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/08-Added-accounts-to-the-owner-type.gif\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/09-Enumeration-type.png\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/10-Added-enumeration-to-the-query.gif\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/11-Not-optimized-query.png\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/12-Optimized-query.png\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/13-Arguments-and-Error-Handling.gif\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/14-Aliases.gif\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/15-Fragments.gif\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/16-Named-Queries.gif\\",\\"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/17-Directives.gif\\"],\\"datePublished\\":\\"2022-01-03T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/code-maze.com/advanced-graphql-queries.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"Advanced GraphQL Queries, Error Handling, Data Loader"}],["meta",{"property":"og:description","content":"Article(s) > Advanced GraphQL Queries, Error Handling, Data Loader"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/banner.png"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://chanhi2000.github.io/bookshelf/assets/image/code-maze.com/advanced-graphql-queries/banner.png"}],["meta",{"name":"twitter:image:alt","content":"Advanced GraphQL Queries, Error Handling, Data Loader"}],["meta",{"property":"article:tag","content":"graphql"}],["meta",{"property":"article:tag","content":"csharp"}],["meta",{"property":"article:tag","content":"code-maze.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2022-01-03T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Advanced GraphQL Queries, Error Handling, Data Loader"},{"property":"og:description","content":"Advanced GraphQL Queries, Error Handling, Data Loader"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/code-maze.com/advanced-graphql-queries.html"}]],"prev":"/programming/cs/articles/README.md","date":"2022-01-03T00:00:00.000Z","isOriginal":false,"cover":"/assets/image/code-maze.com/advanced-graphql-queries/banner.png"},"git":{},"readingTime":{"minutes":7.6,"words":2281},"filePathRelative":"code-maze.com/advanced-graphql-queries.md"}');export{F as comp,R as data};
