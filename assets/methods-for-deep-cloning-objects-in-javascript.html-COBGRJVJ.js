import{_ as m}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as v,d as s,f as a,b as i,a as k,t as h,n as c,g as d,w as p,e,r as l,o as g}from"./app-BVguHYKu.js";const f="/bookshelf/assets/image/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript/banner.png",y={},j={id:"frontmatter-title-관련",tabindex:"-1"},w={class:"header-anchor",href:"#frontmatter-title-관련"},x={class:"table-of-contents"},S={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures",target:"_blank",rel:"noopener noreferrer"},A={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign",target:"_blank",rel:"noopener noreferrer"},O={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax",target:"_blank",rel:"noopener noreferrer"},J={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Enumerability_and_ownership_of_properties",target:"_blank",rel:"noopener noreferrer"},N={class:"hint-container note"},q={href:"https://flaviocopes.com/javascript-types/#primitive-types",target:"_blank",rel:"noopener noreferrer"},T={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#",target:"_blank",rel:"noopener noreferrer"},I={href:"https://github.com/tc39/proposal-object-rest-spread",target:"_blank",rel:"noopener noreferrer"},C={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator",target:"_blank",rel:"noopener noreferrer"},B={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/set",target:"_blank",rel:"noopener noreferrer"},D={href:"https://lodash.com/docs/4.17.10#cloneDeep",target:"_blank",rel:"noopener noreferrer"},M={href:"https://html.spec.whatwg.org/multipage/structured-data.html#safe-passing-of-structured-data",target:"_blank",rel:"noopener noreferrer"},z={href:"https://nodejs.org/api/all.html#v8_serialization_api",target:"_blank",rel:"noopener noreferrer"},W={class:"hint-container info"},L={href:"https://nodejs.org/api/all.html#v8_serialization_api",target:"_blank",rel:"noopener noreferrer"};function R(b,n){const r=l("VPCard"),o=l("router-link"),u=l("SiteInfo"),t=l("VPIcon");return g(),v("div",null,[s("h1",j,[s("a",w,[s("span",null,h(b.$frontmatter.title)+" 관련",1)])]),a(r,c(d({title:"JavaScript > Article(s)",desc:"Article(s)",link:"/programming/js/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",x,[s("ul",null,[s("li",null,[a(o,{to:"#introduction"},{default:p(()=>n[0]||(n[0]=[e("Introduction")])),_:1,__:[0]})]),s("li",null,[a(o,{to:"#introducing-object-behavior"},{default:p(()=>n[1]||(n[1]=[e("Introducing object behavior")])),_:1,__:[1]})]),s("li",null,[a(o,{to:"#object-copying-methods"},{default:p(()=>n[2]||(n[2]=[e("Object copying methods")])),_:1,__:[2]}),s("ul",null,[s("li",null,[a(o,{to:"#copying-an-object-with-the-object-assign-method"},{default:p(()=>n[3]||(n[3]=[e("Copying an object with the Object.assign() method")])),_:1,__:[3]})]),s("li",null,[a(o,{to:"#copying-an-object-with-the-spread-syntax"},{default:p(()=>n[4]||(n[4]=[e("Copying an object with the spread syntax")])),_:1,__:[4]})]),s("li",null,[a(o,{to:"#recommended-method-for-deep-cloning-objects-in-javascript"},{default:p(()=>n[5]||(n[5]=[e("Recommended method for deep cloning objects in JavaScript")])),_:1,__:[5]})]),s("li",null,[a(o,{to:"#native-deep-cloning"},{default:p(()=>n[6]||(n[6]=[e("Native deep cloning")])),_:1,__:[6]})]),s("li",null,[a(o,{to:"#other-object-cloning-methods"},{default:p(()=>n[7]||(n[7]=[e("Other object cloning methods")])),_:1,__:[7]})])])]),s("li",null,[a(o,{to:"#conclusion"},{default:p(()=>n[8]||(n[8]=[e("Conclusion")])),_:1,__:[8]})])])]),n[75]||(n[75]=s("hr",null,null,-1)),a(u,{name:"Methods for deep cloning objects in JavaScript",desc:"There are several ways to shallow clone objects in JavaScript, but deep cloning objects is trickier. We highlight several methods to do so.",url:"https://blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript",logo:"/assets/image/blog.logrocket.com/favicon.png",preview:"/assets/image/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript/banner.png"}),n[76]||(n[76]=s("h2",{id:"introduction",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#introduction"},[s("span",null,"Introduction")])],-1)),s("p",null,[n[10]||(n[10]=e("In JavaScript, objects are like a store or collection of key-value pairs. They are a kind of ")),s("a",S,[a(t,{icon:"fa-brands fa-firefox"}),n[9]||(n[9]=e("structural data type"))]),n[11]||(n[11]=e(", which can be seen as a collection of properties. These properties can either be values of other data types, including primitive types like ")),n[12]||(n[12]=s("code",null,"Boolean",-1)),n[13]||(n[13]=e(", ")),n[14]||(n[14]=s("code",null,"Number",-1)),n[15]||(n[15]=e(", ")),n[16]||(n[16]=s("code",null,"undefined",-1)),n[17]||(n[17]=e(", etc., or even other objects. Therefore, with objects, we can build even more complex data structures."))]),n[77]||(n[77]=i('<figure><img src="'+f+`" alt="Methods for Deep Cloning Objects in JavaScript" tabindex="0" loading="lazy"><figcaption>Methods for Deep Cloning Objects in JavaScript</figcaption></figure><p>Due to the nature of objects in JS, they are usually stored in memory and can only be copied by reference. This means that a variable does not store an object in itself, but rather an identifier, which represents an address or a reference to that particular object in memory. As such, objects cannot be treated in the same way as primitives.</p><p>With primitive data types, once variables are assigned, they cannot be copied over. Therefore, changing the value of the variable never changes the underlying primitive type. This means it is impossible to change the values of these types once they are assigned to a variable — a concept known as immutability. However, they can be combined together to derive new values.</p><p>Objects, on the other hand, are mutable data types. In this article, we will explore ways of modifying or mutating objects in JavaScript. This entails performing either shallow or deep cloning or copying with respect to general object behavior.</p><hr><h2 id="introducing-object-behavior" tabindex="-1"><a class="header-anchor" href="#introducing-object-behavior"><span>Introducing object behavior</span></a></h2><p>To reiterate, objects are reference types, and as such, when we copy an object variable, we are indirectly creating one more reference to the same object stored somewhere else in the computer’s memory. Therefore, when an object variable is copied, only a reference to the object is copied — the actual object is not!</p><p>Let’s look at an example to understand this concept better:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Alexander&quot;</span> <span class="token punctuation">}</span> </span>
<span class="line"></span>
<span class="line"><span class="token comment">// this instead copies a reference to the previous object </span></span>
<span class="line"><span class="token keyword">let</span> newUser <span class="token operator">=</span> user</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the above example, we have two variables, each making reference to the same object in memory. In this case, the variable <code>newUser</code> has a reference to the initially declared <code>user</code> variable in memory. Note that this is only possible for reference types like objects and arrays; for primitive types like a string or a Boolean, this is not the case.</p><div class="hint-container note"><p class="hint-container-title">Note</p><p>We can make use of the <code>Object.is()</code> method to determine whether the two values are actually the same value. Running <code>console.log(Object.is(user, newUser))</code> on the browser console should return the Boolean value <code>true</code>.</p></div><hr><h2 id="object-copying-methods" tabindex="-1"><a class="header-anchor" href="#object-copying-methods"><span>Object copying methods</span></a></h2><p>JavaScript offers many ways of copying objects, but they do not provide a deep copy. Performing shallow copies is the default behavior in most of the cases.</p>`,14)),s("p",null,[n[21]||(n[21]=e("We should note that ES6 provides two shorter syntaxes for shallow copying objects in the language. They include ")),s("a",A,[a(t,{icon:"fa-brands fa-firefox"}),n[18]||(n[18]=s("code",null,"Object.assign()",-1))]),n[22]||(n[22]=e("` and the ")),s("a",O,[a(t,{icon:"fa-brands fa-firefox"}),n[19]||(n[19]=e("spread syntax"))]),n[23]||(n[23]=e(", which copies values of all ")),s("a",J,[a(t,{icon:"fa-brands fa-firefox"}),n[20]||(n[20]=e("enumerable own properties"))]),n[24]||(n[24]=e(". from one object to another."))]),s("div",N,[n[28]||(n[28]=s("p",{class:"hint-container-title"},"Note",-1)),s("p",null,[n[26]||(n[26]=e("A shallow copy successfully copies ")),s("a",q,[a(t,{icon:"fas fa-globe"}),n[25]||(n[25]=e("primitive types"))]),n[27]||(n[27]=e(" like numbers and strings, but any object reference will not be recursively copied, but instead the new, copied object will reference the same initial object."))]),a(u,{name:"JavaScript Types",desc:"You might sometimes read that JS is untyped, but that's incorrect. It's true that you can assign all sorts of different types to a variable, but JavaScript has types. In particular, it provides primitive types, and object types.",url:"https://flaviocopes.com/javascript-types/",logo:"https://flaviocopes.com/img/favicon-16x16.png",preview:"https://flaviocopes.com/og.jpg"})]),n[78]||(n[78]=s("p",null,"Let’s look at them one after the other:",-1)),n[79]||(n[79]=s("h3",{id:"copying-an-object-with-the-object-assign-method",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#copying-an-object-with-the-object-assign-method"},[s("span",null,[e("Copying an object with the "),s("code",null,"Object.assign()"),e(" method")])])],-1)),s("p",null,[n[30]||(n[30]=e("Among the ")),s("a",T,[a(t,{icon:"fa-brands fa-firefox"}),n[29]||(n[29]=e("object constructor methods"))]),n[31]||(n[31]=e(", ")),n[32]||(n[32]=s("code",null,"Object.assign()",-1)),n[33]||(n[33]=e(" is used to copy the values and properties from one or more source objects to a target object. It returns the target object, which has properties and values copied from the source object."))]),n[80]||(n[80]=i(`<p>Since <code>Object.assign()</code> copies property values, it is unsuitable for deep cloning. Basically, we can use this method for shallow cloning an object and for merging two or more objects into one bigger object with the same properties.</p><h4 id="syntax" tabindex="-1"><a class="header-anchor" href="#syntax"><span>Syntax</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> copied <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token operator">...</span>sources<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">Note</p><p>In using this method, if we have matching keys in both target and source objects, the matching keys in the second object would override the first one after cloning.</p></div><h4 id="parameters" tabindex="-1"><a class="header-anchor" href="#parameters"><span>Parameters</span></a></h4><ul><li><code>target</code>: target object to which values and properties are copied</li><li><code>sources</code>: source object from which values and properties are copied</li></ul><h4 id="return-value" tabindex="-1"><a class="header-anchor" href="#return-value"><span>Return value</span></a></h4><ul><li>This method returns the target object.</li></ul><p>Now, let’s look at a very simple example of using this method to merge two objects together:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> objectA <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">let</span> objectB <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>objectA<span class="token punctuation">,</span> objectB<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objectA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// → { a: 1, b: 2, c: 3, d: 4 }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here, the target object is <code>objectA</code>, while the source object is <code>objectB</code>. Using <code>object.assign()</code> is similar to using the lodash <code>clone</code> method for shallow copying objects. Let’s look at another example:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> clone <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;lodash.clone&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">var</span> objA <span class="token operator">=</span> <span class="token punctuation">{</span> </span>
<span class="line">  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">e</span><span class="token operator">:</span> <span class="token number">3</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">var</span> objB <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>objA<span class="token punctuation">)</span></span>
<span class="line">objA<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">30</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objA<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// { a: 1, b: { c: 30, d: { e: 3 } } }</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objB<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// { a: 1, b: { c: 30, d: { e: 3 } } }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Being a shallow copy, values are cloned and object references are copied —not the objects themselves. So if we edit an object property in the original object, it is also modified in the copied object since the referenced inner object is the same in this case.</p><h3 id="copying-an-object-with-the-spread-syntax" tabindex="-1"><a class="header-anchor" href="#copying-an-object-with-the-spread-syntax"><span>Copying an object with the spread syntax</span></a></h3>`,14)),s("p",null,[n[38]||(n[38]=e("The ")),s("a",I,[n[34]||(n[34]=e("spread operator (")),a(t,{icon:"iconfont icon-github"}),n[35]||(n[35]=s("code",null,"tc39/proposal-object-rest-spread",-1)),n[36]||(n[36]=e(")"))]),n[39]||(n[39]=e(" is an ES2018 feature that adds ")),s("a",C,[a(t,{icon:"fa-brands fa-firefox"}),n[37]||(n[37]=e("spread"))]),n[40]||(n[40]=e(" properties to object literals. It provides a very convenient way to perform a shallow clone, equivalent to what ")),n[41]||(n[41]=s("code",null,"Object.assign()",-1)),n[42]||(n[42]=e(" does. With objects, the spread operator is used to create copies of existing objects with new or updated values."))]),n[81]||(n[81]=i(`<p>It copies enumerable properties from a provided object onto a new object. Let’s see an example usage, as per the syntax:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> copied <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>original <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now let’s look at a real-world example:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> objA <span class="token operator">=</span> <span class="token punctuation">{</span> </span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;Alexander&#39;</span><span class="token punctuation">,</span> </span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span> </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> objB <span class="token operator">=</span> <span class="token punctuation">{</span> </span>
<span class="line">  <span class="token literal-property property">Licensed</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> </span>
<span class="line">  <span class="token literal-property property">location</span><span class="token operator">:</span> <span class="token string">&quot;Ikeja&quot;</span> </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> mergedObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>objA<span class="token punctuation">,</span> <span class="token operator">...</span>objB<span class="token punctuation">}</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mergedObj<span class="token punctuation">)</span> </span>
<span class="line"></span>
<span class="line"><span class="token comment">// { name: &#39;Alexander&#39;, age: 26, Licensed: true, location: &#39;Ikeja&#39; }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4)),s("p",null,[n[44]||(n[44]=e("From the above, we can see that ")),n[45]||(n[45]=s("code",null,"mergedObj",-1)),n[46]||(n[46]=e(" is a copy of ")),n[47]||(n[47]=s("code",null,"objA",-1)),n[48]||(n[48]=e(" and ")),n[49]||(n[49]=s("code",null,"objB",-1)),n[50]||(n[50]=e(". Actually, every enumerable property on the objects will be copied to the final ")),n[51]||(n[51]=s("code",null,"mergedObj",-1)),n[52]||(n[52]=e(" object. The spread operator is just a shorthand for the ")),n[53]||(n[53]=s("code",null,"Object.assign()",-1)),n[54]||(n[54]=e(" method, but there are some subtle differences between the two, including the fact that ")),n[55]||(n[55]=s("code",null,"Object.assign()",-1)),n[56]||(n[56]=e(" triggers ")),s("a",B,[a(t,{icon:"fa-brands fa-firefox"}),n[43]||(n[43]=s("code",null,"setters",-1))]),n[57]||(n[57]=e(", whereas the spread operator does not."))]),n[82]||(n[82]=i('<div class="hint-container note"><p class="hint-container-title">Note</p><p>If an object references other objects when performing a shallow copy of the object, we copy the references to the external object. When performing a deep copy, those external objects are copied as well, so the new cloned object is completely independent from the old one.</p></div><h3 id="recommended-method-for-deep-cloning-objects-in-javascript" tabindex="-1"><a class="header-anchor" href="#recommended-method-for-deep-cloning-objects-in-javascript"><span>Recommended method for deep cloning objects in JavaScript</span></a></h3><p>Most of the time, when we decide to copy objects in our program, our intent is to actually copy by reference, which is more or less making a shallow copy of the object. However, when it comes to deeply nested objects, the behavior of <code>Object.assign()</code> or <code>spread</code> is different.</p><p>In essence, there is no one consistent way of cloning or copying objects in the language, regardless of their structure, in terms of how the objects are constructed.</p><p>A question that arises here is copying deeply nested objects up to, say, two or three levels deep in such a way that if we make changes to the new object, it doesn’t affect the original object acting as our target. So how do we correctly deep clone an object?</p><p>To perform a deep copy, our best bet is to rely on a library that’s well tested, popular, and well maintained by the community: Lodash. Lodash offers both <code>clone</code> and <code>cloneDeep</code> functions to perform shallow and deep cloning, respectively.</p>',6)),s("p",null,[n[59]||(n[59]=e("For example, when deep copying objects in Node.js, we can make use of the ")),s("a",D,[a(t,{icon:"fas fa-globe"}),n[58]||(n[58]=e("Lodash"))]),n[60]||(n[60]=e()),n[61]||(n[61]=s("code",null,"cloneDeep()",-1)),n[62]||(n[62]=e(" method. An example is shown below:"))]),n[83]||(n[83]=i(`<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> cloneDeep <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;lodash.clonedeep&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> objA <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">e</span><span class="token operator">:</span> <span class="token number">3</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// copy objA save as new variable objB</span></span>
<span class="line"><span class="token keyword">let</span> objB <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>objA<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// change the values in the original object objA</span></span>
<span class="line">objA<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">20</span></span>
<span class="line">objA<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">30</span></span>
<span class="line">objA<span class="token punctuation">.</span>b<span class="token punctuation">.</span>d<span class="token punctuation">.</span>e <span class="token operator">=</span> <span class="token number">40</span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>objA<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// → {&quot;a&quot;:20,&quot;b&quot;:{&quot;c&quot;:30,&quot;d&quot;:{&quot;e&quot;:40}}}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// objB which is the cloned object is still the same</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>objB<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// → {&quot;a&quot;:1,&quot;b&quot;:{&quot;c&quot;:2,&quot;d&quot;:{&quot;e&quot;:3}}}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The Lodash <code>cloneDeep()</code> method is similar to <code>clone</code>, except that it recursively clones <code>value</code> while preserving object inheritance. The great thing about the library is that we can import each function individually — no need to import the entire library into our project. This can greatly reduce the size of our program dependencies.</p><p>In order to make use of Lodash clone methods in Node.js, we can install it by running <code>npm i lodash.clonedeep</code> for deep clone and <code>npm i lodash.clone</code> for shallow clone. We can use it like so:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> clone <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;lodash.clone&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">const</span> cloneDeep <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;lodash.clonedeep&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> shallowCopy <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>originalObject<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">const</span> deepCopy <span class="token operator">=</span> <span class="token function">clonedeep</span><span class="token punctuation">(</span>originalObject<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">Note</p><p>Copying objects derived from built-in JavaScript objects will result in extra, unwanted properties.</p></div><h3 id="native-deep-cloning" tabindex="-1"><a class="header-anchor" href="#native-deep-cloning"><span>Native deep cloning</span></a></h3>`,6)),s("p",null,[n[64]||(n[64]=e("The HTML standard includes ")),s("a",M,[a(t,{icon:"fas fa-globe"}),n[63]||(n[63]=s("strong",null,"an internal structured cloning/serialization algorithm",-1))]),n[65]||(n[65]=e(" that can create deep clones of objects. Although still limited to certain built-in types, it can preserve references within the cloned data, allowing support for cyclical and recursive structures that would otherwise cause errors with JSON."))]),s("p",null,[n[67]||(n[67]=e("With support in Node.js still experimental, the ")),n[68]||(n[68]=s("code",null,"v8",-1)),n[69]||(n[69]=e(" module ")),s("a",z,[a(t,{icon:"fa-brands fa-node"}),n[66]||(n[66]=e("exposes the structured serialization API directly"))]),n[70]||(n[70]=e(". For example, cloning an object is as simple as:"))]),n[84]||(n[84]=i(`<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> v8 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;v8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">structuredClone</span> <span class="token operator">=</span> <span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> v8<span class="token punctuation">.</span><span class="token function">deserialize</span><span class="token punctuation">(</span>v8<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1)),s("div",W,[n[74]||(n[74]=s("p",{class:"hint-container-title"},"Info",-1)),s("p",null,[n[72]||(n[72]=e("More details can be found ")),s("a",L,[a(t,{icon:"fa-brands fa-node"}),n[71]||(n[71]=e("here"))]),n[73]||(n[73]=e("."))]),a(r,c(d({title:"Node.js v23.6.0 Documentation",desc:"",link:"https://nodejs.org/api/all.html#v8_serialization_api/",logo:"https://nodejs.org/favicon.ico",background:"rgba(4144,185,110,0.2)"})),null,16)]),n[85]||(n[85]=i(`<h3 id="other-object-cloning-methods" tabindex="-1"><a class="header-anchor" href="#other-object-cloning-methods"><span>Other object cloning methods</span></a></h3><h4 id="iterating-through-each-object-property-and-copying-it-into-a-new-empty-object" tabindex="-1"><a class="header-anchor" href="#iterating-through-each-object-property-and-copying-it-into-a-new-empty-object"><span>Iterating through each object property and copying it into a new empty object</span></a></h4><p>This involves iterating through a source object’s properties and copying all of them one after the other to a target object. The idea is to create a new object and replicate the structure of the existing one by iterating over its properties and copying them.</p><p>Let’s see an example:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Alexander&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">26</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> clone <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// the new empty object</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// let&#39;s copy all user properties into it</span></span>
<span class="line"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    clone<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> user<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// now clone is a fully independent object with the same content</span></span>
<span class="line">clone<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Chinedu&quot;</span><span class="token punctuation">;</span> <span class="token comment">// changed the data </span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// still Alexander in the original object</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="cloning-objects-using-json-parse-stringify" tabindex="-1"><a class="header-anchor" href="#cloning-objects-using-json-parse-stringify"><span>Cloning Objects using JSON.parse/stringify</span></a></h4><p>This offers a very fast way of deep cloning objects. However, it is not very reliable and standard as it comes with some data loss along the way.</p><p>Using this method, the source object <em>must</em> be JSON-safe. If we do not use <code>Date</code>, <code>undefined</code>, <code>Infinity</code>, functions, regexps, maps, sets, or other complex types within our object, a very simple way to deep clone an object is by using:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Let’s look at an example:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">string</span><span class="token operator">:</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">bool</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">nul</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// string</span></span>
<span class="line">  <span class="token literal-property property">undef</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>  <span class="token comment">// lost</span></span>
<span class="line">  <span class="token literal-property property">inf</span><span class="token operator">:</span> <span class="token number">Infinity</span><span class="token punctuation">,</span>  <span class="token comment">// &#39;null&#39;</span></span>
<span class="line">  <span class="token literal-property property">re</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  <span class="token comment">// lost</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> a<span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token comment">// returns  object</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> clone <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> clone<span class="token punctuation">.</span>date<span class="token punctuation">)</span>  <span class="token comment">// returns string </span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>clone<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// </span></span>
<span class="line"><span class="token comment">// {</span></span>
<span class="line"><span class="token comment">//   string: &#39;string&#39;,</span></span>
<span class="line"><span class="token comment">//   number: 123,</span></span>
<span class="line"><span class="token comment">//   bool: false,</span></span>
<span class="line"><span class="token comment">//   nul: null,</span></span>
<span class="line"><span class="token comment">//   date: &#39;2020-09-28T15:47:23.734Z&#39;,</span></span>
<span class="line"><span class="token comment">//   inf: null,</span></span>
<span class="line"><span class="token comment">//   re: {}</span></span>
<span class="line"><span class="token comment">// }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">Note</p><p>This method needs some sort of exception handling to keep it safe in case the source object can not be converted to JSON.</p></div><hr><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2><p>By default, JavaScript always passes by value, which means changing the value of the variable never changes the underlying primitive type. However, for non-primitive data types (arrays, functions, and objects), which are passed by reference, we can always mutate the data, causing a single object value to have different content at different times.</p><p>Cloning a JavaScript object is a task that is used mostly because we do not want to create the same object if it already exists. As we are now aware, objects are assigned and copied by reference. In other words, a variable stores not the object value, but a reference. Therefore, copying such a variable or passing it as a function argument copies that reference, not the object.</p><p>For simple objects that only store primitive types like numbers and strings, shallow copying methods discussed earlier will work. A shallow copy means the first level is copied, and deeper levels are referenced. However, if the object properties reference other nested objects, the actual object won’t be copied, as we would only be copying the reference.</p>`,17)),k(" TODO: add ARTICLE CARD "),a(r,c(d({title:"Methods for deep cloning objects in JavaScript",desc:"There are several ways to shallow clone objects in JavaScript, but deep cloning objects is trickier. We highlight several methods to do so.",link:"https://chanhi2000.github.io/bookshelf/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript.html",logo:"/assets/image/blog.logrocket.com/favicon.png",background:"rgba(112,76,182,0.2)"})),null,16)])}const E=m(y,[["render",R]]),V=JSON.parse('{"path":"/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript.html","title":"Methods for deep cloning objects in JavaScript","lang":"en-US","frontmatter":{"lang":"en-US","title":"Methods for deep cloning objects in JavaScript","description":"Article(s) > Methods for deep cloning objects in JavaScript","icon":"fa-brands fa-js","category":["JavaScript","Article(s)"],"tag":["blog","blog.logrocket.com","js","javascript"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Methods for deep cloning objects in JavaScript\\",\\"image\\":[\\"https://chanhi2000.github.io/bookshelf/assets/image/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript/banner.png\\"],\\"datePublished\\":\\"2020-10-01T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Alexander Nnakwue\\",\\"url\\":\\"https://blog.logrocket.com/author/alexandernnakwue/\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript.html"}],["meta",{"property":"og:site_name","content":"📚Bookshelf"}],["meta",{"property":"og:title","content":"Methods for deep cloning objects in JavaScript"}],["meta",{"property":"og:description","content":"Article(s) > Methods for deep cloning objects in JavaScript"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://chanhi2000.github.io/bookshelf/assets/image/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript/banner.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://chanhi2000.github.io/bookshelf/assets/image/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript/banner.png"}],["meta",{"name":"twitter:image:alt","content":"Methods for deep cloning objects in JavaScript"}],["meta",{"property":"article:author","content":"Alexander Nnakwue"}],["meta",{"property":"article:tag","content":"javascript"}],["meta",{"property":"article:tag","content":"js"}],["meta",{"property":"article:tag","content":"blog.logrocket.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2020-10-01T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Methods for deep cloning objects in JavaScript"},{"property":"og:description","content":"Methods for deep cloning objects in JavaScript"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript.html"}]],"prev":"/programming/js/articles/README.md","date":"2020-10-01T00:00:00.000Z","isOriginal":false,"author":[{"name":"Alexander Nnakwue","url":"https://blog.logrocket.com/author/alexandernnakwue/"}],"cover":"/assets/image/blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript/banner.png"},"git":{},"readingTime":{"minutes":8.35,"words":2505},"filePathRelative":"blog.logrocket.com/methods-for-deep-cloning-objects-in-javascript.md","copyright":{"author":"Alexander Nnakwue"}}');export{E as comp,V as data};
