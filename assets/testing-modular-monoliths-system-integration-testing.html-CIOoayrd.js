import{_ as d}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as m,d as s,f as t,b as l,t as k,n as g,g as v,w as e,e as a,r as p,o as h}from"./app-BItykJLQ.js";const y={},b={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},f={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},w={class:"table-of-contents"};function T(c,n){const u=p("VPCard"),i=p("router-link"),r=p("SiteInfo"),o=p("RouteLink");return h(),m("div",null,[s("h1",b,[s("a",f,[s("span",null,k(c.$frontmatter.title)+" ê´€ë ¨",1)])]),t(u,g(v({title:"C# > Article(s)",desc:"Article(s)",link:"/programming/cs/articles/README.md",logo:"https://chanhi2000.github.io/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",w,[s("ul",null,[s("li",null,[t(i,{to:"#what-is-system-integration-testing"},{default:e(()=>[...n[0]||(n[0]=[a("What Is System Integration Testing?",-1)])]),_:1})]),s("li",null,[t(i,{to:"#modular-monolith-system-example"},{default:e(()=>[...n[1]||(n[1]=[a("Modular Monolith System Example",-1)])]),_:1})]),s("li",null,[t(i,{to:"#testing-modular-monoliths-user-registration"},{default:e(()=>[...n[2]||(n[2]=[a("Testing Modular Monoliths: User Registration",-1)])]),_:1})]),s("li",null,[t(i,{to:"#testing-modular-monoliths-adding-ticket-to-cart"},{default:e(()=>[...n[3]||(n[3]=[a("Testing Modular Monoliths: Adding Ticket to Cart",-1)])]),_:1})]),s("li",null,[t(i,{to:"#in-conclusion"},{default:e(()=>[...n[4]||(n[4]=[a("In Conclusion",-1)])]),_:1})])])]),n[39]||(n[39]=s("hr",null,null,-1)),t(r,{name:"Testing Modular Monoliths: System Integration Testing",desc:"System integration testing is the perfect testing approach for modular monoliths. It's an approach to testing the interactions between various modules within a single system.",url:"https://milanjovanovic.tech/blog/testing-modular-monoliths-system-integration-testing/",logo:"https://milanjovanovic.tech/profile_favicon.png",preview:"https://milanjovanovic.tech/blog-covers/mnw_099.png"}),n[40]||(n[40]=l('<p>Modular monoliths strike a balance between the simplicity of monolithic architecture and the flexibility of microservices. By breaking down applications into cohesive modules, modular monoliths enable easier development and maintenance. However, they still have a single codebase and deployment unit.</p><p>A critical aspect of the success of a modular monolith is the interaction between its modules.</p><p><strong>System integration testing (SIT)</strong> is an approach to verifying the collaboration of these modules. It involves testing the integration points and communication mechanisms between modules.</p><p>System integration testing allows us to validate the entire system&#39;s behavior. This allows us to catch problems early before they become big headaches.</p><p>In this article, we&#39;ll learn how to test a modular monolith using system integration testing.</p><p>We&#39;ll look at real-world examples and discuss why this testing approach is useful.</p><hr><h2 id="what-is-system-integration-testing" tabindex="-1"><a class="header-anchor" href="#what-is-system-integration-testing"><span>What Is System Integration Testing?</span></a></h2><p>System integration testing (SIT) is an approach to testing the interactions between various modules within a single system. The system could contain many external services, which should also be included during testing.</p><p>System integration testing is the perfect testing approach for modular monoliths. It allows you to mimic the real-world execution of your application (as you&#39;ll see later).</p><p>The key benefits of system integration testing are:</p><ul><li><strong>Detecting integration issues</strong>: Discover problems from module integrations that unit testing might miss.</li><li><strong>Validating business logic</strong>: Confirm that end-to-end business processes function correctly across modules.</li><li><strong>Ensuring data integrity</strong>: Verify that data flows accurately and consistently between modules.</li><li><strong>Improving system stability</strong>: Identify and resolve issues early, leading to a more reliable system.</li><li><strong>Building confidence</strong>: Ensure that the system is well-integrated and ready for deployment.</li></ul><hr><h2 id="modular-monolith-system-example" tabindex="-1"><a class="header-anchor" href="#modular-monolith-system-example"><span>Modular Monolith System Example</span></a></h2>',14)),s("p",null,[n[6]||(n[6]=a("A modular monolith consists of multiple modules, each with a distinct responsibility. Modules represent high-level components with well-defined boundaries. The modules essentially group together related functionalities (use cases). If you want to learn more about this software architecture, check out this ",-1)),t(o,{to:"/milanjovanovic.tech/what-is-a-modular-monolith.html"},{default:e(()=>[...n[5]||(n[5]=[s("strong",null,"introduction to modular monoliths",-1)])]),_:1}),n[7]||(n[7]=a(".",-1))]),n[41]||(n[41]=s("p",null,"Let's consider a hypothetical ticketing system that consists of several modules:",-1)),n[42]||(n[42]=s("ul",null,[s("li",null,[s("strong",null,"Users Module"),a(": Handles user administration and authentication.")]),s("li",null,[s("strong",null,"Events Module"),a(": Manages events, scheduling, and ticket availability.")]),s("li",null,[s("strong",null,"Ticketing Module"),a(": Allows users to purchase tickets for various events.")]),s("li",null,[s("strong",null,"Attendance Module"),a(": Allows users to check into events using their tickets.")])],-1)),s("figure",null,[n[9]||(n[9]=s("img",{src:"https://milanjovanovic.tech/blogs/mnw_099/modular_monolith.png?imwidth=3840",alt:"Modular monolith UML diagram.",tabindex:"0",loading:"lazy"},null,-1)),s("figcaption",null,[t(o,{to:"/milanjovanovic.tech/modular-monolith-architecture/"},{default:e(()=>[...n[8]||(n[8]=[a("Modular monolith UML diagram.",-1)])]),_:1})])]),n[43]||(n[43]=s("p",null,"During system integration testing, we want to ensure that all these modules interact correctly and fulfill the business requirements of the ticketing system.",-1)),n[44]||(n[44]=s("hr",null,null,-1)),n[45]||(n[45]=s("h2",{id:"testing-modular-monoliths-user-registration",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#testing-modular-monoliths-user-registration"},[s("span",null,"Testing Modular Monoliths: User Registration")])],-1)),s("p",null,[n[11]||(n[11]=a("The modules in our ticketing system represent different ",-1)),t(o,{to:"/milanjovanovic.tech/monolith-to-microservices-how-a-modular-monolith-helps.html"},{default:e(()=>[...n[10]||(n[10]=[s("strong",null,"bounded contexts",-1)])]),_:1}),n[12]||(n[12]=a(". The ",-1)),n[13]||(n[13]=s("strong",null,"Users Module",-1)),n[14]||(n[14]=a(" uses the term ",-1)),n[15]||(n[15]=s("code",null,"User",-1)),n[16]||(n[16]=a(" as its core entity. However, the ",-1)),n[17]||(n[17]=s("strong",null,"Ticketing Module",-1)),n[18]||(n[18]=a(" uses the term ",-1)),n[19]||(n[19]=s("code",null,"Customer",-1)),n[20]||(n[20]=a(" because it's more aligned with its core responsibility of selling tickets. Conceptually, both entities represent the same person within our system.",-1))]),n[46]||(n[46]=l('<p>Here&#39;s the scenario we want to test:</p><ul><li>A user registers with our application through the <strong>Users Module</strong></li><li>The <strong>Users Module</strong> publishes an integration event to notify other modules</li><li>The <strong>Ticketing Module</strong> handles the integration event and creates a customer record</li></ul><figure><img src="https://milanjovanovic.tech/blogs/mnw_099/user_registration.png?imwidth=3840" alt="User registration flow diagram." tabindex="0" loading="lazy"><figcaption>User registration flow diagram.</figcaption></figure>',3)),s("p",null,[n[22]||(n[22]=a("If you haven't figured it out by now, our ",-1)),t(o,{to:"/milanjovanovic.tech/modular-monolith-communication-patterns.html"},{default:e(()=>[...n[21]||(n[21]=[s("strong",null,"modules communicate asynchronously",-1)])]),_:1}),n[23]||(n[23]=a(" using messaging.",-1))]),n[47]||(n[47]=l(`<p>Why is this important for our tests?</p><p>There is a time delay from when something occurs in one module until the other modules are notified and handle the integration events. Our system integration tests will have to take into account this delay.</p><p>Here&#39;s the test for this scenario:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RegisterUserTests</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">BaseIntegrationTest</span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">RegisterUserTests</span><span class="token punctuation">(</span><span class="token class-name">IntegrationTestWebAppFactory</span> factory<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Fact</span></span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">RegisterUser_Should_PropagateToTicketingModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// [Users Module] - Register user</span></span>
<span class="line">        <span class="token class-name"><span class="token keyword">var</span></span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RegisterUserCommand</span><span class="token punctuation">(</span></span>
<span class="line">            Faker<span class="token punctuation">.</span>Internet<span class="token punctuation">.</span><span class="token function">Email</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            Faker<span class="token punctuation">.</span>Internet<span class="token punctuation">.</span><span class="token function">Password</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            Faker<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">FirstName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            Faker<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">LastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">Result<span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span> userResult <span class="token operator">=</span> <span class="token keyword">await</span> Sender<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        userResult<span class="token punctuation">.</span>IsSuccess<span class="token punctuation">.</span><span class="token function">Should</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">BeTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// [Ticketing Module] - Get customer</span></span>
<span class="line">        <span class="token class-name">Result<span class="token punctuation">&lt;</span>CustomerResponse<span class="token punctuation">&gt;</span></span> customerResult <span class="token operator">=</span> <span class="token keyword">await</span> Poller<span class="token punctuation">.</span><span class="token function">WaitAsync</span><span class="token punctuation">(</span></span>
<span class="line">            TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name"><span class="token keyword">var</span></span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomerQuery</span><span class="token punctuation">(</span>userResult<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                <span class="token class-name"><span class="token keyword">var</span></span> customerResult <span class="token operator">=</span> <span class="token keyword">await</span> Sender<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                <span class="token keyword">return</span> customerResult<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Assert</span></span>
<span class="line">        customerResult<span class="token punctuation">.</span>IsSuccess<span class="token punctuation">.</span><span class="token function">Should</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">BeTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        customerResult<span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">Should</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">NotBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A lot is going on here, so let&#39;s unpack the steps:</p>`,5)),s("ul",null,[n[26]||(n[26]=s("li",null,[a("We're using the "),s("code",null,"WebApplicationFactory"),a(" to run an in-memory application instance")],-1)),s("li",null,[n[25]||(n[25]=a("Any external dependencies run in a Docker container using ",-1)),t(o,{to:"/milanjovanovic.tech/testcontainers-integration-testing-using-docker-in-dotnet.html"},{default:e(()=>[...n[24]||(n[24]=[s("strong",null,"Testcontainers",-1)])]),_:1})]),n[27]||(n[27]=s("li",null,[a("We send the "),s("code",null,"RegisterUserCommand"),a(" to register a user in the "),s("strong",null,"Users Module")],-1)),n[28]||(n[28]=s("li",null,[a("Then, we have to poll the "),s("strong",null,"Ticketing Module"),a(" by sending a "),s("code",null,"GetCustomerQuery")],-1)),n[29]||(n[29]=s("li",null,[a("The "),s("code",null,"Poller"),a(" allows us to wait until the system eventually becomes consistent")],-1))]),s("p",null,[n[31]||(n[31]=a("You can learn more about ",-1)),t(o,{to:"/milanjovanovic.tech/testcontainers-integration-testing-using-docker-in-dotnet.html"},{default:e(()=>[...n[30]||(n[30]=[s("strong",null,"integration testing with Testcontainers in this article",-1)])]),_:1}),n[32]||(n[32]=a(".",-1))]),n[48]||(n[48]=l(`<p>System integration tests take longer to execute than integration tests for one module. This is a side effect of testing a bigger slice of the overall system in each test case.</p><p>The <code>Poller</code> class allows you to execute a delegate until you receive a successful result or a timeout occurs. You can customize the timeout duration based on the scenario you are testing.</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">internal</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Poller</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">Error</span> Timeout <span class="token operator">=</span></span>
<span class="line">        Error<span class="token punctuation">.</span><span class="token function">Failure</span><span class="token punctuation">(</span><span class="token string">&quot;Poller.Timeout&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;The poller has time out&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">internal</span> <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>Result<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token generic-method"><span class="token function">WaitAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span></span>
<span class="line">        <span class="token class-name">TimeSpan</span> timeout<span class="token punctuation">,</span></span>
<span class="line">        <span class="token class-name">Func<span class="token punctuation">&lt;</span>Task<span class="token punctuation">&lt;</span>Result<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> func<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> timer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PeriodicTimer</span><span class="token punctuation">(</span>TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">DateTime</span> endTimeUtc <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>UtcNow<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">while</span> <span class="token punctuation">(</span>DateTime<span class="token punctuation">.</span>UtcNow <span class="token operator">&lt;</span> endTimeUtc <span class="token operator">&amp;&amp;</span></span>
<span class="line">               <span class="token keyword">await</span> timer<span class="token punctuation">.</span><span class="token function">WaitForNextTickAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">Result<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>IsSuccess<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">return</span> result<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> Result<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Failure</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>Timeout<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="testing-modular-monoliths-adding-ticket-to-cart" tabindex="-1"><a class="header-anchor" href="#testing-modular-monoliths-adding-ticket-to-cart"><span>Testing Modular Monoliths: Adding Ticket to Cart</span></a></h2><p>Here&#39;s a more complex scenario testing adding a ticket to the customer&#39;s cart:</p><ul><li>A user registers with our application through the <strong>Users Module</strong></li><li>The <strong>Users Module</strong> publishes an integration event to notify other modules</li><li>The <strong>Ticketing Module</strong> handles the integration event and creates a customer record</li><li>The <strong>Ticketing Module</strong> creates a dummy event and adds a ticket to the customer&#39;s cart</li></ul><p>This scenario mimics a user registering with our system, finding a ticket they want to purchase, and adding it to their cart. We can extend this scenario with more test cases, like ticket purchases.</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">sealed</span> <span class="token keyword">class</span> <span class="token class-name">AddItemToCartTests</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">BaseIntegrationTest</span></span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">decimal</span></span> Quantity <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token function">AddItemToCartTests</span><span class="token punctuation">(</span><span class="token class-name">IntegrationTestWebAppFactory</span> factory<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Fact</span></span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">Customer_ShouldBeAbleTo_AddItemToCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// [Users Module] - Register user</span></span>
<span class="line">        <span class="token class-name"><span class="token keyword">var</span></span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RegisterUserCommand</span><span class="token punctuation">(</span></span>
<span class="line">            Faker<span class="token punctuation">.</span>Internet<span class="token punctuation">.</span><span class="token function">Email</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            Faker<span class="token punctuation">.</span>Internet<span class="token punctuation">.</span><span class="token function">Password</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            Faker<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">FirstName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            Faker<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token function">LastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">Result<span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span> userResult <span class="token operator">=</span> <span class="token keyword">await</span> Sender<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        userResult<span class="token punctuation">.</span>IsSuccess<span class="token punctuation">.</span><span class="token function">Should</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">BeTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// [Ticketing Module] - Get customer</span></span>
<span class="line">        <span class="token class-name">Result<span class="token punctuation">&lt;</span>CustomerResponse<span class="token punctuation">&gt;</span></span> customerResult <span class="token operator">=</span> <span class="token keyword">await</span> Poller<span class="token punctuation">.</span><span class="token function">WaitAsync</span><span class="token punctuation">(</span></span>
<span class="line">            TimeSpan<span class="token punctuation">.</span><span class="token function">FromSeconds</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name"><span class="token keyword">var</span></span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetCustomerQuery</span><span class="token punctuation">(</span>userResult<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token class-name"><span class="token keyword">var</span></span> customerResult <span class="token operator">=</span> <span class="token keyword">await</span> Sender<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">return</span> customerResult<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        customerResult<span class="token punctuation">.</span>IsSuccess<span class="token punctuation">.</span><span class="token function">Should</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">BeTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// [Ticketing Module] - Add item to cart</span></span>
<span class="line">        <span class="token class-name">CustomerResponse</span> customer <span class="token operator">=</span> customerResult<span class="token punctuation">.</span>Value<span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name"><span class="token keyword">var</span></span> ticketTypeId <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">await</span> Sender<span class="token punctuation">.</span><span class="token function">CreateEventAsync</span><span class="token punctuation">(</span>Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ticketTypeId<span class="token punctuation">,</span> Quantity<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">Result</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Sender<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AddItemToCartCommand</span><span class="token punctuation">(</span>customer<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> ticketTypeId<span class="token punctuation">,</span> Quantity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Assert</span></span>
<span class="line">        result<span class="token punctuation">.</span>IsSuccess<span class="token punctuation">.</span><span class="token function">Should</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">BeTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9)),s("p",null,[n[34]||(n[34]=a("What I like about system integration testing is that the test cases aren't complicated to write. The tests execute the use cases of our system and verify the side effects. Building your system around ",-1)),t(o,{to:"/milanjovanovic.tech/building-your-first-use-case-with-clean-architecture.html"},{default:e(()=>[...n[33]||(n[33]=[s("strong",null,"use cases",-1)])]),_:1}),n[35]||(n[35]=a(" has a few advantages, the main one being that you can focus on the core business logic. But it also makes (integration) testing easier. The use case runs by sending a command or a query. We can execute the use cases in some logical order and check that we get the expected result.",-1))]),n[49]||(n[49]=s("hr",null,null,-1)),n[50]||(n[50]=s("h2",{id:"in-conclusion",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#in-conclusion"},[s("span",null,"In Conclusion")])],-1)),n[51]||(n[51]=s("p",null,"System integration testing is a crucial step in creating a successful modular monolith. By testing how different modules work together, you can find and fix problems before they become bigger issues. This makes your software more reliable and saves you time and resources in the long run.",-1)),s("p",null,[n[37]||(n[37]=a("If you want to dive deeper into building modular systems, check out ",-1)),t(o,{to:"/milanjovanovic.tech/modular-monolith-architecture/"},{default:e(()=>[...n[36]||(n[36]=[s("strong",null,"Modular Monolith Architecture",-1)])]),_:1}),n[38]||(n[38]=a(". There's an entire chapter dedicated to testing, including advanced techniques like system integration testing, using Testcontainers for external services, and automated testing with CI/CD pipelines.",-1))]),n[52]||(n[52]=s("p",null,"That's all for today.",-1)),n[53]||(n[53]=s("p",null,"See you next week.",-1))])}const I=d(y,[["render",T]]),R=JSON.parse('{"path":"/milanjovanovic.tech/testing-modular-monoliths-system-integration-testing.html","title":"Testing Modular Monoliths: System Integration Testing","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Testing Modular Monoliths: System Integration Testing","description":"Article(s) > Testing Modular Monoliths: System Integration Testing","icon":"iconfont icon-csharp","category":["C#","DotNet","Article(s)"],"tag":["blog","milanjovanovic.tech","cs","c#","csharp","dotnet"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Testing Modular Monoliths: System Integration Testing\\",\\"image\\":[\\"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/modular-monolith-architecture/README.md\\",\\"https://milanjovanovic.tech/blogs/mnw_099/user_registration.png?imwidth=3840\\"],\\"datePublished\\":\\"2024-07-20T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Milan JovanoviÄ‡\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/testing-modular-monoliths-system-integration-testing.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"Testing Modular Monoliths: System Integration Testing"}],["meta",{"property":"og:description","content":"Article(s) > Testing Modular Monoliths: System Integration Testing"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://milanjovanovic.tech/blog-covers/mnw_099.png"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://milanjovanovic.tech/blog-covers/mnw_099.png"}],["meta",{"name":"twitter:image:alt","content":"Testing Modular Monoliths: System Integration Testing"}],["meta",{"property":"article:author","content":"Milan JovanoviÄ‡"}],["meta",{"property":"article:tag","content":"dotnet"}],["meta",{"property":"article:tag","content":"csharp"}],["meta",{"property":"article:tag","content":"c#"}],["meta",{"property":"article:tag","content":"cs"}],["meta",{"property":"article:tag","content":"milanjovanovic.tech"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2024-07-20T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Testing Modular Monoliths: System Integration Testing"},{"property":"og:description","content":"Testing Modular Monoliths: System Integration Testing"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/testing-modular-monoliths-system-integration-testing.html"}]],"prev":"/programming/cs/articles/README.md","date":"2024-07-20T00:00:00.000Z","isOriginal":false,"author":"Milan JovanoviÄ‡","cover":"https://milanjovanovic.tech/blog-covers/mnw_099.png"},"git":{},"readingTime":{"minutes":4.85,"words":1455},"filePathRelative":"milanjovanovic.tech/testing-modular-monoliths-system-integration-testing.md","copyright":{"author":"Milan JovanoviÄ‡"}}');export{I as comp,R as data};
