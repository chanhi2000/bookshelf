import{_ as v}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as b,d as s,f as e,b as i,a as f,t as g,n as u,g as r,w as p,e as a,r as o,o as h}from"./app-BItykJLQ.js";const y={},w={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},T={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},j={class:"table-of-contents"},S={href:"https://splendidlabz.com/",target:"_blank",rel:"noopener noreferrer"},x={href:"https://zellwk.com/blog/keyboard-focusable-elements/",target:"_blank",rel:"noopener noreferrer"},A={href:"https://splendidlabz.com/",target:"_blank",rel:"noopener noreferrer"},E={href:"https://splendidlabz/docs/astro/",target:"_blank",rel:"noopener noreferrer"},F={href:"https://splendidlabz/docs/utils/",target:"_blank",rel:"noopener noreferrer"},P={href:"https://splendidlabz.com/docs/styles/",target:"_blank",rel:"noopener noreferrer"};function I(d,n){const c=o("VPCard"),l=o("router-link"),k=o("SiteInfo"),m=o("RouteLink"),t=o("VPIcon");return h(),b("div",null,[s("h1",w,[s("a",T,[s("span",null,g(d.$frontmatter.title)+" ê´€ë ¨",1)])]),e(c,u(r({title:"Node.js > Article(s)",desc:"Article(s)",link:"/programming/js-node/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",j,[s("ul",null,[s("li",null,[e(l,{to:"#simple-and-easy-focus-trapping-with-splendid-labz"},{default:p(()=>[...n[0]||(n[0]=[a("Simple and easy focus trapping with Splendid Labz",-1)])]),_:1})]),s("li",null,[e(l,{to:"#selecting-all-focusable-elements"},{default:p(()=>[...n[1]||(n[1]=[a("Selecting all focusable elements",-1)])]),_:1})]),s("li",null,[e(l,{to:"#how-to-trap-focus"},{default:p(()=>[...n[2]||(n[2]=[a("How to trap focus",-1)])]),_:1})]),s("li",null,[e(l,{to:"#final-callout-to-splendid-labz"},{default:p(()=>[...n[3]||(n[3]=[a("Final callout to Splendid Labz",-1)])]),_:1})])])]),n[26]||(n[26]=s("hr",null,null,-1)),e(k,{name:"A Primer on Focus Trapping",desc:"Focus trapping is about managing focus within an element, such that focus always stays within it. The whole process sounds simple in theory, but it can quite difficult to build in practice, mostly because of the numerous parts to you got to manage.",url:"https://css-tricks.com/a-primer-on-focus-trapping",logo:"https://css-tricks/favicon.svg",preview:"https://i0.wp.com/css-tricks.com/wp-content/uploads/2019/04/tab-key.png"}),n[27]||(n[27]=s("p",null,"Focus trapping is a term that refers to managing focus within an element, such that focus always stays within it:",-1)),n[28]||(n[28]=s("ul",null,[s("li",null,"If a user tries to tab out from the last element, we return focus to the first one."),s("li",null,"If the user tries to Shift + Tab out of the first element, we return focus back to the last one.")],-1)),s("p",null,[n[5]||(n[5]=a("This whole focus trap thing is used to create accessible modal dialogs since itâ€™s a whole â€˜nother trouble to ",-1)),n[6]||(n[6]=s("code",null,"inert",-1)),n[7]||(n[7]=a(" everything else â€” ",-1)),e(m,{to:"/css-tricks.com/clarifying-the-relationship-between-popovers-and-dialogs.html"},{default:p(()=>[...n[4]||(n[4]=[s("strong",null,"but you donâ€™t need it anymore",-1)])]),_:1}),n[8]||(n[8]=a(" if youâ€™re building modals with the ",-1)),n[9]||(n[9]=s("code",null,"dialog",-1)),n[10]||(n[10]=a(" API (assuming you do it right).",-1))]),n[29]||(n[29]=s("p",null,"Anyway, back to focus trapping.",-1)),n[30]||(n[30]=s("p",null,"The whole process sounds simple in theory, but it can quite difficult to build in practice, mostly because of the numerous parts to you got to manage.",-1)),n[31]||(n[31]=s("hr",null,null,-1)),n[32]||(n[32]=s("h2",{id:"simple-and-easy-focus-trapping-with-splendid-labz",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#simple-and-easy-focus-trapping-with-splendid-labz"},[s("span",null,"Simple and easy focus trapping with Splendid Labz")])],-1)),s("p",null,[n[12]||(n[12]=a("If you are not averse to using code built by others, you might want to consider this snippet with the code Iâ€™ve created in ",-1)),s("a",S,[e(t,{icon:"fas fa-globe"}),n[11]||(n[11]=a("Splendid Labz",-1))]),n[13]||(n[13]=a(".",-1))]),n[33]||(n[33]=i(`<p>The basic idea is:</p><ol><li>We detect all focusable elements within an element.</li><li>We manage focus with a keydown event listener.</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> getFocusableElements<span class="token punctuation">,</span> trapFocus <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@splendidlabz/utils/dom&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> dialog <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;dialog&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Get all focusable content</span></span>
<span class="line"><span class="token keyword">const</span> focusables <span class="token operator">=</span> <span class="token function">getFocusableElements</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Traps focus within the dialog</span></span>
<span class="line">dialog<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">trapFocus</span><span class="token punctuation">(</span><span class="token punctuation">{</span> event<span class="token punctuation">,</span> focusables <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The above code snippet makes focus trapping extremely easy.</p><p>But, since youâ€™re reading this, Iâ€™m sure you wanna know the details that go within each of these functions. Perhaps you wanna build your own, or learn whatâ€™s going on. Either way, both are cool â€” so letâ€™s dive into it.</p><hr><h2 id="selecting-all-focusable-elements" tabindex="-1"><a class="header-anchor" href="#selecting-all-focusable-elements"><span>Selecting all focusable elements</span></a></h2>`,7)),s("p",null,[n[15]||(n[15]=a("I did research when I wrote about this ",-1)),s("a",x,[e(t,{icon:"fas fa-globe"}),n[14]||(n[14]=a("some time ago",-1))]),n[16]||(n[16]=a(". It seems like you could only focus an a handful of elements:",-1))]),n[34]||(n[34]=i(`<ul><li><code>a</code></li><li><code>button</code></li><li><code>input</code></li><li><code>textarea</code></li><li><code>select</code></li><li><code>details</code></li><li><code>iframe</code></li><li><code>embed</code></li><li><code>object</code></li><li><code>summary</code></li><li><code>dialog</code></li><li><code>audio[controls]</code></li><li><code>video[controls]</code></li><li><code>[contenteditable]</code></li><li><code>[tabindex]</code></li></ul><p>So, the first step in <code>getFocusableElements</code> is to search for all focusable elements within a container:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getFocusableElements</span><span class="token punctuation">(</span><span class="token parameter">container <span class="token operator">=</span> document<span class="token punctuation">.</span>body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">get</span> <span class="token function">all</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">const</span> elements <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span></span>
<span class="line">        container<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span></span>
<span class="line">          <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">a,</span>
<span class="line">            button,</span>
<span class="line">            input,</span>
<span class="line">            textarea,</span>
<span class="line">            select,</span>
<span class="line">            details,</span>
<span class="line">            iframe,</span>
<span class="line">            embed,</span>
<span class="line">            object,</span>
<span class="line">            summary,</span>
<span class="line">            dialog,</span>
<span class="line">            audio[controls],</span>
<span class="line">            video[controls],</span>
<span class="line">            [contenteditable],</span>
<span class="line">            [tabindex]</span>
<span class="line">          </span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next, we want to filter away elements that are <code>disabled</code>, <code>hidden</code> or set with <code>display: none</code>, since they cannot be focused on. We can do this with a simple <code>filter</code> function.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getFocusableElements</span><span class="token punctuation">(</span><span class="token parameter">container <span class="token operator">=</span> document<span class="token punctuation">.</span>body</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">get</span> <span class="token function">all</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// ...</span></span>
<span class="line">      <span class="token keyword">return</span> elements<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">el</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;hidden&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span>display <span class="token operator">===</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">true</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next, since we want to trap keyboard focus, itâ€™s only natural to retrieve a list of keyboard-only focusable elements. We can do that easily too. We only need to remove all <code>tabindex</code> values that are less than <code>0</code>.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getFocusableElements</span><span class="token punctuation">(</span><span class="token parameter">container <span class="token operator">=</span> document<span class="token punctuation">.</span>body</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">get</span> <span class="token function">all</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">get</span> <span class="token function">keyboardOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>all<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">el</span> <span class="token operator">=&gt;</span> el<span class="token punctuation">.</span>tabIndex <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, remember that there are two things we need to do for focus trapping:</p><ul><li>If a user tries to tab out from the last element, we return focus to the first one.</li><li>If the user tries to Shift + Tab out of the first element, we return focus back to the last one.</li></ul><p>This means we need to be able to find the first focusable item and the last focusable item. Luckily, we can add <code>first</code> and <code>last</code> getters to retrieve these elements easily inside <code>getFocusableElements</code>.</p><p>In this case, since weâ€™re dealing with keyboard elements, we can grab the first and last items from <code>keyboardOnly</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getFocusableElements</span><span class="token punctuation">(</span><span class="token parameter">container <span class="token operator">=</span> document<span class="token punctuation">.</span>body</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// ...</span></span>
<span class="line">    <span class="token keyword">get</span> <span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyboardOnly<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">get</span> <span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyboardOnly<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We have everything we need â€” next is to implement the focus trapping functionality.</p><hr><h2 id="how-to-trap-focus" tabindex="-1"><a class="header-anchor" href="#how-to-trap-focus"><span>How to trap focus</span></a></h2><p>First, we need to detect a keyboard event. We can do this easily with <code>addEventListener</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.some-element&#39;</span><span class="token punctuation">)</span></span>
<span class="line">container<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>We need to check if the user is:</p><ul><li>Pressing tab (without Shift)</li><li>Pressing tab (with Shift)</li></ul>`,19)),s("p",null,[s("a",A,[e(t,{icon:"fas fa-globe"}),n[17]||(n[17]=a("Splendid Labz",-1))]),n[18]||(n[18]=a(" has convenient functions to detect these as well:",-1))]),n[35]||(n[35]=i(`<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> isTab<span class="token punctuation">,</span> isShiftTab <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@splendidlabz/utils/dom&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ...</span></span>
<span class="line">container<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isTab</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Handle Tab</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isShiftTab</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Handle Shift Tab</span></span>
<span class="line">  <span class="token comment">/* ... */</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Of course, in the spirit of learning, letâ€™s figure out how to write the code from scratch:</p><ul><li>You can use <code>event.key</code> to detect whether the Tab key is being pressed.</li><li>You can use <code>event.shiftKey</code> to detect if the Shift key is being pressed</li></ul><p>Combine these two, you will be able to write your own <code>isTab</code> and <code>isShiftTab</code> functions:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">isTab</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token operator">!</span>event<span class="token punctuation">.</span>shiftKey <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>key <span class="token operator">===</span> <span class="token string">&#39;Tab&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">isShiftTab</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> event<span class="token punctuation">.</span>shiftKey <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>key <span class="token operator">===</span> <span class="token string">&#39;Tab&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Since weâ€™re only handling the Tab key, we can use an early return statement to skip the handling of other keys.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">container<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>key <span class="token operator">!==</span> <span class="token string">&#39;Tab&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isTab</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Handle Tab</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isShiftTab</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Handle Shift Tab</span></span>
<span class="line">  <span class="token comment">/* ... */</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We have almost everything we need now. The only thing is to know where the current focused element is at â€” so we can decide whether to trap focus or allow the default focus action to proceed.</p><p>We can do this with <code>document.activeElement</code>.</p><p>Going back to the steps:</p><ul><li>Shift focus if user Tab on the <em>last item</em></li><li>Shift focus if the user Shift + Tab on the <em>first</em> item</li></ul><p>Naturally, you can tell that we need to check whether <code>document.activeElement</code> is the first or last focusable item.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">container<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ...</span></span>
<span class="line">  <span class="token keyword">const</span> focusables <span class="token operator">=</span> <span class="token function">getFocusableElements</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">const</span> first <span class="token operator">=</span> focusables<span class="token punctuation">.</span>first</span>
<span class="line">  <span class="token keyword">const</span> last <span class="token operator">=</span> focusables<span class="token punctuation">.</span>last</span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>activeElement <span class="token operator">===</span> last <span class="token operator">&amp;&amp;</span> <span class="token function">isTab</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Shift focus to the first item</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>activeElement <span class="token operator">===</span> first <span class="token operator">&amp;&amp;</span> <span class="token function">isShiftTab</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Shift focus to the last item</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The final step is to use <code>focus</code> to bring focus to the item.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">container<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ...</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>activeElement <span class="token operator">===</span> last <span class="token operator">&amp;&amp;</span> <span class="token function">isTab</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    first<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>activeElement <span class="token operator">===</span> first <span class="token operator">&amp;&amp;</span> <span class="token function">isShiftTab</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    last<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thatâ€™s it! Pretty simple if you go through the sequence step-by-step, isnâ€™t it?</p><hr><h2 id="final-callout-to-splendid-labz" tabindex="-1"><a class="header-anchor" href="#final-callout-to-splendid-labz"><span>Final callout to Splendid Labz</span></a></h2>`,18)),s("p",null,[n[22]||(n[22]=a("As I resolve myself to stop teaching (so much) and begin building applications, I find myself needing many common ",-1)),s("a",E,[e(t,{icon:"fas fa-globe"}),n[19]||(n[19]=a("components",-1))]),n[23]||(n[23]=a(", ",-1)),s("a",F,[e(t,{icon:"fas fa-globe"}),n[20]||(n[20]=a("utilities",-1))]),n[24]||(n[24]=a(", even ",-1)),s("a",P,[e(t,{icon:"fas fa-globe"}),n[21]||(n[21]=a("styles",-1))]),n[25]||(n[25]=a(".",-1))]),n[36]||(n[36]=s("p",null,"Since I have the capability to build things for myself, (plus the fact that Iâ€™m super particular when it comes to good DX), Iâ€™ve decided to gather these things I find or build into a couple of easy-to-use libraries.",-1)),n[37]||(n[37]=s("p",null,"Just sharing these with you in hopes that they will help speed up your development workflow.",-1)),n[38]||(n[38]=s("p",null,"Thanks for reading my shameless plug. All the best for whatever you decide to code!",-1)),f(" TODO: add ARTICLE CARD "),e(c,u(r({title:"A Primer on Focus Trapping",desc:"Focus trapping is about managing focus within an element, such that focus always stays within it. The whole process sounds simple in theory, but it can quite difficult to build in practice, mostly because of the numerous parts to you got to manage.",link:"https://chanhi2000.github.io/bookshelf/css-tricks.com/a-primer-on-focus-trapping.html",logo:"https://css-tricks/favicon.svg",background:"rgba(17,17,17,0.2)"})),null,16)])}const N=v(y,[["render",I]]),O=JSON.parse('{"path":"/css-tricks.com/a-primer-on-focus-trapping.html","title":"A Primer on Focus Trapping","lang":"en-US","frontmatter":{"lang":"en-US","title":"A Primer on Focus Trapping","description":"Article(s) > A Primer on Focus Trapping","icon":"fa-brands fa-node","category":["Node.js","Article(s)"],"tag":["blog","css-tricks.com","node","nodejs","node-js"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"A Primer on Focus Trapping\\",\\"image\\":[\\"https://i0.wp.com/css-tricks.com/wp-content/uploads/2019/04/tab-key.png\\"],\\"datePublished\\":\\"2025-07-22T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Zell Liew\\",\\"url\\":\\"https://css-tricks.com/author/zellwk/\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/css-tricks.com/a-primer-on-focus-trapping.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"A Primer on Focus Trapping"}],["meta",{"property":"og:description","content":"Article(s) > A Primer on Focus Trapping"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://i0.wp.com/css-tricks.com/wp-content/uploads/2019/04/tab-key.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://i0.wp.com/css-tricks.com/wp-content/uploads/2019/04/tab-key.png"}],["meta",{"name":"twitter:image:alt","content":"A Primer on Focus Trapping"}],["meta",{"property":"article:author","content":"Zell Liew"}],["meta",{"property":"article:tag","content":"node-js"}],["meta",{"property":"article:tag","content":"nodejs"}],["meta",{"property":"article:tag","content":"node"}],["meta",{"property":"article:tag","content":"css-tricks.com"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2025-07-22T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > A Primer on Focus Trapping"},{"property":"og:description","content":"A Primer on Focus Trapping"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/css-tricks.com/a-primer-on-focus-trapping.html"}]],"prev":"/programming/js-node/articles/README.md","date":"2025-07-22T00:00:00.000Z","isOriginal":false,"author":[{"name":"Zell Liew","url":"https://css-tricks.com/author/zellwk/"}],"cover":"https://i0.wp.com/css-tricks.com/wp-content/uploads/2019/04/tab-key.png"},"git":{},"readingTime":{"minutes":4.77,"words":1430},"filePathRelative":"css-tricks.com/a-primer-on-focus-trapping.md","copyright":{"author":"Zell Liew"}}');export{N as comp,O as data};
