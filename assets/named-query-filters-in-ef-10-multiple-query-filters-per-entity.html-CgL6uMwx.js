import{_ as f}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as g,d as e,f as t,b as p,a as k,t as h,n as c,g as u,w as a,e as s,r as l,o as v}from"./app-BItykJLQ.js";const b={},w={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},F={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},q={class:"table-of-contents"},E={href:"https://learn.microsoft.com/en-us/ef/core/querying/filters",target:"_blank",rel:"noopener noreferrer"};function x(d,n){const r=l("VPCard"),o=l("router-link"),m=l("SiteInfo"),i=l("RouteLink"),y=l("VPIcon");return v(),g("div",null,[e("h1",w,[e("a",F,[e("span",null,h(d.$frontmatter.title)+" ê´€ë ¨",1)])]),t(r,c(u({title:"C# > Article(s)",desc:"Article(s)",link:"/programming/cs/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),e("nav",q,[e("ul",null,[e("li",null,[t(o,{to:"#what-are-query-filters"},{default:a(()=>[...n[0]||(n[0]=[s("What Are Query Filters?",-1)])]),_:1})]),e("li",null,[t(o,{to:"#using-multiple-query-filters"},{default:a(()=>[...n[1]||(n[1]=[s("Using Multiple Query Filters",-1)])]),_:1})]),e("li",null,[t(o,{to:"#tip-using-constants-for-filter-names"},{default:a(()=>[...n[2]||(n[2]=[s("Tip: Using Constants for Filter Names",-1)])]),_:1})]),e("li",null,[t(o,{to:"#wrapping-up"},{default:a(()=>[...n[3]||(n[3]=[s("Wrapping Up",-1)])]),_:1})])])]),n[28]||(n[28]=e("hr",null,null,-1)),t(m,{name:"Named Query Filters in EF 10 (multiple query filters per entity)",desc:"EF 10 introduces named query filters, allowing multiple filters on a single entity and letting you selectively disable specific filters without turning off all query filters. This article explains how the feature works, shows practical examples for combining soft deletion and multi-tenancy, highlights best practices like using constants for filter names, and explores where such fine-grained control is particularly useful.",url:"https://milanjovanovic.tech/blog/named-query-filters-in-ef-10-multiple-query-filters-per-entity",logo:"https://milanjovanovic.tech/profile_favicon.png",preview:"https://milanjovanovic.tech/blog-covers/mnw_152.png"}),e("p",null,[n[6]||(n[6]=s("Entity Framework Core's global query filters have long been a convenient way to apply common conditions to all queries on an entity. They're especially handy in scenarios like ",-1)),t(i,{to:"/milanjovanovic.tech/implementing-soft-delete-with-ef-core.html"},{default:a(()=>[...n[4]||(n[4]=[e("strong",null,"soft deletion",-1)])]),_:1}),n[7]||(n[7]=s(" and ",-1)),t(i,{to:"/milanjovanovic.tech/multi-tenant-applications-with-ef-core.html"},{default:a(()=>[...n[5]||(n[5]=[e("strong",null,"multi-tenancy",-1)])]),_:1}),n[8]||(n[8]=s(", where you want the same ",-1)),n[9]||(n[9]=e("code",null,"WHERE",-1)),n[10]||(n[10]=s(" clause added automatically to every query.",-1))]),n[29]||(n[29]=p('<p>Previous versions of EF Core, however, suffered from <strong>one big limitation</strong>: each entity type could only have one filter defined. If you needed to combine multiple conditions (for example, soft-delete and tenant isolation) you either had to write explicit <code>&amp;&amp;</code> expressions or manually disable and reapply filters in specific queries.</p><p>With EF 10, that changes. The new <strong>named query filters</strong> feature lets you attach multiple filters to a single entity and reference them by name. You can then disable individual filters as needed, rather than turning off all filters at once.</p><p>Let&#39;s explore this new capability, why it matters, and some practical ways to use it.</p><hr><h2 id="what-are-query-filters" tabindex="-1"><a class="header-anchor" href="#what-are-query-filters"><span>What Are Query Filters?</span></a></h2>',5)),e("p",null,[n[12]||(n[12]=s("If you've used EF Core for a while, you may already be familiar with ",-1)),e("a",E,[t(y,{icon:"fa-brands fa-microsoft"}),n[11]||(n[11]=s("global query filters",-1))]),n[13]||(n[13]=s(". A query filter is a condition that EF automatically applies to all queries for a particular entity type. Under the hood, EF adds a ",-1)),n[14]||(n[14]=e("code",null,"WHERE",-1)),n[15]||(n[15]=s(" clause whenever that entity is queried. Typical uses include:",-1))]),n[30]||(n[30]=p(`<ul><li><strong>Soft deletion</strong>: filtering out rows where IsDeleted is true so that deleted records don&#39;t show up in queries by default</li><li><strong>Multi-tenancy</strong>: filtering by a TenantId so that each tenant only sees its own data</li></ul><p>For example, a soft-delete filter might be configured like this:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line">modelBuilder<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Entity</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Order<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">HasQueryFilter</span><span class="token punctuation">(</span>order <span class="token operator">=&gt;</span> <span class="token operator">!</span>order<span class="token punctuation">.</span>IsDeleted<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>With the filter in place, every query on <code>Orders</code> automatically excludes soft-deleted records. To include deleted data (say, for an admin report), you can call <code>IgnoreQueryFilters()</code> on the query. The downside is that all filters on that entity are disabled, which opens the door to accidentally leaking data you don&#39;t intend to show.</p><hr><h2 id="using-multiple-query-filters" tabindex="-1"><a class="header-anchor" href="#using-multiple-query-filters"><span>Using Multiple Query Filters</span></a></h2><p>Until now, EF permitted only one query filter per entity. If you called <code>HasQueryFilter</code> twice on the same entity, the second call overwrote the first. To combine filters you had to write a single expression with <code>&amp;&amp;</code>:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line">modelBuilder<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Entity</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Order<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">HasQueryFilter</span><span class="token punctuation">(</span>order <span class="token operator">=&gt;</span> <span class="token operator">!</span>order<span class="token punctuation">.</span>IsDeleted <span class="token operator">&amp;&amp;</span> order<span class="token punctuation">.</span>TenantId <span class="token operator">==</span> tenantId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>This works but makes it impossible to selectively disable one condition. <code>IgnoreQueryFilters()</code> disables both, forcing you to manually re-apply whichever filter you still need. EF 10 introduces a better alternative: <strong>named query filters</strong>.</p><p>To attach multiple filters to an entity, call <code>HasQueryFilter</code> with a name for each filter:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line">modelBuilder<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Entity</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Order<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">HasQueryFilter</span><span class="token punctuation">(</span><span class="token string">&quot;SoftDeletionFilter&quot;</span><span class="token punctuation">,</span> order <span class="token operator">=&gt;</span> <span class="token operator">!</span>order<span class="token punctuation">.</span>IsDeleted<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">HasQueryFilter</span><span class="token punctuation">(</span><span class="token string">&quot;TenantFilter&quot;</span><span class="token punctuation">,</span> order <span class="token operator">=&gt;</span> order<span class="token punctuation">.</span>TenantId <span class="token operator">==</span> tenantId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Under the hood, EF creates separate filters identified by the names you provide. You can now turn off just the soft-delete filter while keeping the tenant filter in place:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token comment">// Returns all orders (including softâ€‘deleted) for the current tenant</span></span>
<span class="line"><span class="token class-name"><span class="token keyword">var</span></span> allOrders <span class="token operator">=</span> <span class="token keyword">await</span> context<span class="token punctuation">.</span>Orders<span class="token punctuation">.</span><span class="token function">IgnoreQueryFilters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;SoftDeletionFilter&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToListAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>If you omit the parameter array, <code>IgnoreQueryFilters()</code> disables all filters for the entity.</p><hr><h2 id="tip-using-constants-for-filter-names" tabindex="-1"><a class="header-anchor" href="#tip-using-constants-for-filter-names"><span>Tip: Using Constants for Filter Names</span></a></h2><p>Named filters use string keys. Hard-coding those names throughout your codebase makes it easy to introduce typos and brittle magic strings. To avoid this, define constants or enums for your filter names and reuse them wherever needed. For example:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">OrderFilters</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> SoftDelete <span class="token operator">=</span> <span class="token keyword">nameof</span><span class="token punctuation">(</span>SoftDelete<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> Tenant <span class="token operator">=</span> <span class="token keyword">nameof</span><span class="token punctuation">(</span>Tenant<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">modelBuilder<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Entity</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Order<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">HasQueryFilter</span><span class="token punctuation">(</span>OrderFilters<span class="token punctuation">.</span>SoftDelete<span class="token punctuation">,</span> order <span class="token operator">=&gt;</span> <span class="token operator">!</span>order<span class="token punctuation">.</span>IsDeleted<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">HasQueryFilter</span><span class="token punctuation">(</span>OrderFilters<span class="token punctuation">.</span>Tenant<span class="token punctuation">,</span> order <span class="token operator">=&gt;</span> order<span class="token punctuation">.</span>TenantId <span class="token operator">==</span> tenantId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Later in your query</span></span>
<span class="line"><span class="token class-name"><span class="token keyword">var</span></span> allOrders <span class="token operator">=</span> <span class="token keyword">await</span> context<span class="token punctuation">.</span>Orders<span class="token punctuation">.</span><span class="token function">IgnoreQueryFilters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">OrderFilters<span class="token punctuation">.</span>SoftDelete</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToListAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Having the filter names defined in a single place reduces duplication and improves maintainability. Another best practice is to wrap the ignore call in an extension method or repository so that consumers don&#39;t directly interact with filter names at all. For example:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">IQueryable<span class="token punctuation">&lt;</span>Order<span class="token punctuation">&gt;</span></span> <span class="token function">IncludeSoftDeleted</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IQueryable<span class="token punctuation">&lt;</span>Order<span class="token punctuation">&gt;</span></span> query<span class="token punctuation">)</span></span>
<span class="line">    <span class="token operator">=&gt;</span> query<span class="token punctuation">.</span><span class="token function">IgnoreQueryFilters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">OrderFilters<span class="token punctuation">.</span>SoftDelete</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>This makes your intent explicit and centralizes the filter logic in one place.</p><hr><h2 id="wrapping-up" tabindex="-1"><a class="header-anchor" href="#wrapping-up"><span>Wrapping Up</span></a></h2>`,23)),e("p",null,[n[17]||(n[17]=s("The introduction of ",-1)),n[18]||(n[18]=e("strong",null,"named query filters",-1)),n[19]||(n[19]=s(" in EF 10 removes one of the longstanding limitations of EF's ",-1)),t(i,{to:"/milanjovanovic.tech/how-to-use-global-query-filters-in-ef-core.html"},{default:a(()=>[...n[16]||(n[16]=[e("strong",null,"global query filters",-1)])]),_:1}),n[20]||(n[20]=s(" feature. You can now:",-1))]),e("ul",null,[n[26]||(n[26]=e("li",null,"Attach multiple filters to a single entity and manage them individually",-1)),n[27]||(n[27]=e("li",null,[s("Selectively disable specific filters in a LINQ query using "),e("code",null,'IgnoreQueryFilters(["FilterName"])')],-1)),e("li",null,[n[23]||(n[23]=s("Simplify common patterns like ",-1)),t(i,{to:"/milanjovanovic.tech/implementing-soft-delete-with-ef-core.html"},{default:a(()=>[...n[21]||(n[21]=[e("strong",null,"soft deletion",-1)])]),_:1}),n[24]||(n[24]=s(" plus ",-1)),t(i,{to:"/milanjovanovic.tech/multi-tenant-applications-with-ef-core.html"},{default:a(()=>[...n[22]||(n[22]=[e("strong",null,"multi-tenancy",-1)])]),_:1}),n[25]||(n[25]=s(" without resorting to complicated conditional logic",-1))])]),n[31]||(n[31]=e("p",null,"Named query filters can become a powerful tool to keep your queries clean and your domain logic encapsulated.",-1)),n[32]||(n[32]=e("p",null,"Whether you're building SaaS applications that isolate tenant data or ensuring that deleted records stay hidden until you explicitly need them, EF 10's named query filters offer the flexibility you've been waiting for.",-1)),n[33]||(n[33]=e("p",null,"Give them a try in the preview and start thinking about how they can simplify your codebase.",-1)),n[34]||(n[34]=e("hr",null,null,-1)),k(" TODO: add ARTICLE CARD "),t(r,c(u({title:"Named Query Filters in EF 10 (multiple query filters per entity)",desc:"EF 10 introduces named query filters, allowing multiple filters on a single entity and letting you selectively disable specific filters without turning off all query filters. This article explains how the feature works, shows practical examples for combining soft deletion and multi-tenancy, highlights best practices like using constants for filter names, and explores where such fine-grained control is particularly useful.",link:"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/named-query-filters-in-ef-10-multiple-query-filters-per-entity.html",logo:"https://milanjovanovic.tech/profile_favicon.png",background:"rgba(79,70,229,0.2)"})),null,16)])}const T=f(b,[["render",x]]),j=JSON.parse('{"path":"/milanjovanovic.tech/named-query-filters-in-ef-10-multiple-query-filters-per-entity.html","title":"Named Query Filters in EF 10 (multiple query filters per entity)","lang":"en-US","frontmatter":{"lang":"en-US","title":"Named Query Filters in EF 10 (multiple query filters per entity)","description":"Article(s) > Named Query Filters in EF 10 (multiple query filters per entity)","icon":"iconfont icon-csharp","category":["C#","DotNet","Article(s)"],"tag":["blog","milanjovanovic.tech","cs","c#","csharp","dotnet"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Named Query Filters in EF 10 (multiple query filters per entity)\\",\\"image\\":[\\"https://milanjovanovic.tech/blog-covers/mnw_152.png\\"],\\"datePublished\\":\\"2025-07-26T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Milan JovanoviÄ‡\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/named-query-filters-in-ef-10-multiple-query-filters-per-entity.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"Named Query Filters in EF 10 (multiple query filters per entity)"}],["meta",{"property":"og:description","content":"Article(s) > Named Query Filters in EF 10 (multiple query filters per entity)"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://milanjovanovic.tech/blog-covers/mnw_152.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://milanjovanovic.tech/blog-covers/mnw_152.png"}],["meta",{"name":"twitter:image:alt","content":"Named Query Filters in EF 10 (multiple query filters per entity)"}],["meta",{"property":"article:author","content":"Milan JovanoviÄ‡"}],["meta",{"property":"article:tag","content":"dotnet"}],["meta",{"property":"article:tag","content":"csharp"}],["meta",{"property":"article:tag","content":"c#"}],["meta",{"property":"article:tag","content":"cs"}],["meta",{"property":"article:tag","content":"milanjovanovic.tech"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2025-07-26T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Named Query Filters in EF 10 (multiple query filters per entity)"},{"property":"og:description","content":"Named Query Filters in EF 10 (multiple query filters per entity)"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/named-query-filters-in-ef-10-multiple-query-filters-per-entity.html"}]],"prev":"/programming/cs/articles/README.md","date":"2025-07-26T00:00:00.000Z","isOriginal":false,"author":"Milan JovanoviÄ‡","cover":"https://milanjovanovic.tech/blog-covers/mnw_152.png"},"git":{},"readingTime":{"minutes":3.84,"words":1153},"filePathRelative":"milanjovanovic.tech/named-query-filters-in-ef-10-multiple-query-filters-per-entity.md","copyright":{"author":"Milan JovanoviÄ‡"}}');export{T as comp,j as data};
