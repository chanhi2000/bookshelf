import{_ as g}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as v,d as s,f as e,b as c,a as h,t as b,n as r,g as u,w as o,e as a,r as p,o as f}from"./app-BItykJLQ.js";const w={},y={id:"frontmatter-title-á„€á…ªá†«á„…á…§á†«",tabindex:"-1"},S={class:"header-anchor",href:"#frontmatter-title-á„€á…ªá†«á„…á…§á†«"},x={class:"table-of-contents"},V={href:"https://milanjovanovic.tech/search?q=modular%20monolith",target:"_blank",rel:"noopener noreferrer"},A={href:"https://pinecone.io/",target:"_blank",rel:"noopener noreferrer"},q={href:"https://weaviate.io/",target:"_blank",rel:"noopener noreferrer"},z={href:"https://qdrant.tech/",target:"_blank",rel:"noopener noreferrer"},j={href:"https://cloud.google.com/discover/what-is-semantic-search",target:"_blank",rel:"noopener noreferrer"},I={href:"https://learn.microsoft.com/en-us/semantic-kernel/overview/",target:"_blank",rel:"noopener noreferrer"},C={href:"https://en.wikipedia.org/wiki/Metric_space",target:"_blank",rel:"noopener noreferrer"},T={href:"https://en.wikipedia.org/wiki/Cosine_similarity",target:"_blank",rel:"noopener noreferrer"},B={href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/s3-vectors-limitations.html",target:"_blank",rel:"noopener noreferrer"},D={href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/s3-vectors-metadata-filtering.html",target:"_blank",rel:"noopener noreferrer"};function E(m,n){const l=p("VPCard"),i=p("router-link"),k=p("SiteInfo"),d=p("RouteLink"),t=p("VPIcon");return f(),v("div",null,[s("h1",y,[s("a",S,[s("span",null,b(m.$frontmatter.title)+" ê´€ë ¨",1)])]),e(l,r(u({title:"C# > Article(s)",desc:"Article(s)",link:"/programming/cs/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),e(l,r(u({title:"AWS > Article(s)",desc:"Article(s)",link:"/devops/aws/articles/README.md",logo:"/images/ico-wind.svg",background:"rgba(10,10,10,0.2)"})),null,16),s("nav",x,[s("ul",null,[s("li",null,[e(i,{to:"#how-semantic-search-works"},{default:o(()=>[...n[0]||(n[0]=[a("How Semantic Search Works",-1)])]),_:1})]),s("li",null,[e(i,{to:"#generating-embeddings-with-semantic-kernel"},{default:o(()=>[...n[1]||(n[1]=[a("Generating Embeddings with Semantic Kernel",-1)])]),_:1})]),s("li",null,[e(i,{to:"#creating-your-s3-vector-bucket"},{default:o(()=>[...n[2]||(n[2]=[a("Creating Your S3 Vector Bucket",-1)])]),_:1})]),s("li",null,[e(i,{to:"#storing-vectors-with-metadata"},{default:o(()=>[...n[3]||(n[3]=[a("Storing Vectors with Metadata",-1)])]),_:1})]),s("li",null,[e(i,{to:"#querying-vector-indexes"},{default:o(()=>[...n[4]||(n[4]=[a("Querying Vector Indexes",-1)])]),_:1})]),s("li",null,[e(i,{to:"#next-steps"},{default:o(()=>[...n[5]||(n[5]=[a("Next Steps",-1)])]),_:1})])])]),n[40]||(n[40]=s("hr",null,null,-1)),e(k,{name:"Building Semantic Search with Amazon S3 Vectors",desc:"Learn how to add semantic search to your website using Amazon S3 Vectors - a new vector database service that's 90% cheaper than alternatives. Complete implementation guide using Semantic Kernel and .NET, from generating embeddings to querying vector indexes.",url:"https://milanjovanovic.tech/blog/building-semantic-search-with-amazon-s3-vectors",logo:"https://milanjovanovic.tech/profile_favicon.png",preview:"https://milanjovanovic.tech/blog-covers/mnw_158.png"}),s("p",null,[n[8]||(n[8]=a("I implemented ",-1)),e(d,{to:"/milanjovanovic.tech/how-i-implemented-full-text-search-on-my-website.html"},{default:o(()=>[...n[6]||(n[6]=[s("strong",null,"full-text search",-1)])]),_:1}),n[9]||(n[9]=a(" on my static website using Lunr.js. It works great for exact matches or phrases, but it doesn't understand meaning. Someone searches for ",-1)),s("a",V,[e(t,{icon:"fas fa-globe"}),n[7]||(n[7]=a('"modular monolith"',-1))]),n[10]||(n[10]=a(` and finds posts that contain these phrases. But when they search for "database performance issues," they might miss my articles about query optimization and index tuning, even though that's exactly what they need.`,-1))]),n[41]||(n[41]=s("p",null,[s("a",{href:"https://aws.amazon.com/blogs/aws/introducing-amazon-s3-vectors-first-cloud-storage-with-native-vector-support-at-scale/",target:"_blank",rel:"noopener noreferrer"},[s("strong",null,"Amazon S3 is now also a vector database")]),a(", and it's 90% cheaper (according to the announcement) than the alternatives.")],-1)),s("p",null,[n[14]||(n[14]=a("For those of us running static sites or simple web apps, it means we can finally add semantic search without the operational overhead of running a vector database like ",-1)),s("a",A,[e(t,{icon:"fas fa-globe"}),n[11]||(n[11]=a("Pinecone",-1))]),n[15]||(n[15]=a(", ",-1)),s("a",q,[e(t,{icon:"fas fa-globe"}),n[12]||(n[12]=a("Weaviate",-1))]),n[16]||(n[16]=a(", or ",-1)),s("a",z,[e(t,{icon:"fas fa-globe"}),n[13]||(n[13]=a("Qdrant",-1))]),n[17]||(n[17]=a(".",-1))]),n[42]||(n[42]=s("p",null,"Instead, we can just use S3 buckets that understand vectors.",-1)),n[43]||(n[43]=s("p",null,"I'm adding it alongside my existing full-text search implementation, and the whole thing took an afternoon to build.",-1)),n[44]||(n[44]=s("hr",null,null,-1)),n[45]||(n[45]=s("h2",{id:"how-semantic-search-works",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#how-semantic-search-works"},[s("span",null,"How Semantic Search Works")])],-1)),s("p",null,[n[19]||(n[19]=a("The entire ",-1)),s("a",j,[e(t,{icon:"iconfont icon-gcp"}),n[18]||(n[18]=a("semantic search",-1))]),n[20]||(n[20]=a(" flow is straightforward:",-1))]),n[46]||(n[46]=s("figure",null,[s("img",{src:"https://milanjovanovic.tech/blogs/mnw_158/semantic_search_flow.png?imwidth=3840",alt:"Semantic search flow",tabindex:"0",loading:"lazy"}),s("figcaption",null,"Semantic search flow")],-1)),n[47]||(n[47]=s("p",null,"You have to start with some data. In my case, this data comes from the articles I've written over the years.",-1)),n[48]||(n[48]=s("p",null,"Then we need an embedding model. Amazon Bedrock offers many to choose from. You use an embedding model to convert text into vectors. Vectors are numerical representations of your data that capture semantic meaning.",-1)),n[49]||(n[49]=s("p",null,"Finally, we store these vectors in an S3 Vector Bucket, a new type of S3 bucket designed specifically for vector storage and search. When someone searches, we convert their query into a vector and find the closest matches in the bucket.",-1)),s("p",null,[n[22]||(n[22]=a("If you want to understand the fundamentals, I wrote an article explaining what ",-1)),e(d,{to:"/milanjovanovic.tech/what-is-vector-search-a-concise-guide.html"},{default:o(()=>[...n[21]||(n[21]=[s("strong",null,"vector search",-1)])]),_:1}),n[23]||(n[23]=a(" is.",-1))]),n[50]||(n[50]=s("hr",null,null,-1)),n[51]||(n[51]=s("h2",{id:"generating-embeddings-with-semantic-kernel",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#generating-embeddings-with-semantic-kernel"},[s("span",null,"Generating Embeddings with Semantic Kernel")])],-1)),s("p",null,[n[25]||(n[25]=a("Microsoft's ",-1)),s("a",I,[e(t,{icon:"fa-brands fa-microsoft"}),n[24]||(n[24]=a("Semantic Kernel",-1))]),n[26]||(n[26]=a(" makes working with Bedrock surprisingly clean.",-1))]),n[52]||(n[52]=c(`<p>We&#39;ll need to install a few NuGet packages:</p><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code class="language-powershell"><span class="line"><span class="token comment"># Semantic kernel packages</span></span>
<span class="line"><span class="token function">Install-Package</span> Microsoft<span class="token punctuation">.</span>SemanticKernel</span>
<span class="line"><span class="token function">Install-Package</span> Microsoft<span class="token punctuation">.</span>SemanticKernel<span class="token punctuation">.</span>Connectors<span class="token punctuation">.</span>Amazon</span>
<span class="line"></span>
<span class="line"><span class="token comment"># AWS SDK for Bedrock</span></span>
<span class="line"><span class="token function">Install-Package</span> AWSSDK<span class="token punctuation">.</span>BedrockRuntime</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We have to configure the embedding generator in our application. Here we can specify which model to use for generating embeddings. I&#39;ll use the Amazon Titan embedding model (<code>amazon.titan-embed-text-v2:0</code>) which produces 1024-dimensional vectors.</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line">builder<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddBedrockEmbeddingGenerator</span><span class="token punctuation">(</span><span class="token string">&quot;amazon.titan-embed-text-v2:0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">builder<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token function">AddTransient</span><span class="token punctuation">(</span>sp <span class="token operator">=&gt;</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Kernel</span><span class="token punctuation">(</span>sp<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And then we can use the <code>IEmbeddingGenerator</code> abstraction to generate embeddings:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token class-name"><span class="token keyword">var</span></span> kernel <span class="token operator">=</span> app<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Kernel<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name"><span class="token keyword">var</span></span> embeddingGenerator <span class="token operator">=</span> kernel<span class="token punctuation">.</span>Services</span>
<span class="line">    <span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IEmbeddingGenerator<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> Embedding<span class="token punctuation">&lt;</span><span class="token keyword">float</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name"><span class="token keyword">var</span></span> articleContent <span class="token operator">=</span> <span class="token keyword">await</span> blogService<span class="token punctuation">.</span><span class="token function">GetBlogContentAsync</span><span class="token punctuation">(</span>articleUrl<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">Embedding<span class="token punctuation">&lt;</span><span class="token keyword">float</span><span class="token punctuation">&gt;</span></span> embedding <span class="token operator">=</span> <span class="token keyword">await</span> embeddingGenerator<span class="token punctuation">.</span><span class="token function">GenerateAsync</span><span class="token punctuation">(</span>articleContent<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">embeddings<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">(</span>articleUrl<span class="token punctuation">,</span> embedding<span class="token punctuation">.</span>Vector<span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The number of dimensions varies depending on the embedding model you choose. You can find more information about that in the documentation for your specific model.</p><hr><h2 id="creating-your-s3-vector-bucket" tabindex="-1"><a class="header-anchor" href="#creating-your-s3-vector-bucket"><span>Creating Your S3 Vector Bucket</span></a></h2><p>S3 Vectors uses an entirely new bucket type, not a feature you enable on existing buckets. They&#39;re a fundamentally different storage system optimized for vector operations. Creating one feels familiar if you&#39;ve used S3 before:</p><figure><img src="https://milanjovanovic.tech/blogs/mnw_158/s3_vectors_bucket.png?imwidth=3840" alt="Creating S3 Vectors bucket" tabindex="0" loading="lazy"><figcaption>Creating S3 Vectors bucket</figcaption></figure><p>Pick a unique name for your vector bucket:</p><figure><img src="https://milanjovanovic.tech/blogs/mnw_158/s3_vectors_bucket_create.png?imwidth=3840" alt="Creating S3 Vectors bucket" tabindex="0" loading="lazy"><figcaption>Creating S3 Vectors bucket</figcaption></figure>`,13)),s("p",null,[n[29]||(n[29]=a("And finally, you can create a ",-1)),n[30]||(n[30]=s("strong",null,"vector index",-1)),n[31]||(n[31]=a(" for your bucket. You get to choose the number of dimensions in each vector. This is dictated by the embedding model you use. All vectors within a vector index should use the same embedding model. Otherwise, you won't get the correct results when searching. You also have to choose the ",-1)),s("a",C,[e(t,{icon:"fa-brands fa-wikipedia-w"}),n[27]||(n[27]=a("distance metric",-1))]),n[32]||(n[32]=a(" (e.g., cosine similarity, Euclidean distance) for your vector index. I went with ",-1)),s("a",T,[e(t,{icon:"fa-brands fa-wikipedia-w"}),n[28]||(n[28]=a("cosine similarity",-1))]),n[33]||(n[33]=a(", which is a common choice for text embeddings. The additional settings let you configure non-filterable metadata. By default, all metadata is filterable.",-1))]),n[53]||(n[53]=s("figure",null,[s("img",{src:"https://milanjovanovic.tech/blogs/mnw_158/s3_vectors_index_create.png?imwidth=3840",alt:"Creating S3 Vectors bucket",tabindex:"0",loading:"lazy"}),s("figcaption",null,"Creating S3 Vectors bucket")],-1)),s("p",null,[n[35]||(n[35]=a("The UI is not polished at all, and you can't do much else. I expect this will improve over time, but for now, everything else is done via the SDK or CLI. There are certain limitations to be aware of, you can check out the docs ",-1)),s("a",B,[e(t,{icon:"fa-brands fa-aws"}),n[34]||(n[34]=a("here",-1))]),n[36]||(n[36]=a(".",-1))]),n[54]||(n[54]=c(`<hr><h2 id="storing-vectors-with-metadata" tabindex="-1"><a class="header-anchor" href="#storing-vectors-with-metadata"><span>Storing Vectors with Metadata</span></a></h2><p>Now that we have our vector index, we can start storing vector embeddings with metadata. Metadata is interesting because it enables filtered searches. Want to search only recent posts? Posts in a specific category? The metadata makes it possible.</p><p>Here&#39;s how you can store vectors:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">IndexBlogPost</span><span class="token punctuation">(</span><span class="token class-name">BlogPost</span> post<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">float</span><span class="token punctuation">&gt;</span></span> embedding <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">GenerateEmbedding</span><span class="token punctuation">(</span>post<span class="token punctuation">.</span>Content<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">await</span> s3VectorsClient<span class="token punctuation">.</span><span class="token function">PutVectorsAsync</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">PutVectorsRequest</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        VectorBucketName <span class="token operator">=</span> <span class="token string">&quot;mjtech-articles-semantic-search&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        IndexName <span class="token operator">=</span> <span class="token string">&quot;mjtech-article-content&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        Vectors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Vector<span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PutInputVector</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                Key <span class="token operator">=</span> post<span class="token punctuation">.</span>Slug<span class="token punctuation">,</span></span>
<span class="line">                Data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">VectorData</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    Float32 <span class="token operator">=</span> embedding</span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                Metadata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Document</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> Document<span class="token punctuation">&gt;</span></span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> post<span class="token punctuation">.</span>Title<span class="token punctuation">,</span></span>
<span class="line">                    <span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> post<span class="token punctuation">.</span>PublishedDate<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token punctuation">[</span><span class="token string">&quot;category&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> post<span class="token punctuation">.</span>Category<span class="token punctuation">,</span></span>
<span class="line">                    <span class="token punctuation">[</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$&quot;/posts/</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">post<span class="token punctuation">.</span>Slug</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>But if you&#39;re indexing your entire blog archive, doing it one post at a time is costly. You can batch together multiple posts and index them in a single API call. The SDK makes it easy to do this by accepting a list of vectors.</p><hr><h2 id="querying-vector-indexes" tabindex="-1"><a class="header-anchor" href="#querying-vector-indexes"><span>Querying Vector Indexes</span></a></h2><p>When someone searches your site, you convert their query into a vector and find the closest matches.</p><p>Here&#39;s how you can implement semantic search:</p><div class="language-csharp line-numbers-mode" data-highlighter="prismjs" data-ext="cs"><pre><code class="language-csharp"><span class="line"><span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>List<span class="token punctuation">&lt;</span>SearchResult<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">SemanticSearch</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token class-name"><span class="token keyword">string</span></span> query<span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name"><span class="token keyword">int</span></span> topK <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Convert search query to vector (use same model as vectors!)</span></span>
<span class="line">    <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">float</span><span class="token punctuation">&gt;</span></span> queryEmbedding <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">GenerateEmbedding</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name"><span class="token keyword">var</span></span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QueryVectorsRequest</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        VectorBucketName <span class="token operator">=</span> <span class="token string">&quot;mjtech-articles-semantic-search&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        IndexName <span class="token operator">=</span> <span class="token string">&quot;mjtech-article-content&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        QueryVector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">VectorData</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            Float32 <span class="token operator">=</span> queryEmbedding</span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        TopK <span class="token operator">=</span> topK<span class="token punctuation">,</span></span>
<span class="line">        ReturnMetadata <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">        ReturnDistance <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">QueryVectorsResponse</span> response <span class="token operator">=</span> <span class="token keyword">await</span> s3VectorsClient<span class="token punctuation">.</span><span class="token function">QueryVectorsAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> response<span class="token punctuation">.</span>Vectors<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SearchResult</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        Distance <span class="token operator">=</span> v<span class="token punctuation">.</span>Distance<span class="token punctuation">,</span></span>
<span class="line">        Title <span class="token operator">=</span> v<span class="token punctuation">.</span>Metadata<span class="token punctuation">.</span><span class="token function">AsDictionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        Url <span class="token operator">=</span> v<span class="token punctuation">.</span>Metadata<span class="token punctuation">.</span><span class="token function">AsDictionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        Category <span class="token operator">=</span> v<span class="token punctuation">.</span>Metadata<span class="token punctuation">.</span><span class="token function">AsDictionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;category&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11)),s("p",null,[n[38]||(n[38]=a("I omitted metadata filtering here, but you can explore the ",-1)),s("a",D,[e(t,{icon:"fa-brands fa-aws"}),n[37]||(n[37]=a("documentation",-1))]),n[39]||(n[39]=a(" for more details.",-1))]),n[55]||(n[55]=c('<hr><h2 id="next-steps" tabindex="-1"><a class="header-anchor" href="#next-steps"><span>Next Steps</span></a></h2><p>Would I migrate from an existing vector database? Probably not if everything&#39;s working. The operational overhead would have to justify the switch.</p><p>But if you&#39;re adding semantic search for the first time, or your vector database bills are getting uncomfortable, S3 Vectors is a viable choice. The setup takes an afternoon, the ongoing maintenance is zero, and your users get search that actually understands what they&#39;re looking for.</p><p>Don&#39;t forget that S3 Vectors is still in preview, so we can expect some changes before general availability.</p><p>Here&#39;s what I&#39;m planning to do next:</p><ol><li>Automatically update the vector index when I publish a new post. I can do this in my CI/CD pipeline, where I can detect new posts and trigger a re-indexing.</li><li>Expose a search endpoint that uses the new semantic search capabilities. Combine the results with the full-text search results.</li><li>Make sure everything is performant and cost-effective. Acceptable latency is under 500ms.</li><li>Share details about the implementation and any challenges faced. Especially around the costs of using an embedding model and vector storage.</li></ol><hr>',8)),h(" TODO: add ARTICLE CARD "),e(l,r(u({title:"Building Semantic Search with Amazon S3 Vectors",desc:"Learn how to add semantic search to your website using Amazon S3 Vectors - a new vector database service that's 90% cheaper than alternatives. Complete implementation guide using Semantic Kernel and .NET, from generating embeddings to querying vector indexes.",link:"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/building-semantic-search-with-amazon-s3-vectors.html",logo:"https://milanjovanovic.tech/profile_favicon.png",background:"rgba(79,70,229,0.2)"})),null,16)])}const R=g(w,[["render",E]]),K=JSON.parse('{"path":"/milanjovanovic.tech/building-semantic-search-with-amazon-s3-vectors.html","title":"Building Semantic Search with Amazon S3 Vectors","lang":"en-US","frontmatter":{"lang":"en-US","title":"Building Semantic Search with Amazon S3 Vectors","description":"Article(s) > Building Semantic Search with Amazon S3 Vectors","icon":"iconfont icon-csharp","category":["C#","DotNet","DevOps","AWS","Article(s)"],"tag":["blog","milanjovanovic.tech","cs","c#","csharp","dotnet","devops","aws","amazon","amazon-web-services"],"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Building Semantic Search with Amazon S3 Vectors\\",\\"image\\":[\\"https://milanjovanovic.tech/blogs/mnw_158/semantic_search_flow.png?imwidth=3840\\",\\"https://milanjovanovic.tech/blogs/mnw_158/s3_vectors_bucket.png?imwidth=3840\\",\\"https://milanjovanovic.tech/blogs/mnw_158/s3_vectors_bucket_create.png?imwidth=3840\\",\\"https://milanjovanovic.tech/blogs/mnw_158/s3_vectors_index_create.png?imwidth=3840\\"],\\"datePublished\\":\\"2025-09-06T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Milan JovanoviÄ‡\\"}]}"],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/building-semantic-search-with-amazon-s3-vectors.html"}],["meta",{"property":"og:site_name","content":"ðŸ“šBookshelf"}],["meta",{"property":"og:title","content":"Building Semantic Search with Amazon S3 Vectors"}],["meta",{"property":"og:description","content":"Article(s) > Building Semantic Search with Amazon S3 Vectors"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://milanjovanovic.tech/blog-covers/mnw_158.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://milanjovanovic.tech/blog-covers/mnw_158.png"}],["meta",{"name":"twitter:image:alt","content":"Building Semantic Search with Amazon S3 Vectors"}],["meta",{"property":"article:author","content":"Milan JovanoviÄ‡"}],["meta",{"property":"article:tag","content":"amazon-web-services"}],["meta",{"property":"article:tag","content":"amazon"}],["meta",{"property":"article:tag","content":"aws"}],["meta",{"property":"article:tag","content":"devops"}],["meta",{"property":"article:tag","content":"dotnet"}],["meta",{"property":"article:tag","content":"csharp"}],["meta",{"property":"article:tag","content":"c#"}],["meta",{"property":"article:tag","content":"cs"}],["meta",{"property":"article:tag","content":"milanjovanovic.tech"}],["meta",{"property":"article:tag","content":"blog"}],["meta",{"property":"article:published_time","content":"2025-09-06T00:00:00.000Z"}],[{"meta":null},{"property":"og:title","content":"Article(s) > Building Semantic Search with Amazon S3 Vectors"},{"property":"og:description","content":"Building Semantic Search with Amazon S3 Vectors"},{"property":"og:url","content":"https://chanhi2000.github.io/bookshelf/milanjovanovic.tech/building-semantic-search-with-amazon-s3-vectors.html"}]],"prev":"/programming/cs/articles/README.md","date":"2025-09-06T00:00:00.000Z","isOriginal":false,"author":"Milan JovanoviÄ‡","cover":"https://milanjovanovic.tech/blog-covers/mnw_158.png"},"git":{},"readingTime":{"minutes":5.09,"words":1528},"filePathRelative":"milanjovanovic.tech/building-semantic-search-with-amazon-s3-vectors.md","copyright":{"author":"Milan JovanoviÄ‡"}}');export{R as comp,K as data};
