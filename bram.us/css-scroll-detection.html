<!doctype html>
<html lang="en-US" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.99" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed","image":["https://bram.us/wordpress/wp-content/uploads/2017/10/badass_homepage_shoot_02.gif","https://bram.us/wordpress/wp-content/uploads/2023/10/sda-custom-property-main-thread.png","https://bram.us/wordpress/wp-content/uploads/2017/10/badass_homepage_shoot_02.gif","https://bram.us/wordpress/wp-content/uploads/2023/10/sda-custom-property-main-thread.png"],"datePublished":"2023-10-24T00:00:00.000Z","dateModified":null,"author":[{"@type":"Person","name":"Bramus!","url":"https://bram.us/author/bramus/"}]}</script><meta property="og:url" content="https://chanhi2000.github.io/bookshelf/bram.us/css-scroll-detection.html"><meta property="og:site_name" content="üìöBookshelf"><meta property="og:title" content="Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed"><meta property="og:description" content="Article(s) > Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed"><meta property="og:type" content="article"><meta property="og:image" content="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-short-020p-10fps.gif"><meta property="og:locale" content="en-US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:src" content="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-short-020p-10fps.gif"><meta name="twitter:image:alt" content="Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed"><meta property="article:author" content="Bramus!"><meta property="article:tag" content="css"><meta property="article:tag" content="bram.us"><meta property="article:tag" content="blog"><meta property="article:published_time" content="2023-10-24T00:00:00.000Z"><link rel="icon" href="/bookshelf/assets/icon/favicon.svg"><title>Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed | üìöBookshelf</title><meta name="description" content="Article(s) > Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed">
    <link rel="preload" href="/bookshelf/assets/style-Bhb-QcDa.css" as="style"><link rel="stylesheet" href="/bookshelf/assets/style-Bhb-QcDa.css">
    
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/bookshelf/" aria-label="Take me home"><img class="vp-nav-logo" src="/bookshelf/assets/icon/favicon.svg" alt><!----><span class="vp-site-name hide-in-pad">üìöBookshelf</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/bookshelf/news.html" aria-label><!--[--><i class="vp-icon fas fa-rss" sizing="height"></i><!--]--><!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-keyboard" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/hackingwithswift.com/" aria-label="hackingwithswift.com"><!--[--><img class="vp-icon" src="https://hackingwithswift.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->hackingwithswift.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fcc/" aria-label="freecodecamp.org"><!--[--><img class="vp-icon" src="https://cdn.freecodecamp.org/universal/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->freecodecamp.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kodeco.com/" aria-label="kodeco.com"><!--[--><img class="vp-icon" src="https://kodeco.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->kodeco.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.kotzilla.io/" aria-label="blog.kotzilla.io"><!--[--><img class="vp-icon" src="https://blog.kotzilla.io/hubfs/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.kotzilla.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kt.academy/" aria-label="kt.academy"><!--[--><img class="vp-icon" src="https://kt.academy/logo.png" alt aria-hidden no-view sizing="both"><!--]-->kt.academy<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/droidcon.com/" aria-label="droidcon.com"><!--[--><img class="vp-icon" src="https://droidcon.com/wp-content/uploads/2021/07/favicon-300x300.png" alt aria-hidden no-view sizing="both"><!--]-->droidcon.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/outcomeschool.com/" aria-label="outcomeschool.com"><!--[--><img class="vp-icon" src="https://outcomeschool.com/static/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->outcomeschool.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/frontendmasters.com/" aria-label="frontendmasters.com"><!--[--><img class="vp-icon" src="https://frontendmasters.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->frontendmasters.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tricks.com/" aria-label="css-tricks.com"><!--[--><img class="vp-icon" src="https://css-tricks.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->css-tricks.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="smashingmagazine.com"><!--[--><img class="vp-icon" src="https://smashingmagazine.com/images/favicon/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->smashingmagazine.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="oddbird.net"><!--[--><img class="vp-icon" src="https://oddbird.net/safari-pinned-tab.svg" alt aria-hidden no-view sizing="both"><!--]-->oddbird.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/zeroheight.com/" aria-label="zeroheight.com"><!--[--><img class="vp-icon" src="https://zeroheight.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->zeroheight.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/typescript.tv/" aria-label="typescript.tv"><!--[--><img class="vp-icon" src="https://typescript.tv/_astro/android-chrome-192x192.BhQ8hcWh.png" alt aria-hidden no-view sizing="both"><!--]-->typescript.tv<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.logrocket.com/" aria-label="blog.logrocket.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/blog.logrocket.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.logrocket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/realpython.com/" aria-label="realpython.com"><!--[--><img class="vp-icon" src="https://realpython.com/static/favicon.68cbf4197b0c.png" alt aria-hidden no-view sizing="both"><!--]-->realpython.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/digitalocean.com/" aria-label="digitalocean.com"><!--[--><img class="vp-icon" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt aria-hidden no-view sizing="both"><!--]-->digitalocean.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/antonioleiva.com/" aria-label="antonioleiva.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/antonioleiva.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->antonioleiva.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/johnnyreilly.com/" aria-label="johnnyreilly.com"><!--[--><img class="vp-icon" src="https://johnnyreilly.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->johnnyreilly.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/code-maze.com/" aria-label="code-maze.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/code-maze.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->code-maze.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/milanjovanovic.tech/" aria-label="milanjovanovic.tech"><!--[--><img class="vp-icon" src="https://milanjovanovic.tech/profile_favicon.png" alt aria-hidden no-view sizing="both"><!--]-->milanjovanovic.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/shopify.engineering/" aria-label="shopify.engineering"><!--[--><img class="vp-icon" src="https://cdn.shopify.com/static/shopify-favicon.png" alt aria-hidden no-view sizing="both"><!--]-->shopify.engineering<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devtoolstips.org/" aria-label="devtoolstips.org"><!--[--><img class="vp-icon" src="https://devtoolstips.org/assets/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devtoolstips.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/piccalil.li/" aria-label="piccalil.li"><!--[--><img class="vp-icon" src="https://piccalil.li/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->piccalil.li<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/sitepoint.com/" aria-label="sitepoint.com"><!--[--><img class="vp-icon" src="https://sitepoint.com/favicons/512x512.png" alt aria-hidden no-view sizing="both"><!--]-->sitepoint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/event-driven.io/" aria-label="event-driven.io"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/event-driven.io/favicon.jfif" alt aria-hidden no-view sizing="both"><!--]-->event-driven.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/packagemain.tech/" aria-label="packagemain.tech"><!--[--><img class="vp-icon" src="https://substack-post-media.s3.amazonaws.com/public/images/2ea54e25-eaa6-4630-bfc0-10b8cfdce894/apple-touch-icon-1024x1024.png" alt aria-hidden no-view sizing="both"><!--]-->packagemain.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/gosolve.io/" aria-label="gosolve.io"><!--[--><img class="vp-icon" src="https://gosolve.io/wp-content/uploads/2022/03/cropped-ikona1-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->gosolve.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/bookshelf/bram.us/" aria-label="bram.us"><!--[--><img class="vp-icon" src="https://bram.us/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->bram.us<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/una.im/" aria-label="una.im"><!--[--><img class="vp-icon" src="https://una.im/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->una.im<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/joshwcomeau.com/" aria-label="joshwcomeau.com"><!--[--><img class="vp-icon" src="https://joshwcomeau.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->joshwcomeau.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tip.com/" aria-label="css-tip.com"><!--[--><img class="vp-icon" src="https://css-tip.com/img/fav.png" alt aria-hidden no-view sizing="both"><!--]-->css-tip.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/nerdy.dev/" aria-label="nerdy.dev"><!--[--><img class="vp-icon" src="https://nerdy.dev/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->nerdy.dev<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/towardsdatascience.com/" aria-label="towardsdatascience.com"><!--[--><img class="vp-icon" src="https://cdn-images-1.medium.com/v2/resize:fill:128:128/1*VzTUkfeGymHP4Bvav-T-lA.png" alt aria-hidden no-view sizing="both"><!--]-->towardsdatascience.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/douggregor.net/" aria-label="douggregor.net"><!--[--><i class="vp-icon fas fa-globe" sizing="both"></i><!--]-->douggregor.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/d2.naver.com/" aria-label="d2.naver.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/d2.naver.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->d2.naver.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakao.com/" aria-label="tech.kakao.com"><!--[--><img class="vp-icon" src="https://www.kakaocorp.com/page/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakao.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakaopay.com/" aria-label="tech.kakaopay.com"><!--[--><img class="vp-icon" src="https://tech.kakaopay.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakaopay.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fe-developers.kakaoent.com/" aria-label="fe-developers.kakaoent.com"><!--[--><img class="vp-icon" src="https://fe-developers.kakaoent.com/favicon-32x32.png?v=44803cb16c1e2debd3984cf2e8cb2ded" alt aria-hidden no-view sizing="both"><!--]-->fe-developers.kakaoent.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/yozm.wishket.com/" aria-label="yozm.wishket.com"><!--[--><img class="vp-icon" src="https://yozm.wishket.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->yozm.wishket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/popit.kr/" aria-label="popit.kr"><!--[--><img class="vp-icon" src="https://popit.kr/wp-content/uploads/2016/08/favicon_32x32.png" alt aria-hidden no-view sizing="both"><!--]-->popit.kr<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devkuma.com/" aria-label="devkuma.com"><!--[--><img class="vp-icon" src="https://devkuma.com/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devkuma.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.gangnamunni.com/" aria-label="blog.gangnamunni.com"><!--[--><img class="vp-icon" src="https://blog.gangnamunni.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->blog.gangnamunni.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/codingeverybody.kr/" aria-label="codingeverybody.kr"><!--[--><img class="vp-icon" src="https://codingeverybody.kr/wp-content/uploads/cropped-favicon-origin-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->codingeverybody.kr<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-network-wired" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tecmint.com/" aria-label="tecmint.com"><!--[--><img class="vp-icon" src="https://tecmint.com/wp-content/uploads/2020/07/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tecmint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/docker.com/" aria-label="docker.com"><!--[--><img class="vp-icon" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->docker.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/learnkube.com/" aria-label="learnkube.com"><!--[--><img class="vp-icon" src="https://static.learnkube.com/f7e5160d4744cf05c46161170b5c11c9.svg" alt aria-hidden no-view sizing="both"><!--]-->learnkube.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/itsfoss.com/" aria-label="itsfoss.com"><!--[--><img class="vp-icon" src="https://itsfoss.com/content/images/size/w256h256/2022/12/android-chrome-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->itsfoss.com<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/chanhi2000/bookshelf" target="_blank" rel="noopener noreferrer" aria-label="Github"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><!----></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><img class="vp-icon" src="https://bram.us/favicon.ico" alt aria-hidden no-view sizing="both"><span class="vp-sidebar-title">bram.us</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2025</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2024</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">2023</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/bookshelf/bram.us/css-scroll-detection.html" aria-label="Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/bram.us/the-future-of-css-easy-light-dark-mode-color-switching-with-light-dark.html" aria-label="The Future of CSS: Easy Light-Dark Mode Color Switching with light-dark()"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->The Future of CSS: Easy Light-Dark Mode Color Switching with light-dark()<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/bram.us/solved-by-css-scroll-driven-animations-detect-if-an-element-can-scroll-or-not.html" aria-label="Solved by CSS Scroll-Driven Animations: Detect if an element can scroll or not"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->Solved by CSS Scroll-Driven Animations: Detect if an element can scroll or not<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/bram.us/faking-a-snapped-selector-with-scroll-driven-animations.html" aria-label="Solved by CSS Scroll-Driven Animations: A :snapped selector"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->Solved by CSS Scroll-Driven Animations: A :snapped selector<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/bram.us/scroll-triggered-animations.html" aria-label="Creating Scroll-Triggered Animations by combining Scroll-Driven Animations, Custom Properties, Style Queries, and Transitions"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->Creating Scroll-Triggered Animations by combining Scroll-Driven Animations, Custom Properties, Style Queries, and Transitions<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/bram.us/introducing-scroll-driven-animations-style.html" aria-label="Introducing scroll-driven-animations.style"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->Introducing scroll-driven-animations.style<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/bram.us/whats-new-in-web-animations.html" aria-label="What‚Äôs new in web animations (Google I/O 2023)"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->What‚Äôs new in web animations (Google I/O 2023)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/bram.us/the-gotcha-with-animating-custom-properties.html" aria-label="The gotcha with @property animating custom properties"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->The gotcha with @property animating custom properties<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2022</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2021</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2020</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2019</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2017</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2016</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-short-020p-10fps.gif" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon fa-brands fa-css3-alt" sizing="height"></i>Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed</h1><div class="page-info"><span class="page-author-info" aria-label="Authorüñä" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://bram.us/author/bramus/" target="_blank" rel="noopener noreferrer">Bramus!</a></span><span property="author" content="Bramus!"></span></span><!----><span class="page-date-info" aria-label="Writing DateüìÖ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">10/24/23</span><meta property="datePublished" content="2023-10-24T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time‚åõ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 31 min</span><meta property="timeRequired" content="PT31M"></span><span class="page-category-info" aria-label="Categoryüåà" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color7" role>CSS</span><span class="page-category-item color8" role>Article(s)</span><!--]--><meta property="articleSection" content="CSS,Article(s)"></span><span class="page-tag-info" aria-label="Tagüè∑" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8" role>blog</span><span class="page-tag-item color2" role>bram.us</span><span class="page-tag-item color2" role>css</span><!--]--><meta property="keywords" content="blog,bram.us,css"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´" tabindex="-1"><a class="header-anchor" href="#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"><span>Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed Í¥ÄÎ†®</span></a></h1><a class="route-link vp-card" href="/bookshelf/programming/css/articles/" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="/bookshelf/images/ico-wind.svg" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">CSS > Article(s)</div><hr><div class="vp-card-desc">Article(s)</div></div></a><nav class="table-of-contents"><ul><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#table-of-contents" class="router-link-active router-link-exact-active">Table of Contents</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#the-code" class="router-link-active router-link-exact-active">The Code</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#the-concept" class="router-link-active router-link-exact-active">The Concept</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#basic-demos" class="router-link-active router-link-exact-active"># Basic demos</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#intermezzo-what-about-style-queries" class="router-link-active router-link-exact-active"># Intermezzo: what about Style Queries?</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#combine-multiple-scroll-states-thanks-to-more-maths" class="router-link-active router-link-exact-active"># Combine multiple scroll states, thanks to more Maths</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#lerp-effects" class="router-link-active router-link-exact-active"># LERP-effects</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#more-demos" class="router-link-active router-link-exact-active"># More Demos</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#a-note-on-performance" class="router-link-active router-link-exact-active"># A note on performance</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#closing-thoughts" class="router-link-active router-link-exact-active"># Closing Thoughts</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#spread-the-word-name-spread-the-word" class="router-link-active router-link-exact-active">[#](#spread-the-word name=) Spread the word</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#lang-en-ustitle-solved-by-css-scroll-driven-animations-style-an-element-based-on-the-active-scroll-direction-and-scroll-speed-description-article-s-solved-by-css-scroll-driven-animations-style-an-element-based-on-the-active-scroll-direction-and-scroll-speed-icon-category" class="router-link-active router-link-exact-active">lang: en-UStitle: &quot;Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed&quot;description: &quot;Article(s) &gt; Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed&quot;icon:category:</a><ul><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#table-of-contents-1" class="router-link-active router-link-exact-active">Table of Contents</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#the-code-1" class="router-link-active router-link-exact-active"># The Code</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#the-concept-1" class="router-link-active router-link-exact-active"># The Concept</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#basic-demos-1" class="router-link-active router-link-exact-active"># Basic demos</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#intermezzo-what-about-style-queries-1" class="router-link-active router-link-exact-active"># Intermezzo: what about Style Queries?</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#combine-multiple-scroll-states-thanks-to-more-maths-1" class="router-link-active router-link-exact-active"># Combine multiple scroll states, thanks to more Maths</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#lerp-effects-1" class="router-link-active router-link-exact-active"># LERP-effects</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#more-demos-1" class="router-link-active router-link-exact-active"># More Demos</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#a-note-on-performance-1" class="router-link-active router-link-exact-active"># A note on performance</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#closing-thoughts-1" class="router-link-active router-link-exact-active"># Closing Thoughts</a></li></ul></li></ul></nav><hr><div class="vp-site-info" data-name="Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed"><a class="vp-site-info-navigator no-external-link-icon" title="Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed" href="https://bram.us/2023/10/23/css-scroll-detection/" target="_blank"></a><div class="vp-site-info-preview" style="background:url(https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-short-020p-10fps.gif) center/cover no-repeat;"></div><div class="vp-site-info-detail"><img class="vp-site-info-logo" src="https://bramu.us/favicon.ico" alt loading="lazy" no-view><div class="vp-site-info-name">Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed</div><div class="vp-site-info-desc">Combine Scroll-Driven Animations with @‚Äãproperty, transition-delay, calc(), sign() and abs() ‚Ä¶ and you can do Scroll Detection using only CSS!</div></div><!----></div><div></div><div class="hint-container note"><p class="hint-container-title">Note</p><p><a href="https://scroll-driven-animations.style/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Scroll-Driven Animations</a> can be used for more than driving an animation by scroll. In this post, I share how you can use Scroll-Driven Animations to detect the Scroll Velocity a user is actively scrolling in.</p><p>That means that <strong>using only CSS you can style an element based on whether the user is scrolling <em>(or not scrolling)</em>, the direction they are scrolling in, and the speed they are scrolling with</strong>.</p></div><h3 id="table-of-contents" tabindex="-1"><a class="header-anchor" href="#table-of-contents"><span>Table of Contents</span></a></h3><ul><li><a href="#the-code">The Code</a></li><li><a href="#the-concept">The Concept</a></li><li><a href="#basic-demos">Basic Demos</a></li><li><a href="#style-queries">Intermezzo: what about Style Queries?</a></li><li><a href="#more-scroll-states">Combine multiple scroll states, thanks to more Maths</a></li><li><a href="#lerp-effects">LERP Effects</a></li><li><a href="#more-demos">More Demos</a></li><li><a href="#performance">A note on performance</a></li><li><a href="#closing-thoughts">Closing Thoughts</a></li><li><a href="#spread-the-word">Spread the word</a></li></ul><div class="hint-container info"><p class="hint-container-title">üíÅ‚Äç‚ôÇÔ∏è</p><p>This article assumes you know the basics of Scroll-Driven Animations. If you don‚Äôt, then get yourself acquainted with it over at <a href="https://scroll-driven-animations.style/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>scroll-driven-animations.style</a>, which includes links to relevant articles and videos.</p></div><div class="hint-container warning"><p class="hint-container-title">‚ö†Ô∏è Motion Warning</p><p>This article is all about animations so things will move around, often quite abruptly. When implementing these effects in your own projects, take <code>prefers-reduced-motion</code> into account.</p></div><div class="hint-container warning"><p class="hint-container-title">üë®‚Äçüî¨ Browser Compat Warning</p><p>The demos in this post rely on Scroll-Driven Animations and <code>@property</code> being available. In practice, this means you need a Chromium-based browser, version 115 or newer.</p></div><h3 id="the-code" tabindex="-1"><a class="header-anchor" href="#the-code"><span>The Code</span></a></h3><p>If you‚Äôre here for just the code, here it is:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-position</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-position-delayed</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@keyframes</span> adjust-pos</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token selector">to</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">--scroll-position</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">--scroll-position-delayed</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">:root</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">animation</span><span class="token punctuation">:</span> adjust-pos linear both<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">animation-timeline</span><span class="token punctuation">:</span> <span class="token function">scroll</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> --scroll-position-delayed 0.15s linear<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-velocity</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-position<span class="token punctuation">)</span> - <span class="token function">var</span><span class="token punctuation">(</span>--scroll-position-delayed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-speed</span><span class="token punctuation">:</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">,</span> -1 * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* abs(var(--scroll-velocity)); */</span></span>
<span class="line">  <span class="token property">--scroll-direction</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> / <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* sign(var(--scroll-velocity)); */</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--when-scrolling<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling-up</span><span class="token punctuation">:</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> - <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-scrolling-down</span><span class="token punctuation">:</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling-down-or-when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + 1<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-scrolling-up-or-when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you want to know how to use it and why this works, keep on reading üòâ</p><h3 id="the-concept" tabindex="-1"><a class="header-anchor" href="#the-concept"><span>The Concept</span></a></h3><p>When combining a few CSS things together, you often end up with a novel way to achieving something. A while ago, I figured out that you can detect the scroll speed and scroll direction using only CSS when combining the following:</p><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;"><code>@property</code></td><td style="text-align:left;">To register two custom properties of the type <code>&lt;number&gt;</code> so that they can be animated.</td></tr><tr><td style="text-align:left;">Scroll-Driven Animations</td><td style="text-align:left;">To animate those custom properties from <code>0</code> to <code>1</code> on scroll.</td></tr><tr><td style="text-align:left;"><code>transition-delay</code></td><td style="text-align:left;">To delay the computation of the 2nd custom property on a child element of the scroller.</td></tr><tr><td style="text-align:left;"><code>calc()</code></td><td style="text-align:left;">To compute the difference between both numbers, giving you the scroll velocity (= speed + direction).</td></tr><tr><td style="text-align:left;"><code>sign()</code></td><td style="text-align:left;">To extract the scroll direction from the velocity, leaving you with a value of <code>1</code>, <code>0</code>, or <code>-1</code>.</td></tr><tr><td style="text-align:left;"><code>abs()</code></td><td style="text-align:left;">To extract the scroll speed from the velocity.</td></tr></tbody></table><p>If that‚Äôs all gibberish to you don‚Äôt worry, as I‚Äôll explain it all in the next few sections.</p><h4 id="animating-two-custom-properties-on-scroll" tabindex="-1"><a class="header-anchor" href="#animating-two-custom-properties-on-scroll"><span>Animating two Custom Properties on scroll</span></a></h4><p>Let‚Äôs start off at the start, by animating two custom properties on scroll. This is done using a Scroll Timeline which is attached to the root scroller.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-position</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-position-delayed</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@keyframes</span> adjust-pos</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token selector">to</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">--scroll-position</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">--scroll-position-delayed</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">:root</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">animation</span><span class="token punctuation">:</span> adjust-pos linear both<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">animation-timeline</span><span class="token punctuation">:</span> <span class="token function">scroll</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Both of these values will animate from <code>0</code> to <code>1</code> as you scroll the document from top to bottom. Because they are registered through <a href="https://drafts.css-houdini.org/css-properties-values-api/#at-property-rule" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i><code>@property</code></a>, <a href="https://drafts.css-houdini.org/css-properties-values-api/#animation-behavior-of-custom-properties" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>they will interpolate nicely</a> instead of <a href="https://w3.org/TR/web-animations/#discrete" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-w3c" sizing="height"></i>animating discretely</a>.</p><blockquote><p>When referenced by animations and transitions, custom property values interpolate by computed value, in accordance with the type that they parsed as.</p></blockquote><div class="codepen-wrapper codepen-LYMoMEz"><!----><span>See <a>Detecting Scroll Directionality with Scroll-Driven Animations (DEBUG, v0)\</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><h4 id="delaying-one-of-the-custom-properties" tabindex="-1"><a class="header-anchor" href="#delaying-one-of-the-custom-properties"><span>Delaying one of the Custom Properties</span></a></h4><p>Animating two different properties in exactly the same way seems a bit stupid, but that‚Äôs where the rest of the trick comes into play. By delaying the <code>--scroll-position-delayed</code> property ‚Äì using <a href="https://drafts.csswg.org/css-transitions/#transition-delay-property" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i><code>transition-delay</code></a> ‚Äì <strong>on a child of the scroller</strong>, you can have it lag on the parent.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> --scroll-position-delayed 0.15s linear<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It is very important to note that I‚Äôm delaying the <code>--scroll-position-delayed</code> on the <code>body</code> element, which is a child of <code>html</code>. By doing so, I am not lagging <code>--scroll-position-delayed</code> on <code>--scroll-position</code> but, instead, I am lagging the <code>--scroll-position-delayed</code> value of the <code>body</code> element on the <code>--scroll-position-delayed</code> value of the <code>html</code> element.</p><div class="hint-container note"><p class="hint-container-title">‚òùÔ∏è</p><p>This parent-child relationship is a requirement for this trick to work ‚Äì it won‚Äôt work if you delay <code>--scroll-position-delayed</code> on the scroller ‚Äì here <code>html</code> ‚Äì itself. You can draw a parallel to <a class="route-link" href="/bookshelf/bram.us/css-container-queries-a-first-look-and-demo.html#container-queries"><strong>Container Queries</strong></a> here, which also require a parent-child relationship.</p></div><p>The set <code>transition-delay</code> controls how much lag there is before <code>--scroll-position-delayed</code> on the <code>body</code> catches up with the value from the <code>html</code> element. Best is to keep the delay pretty low, as the resulting effect could otherwise feel slow to users.</p><div class="codepen-wrapper codepen-YzdbdyL/52b163fb496bc91464f1a851878b344d"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Try scrolling up and down in the CodePen embedded above, and notice how <code>--scroll-position-delayed</code> lags on the <code>--scroll-position</code> variable. Repeat your test while scrolling very fast or really slow, and compare the effect of both speeds to each other.</p><p>~</p><h4 id="calculating-the-scroll-velocity" tabindex="-1"><a class="header-anchor" href="#calculating-the-scroll-velocity"><span><a href="#the-concept-3">#</a> Calculating the Scroll Velocity</span></a></h4><p>Because the computed values of the <code>--scroll-position</code> and <code>--scroll-position-delayed</code> properties differ as you scroll, you can use them to calculate the scroll velocity. By taking the difference of both values ‚Äì using a regular <a href="https://drafts.csswg.org/css-values/#funcdef-calc" target="_blank" rel="noopener noreferrer"><code>calc()</code></a> ‚Äì you end up with a number that will be one of these:</p><ul><li>A positive float, ranging from <code>0</code> to <code>1</code>, indicating the user is scrolling down</li><li><code>0</code>, indicating the user is not scrolling</li><li>A negative float, ranging from <code>-1</code> to <code>0</code>, indicating the user is scrolling up</li></ul><p>In CSS, it looks like this:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> --scroll-position-delayed 0.15s linear<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-velocity</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-position<span class="token punctuation">)</span> - <span class="token function">var</span><span class="token punctuation">(</span>--scroll-position-delayed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="codepen-wrapper codepen-VwqOqwQ/d0a922a21fd64f8decc88991c754cc04"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Try scrolling up and down in the CodePen embedded above, and notice how <code>--scroll-velocity</code> is a float representing the scroll velocity. Repeat your test while scrolling very fast or really slow, and compare the effect of both speeds to each other.</p><p>üïµÔ∏è When looking really close, you might notice that the number is a bit off when quickly changing the direction or when abruptly stopping a scroll: the updated value of <code>--scroll-velocity</code> will not immediately reflect the actual state. This can be tweaked by tightening the <code>transition-delay</code> of the <code>--scroll-position-delayed</code> property, but then you end up with smaller values for <code>--scroll-velocity</code> so you might need a multiplier to counteract that.</p><p>There‚Äôs also a difference in update speed between dragging the scrollbar versus using the touchpad to scroll the scroller. The former updates much, much, faster.</p><p>~</p><h4 id="calculating-the-scroll-direction-and-scroll-speed" tabindex="-1"><a class="header-anchor" href="#calculating-the-scroll-direction-and-scroll-speed"><span><a href="#the-concept-4">#</a> Calculating the Scroll Direction and Scroll Speed</span></a></h4><p>Because Velocity is a measured Speed into a certain Direction <em>(<a href="https://britannica.com/story/whats-the-difference-between-speed-and-velocity" target="_blank" rel="noopener noreferrer">ref</a>)</em>, the Direction and Speed can be extracted from the Velocity.</p><p>The direction of scrolling can be derived from the <code>--scroll-velocity</code> by looking at its sign: If it‚Äôs positive, then the user is scrolling down. If it is negative, the user is scrolling up.</p><p>In CSS, you can use the <a href="https://drafts.csswg.org/css-values/#sign-funcs" target="_blank" rel="noopener noreferrer">the <code>sign()</code> function</a> to extract that info:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--scroll-direction</span><span class="token punctuation">:</span> <span class="token function">sign</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The value for <code>--scroll-direction</code> is one of these:</p><ul><li><code>1</code>, indicating the user is scrolling down</li><li><code>0</code>, indicating the user is not scrolling</li><li><code>-1</code>, indicating the user is scrolling up</li></ul><p>This value will come in handy in calculations further down the road.</p><p>Extracting the scroll speed from the velocity is also easy to do, as it‚Äôs a matter of dropping sign from the value. In CSS, this can be done using <a href="https://drafts.csswg.org/css-values/#sign-funcs" target="_blank" rel="noopener noreferrer">the <code>abs()</code> function</a>.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--scroll-speed</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Put together, you get this:</p><div class="codepen-wrapper codepen-LYMLoJa/49dd704872be26534482faef58b788fb"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Try scrolling up and down in the CodePen above, and notice how <code>--scroll-direction</code> is an integer representing the scroll direction, unaffected by the scroll speed.</p><p>üë®‚Äçüî¨ At the time of writing, <code>sign()</code> and <code>abs()</code> are available in Chrome only once you flip on the Experimental Web Platform Features feature flag on through <code>chrome://flags</code>.</p><p>Thankfully, the functionality can be polyfilled using some basic mathematics, as detailed by <a href="https://thebabydino.github.io/" target="_blank" rel="noopener noreferrer">Ana Tudor</a> in <a href="https://css-tricks.com/using-absolute-value-sign-rounding-and-modulo-in-css-today/#aa-sign" target="_blank" rel="noopener noreferrer">this post on CSS-Tricks</a>.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--scroll-speed</span><span class="token punctuation">:</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">,</span> -1 * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-direction</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> / <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>~</p><h3 id="basic-demos" tabindex="-1"><a class="header-anchor" href="#basic-demos"><span><a href="#basic-demos">#</a> Basic demos</span></a></h3><p>With these computed custom properties <code>--scroll-velocity</code> and <code>--scroll-direction</code> available it‚Äôs time to get creative ‚Ä¶</p><p>~</p><h4 id="tilted-colored-boxes" tabindex="-1"><a class="header-anchor" href="#tilted-colored-boxes"><span><a href="#demo-tilted-boxes">#</a> Tilted Colored boxes</span></a></h4><p>A first demos are these boxes that get skewed in a certain angle depending on the scroll. The faster you scroll, the more skewed they get, with a maximum of 25 degrees.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">skew</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> * -25deg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Furthermore the boxes also get the hue of their <code>background-color</code> rotated depending on the scroll direction.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">hsl</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>0deg + <span class="token punctuation">(</span>145deg * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 50% 50%<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> background 0.15s ease<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When idle, the boxes are red. When scrolling down they become green and when scrolling up they are blue. The transition of the background is eased at <code>0.15s</code>.</p><div class="codepen-wrapper codepen-oNJeLWg/cb3542fb8be1f8bb0a33e107229b9027"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>~</p><h4 id="motion-blur-scroll" tabindex="-1"><a class="header-anchor" href="#motion-blur-scroll"><span><a href="#demo-motion-blur-scroll">#</a> Motion Blur Scroll</span></a></h4><p>Things also become interesting when using the <code>--scroll-velocity</code> and <code>--scroll-speed</code> values in a <code>filter</code>, as that function has many options. With it, you can create a Motion Blur effect, that even desaturates the content as you scroll.</p><div class="codepen-wrapper codepen-XWoREjv/a0e0aca0d543dc146b90bea779fbd964"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>The blurring and desaturating is handled by the <code>filter</code> property. Some basic translation and <code>opacity</code>-meddling also takes place, to give it a rather cinematic effect. To always have a positive float value for use within all calculations, the code relies on <code>--scroll-speed</code> instead of <code>--scroll-velocity</code> which can become negative.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">main</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">filter</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token function">blur</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>2rem * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">contrast</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>100% - <span class="token punctuation">(</span>500% * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">saturate</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>100% - <span class="token punctuation">(</span>500% * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>1 - <span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span> * 4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">translate</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>-8rem * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Furthermore the entire photostrip gets skewed a tiny bit while scrolling, similar to a previous demo.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">.photo</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">skew</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> * 3deg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The faster your scroll, the harder the effect is.</p><p>~</p><h3 id="intermezzo-what-about-style-queries" tabindex="-1"><a class="header-anchor" href="#intermezzo-what-about-style-queries"><span><a href="#style-queries">#</a> Intermezzo: what about Style Queries?</span></a></h3><p><strong>UPDATE 2023.10.26</strong> After chatting with <a href="https://xanthir.com/contact/" target="_blank" rel="noopener noreferrer">Tab Atkins</a> about this, it became clear that the simplification won‚Äôt happen until the custom property is registered as a <code>&lt;number&gt;</code> ‚Äì something I wasn‚Äôt aware of. This section has been rewritten to incorporate that info.</p><p>Now, you might be wondering if you can use <a href="https://brm.us/style-queries" target="_blank" rel="noopener noreferrer">Style Queries</a> for easier styling when relying on only the scroll direction. It‚Äôs definitely a valid question, as doing the calculations can be hard to get right, with a lot of trial and error.</p><p>After all, it would be so much easier if you could do this, allowing you to put any styles in the container blocks:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> 0<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Idle */</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> 1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Scrolling down */</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> -1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Scrolling up */</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>According <a href="https://drafts.csswg.org/css-values-4/#calc-computed-value" target="_blank" rel="noopener noreferrer">to the spec</a> any mathematical expression should be simplified:</p><blockquote><p>The computed value of a math function is its calculation tree simplified, using all the information available at computed value time.</p></blockquote><p>So when idling, the computed value of <code>--scroll-direction</code> should become <code>0</code>, right? Unfortunately that doesn‚Äôt seem to be the case: when checking the computed value of <code>--scroll-direction</code> when idle, it computes to <code>sign(calc(0 - 0))</code>, without any simplification applied. Huh?!</p><p>The reason why simplification doesn‚Äôt happen is that the browser doesn‚Äôt know that it can. A custom property can hold any value; It‚Äôs only when it‚Äôs being used as a value ‚Äì via <code>var()</code> ‚Äì that the browser tries to convert the custom property to be of a certain type that fits the property it is used in. If the type conversion doesn‚Äôt work out ‚Äì e.g. when trying to set a color as the value for an <code>animation-duration</code> ‚Äì the declaration will become <a href="https://w3.org/TR/css-variables-1/#invalid-at-computed-value-time" target="_blank" rel="noopener noreferrer">‚ÄúInvalid At Computed Value Time‚Äù</a>.</p><p>~</p><h4 id="property-to-the-rescue" tabindex="-1"><a class="header-anchor" href="#property-to-the-rescue"><span><a href="#cq-at-property">#</a> <code>@property</code> to the rescue!</span></a></h4><p>So, can you force the conversion to happen, in order for the simplification to occur? Why yes you can! By registering <code>--scroll-direction</code> ‚Äì using <code>@property</code> ‚Äì to be a <code>&lt;number&gt;</code>, the browser will try to fit the declared value into that type. At that point the simplification will occur, and <code>sign(calc(0 - 0))</code> can be simplified to <code>0</code></p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-direction</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With this registration, it now becomes possible to use style queries for the styling based on the scroll direction:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> 0<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Idle */</span></span>
<span class="line">  <span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">background</span><span class="token punctuation">:</span> crimson<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> 1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Scrolling down */</span></span>
<span class="line">  <span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">background</span><span class="token punctuation">:</span> forestgreen<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> -1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Scrolling up */</span></span>
<span class="line">  <span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">background</span><span class="token punctuation">:</span> lightskyblue<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="codepen-wrapper codepen-dyaYoyG"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>üíÅ‚Äç‚ôÇÔ∏è Compare the non-registered vs registered behavior</p><p>Here‚Äôs a small CodePen that tests the simplification/seriallization of <code>calc()</code>. The value of the <code>--output</code> property eventually becomes <code>calc(2 * 0.5)</code>, because the custom property is not registered to be of a certain type.</p><div class="codepen-wrapper codepen-RwEqJye/2ebcc612170ef036b46bb2fb6c6cf0c7"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Now compare this to this adjusted version where the custom property is registered as a <code>&lt;number&gt;</code>:</p><div class="codepen-wrapper codepen-WNPvvzm"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>~</p><h3 id="combine-multiple-scroll-states-thanks-to-more-maths" tabindex="-1"><a class="header-anchor" href="#combine-multiple-scroll-states-thanks-to-more-maths"><span><a href="#more-scroll-states">#</a> Combine multiple scroll states, thanks to more Maths</span></a></h3><p>Thanks to some more basic maths, it‚Äôs possible to end up with a value of <code>1</code> in various scroll-cases.</p><p>For example, if you take the absolute value of <code>--scroll-direction</code> ‚Äì which is either <code>-1</code>, <code>0</code>, or <code>1</code> ‚Äì you end up with a value of <code>1</code> only when the user scrolling:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--when-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Furthermore, if you take that value, subtract <code>1</code> from it, and absolute the result, you end up with a value of <code>1</code> only when the user is not scrolling:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--when-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--when-scrolling<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Mix and match basic maths, <code>abs</code>, <code>min</code>, <code>max</code>, <code>clamp</code>, and you can end up with a value of <code>1</code> in any of these situations:</p><ul><li>When scrolling up or down</li><li>When not scrolling</li><li>When scrolling up</li><li>When scrolling down</li><li>When scrolling up or idle</li><li>When scrolling down or idle</li></ul><p>In code, it looks like this:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--when-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--when-scrolling<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling-up</span><span class="token punctuation">:</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> - <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-scrolling-down</span><span class="token punctuation">:</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling-down-or-when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + 1<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-scrolling-up-or-when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Look at the examples below for some use-cases. Don‚Äôt forget to <a href="#cq-at-property">register these as a <code>&lt;number&gt;</code> if you want to use these in Style Queries</a>.</p><h4 id="demo-moving-header" tabindex="-1"><a class="header-anchor" href="#demo-moving-header"><span>Demo: Moving Header</span></a></h4><p>One example where you can use this is to hide the header and footer bars while the user is scrolling. This is done by translating the bars out the way in that case. For this, the code uses <code>--when-scrolling</code> ‚Äì which has a value of <code>1</code> when scrolling and a value of <code>0</code> when not scrolling ‚Äì as <a class="route-link" href="/bookshelf/bram.us/conditions-for-css-calculations.html"><strong>the condition for the calculation</strong></a>.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--hide-bars</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--when-scrolling<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">header</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">translate</span><span class="token punctuation">:</span> 0 <span class="token function">calc</span><span class="token punctuation">(</span>-90% * <span class="token function">var</span><span class="token punctuation">(</span>--hide-bars<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">footer</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">translate</span><span class="token punctuation">:</span> 0 <span class="token function">calc</span><span class="token punctuation">(</span>90% * <span class="token function">var</span><span class="token punctuation">(</span>--hide-bars<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The demo below requires Chrome with the Experimental Web Platform Features feature flag enabled.</p><div class="codepen-wrapper codepen-dywzeoN/d4ee4fafdd7287701713d46e741ba94e"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>üí≠ Initially I wanted to hide the header upon scrolling down or remaining idle after having scrolled down, and only show it again once starting to scroll up again. I couldn‚Äôt immediately find a solution here ‚Äì using <code>--when-scrolling-down-or-when-not-scrolling</code> also hides it on initial load, which is not what I want ‚Äì but I‚Äôm sure <a href="https://front-end.social/@johannes" target="_blank" rel="noopener noreferrer">Johannes</a> will be able to tell me how to do it using <a href="https://johannesodland.github.io/state/scroll-snap/scroll-driven-animations/2023/06/18/scroll-persisted-state.html" target="_blank" rel="noopener noreferrer">Scroll-Persisted State</a>.</p><p>It is possible to ‚Äúremember‚Äù the last scrolled direction by using a long <code>transition-delay</code>. See <a href="https://brm.us/hidey-bar" target="_blank" rel="noopener noreferrer">https://brm.us/hidey-bar</a> for details on how to use this.</p><p>~</p><h4 id="demo-directional-chicky-scroll" tabindex="-1"><a class="header-anchor" href="#demo-directional-chicky-scroll"><span><a href="#demo-directional-chicky-scroll">#</a> Demo: Directional Chicky Scroll</span></a></h4><p>When <a href="https://twitter.com/utilitybend" target="_blank" rel="noopener noreferrer">Brecht De Ruyte</a> <a href="https://utilitybend.com/blog/for-the-love-of-scroll-driven-animations-in-css" target="_blank" rel="noopener noreferrer">explored Scroll-Driven Animations back in February</a>, he built a demo where a little chicky walks across the screen as you scroll the page. While building that demo he noted that when scrolling up, the chicky is facing the wrong direction:</p><blockquote><p>The downside is that my animation seems to trigger a bit of moonwalking when scrolling back to top. Let‚Äôs just call it a feature for now, ok? üòâ</p></blockquote><p>With <code>--scroll-direction</code> available it‚Äôs pretty easy to flip the chicky in the other direction by passing that into <code>scaleX()</code>. However, when idling you‚Äôd end up with a <code>scaleX()</code> of <code>0</code> so to counter that I add <code>--when-not-scrolling</code> to the equation. By doing so, the <code>scaleX()</code> will also be <code>1</code> when idle, so the chicky will face forwards in that case.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@keyframes</span> moveChicky</span> <span class="token punctuation">{</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>80px<span class="token punctuation">)</span> <span class="token function">scaleX</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + <span class="token function">var</span><span class="token punctuation">(</span>--when-not-scrolling<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The demo below requires Chrome with the Experimental Web Platform Features feature flag enabled.</p><div class="codepen-wrapper codepen-LYMjgjB/1e36fc337fc5f703e84397f089fc017c"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>~</p><h3 id="lerp-effects" tabindex="-1"><a class="header-anchor" href="#lerp-effects"><span><a href="#lerp-effects">#</a> LERP-effects</span></a></h3><p>Because there is a delay happening it‚Äôs possible to create typical LERP-effects. Below are a few demos that reproduce that.</p><p>üí° LERP = <a href="https://en.wikipedia.org/wiki/Linear_interpolation" target="_blank" rel="noopener noreferrer"><strong>L</strong>inear int<strong>ERP</strong>olation</a></p><p>~</p><h4 id="demo-lerp-reading-indicator" tabindex="-1"><a class="header-anchor" href="#demo-lerp-reading-indicator"><span><a href="#demo-lerp-reading-indicator">#</a> Demo: LERP Reading Indicator</span></a></h4><p>In this demo, the reading indicator catches up on the actual reading position. The code is easy, as it relies directly on <code>--scroll-position-delayed</code>.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">#progress</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scaleX</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-position-delayed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="codepen-wrapper codepen-VwqJObR/7ef7eaaa78ad1382dbe5c5c4c5066989"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Compare the behavior of the demo above to <a href="https://scroll-driven-animations.style/demos/progress-bar/css/" target="_blank" rel="noopener noreferrer">this original version</a> whose reading indicator responds directly to the scroll position change.</p><p>~</p><h4 id="demo-lerp-scrolling" tabindex="-1"><a class="header-anchor" href="#demo-lerp-scrolling"><span><a href="#demo-lerp-scrolling">#</a> Demo: LERP Scrolling</span></a></h4><p>Recreating a LERP scrolling effect is a bit more difficult as you don‚Äôt want to recreate an entirely custom scroller from scratch ‚Äì These always end up in the <a href="https://en.wikipedia.org/wiki/Uncanny_valley" target="_blank" rel="noopener noreferrer">uncanny valley</a>. What I‚Äôve done in the demo below is added some fake drag to the scroll by translating the contents in the opposite scrolling direction.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">.slider</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">animation</span><span class="token punctuation">:</span> adjust-pos linear both<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">animation-timeline</span><span class="token punctuation">:</span> <span class="token function">scroll</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* Hook animation onto self */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> --scroll-position-delayed 0.25s linear<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-velocity</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-position<span class="token punctuation">)</span> - <span class="token function">var</span><span class="token punctuation">(</span>--scroll-position-delayed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> * 500vh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* Add some drag. Tweak the 500vh value to adjust how much drag */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="codepen-wrapper codepen-GRPvqrN/1c39bc90ac0e08708933eb999c0941a8"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>The effect is not entirely perfect though. For example, when hitting the end of the scroller the <code>--scroll-position-delayed</code> is still getting delayed while it should skip forwards in that case.</p><p>~</p><h3 id="more-demos" tabindex="-1"><a class="header-anchor" href="#more-demos"><span><a href="#more-demos">#</a> More Demos</span></a></h3><p>I‚Äôm sure this technique will spark a lot of nice new demos. Here‚Äôs a few more that I‚Äôve built using this technique.</p><p>~</p><h4 id="demo-wormhole" tabindex="-1"><a class="header-anchor" href="#demo-wormhole"><span><a href="#demo-wormhole">#</a> Demo: Wormhole</span></a></h4><p>By nesting a bunch of boxes, you can see how the value of <code>--scroll-position-delayed</code> propagates from box to box. Add some translation + colors, and you get a wormhole effect.</p><div class="codepen-wrapper codepen-wvRqVBm/b4a25463d8c5315758802aba3e60b9ab"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>The demo also includes the code to respond to a horizontal delayed scroll.</p><p>~</p><h4 id="demo-badass" tabindex="-1"><a class="header-anchor" href="#demo-badass"><span><a href="#demo-badass">#</a> Demo: BADASS</span></a></h4><p>Back in 2017 I saw a nice scroll effect on <a href="https://badassfilms.tv/" target="_blank" rel="noopener noreferrer">the BADASS website</a>. The site is no longer up in that state, but thankfully <a href="https://bram.us/2017/10/15/badass/" target="_blank" rel="noopener noreferrer">my blog entry about it</a> also included a video of the effect, which I‚Äôve also embedded below:</p><figure><img src="https://bram.us/wordpress/wp-content/uploads/2017/10/badass_homepage_shoot_02.gif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Recording of the original</p><p>As I wrote back then:</p><blockquote><p>The effect is achieved by placing a duplicate (but clipped) list on top of another one, in combination with scroll velocity calculation to define the slant of the list.</p></blockquote><p>Recreating this effect is now perfectly possible with just CSS:</p><ul><li>Move the two lists across the screen as you scroll from top to bottom</li><li>Adjust the <code>clip-path</code> of the hotpink list as you scroll</li><li>Adjust the slant of the outlined list depending on the scroll speed and direction</li></ul><p>The difficult part here wasn‚Äôt to skew the list ‚Äì this was already done in the other demos ‚Äì but to get the <code>clip-path</code> working correctly. You can check the code for my calculations and comments.</p><div class="codepen-wrapper codepen-OJrxBaL/3069957ece86b0c8aafb4a249ff9271a"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>üé¨ Check a recording of this demo</p><p>Video Player</p><p><a href="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-050p.mp4" target="_blank" rel="noopener noreferrer">https://www.bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-050p.mp4</a></p><p>00:00</p><p>00:00</p><p>00:11</p><p>[Use Up/Down Arrow keys to increase or decrease volume.</p><p>](javascript:void(0)üòâ</p><p>Recording of the demo inspired upon the original animation oon the BADASS website.</p><p>~</p><h3 id="a-note-on-performance" tabindex="-1"><a class="header-anchor" href="#a-note-on-performance"><span><a href="#performance">#</a> A note on performance</span></a></h3><p>When doing a trace via Chrome DevTools you might notice that paint constantly gets triggered as you scroll.</p><figure><a href="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-custom-property-main-thread.png" target="_blank" rel="noopener noreferrer"><img src="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-custom-property-main-thread.png" alt="" tabindex="0" loading="lazy"></a><figcaption></figcaption></figure><p>A Performance Trace in Chrome DevTools of the <a href="#demo-lerp-reading-indicator">LERP Reading Indicator Demo</a>, riddled with rendering Tasks</p><p>This is because Chrome ‚Äì and any other browser for that matter ‚Äì animates Custom Properties on the main thread. I have <a href="https://brm.us/animate-custom-properties" target="_blank" rel="noopener noreferrer">written about this problem space before</a>, and hope to see this fixed in the future. Star <a href="https://crbug.com/1411864" target="_blank" rel="noopener noreferrer">Chromium Issue #1411864</a> to stay in the loop.</p><p>~</p><h3 id="closing-thoughts" tabindex="-1"><a class="header-anchor" href="#closing-thoughts"><span><a href="#closing-thoughts">#</a> Closing Thoughts</span></a></h3><p>One of the features authors have asked about at the CSS Working Group is to expose current scrolling direction in CSS <em>(<a href="https://github.com/w3c/csswg-drafts/issues/6400" target="_blank" rel="noopener noreferrer">w3c/csswg-drafts#6400</a>)</em>. Not only does the technique described in this article offer an answer to that problem, it cranks it up a notch by also exposing the scrolling speed. While it‚Äôs not entirely perfect ‚Äì e.g. the scroll velocity can lag a bit on the actual situation ‚Äì it can already get you quite the distance.</p><p>Personally I think it is very exciting to see that Scroll-Driven Animations yet again <em>([<a href="https://kizu.dev/scroll-driven-animations/" target="_blank" rel="noopener noreferrer">1</a>], [<a href="https://johannesodland.github.io/state/scroll-snap/scroll-driven-animations/2023/06/18/scroll-persisted-state.html" target="_blank" rel="noopener noreferrer">2</a>], [<a href="https://kizu.dev/fit-to-width-text/" target="_blank" rel="noopener noreferrer">3</a>]. [<a href="https://bram.us/2023/06/26/faking-a-snapped-selector-with-scroll-driven-animations/" target="_blank" rel="noopener noreferrer">4</a>], [<a href="https://bram.us/2023/09/16/solved-by-css-scroll-driven-animations-detect-if-an-element-can-scroll-or-not/" target="_blank" rel="noopener noreferrer">5</a>], [<a href="https://kizu.dev/scroll-driven-state-transfer/" target="_blank" rel="noopener noreferrer">6</a>])</em> can be used for so much more than simply animating things as you scroll. I‚Äôm very much looking forward to more unconventional uses of this feature, unlocking some age-old requests ‚Ä¶</p><p>~</p><h3 id="spread-the-word-name-spread-the-word" tabindex="-1"><a class="header-anchor" href="#spread-the-word-name-spread-the-word"><span>[#](#spread-the-word name=) Spread the word</span></a></h3><p>To help spread the contents of this post, feel free to retweet the announcements made on social media:</p><div class="codepen-wrapper codepen-undefined"><!----><span>See <a>N/A</a> by <a href="https://codepen.io/front-end.social/@bramus/111286294127147693/embed">front-end.social/@bramus/111286294127147693/embed</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>~</p><p><strong>üî• Like what you see? Want to stay in the loop? Here&#39;s how:</strong></p><ul><li><a href="https://bsky.app/profile/bram.us" target="_blank" rel="noopener noreferrer">ü¶ã Follow @bram.us on Bluesky</a></li><li><a href="https://bram.us/feed" target="_blank" rel="noopener noreferrer">üî∏ Follow bram.us using RSS</a></li></ul><p>I can also be found on <a href="https://x.com/bramus" target="_blank" rel="noopener noreferrer">ùïè Twitter</a> and <a href="https://front-end.social/@bramus" target="_blank" rel="noopener noreferrer">üêò Mastodon</a> but only post there sporadically.</p><!-- TODO: add ARTICLE CARD --><a class="vp-card" href="https://chanhi2000.github.io/bookshelf/bram.us/css-scroll-detection.html" target="_blank" style="background:rgba(17,17,17,0.2);"><img class="vp-card-logo" src="https://bramu.us/favicon.ico" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed</div><hr><div class="vp-card-desc">Combine Scroll-Driven Animations with @‚Äãproperty, transition-delay, calc(), sign() and abs() ‚Ä¶ and you can do Scroll Detection using only CSS!</div></div></a><hr><h2 id="lang-en-ustitle-solved-by-css-scroll-driven-animations-style-an-element-based-on-the-active-scroll-direction-and-scroll-speed-description-article-s-solved-by-css-scroll-driven-animations-style-an-element-based-on-the-active-scroll-direction-and-scroll-speed-icon-category" tabindex="-1"><a class="header-anchor" href="#lang-en-ustitle-solved-by-css-scroll-driven-animations-style-an-element-based-on-the-active-scroll-direction-and-scroll-speed-description-article-s-solved-by-css-scroll-driven-animations-style-an-element-based-on-the-active-scroll-direction-and-scroll-speed-icon-category"><span>lang: en-US title: &quot;Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed&quot; description: &quot;Article(s) &gt; Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed&quot; icon: category:</span></a></h2><ul><li>Article(s) tag:</li><li>blog</li><li>bram.us</li><li></li></ul><p>head:</p><ul><li><ul><li>meta:</li><li>property: og:title content: &quot;Article(s) &gt; Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed&quot;</li><li>property: og:description content: &quot;Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed&quot;</li><li>property: og:url content: https://chanhi2000.github.io/bookshelf/bram.us/css-scroll-detection.html prev: /articles/README.md date: 2023-10-24 isOriginal: false author:</li></ul></li><li>name: Bramus! url : https://bram.us/author/bramus/ cover: https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-short-020p-10fps.gif</li></ul><hr><h1 id="frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´-1" tabindex="-1"><a class="header-anchor" href="#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´-1"><span>Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed Í¥ÄÎ†®</span></a></h1><a class="route-link vp-card" href="/bookshelf/articles/" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="/bookshelf/images/ico-wind.svg" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title"> > Article(s)</div><hr><div class="vp-card-desc">Article(s)</div></div></a><nav class="table-of-contents"><ul><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#table-of-contents" class="router-link-active router-link-exact-active">Table of Contents</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#the-code" class="router-link-active router-link-exact-active">The Code</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#the-concept" class="router-link-active router-link-exact-active">The Concept</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#basic-demos" class="router-link-active router-link-exact-active"># Basic demos</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#intermezzo-what-about-style-queries" class="router-link-active router-link-exact-active"># Intermezzo: what about Style Queries?</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#combine-multiple-scroll-states-thanks-to-more-maths" class="router-link-active router-link-exact-active"># Combine multiple scroll states, thanks to more Maths</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#lerp-effects" class="router-link-active router-link-exact-active"># LERP-effects</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#more-demos" class="router-link-active router-link-exact-active"># More Demos</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#a-note-on-performance" class="router-link-active router-link-exact-active"># A note on performance</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#closing-thoughts" class="router-link-active router-link-exact-active"># Closing Thoughts</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#spread-the-word-name-spread-the-word" class="router-link-active router-link-exact-active">[#](#spread-the-word name=) Spread the word</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#lang-en-ustitle-solved-by-css-scroll-driven-animations-style-an-element-based-on-the-active-scroll-direction-and-scroll-speed-description-article-s-solved-by-css-scroll-driven-animations-style-an-element-based-on-the-active-scroll-direction-and-scroll-speed-icon-category" class="router-link-active router-link-exact-active">lang: en-UStitle: &quot;Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed&quot;description: &quot;Article(s) &gt; Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed&quot;icon:category:</a><ul><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#table-of-contents-1" class="router-link-active router-link-exact-active">Table of Contents</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#the-code-1" class="router-link-active router-link-exact-active"># The Code</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#the-concept-1" class="router-link-active router-link-exact-active"># The Concept</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#basic-demos-1" class="router-link-active router-link-exact-active"># Basic demos</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#intermezzo-what-about-style-queries-1" class="router-link-active router-link-exact-active"># Intermezzo: what about Style Queries?</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#combine-multiple-scroll-states-thanks-to-more-maths-1" class="router-link-active router-link-exact-active"># Combine multiple scroll states, thanks to more Maths</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#lerp-effects-1" class="router-link-active router-link-exact-active"># LERP-effects</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#more-demos-1" class="router-link-active router-link-exact-active"># More Demos</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#a-note-on-performance-1" class="router-link-active router-link-exact-active"># A note on performance</a></li><li><a aria-current="page" href="/bookshelf/bram.us/css-scroll-detection.html#closing-thoughts-1" class="router-link-active router-link-exact-active"># Closing Thoughts</a></li></ul></li></ul></nav><hr><div class="vp-site-info" data-name="Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed"><a class="vp-site-info-navigator no-external-link-icon" title="Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed" href="https://bram.us/2023/10/23/css-scroll-detection/" target="_blank"></a><div class="vp-site-info-preview" style="background:url(https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-short-020p-10fps.gif) center/cover no-repeat;"></div><div class="vp-site-info-detail"><img class="vp-site-info-logo" src="https://bramu.us/favicon.ico" alt loading="lazy" no-view><div class="vp-site-info-name">Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed</div><div class="vp-site-info-desc">Combine Scroll-Driven Animations with @‚Äãproperty, transition-delay, calc(), sign() and abs() ‚Ä¶ and you can do Scroll Detection using only CSS!</div></div><!----></div><p top:="" 3em;="">.post-33847 .entry-content article { margin: 0; position: relative; } .post-33847 .entry-content :is(h3,h4) { position: sticky; top: 0em; padding: 0.5em 0; border-bottom: 1px solid #e4e4e4; z-index: 2; background: #fff; /* If only we could stick against another sticky ‚Ä¶ */ white-space: nowrap; overflow-x: auto; max-width: 100%; } .post-33847 .entry-content h4</p><p>Video Player</p><p><a href="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-050p.mp4" target="_blank" rel="noopener noreferrer">https://www.bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-050p.mp4</a></p><p>00:02</p><p>00:00</p><p>00:11</p><p>[Use Up/Down Arrow keys to increase or decrease volume.</p><p>](javascript:void(0)üòâ</p><p>Recording of <a href="#demo-badass">the BADASS Demo</a></p><p><a href="https://scroll-driven-animations.style/" target="_blank" rel="noopener noreferrer">Scroll-Driven Animations</a> can be used for more than driving an animation by scroll. In this post, I share how you can use Scroll-Driven Animations to detect the Scroll Velocity a user is actively scrolling in.</p><p>That means that <strong>using only CSS you can style an element based on whether the user is scrolling <em>(or not scrolling)</em>, the direction they are scrolling in, and the speed they are scrolling with</strong>.</p><p>~</p><h3 id="table-of-contents-1" tabindex="-1"><a class="header-anchor" href="#table-of-contents-1"><span>Table of Contents</span></a></h3><ul><li><a href="#the-code">The Code</a></li><li><a href="#the-concept">The Concept</a><ul><li><a href="#the-concept-1">Animating two Custom Properties on scroll</a></li><li><a href="#the-concept-2">Delaying one of the Custom Properties</a></li><li><a href="#the-concept-3">Calculating the Scroll Velocity</a></li><li><a href="#the-concept-4">Calculating the Scroll Direction and Scroll Speed</a></li></ul></li><li><a href="#basic-demos">Basic Demos</a><ul><li><a href="#demo-tilted-boxes">Tilted Colored Boxes</a></li><li><a href="#demo-motion-blur-scroll">Motion Blur Scroll</a> (üî•)</li></ul></li><li><a href="#style-queries">Intermezzo: what about Style Queries?</a><ul><li><a href="#cq-at-property"><code>@property</code> to the rescue!</a></li></ul></li><li><a href="#more-scroll-states">Combine multiple scroll states, thanks to more Maths</a><ul><li><a href="#demo-moving-header">Demo: Moving Header</a></li><li><a href="#demo-directional-chicky-scroll">Demo: Directional Chicky Scroll</a></li></ul></li><li><a href="#lerp-effects">LERP Effects</a><ul><li><a href="#demo-lerp-reading-indicator">Demo: LERP reading indicator</a></li><li><a href="#demo-lerp-scrolling">Demo: LERP scrolling</a></li></ul></li><li><a href="#more-demos">More Demos</a><ul><li><a href="#demo-wormhole">Wormhole</a></li><li><a href="#demo-badass">Badass (üî•)</a></li></ul></li><li><a href="#performance">A note on performance</a></li><li><a href="#closing-thoughts">Closing Thoughts</a></li><li><a href="#spread-the-word">Spread the word</a></li></ul><p>~</p><p>üíÅ‚Äç‚ôÇÔ∏è This article assumes you know the basics of Scroll-Driven Animations. If you don‚Äôt, then get yourself acquainted with it over at <a href="https://scroll-driven-animations.style/" target="_blank" rel="noopener noreferrer">scroll-driven-animations.style</a>, which includes links to relevant articles and videos.</p><p>‚ö†Ô∏è Motion Warning ‚Äì This article is all about animations so things will move around, often quite abruptly. When implementing these effects in your own projects, take <code>prefers-reduced-motion</code> into account.</p><p>üë®‚Äçüî¨ Browser Compat Warning ‚Äì The demos in this post rely on Scroll-Driven Animations and <code>@property</code> being available. In practice, this means you need a Chromium-based browser, version 115 or newer.</p><p>~</p><h3 id="the-code-1" tabindex="-1"><a class="header-anchor" href="#the-code-1"><span><a href="#the-code">#</a> The Code</span></a></h3><p>If you‚Äôre here for just the code, here it is:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-position</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-position-delayed</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@keyframes</span> adjust-pos</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token selector">to</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">--scroll-position</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">--scroll-position-delayed</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">:root</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">animation</span><span class="token punctuation">:</span> adjust-pos linear both<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">animation-timeline</span><span class="token punctuation">:</span> <span class="token function">scroll</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> --scroll-position-delayed 0.15s linear<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-velocity</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-position<span class="token punctuation">)</span> - <span class="token function">var</span><span class="token punctuation">(</span>--scroll-position-delayed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-speed</span><span class="token punctuation">:</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">,</span> -1 * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* abs(var(--scroll-velocity)); */</span></span>
<span class="line">  <span class="token property">--scroll-direction</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> / <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* sign(var(--scroll-velocity)); */</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--when-scrolling<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling-up</span><span class="token punctuation">:</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> - <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-scrolling-down</span><span class="token punctuation">:</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling-down-or-when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + 1<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-scrolling-up-or-when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you want to know how to use it and why this works, keep on reading üòâ</p><p>~</p><h3 id="the-concept-1" tabindex="-1"><a class="header-anchor" href="#the-concept-1"><span><a href="#the-concept">#</a> The Concept</span></a></h3><p>When combining a few CSS things together, you often end up with a novel way to achieving something. A while ago, I figured out that you can detect the scroll speed and scroll direction using only CSS when combining the following:</p><p><code>@property</code></p><p>To register two custom properties of the type <code>&lt;number&gt;</code> so that they can be animated.</p><p>Scroll-Driven Animations</p><p>To animate those custom properties from <code>0</code> to <code>1</code> on scroll.</p><p><code>transition-delay</code></p><p>To delay the computation of the 2nd custom property on a child element of the scroller.</p><p><code>calc()</code></p><p>To compute the difference between both numbers, giving you the scroll velocity (= speed + direction).</p><p><code>sign()</code></p><p>To extract the scroll direction from the velocity, leaving you with a value of <code>1</code>, <code>0</code>, or <code>-1</code>.</p><p><code>abs()</code></p><p>To extract the scroll speed from the velocity.</p><p>If that‚Äôs all gibberish to you don‚Äôt worry, as I‚Äôll explain it all in the next few sections.</p><p>~</p><h4 id="animating-two-custom-properties-on-scroll-1" tabindex="-1"><a class="header-anchor" href="#animating-two-custom-properties-on-scroll-1"><span><a href="#the-concept-1">#</a> Animating two Custom Properties on scroll</span></a></h4><p>Let‚Äôs start off at the start, by animating two custom properties on scroll. This is done using a Scroll Timeline which is attached to the root scroller.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-position</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-position-delayed</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@keyframes</span> adjust-pos</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token selector">to</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">--scroll-position</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span></span>
<span class="line">    <span class="token property">--scroll-position-delayed</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">:root</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">animation</span><span class="token punctuation">:</span> adjust-pos linear both<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">animation-timeline</span><span class="token punctuation">:</span> <span class="token function">scroll</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Both of these values will animate from <code>0</code> to <code>1</code> as you scroll the document from top to bottom. Because they are registered through <a href="https://drafts.css-houdini.org/css-properties-values-api/#at-property-rule" target="_blank" rel="noopener noreferrer"><code>@property</code></a>, <a href="https://drafts.css-houdini.org/css-properties-values-api/#animation-behavior-of-custom-properties" target="_blank" rel="noopener noreferrer">they will interpolate nicely</a> instead of <a href="https://w3.org/TR/web-animations/#discrete" target="_blank" rel="noopener noreferrer">animating discretely</a>.</p><blockquote><p>When referenced by animations and transitions, custom property values interpolate by computed value, in accordance with the type that they parsed as.</p></blockquote><div class="codepen-wrapper codepen-LYMoMEz/eb904c5de30a6a7dd7ffcc1f7c5a085a"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>~</p><h4 id="delaying-one-of-the-custom-properties-1" tabindex="-1"><a class="header-anchor" href="#delaying-one-of-the-custom-properties-1"><span><a href="#the-concept-2">#</a> Delaying one of the Custom Properties</span></a></h4><p>Animating two different properties in exactly the same way seems a bit stupid, but that‚Äôs where the rest of the trick comes into play. By delaying the <code>--scroll-position-delayed</code> property ‚Äì using <a href="https://drafts.csswg.org/css-transitions/#transition-delay-property" target="_blank" rel="noopener noreferrer"><code>transition-delay</code></a> ‚Äì <strong>on a child of the scroller</strong>, you can have it lag on the parent.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> --scroll-position-delayed 0.15s linear<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It is very important to note that I‚Äôm delaying the <code>--scroll-position-delayed</code> on the <code>body</code> element, which is a child of <code>html</code>. By doing so, I am not lagging <code>--scroll-position-delayed</code> on <code>--scroll-position</code> but, instead, I am lagging the <code>--scroll-position-delayed</code> value of the <code>body</code> element on the <code>--scroll-position-delayed</code> value of the <code>html</code> element.</p><p>‚òùÔ∏è This parent-child relationship is a requirement for this trick to work ‚Äì it won‚Äôt work if you delay <code>--scroll-position-delayed</code> on the scroller ‚Äì here <code>html</code> ‚Äì itself. You can draw a parallel to <a class="route-link" href="/bookshelf/bram.us/css-container-queries-a-first-look-and-demo.html#container-queries"><strong>Container Queries</strong></a> here, which also require a parent-child relationship.</p><p>The set <code>transition-delay</code> controls how much lag there is before <code>--scroll-position-delayed</code> on the <code>body</code> catches up with the value from the <code>html</code> element. Best is to keep the delay pretty low, as the resulting effect could otherwise feel slow to users.</p><div class="codepen-wrapper codepen-YzdbdyL/52b163fb496bc91464f1a851878b344d"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Try scrolling up and down in the CodePen embedded above, and notice how <code>--scroll-position-delayed</code> lags on the <code>--scroll-position</code> variable. Repeat your test while scrolling very fast or really slow, and compare the effect of both speeds to each other.</p><p>~</p><h4 id="calculating-the-scroll-velocity-1" tabindex="-1"><a class="header-anchor" href="#calculating-the-scroll-velocity-1"><span><a href="#the-concept-3">#</a> Calculating the Scroll Velocity</span></a></h4><p>Because the computed values of the <code>--scroll-position</code> and <code>--scroll-position-delayed</code> properties differ as you scroll, you can use them to calculate the scroll velocity. By taking the difference of both values ‚Äì using a regular <a href="https://drafts.csswg.org/css-values/#funcdef-calc" target="_blank" rel="noopener noreferrer"><code>calc()</code></a> ‚Äì you end up with a number that will be one of these:</p><ul><li>A positive float, ranging from <code>0</code> to <code>1</code>, indicating the user is scrolling down</li><li><code>0</code>, indicating the user is not scrolling</li><li>A negative float, ranging from <code>-1</code> to <code>0</code>, indicating the user is scrolling up</li></ul><p>In CSS, it looks like this:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> --scroll-position-delayed 0.15s linear<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-velocity</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-position<span class="token punctuation">)</span> - <span class="token function">var</span><span class="token punctuation">(</span>--scroll-position-delayed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="codepen-wrapper codepen-VwqOqwQ/d0a922a21fd64f8decc88991c754cc04"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Try scrolling up and down in the CodePen embedded above, and notice how <code>--scroll-velocity</code> is a float representing the scroll velocity. Repeat your test while scrolling very fast or really slow, and compare the effect of both speeds to each other.</p><p>üïµÔ∏è When looking really close, you might notice that the number is a bit off when quickly changing the direction or when abruptly stopping a scroll: the updated value of <code>--scroll-velocity</code> will not immediately reflect the actual state. This can be tweaked by tightening the <code>transition-delay</code> of the <code>--scroll-position-delayed</code> property, but then you end up with smaller values for <code>--scroll-velocity</code> so you might need a multiplier to counteract that.</p><p>There‚Äôs also a difference in update speed between dragging the scrollbar versus using the touchpad to scroll the scroller. The former updates much, much, faster.</p><p>~</p><h4 id="calculating-the-scroll-direction-and-scroll-speed-1" tabindex="-1"><a class="header-anchor" href="#calculating-the-scroll-direction-and-scroll-speed-1"><span><a href="#the-concept-4">#</a> Calculating the Scroll Direction and Scroll Speed</span></a></h4><p>Because Velocity is a measured Speed into a certain Direction <em>(<a href="https://britannica.com/story/whats-the-difference-between-speed-and-velocity" target="_blank" rel="noopener noreferrer">ref</a>)</em>, the Direction and Speed can be extracted from the Velocity.</p><p>The direction of scrolling can be derived from the <code>--scroll-velocity</code> by looking at its sign: If it‚Äôs positive, then the user is scrolling down. If it is negative, the user is scrolling up.</p><p>In CSS, you can use the <a href="https://drafts.csswg.org/css-values/#sign-funcs" target="_blank" rel="noopener noreferrer">the <code>sign()</code> function</a> to extract that info:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--scroll-direction</span><span class="token punctuation">:</span> <span class="token function">sign</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The value for <code>--scroll-direction</code> is one of these:</p><ul><li><code>1</code>, indicating the user is scrolling down</li><li><code>0</code>, indicating the user is not scrolling</li><li><code>-1</code>, indicating the user is scrolling up</li></ul><p>This value will come in handy in calculations further down the road.</p><p>Extracting the scroll speed from the velocity is also easy to do, as it‚Äôs a matter of dropping sign from the value. In CSS, this can be done using <a href="https://drafts.csswg.org/css-values/#sign-funcs" target="_blank" rel="noopener noreferrer">the <code>abs()</code> function</a>.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--scroll-speed</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Put together, you get this:</p><div class="codepen-wrapper codepen-LYMLoJa/49dd704872be26534482faef58b788fb"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Try scrolling up and down in the CodePen above, and notice how <code>--scroll-direction</code> is an integer representing the scroll direction, unaffected by the scroll speed.</p><p>üë®‚Äçüî¨ At the time of writing, <code>sign()</code> and <code>abs()</code> are available in Chrome only once you flip on the Experimental Web Platform Features feature flag on through <code>chrome://flags</code>.</p><p>Thankfully, the functionality can be polyfilled using some basic mathematics, as detailed by <a href="https://thebabydino.github.io/" target="_blank" rel="noopener noreferrer">Ana Tudor</a> in <a href="https://css-tricks.com/using-absolute-value-sign-rounding-and-modulo-in-css-today/#aa-sign" target="_blank" rel="noopener noreferrer">this post on CSS-Tricks</a>.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--scroll-speed</span><span class="token punctuation">:</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">,</span> -1 * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-direction</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> / <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>~</p><h3 id="basic-demos-1" tabindex="-1"><a class="header-anchor" href="#basic-demos-1"><span><a href="#basic-demos">#</a> Basic demos</span></a></h3><p>With these computed custom properties <code>--scroll-velocity</code> and <code>--scroll-direction</code> available it‚Äôs time to get creative ‚Ä¶</p><p>~</p><h4 id="tilted-colored-boxes-1" tabindex="-1"><a class="header-anchor" href="#tilted-colored-boxes-1"><span><a href="#demo-tilted-boxes">#</a> Tilted Colored boxes</span></a></h4><p>A first demos are these boxes that get skewed in a certain angle depending on the scroll. The faster you scroll, the more skewed they get, with a maximum of 25 degrees.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">skew</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> * -25deg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Furthermore the boxes also get the hue of their <code>background-color</code> rotated depending on the scroll direction.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">hsl</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>0deg + <span class="token punctuation">(</span>145deg * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 50% 50%<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> background 0.15s ease<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When idle, the boxes are red. When scrolling down they become green and when scrolling up they are blue. The transition of the background is eased at <code>0.15s</code>.</p><div class="codepen-wrapper codepen-oNJeLWg/cb3542fb8be1f8bb0a33e107229b9027"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>~</p><h4 id="motion-blur-scroll-1" tabindex="-1"><a class="header-anchor" href="#motion-blur-scroll-1"><span><a href="#demo-motion-blur-scroll">#</a> Motion Blur Scroll</span></a></h4><p>Things also become interesting when using the <code>--scroll-velocity</code> and <code>--scroll-speed</code> values in a <code>filter</code>, as that function has many options. With it, you can create a Motion Blur effect, that even desaturates the content as you scroll.</p><div class="codepen-wrapper codepen-XWoREjv/a0e0aca0d543dc146b90bea779fbd964"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>The blurring and desaturating is handled by the <code>filter</code> property. Some basic translation and <code>opacity</code>-meddling also takes place, to give it a rather cinematic effect. To always have a positive float value for use within all calculations, the code relies on <code>--scroll-speed</code> instead of <code>--scroll-velocity</code> which can become negative.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">main</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">filter</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token function">blur</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>2rem * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">contrast</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>100% - <span class="token punctuation">(</span>500% * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">saturate</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>100% - <span class="token punctuation">(</span>500% * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>1 - <span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-speed<span class="token punctuation">)</span> * 4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">translate</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>-8rem * <span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span><span class="token punctuation">)</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Furthermore the entire photostrip gets skewed a tiny bit while scrolling, similar to a previous demo.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">.photo</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">skew</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> * 3deg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The faster your scroll, the harder the effect is.</p><p>~</p><h3 id="intermezzo-what-about-style-queries-1" tabindex="-1"><a class="header-anchor" href="#intermezzo-what-about-style-queries-1"><span><a href="#style-queries">#</a> Intermezzo: what about Style Queries?</span></a></h3><p><strong>UPDATE 2023.10.26</strong> After chatting with <a href="https://xanthir.com/contact/" target="_blank" rel="noopener noreferrer">Tab Atkins</a> about this, it became clear that the simplification won‚Äôt happen until the custom property is registered as a <code>&lt;number&gt;</code> ‚Äì something I wasn‚Äôt aware of. This section has been rewritten to incorporate that info.</p><p>Now, you might be wondering if you can use <a href="https://brm.us/style-queries" target="_blank" rel="noopener noreferrer">Style Queries</a> for easier styling when relying on only the scroll direction. It‚Äôs definitely a valid question, as doing the calculations can be hard to get right, with a lot of trial and error.</p><p>After all, it would be so much easier if you could do this, allowing you to put any styles in the container blocks:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> 0<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Idle */</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> 1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Scrolling down */</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> -1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Scrolling up */</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>According <a href="https://drafts.csswg.org/css-values-4/#calc-computed-value" target="_blank" rel="noopener noreferrer">to the spec</a> any mathematical expression should be simplified:</p><blockquote><p>The computed value of a math function is its calculation tree simplified, using all the information available at computed value time.</p></blockquote><p>So when idling, the computed value of <code>--scroll-direction</code> should become <code>0</code>, right? Unfortunately that doesn‚Äôt seem to be the case: when checking the computed value of <code>--scroll-direction</code> when idle, it computes to <code>sign(calc(0 - 0))</code>, without any simplification applied. Huh?!</p><p>The reason why simplification doesn‚Äôt happen is that the browser doesn‚Äôt know that it can. A custom property can hold any value; It‚Äôs only when it‚Äôs being used as a value ‚Äì via <code>var()</code> ‚Äì that the browser tries to convert the custom property to be of a certain type that fits the property it is used in. If the type conversion doesn‚Äôt work out ‚Äì e.g. when trying to set a color as the value for an <code>animation-duration</code> ‚Äì the declaration will become <a href="https://w3.org/TR/css-variables-1/#invalid-at-computed-value-time" target="_blank" rel="noopener noreferrer">‚ÄúInvalid At Computed Value Time‚Äù</a>.</p><p>~</p><h4 id="property-to-the-rescue-1" tabindex="-1"><a class="header-anchor" href="#property-to-the-rescue-1"><span><a href="#cq-at-property">#</a> <code>@property</code> to the rescue!</span></a></h4><p>So, can you force the conversion to happen, in order for the simplification to occur? Why yes you can! By registering <code>--scroll-direction</code> ‚Äì using <code>@property</code> ‚Äì to be a <code>&lt;number&gt;</code>, the browser will try to fit the declared value into that type. At that point the simplification will occur, and <code>sign(calc(0 - 0))</code> can be simplified to <code>0</code></p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@property</span> --scroll-direction</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">syntax</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;number&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">inherits</span><span class="token punctuation">:</span> true<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">initial-value</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With this registration, it now becomes possible to use style queries for the styling based on the scroll direction:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> 0<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Idle */</span></span>
<span class="line">  <span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">background</span><span class="token punctuation">:</span> crimson<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> 1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Scrolling down */</span></span>
<span class="line">  <span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">background</span><span class="token punctuation">:</span> forestgreen<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token atrule"><span class="token rule">@container</span> <span class="token function">style</span><span class="token punctuation">(</span><span class="token property">--scroll-direction</span><span class="token punctuation">:</span> -1<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> <span class="token comment">/* Scrolling up */</span></span>
<span class="line">  <span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">background</span><span class="token punctuation">:</span> lightskyblue<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="codepen-wrapper codepen-dyaYoyG"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>üíÅ‚Äç‚ôÇÔ∏è Compare the non-registered vs registered behavior</p><p>Here‚Äôs a small CodePen that tests the simplification/seriallization of <code>calc()</code>. The value of the <code>--output</code> property eventually becomes <code>calc(2 * 0.5)</code>, because the custom property is not registered to be of a certain type.</p><div class="codepen-wrapper codepen-RwEqJye/2ebcc612170ef036b46bb2fb6c6cf0c7"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Now compare this to this adjusted version where the custom property is registered as a <code>&lt;number&gt;</code>:</p><div class="codepen-wrapper codepen-WNPvvzm"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>~</p><h3 id="combine-multiple-scroll-states-thanks-to-more-maths-1" tabindex="-1"><a class="header-anchor" href="#combine-multiple-scroll-states-thanks-to-more-maths-1"><span><a href="#more-scroll-states">#</a> Combine multiple scroll states, thanks to more Maths</span></a></h3><p>Thanks to some more basic maths, it‚Äôs possible to end up with a value of <code>1</code> in various scroll-cases.</p><p>For example, if you take the absolute value of <code>--scroll-direction</code> ‚Äì which is either <code>-1</code>, <code>0</code>, or <code>1</code> ‚Äì you end up with a value of <code>1</code> only when the user scrolling:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--when-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Furthermore, if you take that value, subtract <code>1</code> from it, and absolute the result, you end up with a value of <code>1</code> only when the user is not scrolling:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--when-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--when-scrolling<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Mix and match basic maths, <code>abs</code>, <code>min</code>, <code>max</code>, <code>clamp</code>, and you can end up with a value of <code>1</code> in any of these situations:</p><ul><li>When scrolling up or down</li><li>When not scrolling</li><li>When scrolling up</li><li>When scrolling down</li><li>When scrolling up or idle</li><li>When scrolling down or idle</li></ul><p>In code, it looks like this:</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--when-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--when-scrolling<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling-up</span><span class="token punctuation">:</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> - <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-scrolling-down</span><span class="token punctuation">:</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token property">--when-scrolling-down-or-when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + 1<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--when-scrolling-up-or-when-not-scrolling</span><span class="token punctuation">:</span> <span class="token function">clamp</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> - 1<span class="token punctuation">)</span><span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Look at the examples below for some use-cases. Don‚Äôt forget to <a href="#cq-at-property">register these as a <code>&lt;number&gt;</code> if you want to use these in Style Queries</a>.</p><p>~</p><h4 id="demo-moving-header-1" tabindex="-1"><a class="header-anchor" href="#demo-moving-header-1"><span><a href="#demo-moving-header">#</a> Demo: Moving Header</span></a></h4><p>One example where you can use this is to hide the header and footer bars while the user is scrolling. This is done by translating the bars out the way in that case. For this, the code uses <code>--when-scrolling</code> ‚Äì which has a value of <code>1</code> when scrolling and a value of <code>0</code> when not scrolling ‚Äì as <a href="https://bram.us/2017/01/17/conditions-for-css-calculations/" target="_blank" rel="noopener noreferrer">the condition for the calculation</a>.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">--hide-bars</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--when-scrolling<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">header</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">translate</span><span class="token punctuation">:</span> 0 <span class="token function">calc</span><span class="token punctuation">(</span>-90% * <span class="token function">var</span><span class="token punctuation">(</span>--hide-bars<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">footer</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">translate</span><span class="token punctuation">:</span> 0 <span class="token function">calc</span><span class="token punctuation">(</span>90% * <span class="token function">var</span><span class="token punctuation">(</span>--hide-bars<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The demo below requires Chrome with the Experimental Web Platform Features feature flag enabled.</p><div class="codepen-wrapper codepen-dywzeoN/d4ee4fafdd7287701713d46e741ba94e"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>üí≠ Initially I wanted to hide the header upon scrolling down or remaining idle after having scrolled down, and only show it again once starting to scroll up again. I couldn‚Äôt immediately find a solution here ‚Äì using <code>--when-scrolling-down-or-when-not-scrolling</code> also hides it on initial load, which is not what I want ‚Äì but I‚Äôm sure <a href="https://front-end.social/@johannes" target="_blank" rel="noopener noreferrer">Johannes</a> will be able to tell me how to do it using <a href="https://johannesodland.github.io/state/scroll-snap/scroll-driven-animations/2023/06/18/scroll-persisted-state.html" target="_blank" rel="noopener noreferrer">Scroll-Persisted State</a>.</p><p>It is possible to ‚Äúremember‚Äù the last scrolled direction by using a long <code>transition-delay</code>. See <a href="https://brm.us/hidey-bar" target="_blank" rel="noopener noreferrer">https://brm.us/hidey-bar</a> for details on how to use this.</p><p>~</p><h4 id="demo-directional-chicky-scroll-1" tabindex="-1"><a class="header-anchor" href="#demo-directional-chicky-scroll-1"><span><a href="#demo-directional-chicky-scroll">#</a> Demo: Directional Chicky Scroll</span></a></h4><p>When <a href="https://twitter.com/utilitybend" target="_blank" rel="noopener noreferrer">Brecht De Ruyte</a> <a href="https://utilitybend.com/blog/for-the-love-of-scroll-driven-animations-in-css" target="_blank" rel="noopener noreferrer">explored Scroll-Driven Animations back in February</a>, he built a demo where a little chicky walks across the screen as you scroll the page. While building that demo he noted that when scrolling up, the chicky is facing the wrong direction:</p><blockquote><p>The downside is that my animation seems to trigger a bit of moonwalking when scrolling back to top. Let‚Äôs just call it a feature for now, ok? üòâ</p></blockquote><p>With <code>--scroll-direction</code> available it‚Äôs pretty easy to flip the chicky in the other direction by passing that into <code>scaleX()</code>. However, when idling you‚Äôd end up with a <code>scaleX()</code> of <code>0</code> so to counter that I add <code>--when-not-scrolling</code> to the equation. By doing so, the <code>scaleX()</code> will also be <code>1</code> when idle, so the chicky will face forwards in that case.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token atrule"><span class="token rule">@keyframes</span> moveChicky</span> <span class="token punctuation">{</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>80px<span class="token punctuation">)</span> <span class="token function">scaleX</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-direction<span class="token punctuation">)</span> + <span class="token function">var</span><span class="token punctuation">(</span>--when-not-scrolling<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  ‚Ä¶</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The demo below requires Chrome with the Experimental Web Platform Features feature flag enabled.</p><div class="codepen-wrapper codepen-LYMjgjB/1e36fc337fc5f703e84397f089fc017c"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>~</p><h3 id="lerp-effects-1" tabindex="-1"><a class="header-anchor" href="#lerp-effects-1"><span><a href="#lerp-effects">#</a> LERP-effects</span></a></h3><p>Because there is a delay happening it‚Äôs possible to create typical LERP-effects. Below are a few demos that reproduce that.</p><p>üí° LERP = <a href="https://en.wikipedia.org/wiki/Linear_interpolation" target="_blank" rel="noopener noreferrer"><strong>L</strong>inear int<strong>ERP</strong>olation</a></p><p>~</p><h4 id="demo-lerp-reading-indicator-1" tabindex="-1"><a class="header-anchor" href="#demo-lerp-reading-indicator-1"><span><a href="#demo-lerp-reading-indicator">#</a> Demo: LERP Reading Indicator</span></a></h4><p>In this demo, the reading indicator catches up on the actual reading position. The code is easy, as it relies directly on <code>--scroll-position-delayed</code>.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">#progress</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scaleX</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-position-delayed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="codepen-wrapper codepen-VwqJObR/7ef7eaaa78ad1382dbe5c5c4c5066989"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>Compare the behavior of the demo above to <a href="https://scroll-driven-animations.style/demos/progress-bar/css/" target="_blank" rel="noopener noreferrer">this original version</a> whose reading indicator responds directly to the scroll position change.</p><p>~</p><h4 id="demo-lerp-scrolling-1" tabindex="-1"><a class="header-anchor" href="#demo-lerp-scrolling-1"><span><a href="#demo-lerp-scrolling">#</a> Demo: LERP Scrolling</span></a></h4><p>Recreating a LERP scrolling effect is a bit more difficult as you don‚Äôt want to recreate an entirely custom scroller from scratch ‚Äì These always end up in the <a href="https://en.wikipedia.org/wiki/Uncanny_valley" target="_blank" rel="noopener noreferrer">uncanny valley</a>. What I‚Äôve done in the demo below is added some fake drag to the scroll by translating the contents in the opposite scrolling direction.</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token selector">.slider</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">animation</span><span class="token punctuation">:</span> adjust-pos linear both<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">animation-timeline</span><span class="token punctuation">:</span> <span class="token function">scroll</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* Hook animation onto self */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token selector">.slider-item</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">transition</span><span class="token punctuation">:</span> --scroll-position-delayed 0.25s linear<span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">--scroll-velocity</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-position<span class="token punctuation">)</span> - <span class="token function">var</span><span class="token punctuation">(</span>--scroll-position-delayed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--scroll-velocity<span class="token punctuation">)</span> * 500vh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* Add some drag. Tweak the 500vh value to adjust how much drag */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="codepen-wrapper codepen-GRPvqrN/1c39bc90ac0e08708933eb999c0941a8"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>The effect is not entirely perfect though. For example, when hitting the end of the scroller the <code>--scroll-position-delayed</code> is still getting delayed while it should skip forwards in that case.</p><p>~</p><h3 id="more-demos-1" tabindex="-1"><a class="header-anchor" href="#more-demos-1"><span><a href="#more-demos">#</a> More Demos</span></a></h3><p>I‚Äôm sure this technique will spark a lot of nice new demos. Here‚Äôs a few more that I‚Äôve built using this technique.</p><p>~</p><h4 id="demo-wormhole-1" tabindex="-1"><a class="header-anchor" href="#demo-wormhole-1"><span><a href="#demo-wormhole">#</a> Demo: Wormhole</span></a></h4><p>By nesting a bunch of boxes, you can see how the value of <code>--scroll-position-delayed</code> propagates from box to box. Add some translation + colors, and you get a wormhole effect.</p><div class="codepen-wrapper codepen-wvRqVBm/b4a25463d8c5315758802aba3e60b9ab"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>The demo also includes the code to respond to a horizontal delayed scroll.</p><p>~</p><h4 id="demo-badass-1" tabindex="-1"><a class="header-anchor" href="#demo-badass-1"><span><a href="#demo-badass">#</a> Demo: BADASS</span></a></h4><p>Back in 2017 I saw a nice scroll effect on <a href="https://badassfilms.tv/" target="_blank" rel="noopener noreferrer">the BADASS website</a>. The site is no longer up in that state, but thankfully <a href="https://bram.us/2017/10/15/badass/" target="_blank" rel="noopener noreferrer">my blog entry about it</a> also included a video of the effect, which I‚Äôve also embedded below:</p><figure><img src="https://bram.us/wordpress/wp-content/uploads/2017/10/badass_homepage_shoot_02.gif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Recording of the original</p><p>As I wrote back then:</p><blockquote><p>The effect is achieved by placing a duplicate (but clipped) list on top of another one, in combination with scroll velocity calculation to define the slant of the list.</p></blockquote><p>Recreating this effect is now perfectly possible with just CSS:</p><ul><li>Move the two lists across the screen as you scroll from top to bottom</li><li>Adjust the <code>clip-path</code> of the hotpink list as you scroll</li><li>Adjust the slant of the outlined list depending on the scroll speed and direction</li></ul><p>The difficult part here wasn‚Äôt to skew the list ‚Äì this was already done in the other demos ‚Äì but to get the <code>clip-path</code> working correctly. You can check the code for my calculations and comments.</p><div class="codepen-wrapper codepen-OJrxBaL/3069957ece86b0c8aafb4a249ff9271a"><!----><span>See <a>CodePen Embed</a> by <a href="https://codepen.io/bramus">bramus</a> on <a href="https://codepen.io">CodePen</a>.</span></div><p>üé¨ Check a recording of this demo</p><p>Video Player</p><p><a href="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-050p.mp4" target="_blank" rel="noopener noreferrer">https://www.bram.us/wordpress/wp-content/uploads/2023/10/sda-badass-050p.mp4</a></p><p>00:00</p><p>00:00</p><p>00:11</p><p>[Use Up/Down Arrow keys to increase or decrease volume.</p><p>](javascript:void(0)üòâ</p><p>Recording of the demo inspired upon the original animation oon the BADASS website.</p><p>~</p><h3 id="a-note-on-performance-1" tabindex="-1"><a class="header-anchor" href="#a-note-on-performance-1"><span><a href="#performance">#</a> A note on performance</span></a></h3><p>When doing a trace via Chrome DevTools you might notice that paint constantly gets triggered as you scroll.</p><figure><a href="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-custom-property-main-thread.png" target="_blank" rel="noopener noreferrer"><img src="https://bram.us/wordpress/wp-content/uploads/2023/10/sda-custom-property-main-thread.png" alt="" tabindex="0" loading="lazy"></a><figcaption></figcaption></figure><p>A Performance Trace in Chrome DevTools of the <a href="#demo-lerp-reading-indicator">LERP Reading Indicator Demo</a>, riddled with rendering Tasks</p><p>This is because Chrome ‚Äì and any other browser for that matter ‚Äì animates Custom Properties on the main thread. I have <a href="https://brm.us/animate-custom-properties" target="_blank" rel="noopener noreferrer">written about this problem space before</a>, and hope to see this fixed in the future. Star <a href="https://crbug.com/1411864" target="_blank" rel="noopener noreferrer">Chromium Issue #1411864</a> to stay in the loop.</p><p>~</p><h3 id="closing-thoughts-1" tabindex="-1"><a class="header-anchor" href="#closing-thoughts-1"><span><a href="#closing-thoughts">#</a> Closing Thoughts</span></a></h3><p>One of the features authors have asked about at the CSS Working Group is to expose current scrolling direction in CSS <em>(<a href="https://github.com/w3c/csswg-drafts/issues/6400" target="_blank" rel="noopener noreferrer">w3c/csswg-drafts#6400</a>)</em>. Not only does the technique described in this article offer an answer to that problem, it cranks it up a notch by also exposing the scrolling speed. While it‚Äôs not entirely perfect ‚Äì e.g. the scroll velocity can lag a bit on the actual situation ‚Äì it can already get you quite the distance.</p><p>Personally I think it is very exciting to see that Scroll-Driven Animations yet again <em>([<a href="https://kizu.dev/scroll-driven-animations/" target="_blank" rel="noopener noreferrer">1</a>], [<a href="https://johannesodland.github.io/state/scroll-snap/scroll-driven-animations/2023/06/18/scroll-persisted-state.html" target="_blank" rel="noopener noreferrer">2</a>], [<a href="https://kizu.dev/fit-to-width-text/" target="_blank" rel="noopener noreferrer">3</a>]. [<a href="https://bram.us/2023/06/26/faking-a-snapped-selector-with-scroll-driven-animations/" target="_blank" rel="noopener noreferrer">4</a>], [<a href="https://bram.us/2023/09/16/solved-by-css-scroll-driven-animations-detect-if-an-element-can-scroll-or-not/" target="_blank" rel="noopener noreferrer">5</a>], [<a href="https://kizu.dev/scroll-driven-state-transfer/" target="_blank" rel="noopener noreferrer">6</a>])</em> can be used for so much more than simply animating things as you scroll. I‚Äôm very much looking forward to more unconventional uses of this feature, unlocking some age-old requests ‚Ä¶</p><!-- TODO: add ARTICLE CARD --><a class="vp-card" href="https://chanhi2000.github.io/bookshelf/bram.us/css-scroll-detection.html" target="_blank" style="background:rgba(17,17,17,0.2);"><img class="vp-card-logo" src="https://bramu.us/favicon.ico" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Solved by CSS Scroll-Driven Animations: Style an element based on the active Scroll Direction and Scroll Speed</div><hr><div class="vp-card-desc">Combine Scroll-Driven Animations with @‚Äãproperty, transition-delay, calc(), sign() and abs() ‚Ä¶ and you can do Scroll Detection using only CSS!</div></div></a></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/chanhi2000/bookshelf/edit/main/src/bram.us/css-scroll-detection.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/bookshelf/programming/css/articles/" aria-label="/programming/css/articles/"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->/programming/css/articles/</div></a><a class="route-link auto-link next" href="/bookshelf/bram.us/the-future-of-css-easy-light-dark-mode-color-switching-with-light-dark.html" aria-label="The Future of CSS: Easy Light-Dark Mode Color Switching with light-dark()"><div class="hint">Next<span class="arrow end"></span></div><div class="link">The Future of CSS: Easy Light-Dark Mode Color Switching with light-dark()<i class="vp-icon fa-brands fa-css3-alt" sizing="height"></i></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">MIT Licensed | Copyright ¬© 2022-present <a href="https://github.com/chanhi2000">Chan Hee Lee</a></div><div class="vp-copyright">Copyright ¬© 2026 Bramus! </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/bookshelf/assets/app-BItykJLQ.js" defer></script>
  </body>
</html>
