<!doctype html>
<html lang="ko-KR" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"URL이 이상해요! Java와 Spring 중 범인은 누구?","image":["https://tech.kakaopay.com/_astro/screen.063e0de1_2f5m8V.avif","https://tech.kakaopay.com/_astro/landing_error.914c1172_e7ocx.avif","https://tech.kakaopay.com/_astro/test_result.1eb9bdd2_Z4mrQ6.avif","https://tech.kakaopay.com/_astro/fromUri_host_exists.b2b3ad76_Z26H84S.avif","https://tech.kakaopay.com/_astro/fromUri_host_null.f01247c2_1hFhYI.avif","https://tech.kakaopay.com/_astro/UriComponentsBuilder_fromUri.4e8d9e9d_1PQ0wU.avif","https://tech.kakaopay.com/_astro/UriComponentsBuilder_uri.b22745bb_ZR0Aj3.avif","https://tech.kakaopay.com/_astro/URI_host_exists.3261570c_1UH0Qp.avif","https://tech.kakaopay.com/_astro/URI_host_null.eb4f9b78_Z2uQCIt.avif","https://tech.kakaopay.com/_astro/URI_host_null_toString.d118cf92_Z74Q2I.avif","https://tech.kakaopay.com/_astro/URI_host_null_authority.a7e39746_Z1lUgWV.avif","https://novaworkssoftware.com/blog/archives/218-LDC-72-Get-Crackn-Working-with-URIs.html","https://tech.kakaopay.com/_astro/URI_parseHostname.adc23c2c_2qK3uY.avif","https://tech.kakaopay.com/_astro/UriComponentsBuilder_code.547aa00e_1LuMMN.avif","https://tech.kakaopay.com/_astro/UriComponents_methods.fcb8172c_1qTL9R.avif","https://tech.kakaopay.com/_astro/test_success.76960382_2jxcf2.avif","https://tech.kakaopay.com/_astro/sonar.16182527_1HWJ68.avif"],"datePublished":"2024-09-26T00:00:00.000Z","dateModified":null,"author":[{"@type":"Person","name":"rain.drop"}]}</script><meta property="og:url" content="https://chanhi2000.github.io/bookshelf/tech.kakaopay.com/url-is-strange.html"><meta property="og:site_name" content="📚Bookshelf"><meta property="og:title" content="URL이 이상해요! Java와 Spring 중 범인은 누구?"><meta property="og:description" content="Article(s) > URL이 이상해요! Java와 Spring 중 범인은 누구?"><meta property="og:type" content="article"><meta property="og:image" content="https://tech.kakaopay.com/_astro/thumb.ae533dc7_Z1gJ8gh.png"><meta property="og:locale" content="ko-KR"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:src" content="https://tech.kakaopay.com/_astro/thumb.ae533dc7_Z1gJ8gh.png"><meta name="twitter:image:alt" content="URL이 이상해요! Java와 Spring 중 범인은 누구?"><meta property="article:author" content="rain.drop"><meta property="article:tag" content="알림피드"><meta property="article:tag" content="UriComponentsBuilder"><meta property="article:tag" content="uri"><meta property="article:tag" content="kotlin"><meta property="article:tag" content="spring"><meta property="article:tag" content="jdk"><meta property="article:tag" content="java"><meta property="article:tag" content="tech.kakaopay.com"><meta property="article:tag" content="blog"><meta property="article:published_time" content="2024-09-26T00:00:00.000Z"><link rel="icon" href="/bookshelf/assets/icon/favicon.svg"><title>URL이 이상해요! Java와 Spring 중 범인은 누구? | 📚Bookshelf</title><meta name="description" content="Article(s) > URL이 이상해요! Java와 Spring 중 범인은 누구?">
    <link rel="preload" href="/bookshelf/assets/style-DmRYlEXZ.css" as="style"><link rel="stylesheet" href="/bookshelf/assets/style-DmRYlEXZ.css">
    
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/bookshelf/" aria-label="Take me home"><img class="vp-nav-logo" src="/bookshelf/assets/icon/favicon.svg" alt><!----><span class="vp-site-name hide-in-pad">📚Bookshelf</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/bookshelf/news.html" aria-label><!--[--><i class="vp-icon fas fa-rss" sizing="height"></i><!--]--><!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-keyboard" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/hackingwithswift.com/" aria-label="hackingwithswift.com"><!--[--><img class="vp-icon" src="https://hackingwithswift.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->hackingwithswift.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fcc/" aria-label="freecodecamp.org"><!--[--><img class="vp-icon" src="https://cdn.freecodecamp.org/universal/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->freecodecamp.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kodeco.com/" aria-label="kodeco.com"><!--[--><img class="vp-icon" src="https://kodeco.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->kodeco.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.kotzilla.io/" aria-label="blog.kotzilla.io"><!--[--><img class="vp-icon" src="https://blog.kotzilla.io/hubfs/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.kotzilla.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kt.academy/" aria-label="kt.academy"><!--[--><img class="vp-icon" src="https://kt.academy/logo.png" alt aria-hidden no-view sizing="both"><!--]-->kt.academy<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/droidcon.com/" aria-label="droidcon.com"><!--[--><img class="vp-icon" src="https://droidcon.com/wp-content/uploads/2021/07/favicon-300x300.png" alt aria-hidden no-view sizing="both"><!--]-->droidcon.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/outcomeschool.com/" aria-label="outcomeschool.com"><!--[--><img class="vp-icon" src="https://outcomeschool.com/static/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->outcomeschool.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/frontendmasters.com/" aria-label="frontendmasters.com"><!--[--><img class="vp-icon" src="https://frontendmasters.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->frontendmasters.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tricks.com/" aria-label="css-tricks.com"><!--[--><img class="vp-icon" src="https://css-tricks.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->css-tricks.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="smashingmagazine.com"><!--[--><img class="vp-icon" src="https://smashingmagazine.com/images/favicon/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->smashingmagazine.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.logrocket.com/" aria-label="blog.logrocket.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/blog.logrocket.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.logrocket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/realpython.com/" aria-label="realpython.com"><!--[--><img class="vp-icon" src="https://realpython.com/static/favicon.68cbf4197b0c.png" alt aria-hidden no-view sizing="both"><!--]-->realpython.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/digitalocean.com/" aria-label="digitalocean.com"><!--[--><img class="vp-icon" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt aria-hidden no-view sizing="both"><!--]-->digitalocean.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/antonioleiva.com/" aria-label="antonioleiva.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/antonioleiva.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->antonioleiva.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/johnnyreilly.com/" aria-label="johnnyreilly.com"><!--[--><img class="vp-icon" src="https://johnnyreilly.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->johnnyreilly.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/code-maze.com/" aria-label="code-maze.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/code-maze.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->code-maze.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/milanjovanovic.tech/" aria-label="milanjovanovic.tech"><!--[--><img class="vp-icon" src="https://milanjovanovic.tech/profile_favicon.png" alt aria-hidden no-view sizing="both"><!--]-->milanjovanovic.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/shopify.engineering/" aria-label="shopify.engineering"><!--[--><img class="vp-icon" src="https://cdn.shopify.com/static/shopify-favicon.png" alt aria-hidden no-view sizing="both"><!--]-->shopify.engineering<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devtoolstips.org/" aria-label="devtoolstips.org"><!--[--><img class="vp-icon" src="https://devtoolstips.org/assets/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devtoolstips.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/piccalil.li/" aria-label="piccalil.li"><!--[--><img class="vp-icon" src="https://piccalil.li/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->piccalil.li<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/sitepoint.com/" aria-label="sitepoint.com"><!--[--><img class="vp-icon" src="https://sitepoint.com/favicons/512x512.png" alt aria-hidden no-view sizing="both"><!--]-->sitepoint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/event-driven.io/" aria-label="event-driven.io"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/event-driven.io/favicon.jfif" alt aria-hidden no-view sizing="both"><!--]-->event-driven.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/packagemain.tech/" aria-label="packagemain.tech"><!--[--><img class="vp-icon" src="https://substack-post-media.s3.amazonaws.com/public/images/2ea54e25-eaa6-4630-bfc0-10b8cfdce894/apple-touch-icon-1024x1024.png" alt aria-hidden no-view sizing="both"><!--]-->packagemain.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/gosolve.io/" aria-label="gosolve.io"><!--[--><img class="vp-icon" src="https://gosolve.io/wp-content/uploads/2022/03/cropped-ikona1-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->gosolve.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/towardsdatascience.com/" aria-label="towardsdatascience.com"><!--[--><img class="vp-icon" src="https://cdn-images-1.medium.com/v2/resize:fill:128:128/1*VzTUkfeGymHP4Bvav-T-lA.png" alt aria-hidden no-view sizing="both"><!--]-->towardsdatascience.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/douggregor.net/" aria-label="douggregor.net"><!--[--><i class="vp-icon fas fa-globe" sizing="both"></i><!--]-->douggregor.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/d2.naver.com/" aria-label="d2.naver.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/d2.naver.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->d2.naver.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakao.com/" aria-label="tech.kakao.com"><!--[--><img class="vp-icon" src="https://www.kakaocorp.com/page/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakao.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/bookshelf/tech.kakaopay.com/" aria-label="tech.kakaopay.com"><!--[--><img class="vp-icon" src="https://tech.kakaopay.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakaopay.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fe-developers.kakaoent.com/" aria-label="fe-developers.kakaoent.com"><!--[--><img class="vp-icon" src="https://fe-developers.kakaoent.com/favicon-32x32.png?v=44803cb16c1e2debd3984cf2e8cb2ded" alt aria-hidden no-view sizing="both"><!--]-->fe-developers.kakaoent.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/yozm.wishket.com/" aria-label="yozm.wishket.com"><!--[--><img class="vp-icon" src="https://yozm.wishket.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->yozm.wishket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/popit.kr/" aria-label="popit.kr"><!--[--><img class="vp-icon" src="https://popit.kr/wp-content/uploads/2016/08/favicon_32x32.png" alt aria-hidden no-view sizing="both"><!--]-->popit.kr<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devkuma.com/" aria-label="devkuma.com"><!--[--><img class="vp-icon" src="https://devkuma.com/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devkuma.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.gangnamunni.com/" aria-label="blog.gangnamunni.com"><!--[--><img class="vp-icon" src="https://blog.gangnamunni.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->blog.gangnamunni.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/codingeverybody.kr/" aria-label="codingeverybody.kr"><!--[--><img class="vp-icon" src="https://codingeverybody.kr/wp-content/uploads/cropped-favicon-origin-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->codingeverybody.kr<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-network-wired" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tecmint.com/" aria-label="tecmint.com"><!--[--><img class="vp-icon" src="https://tecmint.com/wp-content/uploads/2020/07/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tecmint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/docker.com/" aria-label="docker.com"><!--[--><img class="vp-icon" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->docker.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/learnk8s.io/" aria-label="learnk8s.io"><!--[--><img class="vp-icon" src="https://static.learnk8s.io/f7e5160d4744cf05c46161170b5c11c9.svg" alt aria-hidden no-view sizing="both"><!--]-->learnk8s.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/itsfoss.com/" aria-label="itsfoss.com"><!--[--><img class="vp-icon" src="https://itsfoss.com/content/images/size/w256h256/2022/12/android-chrome-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->itsfoss.com<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/chanhi2000/articles" target="_blank" rel="noopener noreferrer" aria-label="Github"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-appearance-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-appearance-dropdown"><!----></div></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><img class="vp-icon" src="https://tech.kakaopay.com/favicon.ico" alt aria-hidden no-view sizing="both"><span class="vp-sidebar-title">tech.kakaopay.com</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/tech.kakaopay.com/r2dbc-connection-pool-missing.html" aria-label="R2DBC Connection Pool 실종 사건"><!--[--><i class="vp-icon iconfont icon-spring" sizing="both"></i><!--]-->R2DBC Connection Pool 실종 사건<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/bookshelf/tech.kakaopay.com/url-is-strange.html" aria-label="URL이 이상해요! Java와 Spring 중 범인은 누구?"><!--[--><i class="vp-icon iconfont icon-spring" sizing="both"></i><!--]-->URL이 이상해요! Java와 Spring 중 범인은 누구?<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="https://tech.kakaopay.com/_astro/thumb.ae533dc7_Z1gJ8gh.png" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon iconfont icon-spring" sizing="height"></i>URL이 이상해요! Java와 Spring 중 범인은 누구?</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">rain.drop</span></span><span property="author" content="rain.drop"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">24. 9. 26.</span><meta property="datePublished" content="2024-09-26T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 4 min</span><meta property="timeRequired" content="PT4M"></span><span class="page-category-info" aria-label="Category🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8" role>Java</span><span class="page-category-item color2" role>Kotlin</span><span class="page-category-item color1" role>Spring</span><span class="page-category-item color8" role>Article(s)</span><!--]--><meta property="articleSection" content="Java,Kotlin,Spring,Article(s)"></span><span class="page-tag-info" aria-label="Tag🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8" role>blog</span><span class="page-tag-item color1" role>tech.kakaopay.com</span><span class="page-tag-item color8" role>java</span><span class="page-tag-item color2" role>jdk</span><span class="page-tag-item color8" role>spring</span><span class="page-tag-item color0" role>kotlin</span><span class="page-tag-item color2" role>uri</span><span class="page-tag-item color6" role>UriComponentsBuilder</span><span class="page-tag-item color0" role>알림피드</span><!--]--><meta property="keywords" content="blog,tech.kakaopay.com,java,jdk,spring,kotlin,uri,UriComponentsBuilder,알림피드"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="frontmatter-title-관련" tabindex="-1"><a class="header-anchor" href="#frontmatter-title-관련"><span>URL이 이상해요! Java와 Spring 중 범인은 누구? 관련</span></a></h1><a class="route-link vp-card" href="/bookshelf/programming/java-spring/articles/" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="https://chanhi2000.github.io/images/ico-wind.svg" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Spring > Article(s)</div><hr><div class="vp-card-desc">Article(s)</div></div></a><nav class="table-of-contents"><ul><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#시작하며" class="router-link-active router-link-exact-active">시작하며</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#기-무슨-일이-발생했는가" class="router-link-active router-link-exact-active">기: 무슨 일이 발생했는가</a><ul><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#정책을-반영하다" class="router-link-active router-link-exact-active">정책을 반영하다</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#장애가-발생하다" class="router-link-active router-link-exact-active">장애가 발생하다</a></li></ul></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#승-무엇이-문제였는가" class="router-link-active router-link-exact-active">승: 무엇이 문제였는가</a><ul><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#추가한-코드를-살펴보자" class="router-link-active router-link-exact-active">추가한 코드를 살펴보자</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#사라진-정보를-찾아보자" class="router-link-active router-link-exact-active">사라진 정보를 찾아보자</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#사라진-정보는-여기에" class="router-link-active router-link-exact-active">사라진 정보는 여기에</a></li></ul></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#쉬어가며" class="router-link-active router-link-exact-active">쉬어가며</a><ul><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#uri에-대해-알아보자" class="router-link-active router-link-exact-active">URI에 대해 알아보자</a></li></ul></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#전-누구의-문제인가" class="router-link-active router-link-exact-active">전: 누구의 문제인가</a><ul><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#java-net-uri-클래스를-들여다보다" class="router-link-active router-link-exact-active">java.net.URI 클래스를 들여다보다</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#rfc-문서를-찾아보다" class="router-link-active router-link-exact-active">RFC 문서를 찾아보다</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#uricomponentsbuilder-클래스를-들여다보다" class="router-link-active router-link-exact-active">UriComponentsBuilder 클래스를 들여다보다</a></li></ul></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#결-어떻게-해결할-수-있는가" class="router-link-active router-link-exact-active">결: 어떻게 해결할 수 있는가</a><ul><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#의문에-답을-내리다" class="router-link-active router-link-exact-active">의문에 답을 내리다</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#fromuristring-메서드를-사용하다" class="router-link-active router-link-exact-active">fromUriString 메서드를 사용하다</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#재발-방지에-기여하다" class="router-link-active router-link-exact-active">재발 방지에 기여하다.</a></li></ul></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#마치며" class="router-link-active router-link-exact-active">마치며</a></li><li><a aria-current="page" href="/bookshelf/tech.kakaopay.com/url-is-strange.html#참고-자료" class="router-link-active router-link-exact-active">참고 자료</a></li></ul></nav><hr><div class="vp-site-info" data-name="URL이 이상해요! Java와 Spring 중 범인은 누구?"><a class="vp-site-info-navigator no-external-link-icon" title="URL이 이상해요! Java와 Spring 중 범인은 누구?" href="https://tech.kakaopay.com/post/url-is-strange/" target="_blank"></a><div class="vp-site-info-preview" style="background:url(https://tech.kakaopay.com/_astro/thumb.ae533dc7_Z1gJ8gh.png) center/cover no-repeat;"></div><div class="vp-site-info-detail"><img class="vp-site-info-logo" src="https://tech.kakaopay.com/favicon.ico" alt loading="lazy" no-view><div class="vp-site-info-name">URL이 이상해요! Java와 Spring 중 범인은 누구?</div><div class="vp-site-info-desc">카카오페이 알림피드 서비스에서 발생한 장애 원인과 해결 과정을 공유합니다.</div></div><!----></div><div class="hint-container info"><p class="hint-container-title">요약</p><p>이 글은 카카오페이 알림피드 서비스에서 발생한 장애 원인과 해결 과정을 다룹니다. 알림피드의 랜딩 URL을 가공하는 중 발생한 문제를 분석하며, Java의 URI 클래스와 Spring의 <code>UriComponentsBuilder</code> 클래스 간의 불일치가 장애의 원인이었음을 설명합니다. 이를 해결하기 위해 <code>fromUriString</code> 메서드를 사용하여 문제를 해결하는 방법을 제안하며, 경험을 공유하는 글입니다.</p></div><div class="hint-container note"><p class="hint-container-title">💡 <strong>리뷰어 한줄평</strong></p><blockquote><p><strong>hyeoni.c</strong> 평소 잘 사용하던 라이브러리의 정책과 내부 구현을 살펴보며 문제를 해결해 가는 과정을 재밌게 풀어내었습니다. 유사한 경험을 가지신, 앞으로 마주할 수 있는 모든 분들에게 추천합니다!</p></blockquote><blockquote><p><strong>daisy.dani</strong> URI 정보가 왜 갑자기 사라졌을까요? 이 글에서 원인을 파헤치고, 어떻게 해결할 수 있는지 알아봅시다!</p></blockquote></div><hr><h2 id="시작하며" tabindex="-1"><a class="header-anchor" href="#시작하며"><span>시작하며</span></a></h2><p>Spring 프레임워크가 제공하는 <code>UriComponentsBuilder</code> 클래스를 아시나요? <code>UriComponentsBuilder</code> 클래스는 URL을 쉽게 다루기 위한 유틸 클래스입니다. 이번에 URL을 수정하기 위해 <code>UriComponentsBuilder</code> 클래스를 사용하던 중 서비스 장애가 발생했는데요. 원인을 분석해 보니 <code>java.net.URI</code> 클래스와 <code>UriComponentsBuilder</code> 클래스 사이에서 꽤나 흥미로운 일이 이뤄지고 있습니다. 무슨 일인지 궁금하지 않으신가요? 지금부터 함께 당시의 상황 속으로 들어가 보겠습니다.</p><p>안녕하세요. 채널서버유닛의 레인입니다. 채널서버유닛은 여러분이 카카오페이의 다양한 서비스와 혜택을 마주하고 탐색할 수 있도록 홈 탭, 혜택 탭, 결제 탭 등 다양한 전면 서비스를 개발하고 있습니다. 이러한 서비스에는 <strong>이 글의 배경이 되는 알림피드</strong>도 존재하는데요. 카카오페이 앱을 사용하신다면 아래 사진 속 공간, 알림피드가 익숙하실 겁니다.</p><figure><img src="https://tech.kakaopay.com/_astro/screen.063e0de1_2f5m8V.avif" alt="(좌) OS 알림 센터 / (우) 알림피드" tabindex="0" loading="lazy"><figcaption>(좌) OS 알림 센터 / (우) 알림피드</figcaption></figure><p><strong>알림피드는 여러분이 언제나 편하게 알림을 탐색하고 원하는 서비스를 방문할 수 있도록 노력하고 있습니다.</strong> 클릭하면 메시지가 사라지는 OS 알림 센터와 달리 메시지를 다시 볼 수 있도록 30일 동안 보관하고 있고요. 알림을 식별하기 편하도록 메시지에 서비스를 표시하거나, 원하는 종류의 알림을 탐색하기 편하도록 필터 등의 기능을 제공하고 있습니다.</p><hr><h2 id="기-무슨-일이-발생했는가" tabindex="-1"><a class="header-anchor" href="#기-무슨-일이-발생했는가"><span>기: 무슨 일이 발생했는가</span></a></h2><p>알림피드를 구성하는 데이터는 앱푸시로 발송하는 메시지에 기반하고 있습니다. 그래서 알림피드는 OS 알림 센터 환경에 맞춰진 데이터들을 목적에 맞게 가공해서 사용하고 있습니다. 이 과정에서 알림피드는 반복되는 키워드를 제거하는 등 문구를 가공하고 있는데요. <strong>어느 날 메시지의 랜딩 URL도 가공해야 하는 순간이 찾아왔습니다.</strong></p><h3 id="정책을-반영하다" tabindex="-1"><a class="header-anchor" href="#정책을-반영하다"><span>정책을 반영하다</span></a></h3><p>카카오페이 앱 정책이 변경되면서 <strong>OS 알림 센터와 알림피드에서 메시지의 랜딩 동작이 서로 달라야 했습니다.</strong> OS 알림 센터에서 앱푸시 메시지를 클릭한 경우는 카카오페이 앱이 열리고 특정 흐름을 거친 후 서비스로 랜딩 합니다. 하지만 알림피드에서 메시지를 클릭한 경우는 카카오페이 앱 내부에서의 동작이기 때문에 특정 흐름을 거치지 않아야 합니다.</p><p>정책을 반영하기 위해서는 <strong>메시지의 랜딩 URL에서 특정 파라미터를 제거하면 됩니다.</strong> 아래와 같이 OS 알림 센터에 맞춰진 메시지 랜딩 URL에서 base 파라미터를 제거하면 되는데요. 알림피드에 랜딩 URL을 가공하는 로직을 추가한 그날 문제가 발생했습니다.</p><ul><li>OS 알림 센터에서의 메시지 랜딩 URL: <code>kakaopay://payweb?base=home&amp;min_version=2.22.1</code></li><li>알림피드에서의 메시지 랜딩 URL: <code>kakaopay://payweb?min_version=2.22.1</code></li></ul><h3 id="장애가-발생하다" tabindex="-1"><a class="header-anchor" href="#장애가-발생하다"><span>장애가 발생하다</span></a></h3><p>알림피드에 URL 재처리 기능을 배포하고 몇 시간 후, 내부 크루 채널을 통해 <strong>알림피드가 이상하다는 제보를 받았습니다.</strong> 제보에 따르면 알림피드에서 특정 메시지의 랜딩이 제대로 동작하지 않고 있었습니다.</p><figure><img src="https://tech.kakaopay.com/_astro/landing_error.914c1172_e7ocx.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>해당 계정의 API 응답을 확인해 보니 <strong>메시지의 랜딩 URL이 이상했습니다.</strong> 이 현상은 특정 메시지에서만 발생했는데요. 처음에는 해당 메시지가 랜딩 URL이 잘못된 상태로 저장된 것은 아닐까 의심했습니다. 하지만 알림피드 DB를 살펴보니 데이터 상에는 문제가 없었습니다.</p><ul><li>API 응답 내 메시지의 랜딩 URL: <code>kakaopay:?min_version=2.22.1&amp;data=(생략)</code></li><li>DB에 저장된 메시지의 랜딩 URL: <code>kakaopay://payweb_tab?min_version=2.22.1&amp;data=(생략)</code></li><li>=&gt; API 응답에 담긴 메시지의 랜딩 URL의 경우 <strong><code>//payweb_tab</code> 정보가 사라졌습니다.</strong></li></ul><p>데이터 상에 문제가 없다는 것은 앞서 배포한 기능에 문제가 있음을 의미했습니다. 그래서 앞서 배포한 기능을 롤백했더니 다행히도 더 이상 문제가 발생하지 않았습니다.</p><hr><hr><h2 id="승-무엇이-문제였는가" tabindex="-1"><a class="header-anchor" href="#승-무엇이-문제였는가"><span>승: 무엇이 문제였는가</span></a></h2><p>배포한 기능에 문제가 있다는 점을 인지했을 때 몹시 당황스러웠습니다. QA도 진행하고 카나리 응답도 확인하는 등 여러 방면으로 검증을 진행했기 때문에 기능에 대한 확신이 있었습니다. 그래서 이 상황이 믿기지 않았는데요. 진정하고 원인을 분석하기 시작하자 놀라운 사실들이 보이기 시작했습니다.</p><h3 id="추가한-코드를-살펴보자" tabindex="-1"><a class="header-anchor" href="#추가한-코드를-살펴보자"><span>추가한 코드를 살펴보자</span></a></h3><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">private</span> <span class="token keyword">fun</span> String<span class="token punctuation">.</span><span class="token function">removeBaseParameter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> String <span class="token operator">=</span></span>
<span class="line">    UriComponentsBuilder<span class="token punctuation">.</span><span class="token function">fromUri</span><span class="token punctuation">(</span><span class="token function">URI</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">replaceQueryParam</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;base&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">toUriString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>위의 코드가 바로, 당시 <strong>추가한 코틀린 확장함수입니다.</strong> Spring 프레임워크가 제공하는 <code>UriComponentsBuilder</code> 클래스를 사용하여 URL 문자열에서 특정 파라미터를 제거하고 있습니다. 여러분은 이 코드에서 문제점이 무엇인지 보이시나요?</p><p>이 확장함수는 컴파일도 잘 되고 특정 파라미터를 제거하는 동작도 잘 수행합니다. 그래서 QA를 비롯한 여러 검증도 문제없이 통과했습니다. 하지만 앞서 장애 상황에서 보았듯 <strong>특정 URL이 주어지면 이상하게 동작하고 있습니다.</strong></p><p>당시의 상황을 테스트 코드로 작성해 보겠습니다.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token annotation builtin">@Test</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 당시 문제가 발생하지 않았던 케이스</span></span>
<span class="line">    <span class="token keyword">val</span> <span class="token keyword">actual</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;kakaopay://payweb?base=home&amp;min_version=2.22.1&quot;</span></span><span class="token punctuation">.</span><span class="token function">removeBaseParameter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">val</span> expected <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;kakaopay://payweb?min_version=2.22.1&quot;</span></span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">actual</span> shouldBe expected</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation builtin">@Test</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 당시 문제가 발생했던 케이스</span></span>
<span class="line">    <span class="token keyword">val</span> <span class="token keyword">actual</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;kakaopay://payweb_tab?base=home&amp;min_version=2.22.1&quot;</span></span><span class="token punctuation">.</span><span class="token function">removeBaseParameter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">val</span> expected <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;kakaopay://payweb_tab?min_version=2.22.1&quot;</span></span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">actual</span> shouldBe expected</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://tech.kakaopay.com/_astro/test_result.1eb9bdd2_Z4mrQ6.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>위에서 테스트를 통과하지 못한 URL이 바로 당시 문제를 일으킨 URL입니다. 이 URL의 테스트 실행 결과를 보면, 특정 파라미터뿐만 아니라 <strong>URL의 주요 요소까지 제거된 것을 볼 수 있습니다.</strong> <code>payweb_tab</code> 정보는 어디로 사라진 걸까요?</p><h3 id="사라진-정보를-찾아보자" tabindex="-1"><a class="header-anchor" href="#사라진-정보를-찾아보자"><span>사라진 정보를 찾아보자</span></a></h3><p>앞서 비교한 두 문자열에 대해 <code>UriComponentsBuilder#fromUri</code> 정적 팩토리 메서드의 반환 값을 확인해 보겠습니다.</p><figure><img src="https://tech.kakaopay.com/_astro/fromUri_host_exists.b2b3ad76_Z26H84S.avif" alt="정상 케이스" tabindex="0" loading="lazy"><figcaption>정상 케이스</figcaption></figure><figure><img src="https://tech.kakaopay.com/_astro/fromUri_host_null.f01247c2_1hFhYI.avif" alt="비정상 케이스" tabindex="0" loading="lazy"><figcaption>비정상 케이스</figcaption></figure><p>정상 케이스와 달리 비정상 케이스의 <code>host</code> 변수가 비어 있습니다. 정상 케이스의 <code>host</code> 변수에 <code>payweb</code>이 저장된 것을 보면, 비정상 케이스의 <code>host</code> 변수에는 동일한 위치의 <code>payweb_tab</code>이 저장되어야 할 것 같은데요. 어째서 <code>host</code> 변수에 <code>payweb_tab</code> 정보가 담기지 못한 걸까요?</p><p><code>UriComponentsBuilder#fromUri</code> 메서드에서 <code>host</code> 변수에 무엇을 저장하는지 확인해 보겠습니다.</p><figure><img src="https://tech.kakaopay.com/_astro/UriComponentsBuilder_fromUri.4e8d9e9d_1PQ0wU.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://tech.kakaopay.com/_astro/UriComponentsBuilder_uri.b22745bb_ZR0Aj3.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><code>UriComponentsBuilder#fromUri</code>에서 호출하는 <code>UriComponentsBuilder#uri</code>를 따라가 보면 <code>host</code> 변수에 무엇이 저장되는지 볼 수 있습니다. 인자로 전달된 <code>URI</code> 인스턴스의 <code>host</code> 변수를 넘겨받아 저장하고 있네요. 그렇다면 <code>UriComponentsBuilder</code> 인스턴스의 <code>host</code> 변수와 마찬가지로 <code>URI</code> 인스턴스의 <code>host</code> 변수도 비어 있을까요?</p><p>이어서 인자로 전달된 <code>URI</code> 인스턴스도 확인해 보겠습니다.</p><figure><img src="https://tech.kakaopay.com/_astro/URI_host_exists.3261570c_1UH0Qp.avif" alt="정상 케이스" tabindex="0" loading="lazy"><figcaption>정상 케이스</figcaption></figure><figure><img src="https://tech.kakaopay.com/_astro/URI_host_null.eb4f9b78_Z2uQCIt.avif" alt="비정상 케이스" tabindex="0" loading="lazy"><figcaption>비정상 케이스</figcaption></figure><p>정상 케이스와 달리 비정상 케이스의 host 변수가 비어 있네요. 결국 <strong><code>UriComponentsBuilder</code> 인스턴스가 잘못된 URL을 만들어낸 것은 URI 인스턴스의 host 변수가 비어 있었기 때문이었습니다.</strong> <code>payweb_tab</code> 정보는 어디로 사라진 걸까요? URI 인스턴스가 <code>payweb_tab</code> 정보를 저장하지 않은 걸까요?</p><h3 id="사라진-정보는-여기에" tabindex="-1"><a class="header-anchor" href="#사라진-정보는-여기에"><span>사라진 정보는 여기에</span></a></h3><p>사실 <strong>URI 인스턴스는 <code>payweb_tab</code> 정보를 버리지 않았습니다.</strong> 비정상 케이스의 URI 인스턴스에 대해 toString 메서드를 호출해 보면 아래와 같이 <code>payweb_tab</code> 정보가 포함된 URL이 반환되는 것을 볼 수 있습니다.</p><figure><img src="https://tech.kakaopay.com/_astro/URI_host_null_toString.d118cf92_Z74Q2I.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>그리고 비정상 케이스의 URI 인스턴스 변수를 다시 확인해 보면 <strong><code>authority</code> 변수에 값을 저장하고 있는 것도 볼 수 있습니다.</strong></p><figure><img src="https://tech.kakaopay.com/_astro/URI_host_null_authority.a7e39746_Z1lUgWV.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>즉 우리가 찾아 헤매던 <code>payweb_tab</code> 정보는 URI 인스턴스에 있었습니다. <strong>단지 <code>host</code> 변수가 아닌 <code>authority</code> 변수에만 저장하고 있을 뿐입니다.</strong></p><p>사라진 정보의 행방은 찾았지만 여전히 문제의 발생 원인은 오리무중입니다. 왜 URI 인스턴스의 host 변수는 비어있고, 왜 UriComponentsBuilder 인스턴스는 authority 변수를 바라보지 않은 걸까요? 잠시 URI에 대해 알아본 후, 이들의 동작 구조를 확인해 보며 답을 찾아보겠습니다.</p><hr><h2 id="쉬어가며" tabindex="-1"><a class="header-anchor" href="#쉬어가며"><span>쉬어가며</span></a></h2><p>이후의 내용을 이해하기 위해서는 URI에 대해 알아볼 필요가 있습니다. 여러분은 URI에 대해 알고 계신가요? 흔히 사용하는 URL과는 달리 URI는 생소할 수 있는데요. 잠시 URI에 대해 알아보겠습니다.</p><h3 id="uri에-대해-알아보자" tabindex="-1"><a class="header-anchor" href="#uri에-대해-알아보자"><span>URI에 대해 알아보자</span></a></h3><p>RFC 1630<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup>에 따르면 URI(Uniform Resource Identifier)는 인터넷 자원의 고유 식별자를 의미합니다. 그에 반해 우리에게 익숙한 URL(Uniform Resource Locator)은 URI의 하위 개념으로, 인터넷 자원의 위치를 의미합니다.</p><p>대부분의 경우는 위치만으로 자원을 식별할 수 있기 때문에 URI와 URL이 동일합니다. 하지만 게시글의 특정 섹션을 가리킬 때처럼 위치만으로 자원을 식별할 수 없을 때는 URI와 URL이 다른 형태를 띠곤 합니다.</p><ul><li>URI: <strong><a href="https://tech.kakaopay.com/post/r2dbc-connection-pool-missing#%EC%BB%A4%EB%84%A5%EC%85%98-%ED%92%80%EC%97%90-%EA%B8%B0%EB%8C%80%ED%95%98%EB%8A%94-%EB%8F%99%EC%9E%91" target="_blank" rel="noopener noreferrer">https://tech.kakaopay.com/post/r2dbc-connection-pool-missing#커넥션-풀에-기대하는-동작</a></strong></li><li>URL: <strong><a href="https://tech.kakaopay.com/post/r2dbc-connection-pool-missing" target="_blank" rel="noopener noreferrer">https://tech.kakaopay.com/post/r2dbc-connection-pool-missing</a></strong></li></ul><p>URI를 구성하는 요소를 간단히 표현하면 다음과 같습니다.</p><figure><img src="https://tech.kakaopay.com/_astro/URI_hierarchical_part.1d224dc1_2f3LhN.avif" alt="출처: &lt;VPIcon icon=&quot;fas fa-globe&quot;/&gt;novaworkssoftware.com" tabindex="0" loading="lazy"><figcaption>출처: <a href="https://novaworkssoftware.com/blog/archives/218-LDC-72-Get-Crackn-Working-with-URIs.html" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>novaworkssoftware.com</a></figcaption></figure><p>익숙한 단어가 보이지 않으신가요? 앞서 봐왔던 <strong><code>host</code>와 <code>authority</code>는 URI의 주요 요소입니다.</strong> host는 인터넷상에서 식별 가능한 주소(도메인 주소, IP 주소)를 의미합니다. 그리고 authority는 주소와 사용자 정보 등이 결합된 접근 권한을 의미합니다.</p><p><code>ftc://rain-drop:password** **@kakaopay.com/data.txt</code>을 예로 들어볼게요. 여기서 <code>authority</code>는 접근 권한으로 <code>rain-drop:password@kakaopay.com</code>을 가리키고, host는 식별 가능한 주소 “kakaopay.com”를 가리킵니다.</p><p>그렇다면 장애가 발생한 메시지의 <code>kakaopay://payweb_tab?min_version=2.22.1</code>은 어떨까요? <code>authority</code>의 구성 요소 중 사용자 정보와 port 정보는 생략 가능하기 때문에, 여기서 <code>authority</code>와 <code>host</code>는 모두 <code>payweb_tab</code>을 가리킵니다.</p><p><code>authority</code>와 <code>host</code>의 관계를 기억해 주세요. 다른 구성요소는 이 글에서 중요하지 않기에 다루지 않겠습니다.</p><hr><h2 id="전-누구의-문제인가" tabindex="-1"><a class="header-anchor" href="#전-누구의-문제인가"><span>전: 누구의 문제인가</span></a></h2><p>앞서 우리는 사라진 정보의 행방을 찾으며 Java 표준 라이브러리가 제공하는 <code>java.net.URI</code> 클래스와 Spring 프레임워크가 제공하는 <code>UriComponentsBuilder</code> 클래스 사이에서 <strong>불협화음을 확인했습니다.</strong> URI 인스턴스가 저장하고 있는 정보가 <code>UriComponentsBuilder</code> 인스턴스로 전달되지 못한 이 상황을 어떻게 바라봐야 할까요? 아래의 의문점을 하나씩 들여다보며 나아가 보겠습니다.</p><ul><li>왜 URI 인스턴스는 <code>host</code> 변수를 비워두는가?</li><li>왜 <code>UriComponentsBuilder</code> 인스턴스는 <code>authority</code> 변수를 바라보지 않는가?</li></ul><h3 id="java-net-uri-클래스를-들여다보다" tabindex="-1"><a class="header-anchor" href="#java-net-uri-클래스를-들여다보다"><span><code>java.net.URI</code> 클래스를 들여다보다</span></a></h3><p><code>java.net.URI</code> 클래스가 host 변수를 어떻게 저장하고 있는지 확인하기 위해 생성자를 들여다보겠습니다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">public</span> <span class="token function">URI</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">URISyntaxException</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">Parser</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><code>URI.Parser</code>#parse</li><li><code>URI.Parser</code>#parseHierarchical</li><li><code>URI.Parser</code>#parseAuthority</li><li><code>URI.Parser</code>#parseServer</li><li><code>URI.Parser</code>#parseHostname</li><li>...</li></ol><p>URI 클래스의 생성자를 들여다보면 <code>Parser#parse</code> 메서드를 호출하는 모습이 보입니다. <code>Parser#parse</code> 메서드를 따라 들어가 보면 위의 흐름도를 완성할 수 있는데요. 여기서 <code>parseHostname</code> 메서드가 바로 host 영역의 구문 분석을 담당하는 메서드입니다.</p><p>다음은 <code>parseHostname</code> 메서드의 내용입니다.</p><figure><img src="https://tech.kakaopay.com/_astro/URI_parseHostname.adc23c2c_2qK3uY.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><code>parseHostname</code> 메서드의 주석에는 host 영역의 구성 규칙이 적혀있습니다. 이 주석은 host 영역이 영문자와 숫자, 그리고 <code>-</code> 문자로 구성될 수 있다고 말하고 있습니다. 그런데 뭔가 이상하지 않나요?</p><p><code>kakaopay://payweb_tab?min_version=2.22.1</code> URL을 떠올려 보겠습니다. 이 URL의 <code>payweb_tab</code>은 <code>-</code> 문자가 아닌 <code>_</code> 문자를 포함하고 있습니다. <code>parseHostname</code>가 따르는 <strong><code>host</code> 영역의 구성 규칙을 어기고 있는 것인데요.</strong> 결국 <code>parseHostname</code> 메서드는 <code>payweb_tab</code>을 host 변수에 저장하지 않습니다.</p><p><code>kakaopay://payweb_tab?min_version=2.22.1</code> URL이 규칙을 위배하고 있다니, 대체 어떻게 된 일일까요? 애당초 이 문제의 시작은 규칙에 어긋난 URL을 만들어 사용했기 때문이었을까요? URI 문법에 대해 조사해 봤습니다.</p><h3 id="rfc-문서를-찾아보다" tabindex="-1"><a class="header-anchor" href="#rfc-문서를-찾아보다"><span>RFC 문서를 찾아보다</span></a></h3><p><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/net/URI.html" target="_blank" rel="noopener noreferrer">Java Docs</a>를 보면 아래와 설명에서 <code>java.net.URI</code> 클래스가 따르는 RFC 문서를 알 수 있습니다. RFC 2396<sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup>은 URI의 문법을 처음 정의한 문서입니다. 이 문서는 URI의 구성요소가 어떠한 규칙을 가져야 하는지 정의하고 있습니다.</p><div class="hint-container info"><p class="hint-container-title">RFC 2396</p><p>Represents a Uniform Resource Identifier (URI) reference. Aside from some minor deviations noted below, an instance of this class represents a URI reference as defined by <a href="https://ietf.org/rfc/rfc2396.txt" target="_blank" rel="noopener noreferrer">RFC 2396: Uniform Resource Identifiers (URI): Generic Syntax</a>, amended by <a href="https://ietf.org/rfc/rfc2732.txt" target="_blank" rel="noopener noreferrer">RFC 2732: Format for Literal IPv6 Addresses in URLs</a>.</p></div><p>이 문서의 [RFC 2396. Section 3.2.2]에는 아래와 같이 host 영역의 규칙이 적혀 있습니다. 하지만 앞서 <code>parseHostname</code> 메서드의 주석에서 본 것처럼 <code>_</code> 문자는 찾아볼 수 없습니다.</p><div class="hint-container info"><p class="hint-container-title">RFC 2396</p><p>Hostnames take the form described in Section 3 of [RFC1034] and Section 2.1 of [RFC1123]: a sequence of domain labels separated by ”.”, each domain label starting and ending with an <strong>alphanumeric character and possibly also containing ”-” characters</strong>.</p></div><p>위 내용에 따르면 결국 <code>kakaopay://payweb_tab?min_version=2.22.1</code>은 RFC 2396을 위배하고 있습니다. 그렇다면 <code>kakaopay://payweb_tab?min_version=2.22.1</code>은 정말 잘못된 URL일까요? 흥미롭게도 URI 문법에 대한 RFC 문서는 하나가 더 존재합니다.</p><p>URI 클래스가 따르는 RFC 2396은 1998년에 작성된 문서입니다. 이때 URI 참조 문법이 처음 정의됐는데요. 시간이 흘러 2005년에 RFC 3986<sup class="footnote-ref"><a href="#footnote3">[3]</a><a class="footnote-anchor" id="footnote-ref3"></a></sup>이 등장했습니다. <strong>오늘날 표준이 된 RFC 3986은 RFC 2396을 대체하여 URI 문법을 재정의</strong>하고 있으며, 이와 관련된 내용을 [RFC 3986. Introduction]에서 찾아볼 수 있습니다.</p><div class="hint-container info"><p class="hint-container-title">RFC 3986</p><p>This document obsoletes [RFC2396], which merged “Uniform Resource Locators” [RFC1738] and “Relative Uniform Resource Locators” [RFC1808] in order to define a single, generic syntax for all URIs.</p></div><p>RFC 3986은 RFC 2396에서 어떤 부분이 바뀌었을까요? 문서를 살펴보면 아래의 문구를 확인할 수 있습니다.</p><div class="hint-container info"><p class="hint-container-title">RFC 3986</p><p>The server, hostport, hostname, domainlabel, toplabel, and alphanum rules have been removed.</p></div><p><strong>RFC 3986은 더 이상 RFC 2396에 정의된 여러 규칙을 따르지 않습니다.</strong> 제약을 없애는 방향을 택했고, RFC 2396과 달리 Hostname으로 <code>_</code> 문자를 허용하고 있습니다.</p><p>즉 <code>kakaopay://payweb_tab?min_version=2.22.1</code> URL은 RFC 3986에 따라 규칙을 지키고 있었습니다. 오히려 URI 클래스가 지금은 폐지된 옛 문법을 따르며 <code>payweb_tab</code>을 host로 인지하지 못하고 있었습니다. 그렇다면 <code>UriComponentsBuilder</code> 클래스는 어떨까요?</p><h3 id="uricomponentsbuilder-클래스를-들여다보다" tabindex="-1"><a class="header-anchor" href="#uricomponentsbuilder-클래스를-들여다보다"><span><code>UriComponentsBuilder</code> 클래스를 들여다보다</span></a></h3><p><code>UriComponentsBuilder</code> 클래스는 RFC 3986을 따르고 있습니다. 이 내용은 코드에서 확인할 수 있고, 아래의 [RFC 3986. appendix B]에 나온 정규식에 따라 URI를 파싱한다는 점도 확인할 수 있습니다.</p><div class="hint-container info"><p class="hint-container-title">RFC 3986</p><p>The following line is the regular expression for breaking-down a well-formed URI reference into its components.- <code>^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?</code></p><figure><img src="https://tech.kakaopay.com/_astro/UriComponentsBuilder_code.547aa00e_1LuMMN.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></div><p>그렇다면 <code>UriComponentsBuilder</code>는 왜 <code>java.net.URI</code>의 <code>authority</code> 변수를 바라보지 않았을까요? URI 인스턴스의 <code>host</code> 변수가 비어 있다면 <code>authority</code> 변수를 바라봤으면 좋았을 텐데요. 아쉽게도 <code>UriComponentsBuilder</code> 클래스, 그리고 이 클래스가 생성하는 <code>UriComponents</code> 클래스는 <strong><code>authority</code>를 관리하지 않고 있습니다.</strong></p><p>아래 <code>UriComponents</code>의 <code>getter</code> 메서드 목록을 보시면 이들이 다루는 URI의 구성요소를 볼 수 있습니다.</p><figure><img src="https://tech.kakaopay.com/_astro/UriComponents_methods.fcb8172c_1qTL9R.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><code>authority</code>의 요소인 <code>userinfo</code>, <code>host</code>, <code>port</code> 등은 보이지만 <code>authority</code> 자체는 보이지 않습니다. 즉 <code>UriComponentsBuilder</code>는 <code>authority</code>를 다루지 않기 때문에 <code>java.net.URI</code>의 <code>authority</code> 변수를 바라보지 않았고, 이로 인해 정보의 누락이 발생한 것입니다.</p><hr><h2 id="결-어떻게-해결할-수-있는가" tabindex="-1"><a class="header-anchor" href="#결-어떻게-해결할-수-있는가"><span>결: 어떻게 해결할 수 있는가</span></a></h2><h3 id="의문에-답을-내리다" tabindex="-1"><a class="header-anchor" href="#의문에-답을-내리다"><span>의문에 답을 내리다</span></a></h3><p>우리는 이 장애가 왜 발생했는지 드디어 해답을 찾았습니다. 이제는 의문에 대해 하나씩 답을 적어보며 정리해 보겠습니다.</p><div class="hint-container note"><p class="hint-container-title">Question. 왜 <code>URI</code> 인스턴스는 <code>host</code> 변수를 비워두는가?</p><p><code>java.net.URI</code> 클래스는 RFC 2396을 따르고 있습니다. RFC 2396에 의하면 host는 영문자, 숫자, <code>-</code> 문자로 구성되어야 합니다. 그래서 <code>java.net.URI</code> 클래스는 규칙에 어긋난 <code>payweb_tab</code>을 host에 저장하지 않았습니다.</p></div><div class="hint-container note"><p class="hint-container-title">Question. RFC 2396을 위배한다면 처음부터 URL이 잘못된 것 아닌가?</p><p>URL이 잘못된 것은 아닙니다. 오늘날 표준이 된 RFC 3986에서는 <code>host</code>의 규칙 제한을 해제했기 때문에 <code>payweb_tab</code>은 <code>host</code>가 맞습니다. 단지 <code>java.net.URI</code>가 폐지된 RFC 2396을 따르고 있기에 발생한 문제입니다.</p></div><div class="hint-container note"><p class="hint-container-title">Question. 왜 <code>UriComponentsBuilder</code> 인스턴스는 <code>authority</code> 변수를 바라보지 않는가?</p><p><code>UriComponentsBuilder</code> 클래스는 <code>userinfo</code>, <code>host</code>, <code>port</code> 등의 구성요소는 관리하지만 <code>authority</code>를 다루지는 않습니다. 때문에 <code>UriComponentsBuilder#fromUri</code> 메서드는 인자로 전달된 <code>URI</code> 인스턴스로부터 <code>authority</code> 변수를 바라보지 않은 것입니다.</p></div><div class="hint-container note"><p class="hint-container-title">Question. 누구의 잘못인가?</p><p>함부로 말하기 어렵지만, 개인적인 생각으로는 <code>UriComponentsBuilder#fromUri</code>의 문제라고 생각합니다. <code>java.net.URI</code>는 폐지된 RFC 2396을 따를 뿐 <code>URI</code> 파싱에 문제가 없습니다. 정보를 누락하지 않고 <code>authority</code>에 저장하고 있기도 합니다. 하지만 <code>UriComponentsBuilder</code>의 경우, <code>authority</code>를 관리하지 않고 있습니다. <code>URI</code> 인스턴스의 <code>host</code>만을 바라보고 있던 부분, 바로 이것이 문제의 원인이라고 생각합니다.</p></div><h3 id="fromuristring-메서드를-사용하다" tabindex="-1"><a class="header-anchor" href="#fromuristring-메서드를-사용하다"><span><code>fromUriString</code> 메서드를 사용하다</span></a></h3><p>문제 발생 원인을 찾았으니, 이제 해결책을 알아보겠습니다. 재밌게도 <code>UriComponentsBuilder#fromUri</code>의 대안은 <code>UriComponentsBuilder</code> 클래스 안에 있습니다. <code>UriComponentsBuilder</code> 클래스는 <strong><code>fromUriString</code> 메서드를 제공</strong>하고 있는데요.</p><p>이 메서드를 들여다보면, 정규식에 기반하여 URI를 파싱하고 있음을 볼 수 있습니다. [RFC 3986. appendix B]에 나온 정규식에 따라 host 등의 구성요소를 파싱하기 때문에 <code>java.net.URI</code>와 달리 정보를 누락하지 않습니다.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UriComponentsBuilder</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">SCHEME_PATTERN</span> <span class="token operator">=</span> <span class="token string">&quot;([^:/?#]+):&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">USERINFO_PATTERN</span> <span class="token operator">=</span> <span class="token string">&quot;([^@/]*)&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">HOST_PATTERN</span> <span class="token operator">=</span> <span class="token string">&quot;([^/?#:]*)&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">PORT_PATTERN</span> <span class="token operator">=</span> <span class="token string">&quot;(\\d*)&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">PATH_PATTERN</span> <span class="token operator">=</span> <span class="token string">&quot;([^?#]*)&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">QUERY_PATTERN</span> <span class="token operator">=</span> <span class="token string">&quot;([^#]*)&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">LAST_PATTERN</span> <span class="token operator">=</span> <span class="token string">&quot;(.*)&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// Regex patterns that matches URIs. See RFC 3986, appendix B</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Pattern</span> <span class="token constant">URI_PATTERN</span> <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span></span>
<span class="line">      <span class="token string">&quot;^(&quot;</span> <span class="token operator">+</span> <span class="token constant">SCHEME_PATTERN</span> <span class="token operator">+</span> <span class="token string">&quot;)?&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;(//(&quot;</span> <span class="token operator">+</span> <span class="token constant">USERINFO_PATTERN</span> <span class="token operator">+</span> <span class="token string">&quot;@)?&quot;</span> <span class="token operator">+</span> <span class="token constant">HOST_PATTERN</span> <span class="token operator">+</span> <span class="token string">&quot;(:&quot;</span> <span class="token operator">+</span> <span class="token constant">PORT_PATTERN</span> <span class="token operator">+</span></span>
<span class="line">          <span class="token string">&quot;)?&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;)?&quot;</span> <span class="token operator">+</span> <span class="token constant">PATH_PATTERN</span> <span class="token operator">+</span> <span class="token string">&quot;(\\?&quot;</span> <span class="token operator">+</span> <span class="token constant">QUERY_PATTERN</span> <span class="token operator">+</span> <span class="token string">&quot;)?&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;(#&quot;</span> <span class="token operator">+</span> <span class="token constant">LAST_PATTERN</span> <span class="token operator">+</span> <span class="token string">&quot;)?&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">UriComponentsBuilder</span> <span class="token function">fromUriString</span><span class="token punctuation">(</span><span class="token class-name">String</span> uri<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> <span class="token string">&quot;&#39;uri&#39; must not be empty&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">Matcher</span> m <span class="token operator">=</span> <span class="token constant">URI_PATTERN</span><span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token class-name">UriComponentsBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UriComponentsBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">      builder<span class="token punctuation">.</span><span class="token function">scheme</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      builder<span class="token punctuation">.</span><span class="token function">userInfo</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      builder<span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token class-name">String</span> port <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasLength</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        builder<span class="token punctuation">.</span><span class="token function">port</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">      builder<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      builder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      builder<span class="token punctuation">.</span><span class="token function">fragment</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">      <span class="token keyword">return</span> builder<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;[&quot;</span> <span class="token operator">+</span> uri <span class="token operator">+</span> <span class="token string">&quot;] is not a valid URI&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>장애 당시 추가했던 확장함수에 대해 <code>fromUriString</code> 메서드를 사용토록 수정하고 테스트 코드를 실행해 봤습니다. <code>fromUri</code> 메서드를 사용했던 이전과 달리, 모든 테스트가 통과하는 것을 볼 수 있습니다.</p><div class="language-kotlin line-numbers-mode" data-highlighter="prismjs" data-ext="kt"><pre><code class="language-kotlin"><span class="line"><span class="token keyword">private</span> <span class="token keyword">fun</span> String<span class="token punctuation">.</span><span class="token function">removeBaseParameter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> String <span class="token operator">=</span></span>
<span class="line">    UriComponentsBuilder<span class="token punctuation">.</span><span class="token function">fromUriString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// 수정 (fromUri -&gt; fromUriString)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">replaceQueryParam</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;base&quot;</span></span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">toUriString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation builtin">@Test</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">val</span> <span class="token keyword">actual</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;kakaopay://payweb?base=home&amp;min_version=2.22.1&quot;</span></span><span class="token punctuation">.</span><span class="token function">removeBaseParameter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">val</span> expected <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;kakaopay://payweb?min_version=2.22.1&quot;</span></span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">actual</span> shouldBe expected</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token annotation builtin">@Test</span></span>
<span class="line"><span class="token keyword">fun</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">val</span> <span class="token keyword">actual</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;kakaopay://payweb_tab?base=home&amp;min_version=2.22.1&quot;</span></span><span class="token punctuation">.</span><span class="token function">removeBaseParameter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">val</span> expected <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;kakaopay://payweb_tab?min_version=2.22.1&quot;</span></span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">actual</span> shouldBe expected</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://tech.kakaopay.com/_astro/test_success.76960382_2jxcf2.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="재발-방지에-기여하다" tabindex="-1"><a class="header-anchor" href="#재발-방지에-기여하다"><span>재발 방지에 기여하다.</span></a></h3><p>원인을 분석하고 문제를 해결한 다음, 항상 마지막에는 재발 방지를 고민하고 있습니다. 지금껏 장애는 주로 개발이나 기획의 실수로 발생했습니다. 그래서 테스트 코드를 보충하거나 QA에 검증 케이스를 추가하는 방향으로 재발 방지를 해왔는데요. 이번에 발생한 장애 상황은 좀 달랐습니다.</p><p><code>UriComponentsBuilder#fromUri</code> 메서드에 이런 문제점이 있다는 사실을 과연 얼마나 많은 개발자들이 알고 있을까요? 내부 구현을 들여다보지 않았다면 이 사실을 모를 겁니다. 우리도 내부 구현을 들여다본 후에야 <code>java.net.URI</code> 클래스와 <code>UriComponentsBuilder</code> 클래스 사이의 정보 누락을 알았으니까요. 이렇듯 이번 장애는 개발자의 실수가 아니라 라이브러리의 내부 구현에 의해 발생했다는 점에서 평상시의 장애 상황과 달랐습니다.</p><p>그래서 이 내용을 사내 채널에 공유했습니다. 카카오페이가 보다 안전한 서비스를 제공할 수 있도록, 많은 크루들이 이 문제점을 인지하고 <code>UriComponentsBuilder</code> 클래스를 사용할 때 주의하기를 바랐습니다. 이 내용은 감사하게도 많은 분들의 관심을 받았습니다. 그리고 위험성에 공감하신 크루들의 추천으로 카카오페이 전사 소나큐브에 커스텀 룰으로 등록될 수 있었습니다.</p><figure><img src="https://tech.kakaopay.com/_astro/sonar.16182527_1HWJ68.avif" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><hr><h2 id="마치며" tabindex="-1"><a class="header-anchor" href="#마치며"><span>마치며</span></a></h2><p>지금까지 알림피드 서비스에서 발생한 장애 상황에 대해 원인과 대안을 살펴봤습니다. <code>java.net.URI</code> 클래스와 <code>UriComponentsBuilder</code> 클래스의 관계에 대해 들여다볼 수 있어서 뜻깊은 시간이었는데요. 여러분은 어떠셨나요?</p><p>저는 새로운 사실을 알게 되어 흥미로운 시간이기도 했지만 아쉬움이 많이 남는 시간이기도 했습니다. 사실 기능을 구현할 당시 <code>fromUriString</code> 메서드의 존재를 알고 있었습니다. 다만 <code>fromUriString</code> 메서드와 <code>fromUri</code> 메서드가 인자 타입을 다양히 받기 위해 존재한다고 생각했습니다. 이런 단순한 생각 때문에 내부 동작을 모름에도 <code>fromUri</code> 메서드를 선택했는데요. <code>String</code> 문자열을 그대로 인자로 넘기는 것보단 <strong><code>URI</code> 클래스로 한 번 감싸서 전달하는 것이 구문 분석에 있어서 안전할 것이라고 판단했습니다.</strong> 하지만 제 의도와 달리 내부 동작은 그렇지 않았고, 그로 인해 장애가 발생했습니다.</p><p>다시 그때로 되돌아간다면 이 문제를 막을 수 있었을까요? 확신하기 어렵지만, 그래도 현재와 미래는 다릅니다. 이번 경험에서 많은 것을 학습하고 생각할 수 있었습니다. <code>java.net.URI</code> 클래스와 <code>UriComponentsBuilder</code> 클래스의 관계에 대한 사실도 알 수 있었고, 평소 당연하듯이 사용해 오던 라이브러리에 대해 조심스러운 태도를 가질 수 있었습니다. 여러분은 어떠셨나요? 제가 경험한 이 내용이 여러분께도 도움 되었으면 좋겠습니다.</p><p>지금까지 긴 시간 읽어주셔서 감사합니다.</p><hr><h2 id="참고-자료" tabindex="-1"><a class="header-anchor" href="#참고-자료"><span>참고 자료</span></a></h2><!-- TODO: add ARTICLE CARD --><a class="vp-card" href="https://chanhi2000.github.io/bookshelf/tech.kakaopay.com/url-is-strange.html" target="_blank" style="background:rgba(255,84,15,0.2);"><img class="vp-card-logo" src="https://tech.kakaopay.com/favicon.ico" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">URL이 이상해요! Java와 Spring 중 범인은 누구?</div><hr><div class="vp-card-desc">카카오페이 알림피드 서비스에서 발생한 장애 원인과 해결 과정을 공유합니다.</div></div></a><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p><a href="https://ietf.org/rfc/rfc1630.txt" target="_blank" rel="noopener noreferrer">RFC 1630: Universal Resource Identifiers in WWW</a> <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li><li id="footnote2" class="footnote-item"><p><a href="https://ietf.org/rfc/rfc2396.txt" target="_blank" rel="noopener noreferrer">RFC 2396: Uniform Resource Identifiers (URI): Generic Syntax</a> <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li><li id="footnote3" class="footnote-item"><p><a href="https://ietf.org/rfc/rfc3986.txt" target="_blank" rel="noopener noreferrer">RFC 3986: Uniform Resource Identifier (URI): Generic Syntax</a> <a href="#footnote-ref3" class="footnote-backref">↩︎</a></p></li></ol></section></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/chanhi2000/articles/edit/main/src/tech.kakaopay.com/url-is-strange.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/bookshelf/articles/" aria-label="/articles/"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->/articles/</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">MIT Licensed | Copyright © 2022-present <a href="https://github.com/chanhi2000">Chan Hee Lee</a></div><div class="vp-copyright">Copyright © 2025 rain.drop </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/bookshelf/assets/app-BVguHYKu.js" defer></script>
  </body>
</html>
