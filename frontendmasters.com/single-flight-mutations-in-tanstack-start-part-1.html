<!doctype html>
<html lang="en-US" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.99" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Single Flight Mutations in TanStack Start: Part 1","image":["https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img1.png?ssl=1","https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img2.png?ssl=1","https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img3.png?resize=1024%2C922&ssl=1","https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img4.png?ssl=1","https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img5.png?resize=830%2C1024&ssl=1","https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img6.png?resize=792%2C1024&ssl=1","https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img7.png?resize=1024%2C150&ssl=1"],"datePublished":"2026-01-23T00:00:00.000Z","dateModified":null,"author":[{"@type":"Person","name":"Adam Rackis","url":"https://frontendmasters.com/blog/author/adamrackis/"}]}</script><meta property="og:url" content="https://chanhi2000.github.io/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html"><meta property="og:site_name" content="üìöBookshelf"><meta property="og:title" content="Single Flight Mutations in TanStack Start: Part 1"><meta property="og:description" content="Article(s) > Single Flight Mutations in TanStack Start: Part 1"><meta property="og:type" content="article"><meta property="og:image" content="https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/8334"><meta property="og:locale" content="en-US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:src" content="https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/8334"><meta name="twitter:image:alt" content="Single Flight Mutations in TanStack Start: Part 1"><meta property="article:author" content="Adam Rackis"><meta property="article:tag" content="react-js"><meta property="article:tag" content="reactjs"><meta property="article:tag" content="react"><meta property="article:tag" content="node-js"><meta property="article:tag" content="nodejs"><meta property="article:tag" content="node"><meta property="article:tag" content="frontendmasters.com"><meta property="article:tag" content="blog"><meta property="article:published_time" content="2026-01-23T00:00:00.000Z"><link rel="icon" href="/bookshelf/assets/icon/favicon.svg"><title>Single Flight Mutations in TanStack Start: Part 1 | üìöBookshelf</title><meta name="description" content="Article(s) > Single Flight Mutations in TanStack Start: Part 1">
    <link rel="preload" href="/bookshelf/assets/style-Bhb-QcDa.css" as="style"><link rel="stylesheet" href="/bookshelf/assets/style-Bhb-QcDa.css">
    
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/bookshelf/" aria-label="Take me home"><img class="vp-nav-logo" src="/bookshelf/assets/icon/favicon.svg" alt><!----><span class="vp-site-name hide-in-pad">üìöBookshelf</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/bookshelf/news.html" aria-label><!--[--><i class="vp-icon fas fa-rss" sizing="height"></i><!--]--><!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-keyboard" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/hackingwithswift.com/" aria-label="hackingwithswift.com"><!--[--><img class="vp-icon" src="https://hackingwithswift.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->hackingwithswift.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fcc/" aria-label="freecodecamp.org"><!--[--><img class="vp-icon" src="https://cdn.freecodecamp.org/universal/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->freecodecamp.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kodeco.com/" aria-label="kodeco.com"><!--[--><img class="vp-icon" src="https://kodeco.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->kodeco.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.kotzilla.io/" aria-label="blog.kotzilla.io"><!--[--><img class="vp-icon" src="https://blog.kotzilla.io/hubfs/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.kotzilla.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kt.academy/" aria-label="kt.academy"><!--[--><img class="vp-icon" src="https://kt.academy/logo.png" alt aria-hidden no-view sizing="both"><!--]-->kt.academy<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/droidcon.com/" aria-label="droidcon.com"><!--[--><img class="vp-icon" src="https://droidcon.com/wp-content/uploads/2021/07/favicon-300x300.png" alt aria-hidden no-view sizing="both"><!--]-->droidcon.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/outcomeschool.com/" aria-label="outcomeschool.com"><!--[--><img class="vp-icon" src="https://outcomeschool.com/static/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->outcomeschool.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/bookshelf/frontendmasters.com/" aria-label="frontendmasters.com"><!--[--><img class="vp-icon" src="https://frontendmasters.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->frontendmasters.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tricks.com/" aria-label="css-tricks.com"><!--[--><img class="vp-icon" src="https://css-tricks.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->css-tricks.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="smashingmagazine.com"><!--[--><img class="vp-icon" src="https://smashingmagazine.com/images/favicon/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->smashingmagazine.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="oddbird.net"><!--[--><img class="vp-icon" src="https://oddbird.net/safari-pinned-tab.svg" alt aria-hidden no-view sizing="both"><!--]-->oddbird.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/zeroheight.com/" aria-label="zeroheight.com"><!--[--><img class="vp-icon" src="https://zeroheight.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->zeroheight.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/typescript.tv/" aria-label="typescript.tv"><!--[--><img class="vp-icon" src="https://typescript.tv/_astro/android-chrome-192x192.BhQ8hcWh.png" alt aria-hidden no-view sizing="both"><!--]-->typescript.tv<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.logrocket.com/" aria-label="blog.logrocket.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/blog.logrocket.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.logrocket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/realpython.com/" aria-label="realpython.com"><!--[--><img class="vp-icon" src="https://realpython.com/static/favicon.68cbf4197b0c.png" alt aria-hidden no-view sizing="both"><!--]-->realpython.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/digitalocean.com/" aria-label="digitalocean.com"><!--[--><img class="vp-icon" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt aria-hidden no-view sizing="both"><!--]-->digitalocean.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/antonioleiva.com/" aria-label="antonioleiva.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/antonioleiva.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->antonioleiva.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/johnnyreilly.com/" aria-label="johnnyreilly.com"><!--[--><img class="vp-icon" src="https://johnnyreilly.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->johnnyreilly.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/code-maze.com/" aria-label="code-maze.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/code-maze.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->code-maze.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/milanjovanovic.tech/" aria-label="milanjovanovic.tech"><!--[--><img class="vp-icon" src="https://milanjovanovic.tech/profile_favicon.png" alt aria-hidden no-view sizing="both"><!--]-->milanjovanovic.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/shopify.engineering/" aria-label="shopify.engineering"><!--[--><img class="vp-icon" src="https://cdn.shopify.com/static/shopify-favicon.png" alt aria-hidden no-view sizing="both"><!--]-->shopify.engineering<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devtoolstips.org/" aria-label="devtoolstips.org"><!--[--><img class="vp-icon" src="https://devtoolstips.org/assets/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devtoolstips.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/piccalil.li/" aria-label="piccalil.li"><!--[--><img class="vp-icon" src="https://piccalil.li/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->piccalil.li<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/sitepoint.com/" aria-label="sitepoint.com"><!--[--><img class="vp-icon" src="https://sitepoint.com/favicons/512x512.png" alt aria-hidden no-view sizing="both"><!--]-->sitepoint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/event-driven.io/" aria-label="event-driven.io"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/event-driven.io/favicon.jfif" alt aria-hidden no-view sizing="both"><!--]-->event-driven.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/packagemain.tech/" aria-label="packagemain.tech"><!--[--><img class="vp-icon" src="https://substack-post-media.s3.amazonaws.com/public/images/2ea54e25-eaa6-4630-bfc0-10b8cfdce894/apple-touch-icon-1024x1024.png" alt aria-hidden no-view sizing="both"><!--]-->packagemain.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/gosolve.io/" aria-label="gosolve.io"><!--[--><img class="vp-icon" src="https://gosolve.io/wp-content/uploads/2022/03/cropped-ikona1-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->gosolve.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/bram.us/" aria-label="bram.us"><!--[--><img class="vp-icon" src="https://bram.us/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->bram.us<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/una.im/" aria-label="una.im"><!--[--><img class="vp-icon" src="https://una.im/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->una.im<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/joshwcomeau.com/" aria-label="joshwcomeau.com"><!--[--><img class="vp-icon" src="https://joshwcomeau.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->joshwcomeau.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tip.com/" aria-label="css-tip.com"><!--[--><img class="vp-icon" src="https://css-tip.com/img/fav.png" alt aria-hidden no-view sizing="both"><!--]-->css-tip.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/nerdy.dev/" aria-label="nerdy.dev"><!--[--><img class="vp-icon" src="https://nerdy.dev/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->nerdy.dev<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/towardsdatascience.com/" aria-label="towardsdatascience.com"><!--[--><img class="vp-icon" src="https://cdn-images-1.medium.com/v2/resize:fill:128:128/1*VzTUkfeGymHP4Bvav-T-lA.png" alt aria-hidden no-view sizing="both"><!--]-->towardsdatascience.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/douggregor.net/" aria-label="douggregor.net"><!--[--><i class="vp-icon fas fa-globe" sizing="both"></i><!--]-->douggregor.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/d2.naver.com/" aria-label="d2.naver.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/d2.naver.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->d2.naver.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakao.com/" aria-label="tech.kakao.com"><!--[--><img class="vp-icon" src="https://www.kakaocorp.com/page/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakao.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakaopay.com/" aria-label="tech.kakaopay.com"><!--[--><img class="vp-icon" src="https://tech.kakaopay.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakaopay.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fe-developers.kakaoent.com/" aria-label="fe-developers.kakaoent.com"><!--[--><img class="vp-icon" src="https://fe-developers.kakaoent.com/favicon-32x32.png?v=44803cb16c1e2debd3984cf2e8cb2ded" alt aria-hidden no-view sizing="both"><!--]-->fe-developers.kakaoent.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/yozm.wishket.com/" aria-label="yozm.wishket.com"><!--[--><img class="vp-icon" src="https://yozm.wishket.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->yozm.wishket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/popit.kr/" aria-label="popit.kr"><!--[--><img class="vp-icon" src="https://popit.kr/wp-content/uploads/2016/08/favicon_32x32.png" alt aria-hidden no-view sizing="both"><!--]-->popit.kr<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devkuma.com/" aria-label="devkuma.com"><!--[--><img class="vp-icon" src="https://devkuma.com/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devkuma.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.gangnamunni.com/" aria-label="blog.gangnamunni.com"><!--[--><img class="vp-icon" src="https://blog.gangnamunni.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->blog.gangnamunni.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/codingeverybody.kr/" aria-label="codingeverybody.kr"><!--[--><img class="vp-icon" src="https://codingeverybody.kr/wp-content/uploads/cropped-favicon-origin-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->codingeverybody.kr<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-network-wired" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tecmint.com/" aria-label="tecmint.com"><!--[--><img class="vp-icon" src="https://tecmint.com/wp-content/uploads/2020/07/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tecmint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/docker.com/" aria-label="docker.com"><!--[--><img class="vp-icon" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->docker.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/learnkube.com/" aria-label="learnkube.com"><!--[--><img class="vp-icon" src="https://static.learnkube.com/f7e5160d4744cf05c46161170b5c11c9.svg" alt aria-hidden no-view sizing="both"><!--]-->learnkube.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/itsfoss.com/" aria-label="itsfoss.com"><!--[--><img class="vp-icon" src="https://itsfoss.com/content/images/size/w256h256/2022/12/android-chrome-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->itsfoss.com<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/chanhi2000/bookshelf" target="_blank" rel="noopener noreferrer" aria-label="Github"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><!----></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><img class="vp-icon" src="https://frontendmasters.com/favicon.ico" alt aria-hidden no-view sizing="both"><span class="vp-sidebar-title">frontendmasters.com</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">2026</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html" aria-label="Single Flight Mutations in TanStack Start: Part 1"><!--[--><i class="vp-icon fa-brands fa-react" sizing="both"></i><!--]-->Single Flight Mutations in TanStack Start: Part 1<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/frontendmasters.com/view-transitions-playing-video.html" aria-label="View Transitions &amp; Playing Video"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->View Transitions &amp; Playing Video<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/frontendmasters.com/the-missing-link-for-web-components.html" aria-label="The Missing Link for Web Components"><!--[--><i class="vp-icon iconfont icon-storybook" sizing="both"></i><!--]-->The Missing Link for Web Components<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/frontendmasters.com/simulating-crop-marks.html" aria-label="Simulating Crop Marks"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->Simulating Crop Marks<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/frontendmasters.com/beyond-the-mouse-animating-with-mobile-accelerometers.html" aria-label="Beyond the Mouse: Animating with Mobile Accelerometers"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->Beyond the Mouse: Animating with Mobile Accelerometers<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/frontendmasters.com/popover-context-menus-with-anchor-positioning.html" aria-label="Popover Context Menus with Anchor Positioning"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->Popover Context Menus with Anchor Positioning<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/frontendmasters.com/how-to-scope-css-now-that-its-baseline.html" aria-label="How to @scope CSS Now That It‚Äôs Baseline"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->How to @scope CSS Now That It‚Äôs Baseline<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/frontendmasters.com/important-and-css-custom-properties.html" aria-label="!important and CSS Custom Properties"><!--[--><i class="vp-icon fa-brands fa-css3-alt" sizing="both"></i><!--]-->!important and CSS Custom Properties<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2025</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2024</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2023</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/8334" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon fa-brands fa-react" sizing="height"></i>Single Flight Mutations in TanStack Start: Part 1</h1><div class="page-info"><span class="page-author-info" aria-label="Authorüñä" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://frontendmasters.com/blog/author/adamrackis/" target="_blank" rel="noopener noreferrer">Adam Rackis</a></span><span property="author" content="Adam Rackis"></span></span><!----><span class="page-date-info" aria-label="Writing DateüìÖ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">1/23/26</span><meta property="datePublished" content="2026-01-23T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time‚åõ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 7 min</span><meta property="timeRequired" content="PT7M"></span><span class="page-category-info" aria-label="Categoryüåà" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color1" role>Node.js</span><span class="page-category-item color6" role>React.js</span><span class="page-category-item color8" role>Article(s)</span><!--]--><meta property="articleSection" content="Node.js,React.js,Article(s)"></span><span class="page-tag-info" aria-label="Tagüè∑" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8" role>blog</span><span class="page-tag-item color8" role>frontendmasters.com</span><span class="page-tag-item color2" role>node</span><span class="page-tag-item color6" role>nodejs</span><span class="page-tag-item color3" role>node-js</span><span class="page-tag-item color5" role>react</span><span class="page-tag-item color6" role>reactjs</span><span class="page-tag-item color6" role>react-js</span><!--]--><meta property="keywords" content="blog,frontendmasters.com,node,nodejs,node-js,react,reactjs,react-js"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´" tabindex="-1"><a class="header-anchor" href="#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"><span>Single Flight Mutations in TanStack Start: Part 1 Í¥ÄÎ†®</span></a></h1><a class="route-link vp-card" href="/bookshelf/programming/js-react/articles/" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="/bookshelf/images/ico-wind.svg" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">React.js > Article(s)</div><hr><div class="vp-card-desc">Article(s)</div></div></a><nav class="table-of-contents"><ul><li><a aria-current="page" href="/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html#laying-the-groundwork" class="router-link-active router-link-exact-active">Laying the Groundwork</a></li><li><a aria-current="page" href="/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html#why-single-flight-mutations" class="router-link-active router-link-exact-active">Why Single Flight Mutations</a></li><li><a aria-current="page" href="/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html#our-app" class="router-link-active router-link-exact-active">Our App</a></li><li><a aria-current="page" href="/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html#simplest-possible-single-flight-mutation" class="router-link-active router-link-exact-active">Simplest Possible Single Flight Mutation</a></li><li><a aria-current="page" href="/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html#updating-the-ui" class="router-link-active router-link-exact-active">Updating the UI</a></li><li><a aria-current="page" href="/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html#iterating" class="router-link-active router-link-exact-active">Iterating</a></li></ul></nav><hr><div class="vp-site-info" data-name="Single Flight Mutations in TanStack Start: Part 1"><a class="vp-site-info-navigator no-external-link-icon" title="Single Flight Mutations in TanStack Start: Part 1" href="https://frontendmasters.com/blog/single-flight-mutations-in-tanstack-start-part-1/" target="_blank"></a><div class="vp-site-info-preview" style="background:url(https://frontendmasters.com/blog/wp-json/social-image-generator/v1/image/8334) center/cover no-repeat;"></div><div class="vp-site-info-detail"><img class="vp-site-info-logo" src="https://frontendmasters.com/favicon.ico" alt loading="lazy" no-view><div class="vp-site-info-name">Single Flight Mutations in TanStack Start: Part 1</div><div class="vp-site-info-desc">What if we could mutate data *and* get all the data back we need to properly update the UI in just one network round-trip?</div></div><!----></div><p>A <strong>‚Äúsingle flight mutation‚Äù</strong> is a fancy way of saying: mutate the data <em>and</em> update the UI with just <em>one</em> round trip to the network.</p><p>The beautiful thing about implementing this with TanStack is that we can leverage the tools we already know, and love: <a href="https://tanstack.com/query/latest" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>TanStack Query</a> (formerly react-query), <a href="https://tanstack.com/router/latest" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>TanStack Router</a>, and <a href="https://tanstack.com/start/latest" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>TanStack Start</a>.</p><p>If you‚Äôre not familiar with these tools, TanStack Router is a client-only SPA framework (see my <a class="route-link" href="/bookshelf/frontendmasters.com/introducing-tanstack-router.html"><strong>three-part introduction series</strong></a>). TanStack Start is a server layer for Router that enables things like SSR, API routes, and server functions (see my <a class="route-link" href="/bookshelf/frontendmasters.com/introducing-tanstack-start.html"><strong>introduction for it</strong></a> and <a class="route-link" href="/bookshelf/frontendmasters.com/introducing-tanstack-start-middleware.html"><strong>a post on its middleware feature</strong></a>).</p><p>I‚Äôve never written about TanStack Query, but it‚Äôs one of the most widely used React libraries, and there are tons of resources about it. One of the best would be <a href="https://tkdodo.eu/blog/all" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>TkDodo‚Äôs blog</a>. He‚Äôs the lead maintainer of TanStack Query, and his blog is superb.</p><p>In this first post, we‚Äôll cover some fundamentals and then implement the simplest imaginable single flight mutation with a TanStack Start Server Function. In the next part, we‚Äôll dive deep into middleware and implement a more serious solution, while having some fun with TypeScript in the process.</p><hr><h2 id="laying-the-groundwork" tabindex="-1"><a class="header-anchor" href="#laying-the-groundwork"><span>Laying the Groundwork</span></a></h2><p>In my <a class="route-link" href="/bookshelf/frontendmasters.com/introducing-tanstack-start.html"><strong>post on TanStack Start</strong></a>, I included this image, which is how client-driven single-page applications (SPAs) almost always behave.</p><figure><img src="https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img1.png?ssl=1" alt="A flow diagram illustrating the sequence of actions between a browser and a web server when loading a webpage, highlighting the steps of rendering an empty app shell, loading scripts, requesting data, and finally displaying the full page." tabindex="0" loading="lazy"><figcaption>A flow diagram illustrating the sequence of actions between a browser and a web server when loading a webpage, highlighting the steps of rendering an empty app shell, loading scripts, requesting data, and finally displaying the full page.</figcaption></figure><!-- TODO: mermaidÌôî --><p>The initial request for whatever URL you‚Äôre viewing returns an empty skeleton of a page. From there, more networks requests happen to fetch scripts and styles, and most likely some data, which eventually results in your actual content page being rendered.</p><p>The network round trips will almost always be the single most expensive thing your web application will do. To look at it another way, there are few things you can do to improve performance as much as <em>removing</em> network roundtrips. And this is why server-side rendering can be so beneficial: it allows us to display content to our users <em>immediately</em>, after the initial request is responded to.</p><p>I expressed this in the Start post with this image.</p><figure><img src="https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img2.png?ssl=1" alt="Diagram illustrating the sequence of actions in client-driven single-page applications, showing the initial GET request for an HTML document, followed by script file requests, and the transition from page display to interactivity." tabindex="0" loading="lazy"><figcaption>Diagram illustrating the sequence of actions in client-driven single-page applications, showing the initial GET request for an HTML document, followed by script file requests, and the transition from page display to interactivity.</figcaption></figure><!-- TODO: mermaidÌôî --><p>Those scripts and styles still have to load for your page to be interactive, but that initial response from the server can immediately display content for the user.</p><hr><h2 id="why-single-flight-mutations" tabindex="-1"><a class="header-anchor" href="#why-single-flight-mutations"><span>Why Single Flight Mutations</span></a></h2><p>Let‚Äôs think about how you‚Äôd normally update a piece of data in a web application.</p><p>You probably make a network request to some sort of <code>/update</code> endpoint, along with a post packet for whatever you‚Äôre trying to change. The endpoint will probably return a success flag, possibly with the actual piece of data you just updated. Your UI will usually then request updated data. You might think that returning the updated piece of data you just changed is all you‚Äôd need in order to update the UI, but frequently that‚Äôs not the case.</p><p>Imagine you‚Äôre looking at a list of TODO tasks, and you just edited one of them. Just updating the item on the screen isn‚Äôt good enough; maybe the edit causes this TODO to no longer even be in this list, depending on your filters. Or perhaps your edit causes this TODO to move to a different page in your results, based on your sort order. Or maybe you just <em>created</em> a <em>brand new</em> todo. In that case, who knows where, or even <em>if</em> this todo will show up in your list, again based on your filters and sorts.</p><p>So we re-fetch whatever query produces our list. It usually looks like this</p><figure><img src="https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img3.png?resize=1024%2C922&amp;ssl=1" alt="A flowchart illustrating the interaction between a browser and web server, detailing the process of posting updated data, receiving an update result, requesting updated data, and updating the UI accordingly." tabindex="0" loading="lazy"><figcaption>A flowchart illustrating the interaction between a browser and web server, detailing the process of posting updated data, receiving an update result, requesting updated data, and updating the UI accordingly.</figcaption></figure><!-- TODO: mermaidÌôî --><p>This works, and if we‚Äôre honest with ourselves, it‚Äôs usually good enough. But can we do better? We wouldn‚Äôt be good engineers if we didn‚Äôt at least <em>try</em>. Conceptually we‚Äôd like to get something like this</p><figure><img src="https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img4.png?ssl=1" alt="A diagram illustrating the flow of data between the browser and web server during a single flight mutation. It shows a POST request to &#39;/update-data&#39; from the browser, followed by a response that includes both the result and new data for UI updates." tabindex="0" loading="lazy"><figcaption>A diagram illustrating the flow of data between the browser and web server during a single flight mutation. It shows a POST request to &#39;/update-data&#39; from the browser, followed by a response that includes both the result and new data for UI updates.</figcaption></figure><!-- TODO: mermaidÌôî --><p>We‚Äôll implement a dead simple solution to this here in part 1, and then part 2 will discuss increasingly flexible ways of accomplishing it with middleware.</p><hr><h2 id="our-app" tabindex="-1"><a class="header-anchor" href="#our-app"><span>Our App</span></a></h2><p>As with prior posts about TanStack Start and Router, this post will use our cheap, simple, and frankly ugly Jira clone. <a href="https://github.com/arackaf/tanstack-start-single-flight-mutations-blog-post" target="_blank" rel="noopener noreferrer">Here‚Äôs a repo for it (<i class="vp-icon iconfont icon-github" sizing="height"></i><code>arackaf/tanstack-start-single-flight-mutations-blog-post</code>)</a>. It‚Äôs a trivial app that runs on an SQLite database. The epics page looks like this:</p><figure><img src="https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img5.png?resize=830%2C1024&amp;ssl=1" alt="Screenshot of a web application displaying an overview of epics with a list of tasks, including buttons for viewing and editing." tabindex="0" loading="lazy"><figcaption>Screenshot of a web application displaying an overview of epics with a list of tasks, including buttons for viewing and editing.</figcaption></figure><p>As you can see, zero effort was put into the design. But there‚Äôs a few sources of data on the screen, which will help us implement single flight mutations: the main list of epics; the count of all epics (12) just above the list; and above that we have a summary list of epics, with the numbers of tasks therein.</p><p>This is the page we‚Äôll be focusing on for this post. If you‚Äôre following along at home, you can run the app with <code>npm run dev</code> and then visit <code>http://localhost:3000/app/epics</code>.</p><p>Our queries for our list of epics and our summary data are driven by react-query. I‚Äôve put the query options into helper utilities, like so.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">epicsQueryOptions</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">page</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">queryOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">queryKey</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;epics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> page<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function-variable function">queryFn</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEpicsList</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> page <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token keyword">return</span> result<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">staleTime</span><span class="token operator">:</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">gcTime</span><span class="token operator">:</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This allows me to query data using the normal <code>useQuery</code> or <code>useSuspenseQuery</code> hook.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> epicsData <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useSuspenseQuery</span><span class="token punctuation">(</span><span class="token function">epicsQueryOptions</span><span class="token punctuation">(</span>deferredPage<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And also prefetch these queries in TanStack loaders, without duplicating code.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">async</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> context<span class="token punctuation">,</span> deps <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> queryClient <span class="token operator">=</span> context<span class="token punctuation">.</span>queryClient<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    queryClient<span class="token punctuation">.</span><span class="token function">ensureQueryData</span><span class="token punctuation">(</span><span class="token function">epicsQueryOptions</span><span class="token punctuation">(</span>deps<span class="token punctuation">.</span>page<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    queryClient<span class="token punctuation">.</span><span class="token function">ensureQueryData</span><span class="token punctuation">(</span><span class="token function">epicsCountQueryOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As you can see, this query (and all our other queries) are just straight calls to a single server function (<code>getEpicsList</code> in this case), with the result passed through. This is a key detail that will come in handy in part 2.</p><hr><h2 id="simplest-possible-single-flight-mutation" tabindex="-1"><a class="header-anchor" href="#simplest-possible-single-flight-mutation"><span>Simplest Possible Single Flight Mutation</span></a></h2><p>Let‚Äôs implement a dirt simple single flight mutation, and then iterate on it, to make it more and more scalable. Our main epics page has an edit button, which allows for inline editing.</p><figure><img src="https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img6.png?resize=792%2C1024&amp;ssl=1" alt="A user interface displaying a list of epics with their respective task counts, including buttons for viewing and editing each epic." tabindex="0" loading="lazy"><figcaption>A user interface displaying a list of epics with their respective task counts, including buttons for viewing and editing each epic.</figcaption></figure><p>When we hit save, let‚Äôs just refetch the list of epics, as well as the epics summary data inside the edit epic server function, and send those new data down to the client, so the client can update the UI.</p><p>Here‚Äôs the entire server function:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> updateWithSimpleRefetch <span class="token operator">=</span> <span class="token function">createServerFn</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">.</span><span class="token function">inputValidator</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">obj</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> number<span class="token punctuation">;</span> name<span class="token operator">:</span> string <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>epicsTable<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> data<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token function">eq</span><span class="token punctuation">(</span>epicsTable<span class="token punctuation">.</span>id<span class="token punctuation">,</span> data<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">[</span>epicsList<span class="token punctuation">,</span> epicsSummaryData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">getEpicsList</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getEpicsSummary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span> epicsList<span class="token punctuation">,</span> epicsSummaryData <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We save our epic, and then fetch the updated data from the <code>getEpicsList</code>, and <code>getEpicsSummary</code> server functions, which we call in parallel with <code>Promise.all</code>. Note that a production-ready application would likely have some error handling.</p><p>Now when we call our server function, the data for those queries will be attached to the result. In fact, since we‚Äôre using server functions, these things will even be statically typed!</p><figure><img src="https://i0.wp.com/frontendmasters.com/blog/wp-content/uploads/2026/01/img7.png?resize=1024%2C150&amp;ssl=1" alt="Code snippet displaying a loop over result.epicsList with properties of each epic highlighted, showing &#39;id&#39; and &#39;name&#39; attributes." tabindex="0" loading="lazy"><figcaption>Code snippet displaying a loop over result.epicsList with properties of each epic highlighted, showing &#39;id&#39; and &#39;name&#39; attributes.</figcaption></figure><hr><h2 id="updating-the-ui" tabindex="-1"><a class="header-anchor" href="#updating-the-ui"><span>Updating the UI</span></a></h2><p>With updated data for our queries coming back after the save, we can now insert it back into the UI. TanStack Query makes this simple. We need a reference to the QueryClient:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> queryClient <span class="token operator">=</span> <span class="token function">useQueryClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then we can update the query payload for a given query with the <code>setQueryData</code> method. It takes the query key and the data.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> <span class="token function-variable function">handleSaveSimple</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> newValue <span class="token operator">=</span> inputRef<span class="token punctuation">.</span>current<span class="token operator">?.</span>value <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">runSaveSimple</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">id</span><span class="token operator">:</span> epic<span class="token punctuation">.</span>id<span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">name</span><span class="token operator">:</span> newValue<span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  queryClient<span class="token punctuation">.</span><span class="token function">setQueryData</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;epics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>epicsList<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  queryClient<span class="token punctuation">.</span><span class="token function">setQueryData</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;epics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;summary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>epicsSummaryData<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">setIsEditing</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If hard-coding those query keys feels gross to you, don‚Äôt forget about those helper utilities we added before.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">queryClient<span class="token punctuation">.</span><span class="token function">setQueryData</span><span class="token punctuation">(</span><span class="token function">epicsQueryOptions</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>queryKey<span class="token punctuation">,</span> result<span class="token punctuation">.</span>epicsList<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">updatedAt</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">queryClient<span class="token punctuation">.</span><span class="token function">setQueryData</span><span class="token punctuation">(</span><span class="token function">epicsSummaryQueryOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>queryKey<span class="token punctuation">,</span> result<span class="token punctuation">.</span>epicsSummaryData<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">updatedAt</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="iterating" tabindex="-1"><a class="header-anchor" href="#iterating"><span>Iterating</span></a></h2><p>Our solution works, but it‚Äôs fragile. Our server function hard codes which data to fetch. What if our update function were to be called from different parts of the UI, which each needed different slices of data to be refetched? We certainly don‚Äôt want to redefine our server function N times, for each place it needs to be called.</p><p>Fortunately, TanStack has the perfect feature to help reduce this coupling: Middleware. We can remove the refetching from the server function, and move it to a reusable middleware which can be attached to server functions.</p><p>Stay tuned for part 2 where we‚Äôll dive into all of this.</p><!-- TODO: add ARTICLE CARD --><a class="vp-card" href="https://chanhi2000.github.io/bookshelf/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.html" target="_blank" style="background:rgba(188,75,52,0.2);"><img class="vp-card-logo" src="https://frontendmasters.com/favicon.ico" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Single Flight Mutations in TanStack Start: Part 1</div><hr><div class="vp-card-desc">What if we could mutate data *and* get all the data back we need to properly update the UI in just one network round-trip?</div></div></a></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/chanhi2000/bookshelf/edit/main/src/frontendmasters.com/single-flight-mutations-in-tanstack-start-part-1.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/bookshelf/programming/js-react/articles/" aria-label="/programming/js-react/articles/"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->/programming/js-react/articles/</div></a><a class="route-link auto-link next" href="/bookshelf/frontendmasters.com/view-transitions-playing-video.html" aria-label="View Transitions &amp; Playing Video"><div class="hint">Next<span class="arrow end"></span></div><div class="link">View Transitions &amp; Playing Video<i class="vp-icon fa-brands fa-css3-alt" sizing="height"></i></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">MIT Licensed | Copyright ¬© 2022-present <a href="https://github.com/chanhi2000">Chan Hee Lee</a></div><div class="vp-copyright">Copyright ¬© 2026 Adam Rackis </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/bookshelf/assets/app-BItykJLQ.js" defer></script>
  </body>
</html>
