<!doctype html>
<html lang="ko-KR" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt","image":["https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg"],"datePublished":"2022-11-18T00:00:00.000Z","dateModified":null,"author":[]}</script><meta property="og:url" content="https://chanhi2000.github.io/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html"><meta property="og:site_name" content="📚Bookshelf"><meta property="og:title" content="How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt"><meta property="og:description" content="Article(s) > How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt"><meta property="og:type" content="article"><meta property="og:image" content="https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg"><meta property="og:locale" content="ko-KR"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:src" content="https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg"><meta name="twitter:image:alt" content="How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt"><meta property="article:tag" content="serverless"><meta property="article:tag" content="kubctl"><meta property="article:tag" content="k8s"><meta property="article:tag" content="kubernetes"><meta property="article:tag" content="digitalocean.com"><meta property="article:tag" content="blog"><meta property="article:published_time" content="2022-11-18T00:00:00.000Z"><link rel="icon" href="/bookshelf/assets/icon/favicon.svg"><title>How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt | 📚Bookshelf</title><meta name="description" content="Article(s) > How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt">
    <link rel="preload" href="/bookshelf/assets/style-DmRYlEXZ.css" as="style"><link rel="stylesheet" href="/bookshelf/assets/style-DmRYlEXZ.css">
    
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/bookshelf/" aria-label="Take me home"><img class="vp-nav-logo" src="/bookshelf/assets/icon/favicon.svg" alt><!----><span class="vp-site-name hide-in-pad">📚Bookshelf</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/bookshelf/news.html" aria-label><!--[--><i class="vp-icon fas fa-rss" sizing="height"></i><!--]--><!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-keyboard" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/hackingwithswift.com/" aria-label="hackingwithswift.com"><!--[--><img class="vp-icon" src="https://hackingwithswift.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->hackingwithswift.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fcc/" aria-label="freecodecamp.org"><!--[--><img class="vp-icon" src="https://cdn.freecodecamp.org/universal/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->freecodecamp.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kodeco.com/" aria-label="kodeco.com"><!--[--><img class="vp-icon" src="https://kodeco.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->kodeco.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.kotzilla.io/" aria-label="blog.kotzilla.io"><!--[--><img class="vp-icon" src="https://blog.kotzilla.io/hubfs/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.kotzilla.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kt.academy/" aria-label="kt.academy"><!--[--><img class="vp-icon" src="https://kt.academy/logo.png" alt aria-hidden no-view sizing="both"><!--]-->kt.academy<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/droidcon.com/" aria-label="droidcon.com"><!--[--><img class="vp-icon" src="https://droidcon.com/wp-content/uploads/2021/07/favicon-300x300.png" alt aria-hidden no-view sizing="both"><!--]-->droidcon.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/outcomeschool.com/" aria-label="outcomeschool.com"><!--[--><img class="vp-icon" src="https://outcomeschool.com/static/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->outcomeschool.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/frontendmasters.com/" aria-label="frontendmasters.com"><!--[--><img class="vp-icon" src="https://frontendmasters.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->frontendmasters.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tricks.com/" aria-label="css-tricks.com"><!--[--><img class="vp-icon" src="https://css-tricks.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->css-tricks.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="smashingmagazine.com"><!--[--><img class="vp-icon" src="https://smashingmagazine.com/images/favicon/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->smashingmagazine.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.logrocket.com/" aria-label="blog.logrocket.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/blog.logrocket.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.logrocket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/realpython.com/" aria-label="realpython.com"><!--[--><img class="vp-icon" src="https://realpython.com/static/favicon.68cbf4197b0c.png" alt aria-hidden no-view sizing="both"><!--]-->realpython.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/bookshelf/digitalocean.com/" aria-label="digitalocean.com"><!--[--><img class="vp-icon" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt aria-hidden no-view sizing="both"><!--]-->digitalocean.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/antonioleiva.com/" aria-label="antonioleiva.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/antonioleiva.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->antonioleiva.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/johnnyreilly.com/" aria-label="johnnyreilly.com"><!--[--><img class="vp-icon" src="https://johnnyreilly.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->johnnyreilly.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/code-maze.com/" aria-label="code-maze.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/code-maze.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->code-maze.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/milanjovanovic.tech/" aria-label="milanjovanovic.tech"><!--[--><img class="vp-icon" src="https://milanjovanovic.tech/profile_favicon.png" alt aria-hidden no-view sizing="both"><!--]-->milanjovanovic.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/shopify.engineering/" aria-label="shopify.engineering"><!--[--><img class="vp-icon" src="https://cdn.shopify.com/static/shopify-favicon.png" alt aria-hidden no-view sizing="both"><!--]-->shopify.engineering<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devtoolstips.org/" aria-label="devtoolstips.org"><!--[--><img class="vp-icon" src="https://devtoolstips.org/assets/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devtoolstips.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/piccalil.li/" aria-label="piccalil.li"><!--[--><img class="vp-icon" src="https://piccalil.li/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->piccalil.li<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/sitepoint.com/" aria-label="sitepoint.com"><!--[--><img class="vp-icon" src="https://sitepoint.com/favicons/512x512.png" alt aria-hidden no-view sizing="both"><!--]-->sitepoint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/event-driven.io/" aria-label="event-driven.io"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/event-driven.io/favicon.jfif" alt aria-hidden no-view sizing="both"><!--]-->event-driven.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/packagemain.tech/" aria-label="packagemain.tech"><!--[--><img class="vp-icon" src="https://substack-post-media.s3.amazonaws.com/public/images/2ea54e25-eaa6-4630-bfc0-10b8cfdce894/apple-touch-icon-1024x1024.png" alt aria-hidden no-view sizing="both"><!--]-->packagemain.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/gosolve.io/" aria-label="gosolve.io"><!--[--><img class="vp-icon" src="https://gosolve.io/wp-content/uploads/2022/03/cropped-ikona1-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->gosolve.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/towardsdatascience.com/" aria-label="towardsdatascience.com"><!--[--><img class="vp-icon" src="https://cdn-images-1.medium.com/v2/resize:fill:128:128/1*VzTUkfeGymHP4Bvav-T-lA.png" alt aria-hidden no-view sizing="both"><!--]-->towardsdatascience.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/douggregor.net/" aria-label="douggregor.net"><!--[--><i class="vp-icon fas fa-globe" sizing="both"></i><!--]-->douggregor.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/d2.naver.com/" aria-label="d2.naver.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/d2.naver.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->d2.naver.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakao.com/" aria-label="tech.kakao.com"><!--[--><img class="vp-icon" src="https://www.kakaocorp.com/page/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakao.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakaopay.com/" aria-label="tech.kakaopay.com"><!--[--><img class="vp-icon" src="https://tech.kakaopay.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakaopay.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fe-developers.kakaoent.com/" aria-label="fe-developers.kakaoent.com"><!--[--><img class="vp-icon" src="https://fe-developers.kakaoent.com/favicon-32x32.png?v=44803cb16c1e2debd3984cf2e8cb2ded" alt aria-hidden no-view sizing="both"><!--]-->fe-developers.kakaoent.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/yozm.wishket.com/" aria-label="yozm.wishket.com"><!--[--><img class="vp-icon" src="https://yozm.wishket.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->yozm.wishket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/popit.kr/" aria-label="popit.kr"><!--[--><img class="vp-icon" src="https://popit.kr/wp-content/uploads/2016/08/favicon_32x32.png" alt aria-hidden no-view sizing="both"><!--]-->popit.kr<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devkuma.com/" aria-label="devkuma.com"><!--[--><img class="vp-icon" src="https://devkuma.com/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devkuma.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.gangnamunni.com/" aria-label="blog.gangnamunni.com"><!--[--><img class="vp-icon" src="https://blog.gangnamunni.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->blog.gangnamunni.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/codingeverybody.kr/" aria-label="codingeverybody.kr"><!--[--><img class="vp-icon" src="https://codingeverybody.kr/wp-content/uploads/cropped-favicon-origin-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->codingeverybody.kr<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-network-wired" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tecmint.com/" aria-label="tecmint.com"><!--[--><img class="vp-icon" src="https://tecmint.com/wp-content/uploads/2020/07/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tecmint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/docker.com/" aria-label="docker.com"><!--[--><img class="vp-icon" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->docker.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/learnk8s.io/" aria-label="learnk8s.io"><!--[--><img class="vp-icon" src="https://static.learnk8s.io/f7e5160d4744cf05c46161170b5c11c9.svg" alt aria-hidden no-view sizing="both"><!--]-->learnk8s.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/itsfoss.com/" aria-label="itsfoss.com"><!--[--><img class="vp-icon" src="https://itsfoss.com/content/images/size/w256h256/2022/12/android-chrome-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->itsfoss.com<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/chanhi2000/articles" target="_blank" rel="noopener noreferrer" aria-label="Github"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-appearance-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-appearance-dropdown"><!----></div></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><img class="vp-icon" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt aria-hidden no-view sizing="both"><span class="vp-sidebar-title">digitalocean.com</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/" aria-label="DigitalOcean (digitalocean.com)"><!--[--><img class="vp-icon" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt aria-hidden no-view sizing="both"><!--]-->DigitalOcean (digitalocean.com)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-install-nginx-on-centos-6-with-yum.html" aria-label="How To Install nginx on CentOS 6 with yum"><!--[--><i class="vp-icon fa-brands fa-centos" sizing="both"></i><!--]-->How To Install nginx on CentOS 6 with yum<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/initial-server-setup-with-centos-6.html" aria-label="Initial Server Setup with CentOS 6"><!--[--><i class="vp-icon fa-brands fa-centos" sizing="both"></i><!--]-->Initial Server Setup with CentOS 6<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-use-sqlite-with-node-js-on-ubuntu-22-04.html" aria-label="How To Use SQLite with Node.js on Ubuntu 22.04"><!--[--><i class="vp-icon fa-brands fa-node" sizing="both"></i><!--]-->How To Use SQLite with Node.js on Ubuntu 22.04<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html" aria-label="How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt"><!--[--><i class="vp-icon iconfont icon-k8s" sizing="both"></i><!--]-->How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-run-serverless-workloads-with-knative-on-digitalocean-kubernetes.html" aria-label="How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes"><!--[--><i class="vp-icon iconfont icon-k8s" sizing="both"></i><!--]-->How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-scale-node-js-applications-with-clustering.html" aria-label="How To Scale Node.js Applications with Clustering"><!--[--><i class="vp-icon fa-brands fa-node" sizing="both"></i><!--]-->How To Scale Node.js Applications with Clustering<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-integrate-existing-systems-with-kafka-connect.html" aria-label="How to Integrate Existing Systems with Kafka Connect"><!--[--><i class="vp-icon iconfont icon-apachekafka" sizing="both"></i><!--]-->How to Integrate Existing Systems with Kafka Connect<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-use-docker-exec-to-run-commands-in-a-docker-container.html" aria-label="How To Use docker exec to Run Commands in a Docker Container"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->How To Use docker exec to Run Commands in a Docker Container<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/markdown-markdown-images.html" aria-label="How To Add Images in Markdown"><!--[--><i class="vp-icon fa-brands fa-markdown" sizing="both"></i><!--]-->How To Add Images in Markdown<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/python-pretty-print-json.html" aria-label="Python Pretty Print JSON"><!--[--><i class="vp-icon iconfont icon-django" sizing="both"></i><!--]-->Python Pretty Print JSON<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-use-break-continue-and-pass-statements-when-working-with-loops-in-python-3.html" aria-label="How To Use Break, Continue, and Pass Statements when Working with Loops in Python"><!--[--><i class="vp-icon iconfont icon-django" sizing="both"></i><!--]-->How To Use Break, Continue, and Pass Statements when Working with Loops in Python<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/developing-multi-modal-bots-with-django-gpt-4-whisper-and-dall-e.html" aria-label="Developing Multi-Modal Bots with Django, GPT-4, Whisper, and DALL-E"><!--[--><i class="vp-icon iconfont icon-django" sizing="both"></i><!--]-->Developing Multi-Modal Bots with Django, GPT-4, Whisper, and DALL-E<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-set-up-a-multi-node-kafka-cluster-using-kraft.html" aria-label="How To Set Up a Multi-Node Kafka Cluster using KRaft"><!--[--><i class="vp-icon iconfont icon-apachekafka" sizing="both"></i><!--]-->How To Set Up a Multi-Node Kafka Cluster using KRaft<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/digitalocean.com/how-to-manage-kafka-programmatically.html" aria-label="How To Manage Kafka Programmatically"><!--[--><i class="vp-icon iconfont icon-apachekafka" sizing="both"></i><!--]-->How To Manage Kafka Programmatically<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon iconfont icon-k8s" sizing="height"></i>How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">22. 11. 18.</span><meta property="datePublished" content="2022-11-18T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 15 min</span><meta property="timeRequired" content="PT15M"></span><span class="page-category-info" aria-label="Category🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color2" role>DevOps</span><span class="page-category-item color7" role>VM</span><span class="page-category-item color7" role>Kubernetes</span><span class="page-category-item color8" role>Article(s)</span><!--]--><meta property="articleSection" content="DevOps,VM,Kubernetes,Article(s)"></span><span class="page-tag-info" aria-label="Tag🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8" role>blog</span><span class="page-tag-item color3" role>digitalocean.com</span><span class="page-tag-item color2" role>kubernetes</span><span class="page-tag-item color5" role>k8s</span><span class="page-tag-item color4" role>kubctl</span><span class="page-tag-item color3" role>serverless</span><!--]--><meta property="keywords" content="blog,digitalocean.com,kubernetes,k8s,kubctl,serverless"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="frontmatter-title-관련" tabindex="-1"><a class="header-anchor" href="#frontmatter-title-관련"><span>How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt 관련</span></a></h1><a class="route-link vp-card" href="/bookshelf/devops/k8s/articles/" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="https://chanhi2000.github.io/images/ico-wind.svg" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Kubernetes > Article(s)</div><hr><div class="vp-card-desc">Article(s)</div></div></a><nav class="table-of-contents"><ul><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#introduction" class="router-link-active router-link-exact-active">Introduction</a></li><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#step-1-—-setting-up-cert-manager-in-your-cluster" class="router-link-active router-link-exact-active">Step 1 — Setting Up cert-manager in Your Cluster</a></li><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#step-2-—-configuring-the-let-s-encrypt-certificate-issuer" class="router-link-active router-link-exact-active">Step 2 — Configuring the Let’s Encrypt Certificate Issuer</a><ul><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#tutorial-cluster-config-ltutorial-cluster-config-lets-encrypt-do-dns-yaml" class="router-link-active router-link-exact-active"><i class="vp-icon iconfont icon-yaml" sizing="height"></i>tutorial-cluster-config/ltutorial-cluster-config/lets-encrypt-do-dns.yaml</a></li><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#tutorial-cluster-config-llets-encrypt-issuer-yaml" class="router-link-active router-link-exact-active"><i class="vp-icon iconfont icon-yaml" sizing="height"></i>tutorial-cluster-config/llets-encrypt-issuer.yaml</a></li></ul></li><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#step-3-—-using-a-load-balancer-with-traefik" class="router-link-active router-link-exact-active">Step 3 — Using a Load Balancer with Traefik</a></li><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#step-4-—-accessing-traefik-with-your-domain" class="router-link-active router-link-exact-active">Step 4 — Accessing Traefik with Your Domain</a></li><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#step-5-—-creating-your-web-service" class="router-link-active router-link-exact-active">Step 5 — Creating Your Web Service</a></li><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#step-6-—-making-your-web-service-available-and-secure" class="router-link-active router-link-exact-active">Step 6 — Making Your Web Service Available and Secure</a></li><li><a aria-current="page" href="/bookshelf/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.html#conclusion" class="router-link-active router-link-exact-active">Conclusion</a></li></ul></nav><hr><div class="vp-site-info" data-name="How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt | DigitalOcean"><a class="vp-site-info-navigator no-external-link-icon" title="How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt | DigitalOcean" href="https://digitalocean.com/community/tutorials/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt" target="_blank"></a><div class="vp-site-info-preview" style="background:url(https://digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg) center/cover no-repeat;"></div><div class="vp-site-info-detail"><img class="vp-site-info-logo" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt loading="lazy" no-view><div class="vp-site-info-name">How To Secure Your Site in Kubernetes with cert-manager, Traefik, and Let’s Encrypt | DigitalOcean</div><div class="vp-site-info-desc">Kubernetes is a popular way to host websites. As more websites interact with sensitive data, more browsers are requiring TLS to secure traffic. However, it c… </div></div><!----></div><hr><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h2><p><a href="https://kubernetes.io" target="_blank" rel="noopener noreferrer">Kubernetes</a> is a popular way to host websites and other services that benefit from its reliability and scalability. As more websites interact with sensitive data, such as personal information or passwords, browsers are starting to require that all websites use <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank" rel="noopener noreferrer">TLS</a> to secure their traffic. However, it can be difficult to manage all the moving parts required to host a TLS-based site, from acquiring TLS certificate to renewing those certificates on time and configuring your server to use them.</p><p>Fortunately, there are services you can run in your Kubernetes cluster to manage a lot of this complexity for you. You can use <a href="https://traefik.io/traefik" target="_blank" rel="noopener noreferrer">Traefik Proxy</a> (pronounced like “traffic”) as a network proxy with <a href="https://cert-manager.io" target="_blank" rel="noopener noreferrer">cert-manager</a> as the service that acquires and manages secure certificates. Using these services with <a href="https://letsencrypt.org" target="_blank" rel="noopener noreferrer">Let’s Encrypt</a>, a provider of free and automated secure certificates, reduces the burden of managing your certificates, typically to the point where you only need to do the initial setup.</p><p>In this tutorial, you will set up cert-manager, Traefik, and Let’s Encrypt in your Kubernetes cluster, along with an example website service, to acquire, renew, and use secure certificates with your website automatically.</p><p>If you’re looking for a managed Kubernetes hosting service, <a href="https://digitalocean.com/products/kubernetes" target="_blank" rel="noopener noreferrer">check out our simple, managed Kubernetes service built for growth.</a></p><div class="hint-container note"><p class="hint-container-title">Prerequisites</p><ul><li>A Kubernetes cluster accessible with <code>kubectl</code>. If you need to create a cluster, DigitalOcean has a <a href="https://docs.digitalocean.com/products/kubernetes/quickstart" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Kubernetes Quickstart</a>.</li><li>A recent version of <code>kubectl</code> for interacting with your cluster. See the product documentation for <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-linux" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>installing <code>kubectl</code> on Linux, MacOS, and Windows</a>.</li><li>A DigitalOcean account with doctl installed and configured. To set this up, see our product documentation for <a href="https://docs.digitalocean.com/reference/doctl/how-to/install" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>How To Install and Configure <code>doctl</code></a>.</li><li><a href="https://helm.sh" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Helm</a> version 3 or greater. See the official documentation for <a href="https://helm.sh/docs/intro/install" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>installing Helm</a>.</li><li>Experience interacting with a Kubernetes cluster using <code>kubectl</code>. To get started, follow our tutorial, <a href="https://docs.digitalocean.com/tutorials/build-deploy-first-image" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Build and Deploy Your First Image to Your First Cluster</a>.</li><li>A registered domain name. This tutorial will use <code>your_domain</code>. You can purchase a domain name from <a href="https://www.namecheap.com" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Namecheap</a>, get one for free with <a href="https://www.freenom.com/en/index.html?lang=en" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Freenom</a>, or use the domain registrar of your choice.</li><li>DNS set up for your domain name. This tutorial assumes you are using DigitalOcean DNS, but it is not a requirement. If you are using DigitalOcean, please see our <a href="https://docs.digitalocean.com/products/networking/dns/how-to/add-domains" target="_blank" rel="noopener noreferrer">DNS documentation</a> for details on how to add a domain and <a href="https://docs.digitalocean.com/tutorials/dns-registrars" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>How To Point to DigitalOcean Nameservers From Common Domain Registrars</a> for information on using DigitalOcean DNS with common domain registrars.</li><li>A <a href="https://docs.digitalocean.com/reference/api/create-personal-access-token" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Personal Access Token</a> with read and write access for DigitalOcean DNS, if you are using DigitalOcean for DNS. Other providers will have similar access tokens.</li></ul></div><hr><h2 id="step-1-—-setting-up-cert-manager-in-your-cluster" tabindex="-1"><a class="header-anchor" href="#step-1-—-setting-up-cert-manager-in-your-cluster"><span>Step 1 — Setting Up cert-manager in Your Cluster</span></a></h2><p>Traditionally, when setting up secure certificates for a website, you would need to generate a <a href="https://en.wikipedia.org/wiki/Certificate_signing_request" target="_blank" rel="noopener noreferrer"><i class="vp-icon fa-brands fa-wikipedia-w" sizing="height"></i>certificate signing request</a> and pay a trusted <a href="https://en.wikipedia.org/wiki/Certificate_authority" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>certificate authority</a> to generate a certificate for you. You would then need to configure your web server to use that certificate and remember to go through that same process every year to keep your certificates up-to-date.</p><p>However, with the creation of <a href="https://letsencrypt.org" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Let’s Encrypt</a> in 2014, it’s now possible to acquire free certificates through an automated process. These certificates are only valid for a few months instead of a year, though, so using an automated system to renew those certificates is a requirement. To handle that, you’ll use <a href="https://cert-manager.io" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>cert-manager</a>, a service designed to run in Kubernetes that automatically manages the lifecycle of your certificates.</p><p>In this section, you will set up <code>cert-manager</code> to run in your cluster in its own cert-manager namespace.</p><p>First, <a href="https://cert-manager.io/docs/installation" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>install cert-manager</a> using <code>kubectl</code> with cert-manager’s release file:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-f</span> https://github.com/cert-manager/cert-manager/releases/download/v1.9.1/cert-manager.yaml</span>
<span class="line"><span class="token comment"># namespace/cert-manager created</span></span>
<span class="line"><span class="token comment"># customresourcedefinition.apiextensions.k8s.io/certificaterequests.cert-manager.io created</span></span>
<span class="line"><span class="token comment"># customresourcedefinition.apiextensions.k8s.io/certificates.cert-manager.io created</span></span>
<span class="line"><span class="token comment"># ...</span></span>
<span class="line"><span class="token comment"># deployment.apps/cert-manager-cainjector created</span></span>
<span class="line"><span class="token comment"># deployment.apps/cert-manager created</span></span>
<span class="line"><span class="token comment"># deployment.apps/cert-manager-webhook created</span></span>
<span class="line"><span class="token comment"># mutatingwebhookconfiguration.admissionregistration.k8s.io/cert-manager-webhook created</span></span>
<span class="line"><span class="token comment"># validatingwebhookconfiguration.admissionregistration.k8s.io/cert-manager-webhook created</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>By default, cert-manager will install in its own namespace named <code>cert-manager</code>. As the file is applied, a number of resources will be created in your cluster, which will appear in your output (some of the output is removed due to length):</p><p>In this section, you installed cert-manager to manage your secure certificates. Now, you need to set up a way to tell cert-manager how you want your certificates to be issued. In the next section, you’ll set up a Let’s Encrypt issuer in your cluster.</p><hr><h2 id="step-2-—-configuring-the-let-s-encrypt-certificate-issuer" tabindex="-1"><a class="header-anchor" href="#step-2-—-configuring-the-let-s-encrypt-certificate-issuer"><span>Step 2 — Configuring the Let’s Encrypt Certificate Issuer</span></a></h2><p>Using a secure certificate for your website is a way to tell your users they can trust that the site they’re viewing came from your servers. To do this, the certificate authority must validate that you own the domain the certificate is for. Let’s Encrypt does this by using a standard called <a href="https://datatracker.ietf.org/doc/html/rfc8555" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>ACME</a>, which uses <a href="https://letsencrypt.org/docs/challenge-types" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>challenges</a> to prove you own the domain you’re generating a certificate for. cert-manager supports both DNS and HTTP challenges for various providers, but in this tutorial, you’ll use the <a href="https://letsencrypt.org/docs/challenge-types/#dns-01-challenge" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>DNS-01</a> challenge with DigitalOcean’s DNS provider.</p><p>In this section, you will create a <a href="https://cert-manager.io/docs/concepts/issuer/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i><code>ClusterIssuer</code></a> for your cluster to tell cert-manager how to issue certificates from Let’s Encrypt and which credentials to use to complete the DNS challenges required by Let’s Encrypt.</p><div class="hint-container tip"><p class="hint-container-title">Note</p><p>This tutorial assumes you are using DigitalOcean for your DNS provider and configures the <code>ClusterIssuer</code> with that assumption. cert-manager supports a number of different cloud providers for both HTTP and DNS challenges, so the same concepts can be applied to them.</p><p>For more information about other providers supported by cert-manager, see the <a href="https://cert-manager.io/docs/configuration/acme" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>ACME Introduction</a> in cert-manager’s documentation.</p></div><p>Before you create the <code>ClusterIssuer</code> for your cluster, you’ll want to create a directory for your cluster configuration. Use the <code>mkdir</code> command to create a directory and then <code>cd</code> to enter that directory:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">mkdir</span> tutorial-cluster-config</span>
<span class="line"><span class="token builtin class-name">cd</span> tutorial-cluster-config</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Once you’ve created your directory, you’ll need the <a href="https://docs.digitalocean.com/reference/api/create-personal-access-token/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Personal Access Token</a> for DNS access that you created as part of this tutorial’s prerequisites. A DigitalOcean access token will look similar to <code>dop_v1_4321...</code> with a long string of numbers.</p><!-- TODO code highlight to yellow --><p>To store your access token as a secret in Kubernetes, you’ll need to <a href="https://en.wikipedia.org/wiki/Base64" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>base-64</a> encode it. To do this, you can use the echo command to pipe your token to the <code>base64</code> command, replacing the highlighted portion with your access token</p><p>This command will send your access token from <code>echo</code> to the <code>base64</code> command to encode it. The <code>-n</code> option ensures that a new line isn’t included at the end. Depending on your access token, you will receive output similar to the following:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">&#39;dop_v1_4321...&#39;</span> <span class="token operator">|</span> base64</span>
<span class="line"><span class="token comment"># ZG9wX3YxX3RoaXNpc25vdGFyZWFsdG9rZW5idXRpbXB1dHRpbmdhYnVuY2hvZnN0dWZmaW5oZXJlc29sZW5ndGhzbWF0Y2g=</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>This output is your base-64 encoded access token. Copy this because you’ll be using it next.</p><p>Using <code>nano</code> or your favorite editor, create and open a new file called <i class="vp-icon iconfont icon-yaml" sizing="height"></i><code>lets-encrypt-do-dns.yaml</code>:</p><h3 id="tutorial-cluster-config-ltutorial-cluster-config-lets-encrypt-do-dns-yaml" tabindex="-1"><a class="header-anchor" href="#tutorial-cluster-config-ltutorial-cluster-config-lets-encrypt-do-dns-yaml"><span><i class="vp-icon iconfont icon-yaml" sizing="height"></i><code>tutorial-cluster-config/ltutorial-cluster-config/lets-encrypt-do-dns.yaml</code></span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Secret</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> cert<span class="token punctuation">-</span>manager</span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> lets<span class="token punctuation">-</span>encrypt<span class="token punctuation">-</span>do<span class="token punctuation">-</span>dns</span>
<span class="line"><span class="token key atrule">data</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">access-token</span><span class="token punctuation">:</span> ZG9wX3Y<span class="token punctuation">...</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This <code>Secret</code> will be called <code>lets-encrypt-do-dns</code> and is stored in the namespace <code>cert-manager</code>. In the <code>data</code> section, you include the base-64 encoded <code>access-token</code> you created earlier. This Secret securely stores the access token you will reference when creating the Let’s Encrypt issuer.</p><p>Next, save your file and apply it to the cluster using <code>kubectl apply</code>:</p><p>In the output, you’ll receive a message that your secret has been created in the cluster:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-f</span> lets-encrypt-do-dns.yaml</span>
<span class="line"><span class="token comment"># secret/lets-encrypt-do-dns created</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, create a new file named <i class="vp-icon iconfont icon-yaml" sizing="height"></i><code>lets-encrypt-issuer.yaml</code> to contain cert-manager’s <code>ClusterIssuer</code>, which you’ll use to issue your Let’s Encrypt certificates:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">nano</span> lets-encrypt-issuer.yaml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Add the following lines, entering your email address in the <code>spec.acme.email</code> field (this is the address Let’s Encrypt will associate with the certificates it provides):</p><h3 id="tutorial-cluster-config-llets-encrypt-issuer-yaml" tabindex="-1"><a class="header-anchor" href="#tutorial-cluster-config-llets-encrypt-issuer-yaml"><span><i class="vp-icon iconfont icon-yaml" sizing="height"></i><code>tutorial-cluster-config/llets-encrypt-issuer.yaml</code></span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> cert<span class="token punctuation">-</span>manager.io/v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterIssuer</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt<span class="token punctuation">-</span>issuer</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">acme</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">email</span><span class="token punctuation">:</span> your_email_address</span>
<span class="line">    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//acme<span class="token punctuation">-</span>v02.api.letsencrypt.org/directory</span>
<span class="line">    <span class="token key atrule">privateKeySecretRef</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">name</span><span class="token punctuation">:</span> letsencrypt<span class="token punctuation">-</span>issuer<span class="token punctuation">-</span>account<span class="token punctuation">-</span>key</span>
<span class="line">    <span class="token key atrule">solvers</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">selector</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token key atrule">dns01</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">digitalocean</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token key atrule">tokenSecretRef</span><span class="token punctuation">:</span></span>
<span class="line">              <span class="token key atrule">name</span><span class="token punctuation">:</span> lets<span class="token punctuation">-</span>encrypt<span class="token punctuation">-</span>do<span class="token punctuation">-</span>dns</span>
<span class="line">              <span class="token key atrule">key</span><span class="token punctuation">:</span> access<span class="token punctuation">-</span>token</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the first two lines, the <code>apiVersion</code> and <code>kind</code> say this Kubernetes resource is a cert-manager <code>ClusterIssuer</code>. Next, you name it <code>letsencrypt-issuer</code>. In this case, you didn’t include a <code>namespace</code> field because the resource is a <code>Cluster</code> resource, meaning it applies to the entire cluster instead of a single namespace.</p><p>Next, in the <code>spec</code> section, you define the acme challenge section to tell cert-manager this <code>ClusterIssuer</code> should use ACME to issue certificates using the <code>letsencrypt-issuer</code>. The <code>email</code> is your email address to which Let’s Encrypt will send any certificate-related communications, such as renewal reminders if there’s a problem and cert-manager doesn’t renew them in time. The <code>server</code> field specifies the URL to contact for requesting the ACME challenges and is set to the production Let’s Encrypt URL. After the <code>server</code> field, you include the <code>privateKeySecretRef</code> field with the name of the secret that cert-manager will use to store its generated private key for your cluster.</p><p>One of the most important sections in the <code>spec.acme</code> section is the <code>solvers</code> section. In this section, you configure the ACME challenge solvers you want to use for the <code>letsencrypt-issuer</code>. In this case, you include a single solver, the <code>dns01</code> solver. The first part of the solver configuration, the <code>selector</code>, is configured to be <code>{}</code>, which means “anything.” If you wanted to use different solvers for other certificates in your cluster, you could set up additional selectors in the same issuer. You can find more information about how to do this in cert-manager’s <a href="https://cert-manager.io/docs/configuration/acme" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>ACME Introduction</a>.</p><p>Inside the <code>dns01</code> section, you add a <code>digitalocean</code> section to say this issuer should use DigitalOcean as the DNS-01 solver. If you are using a different cloud provider, this is where you would <a href="https://cert-manager.io/docs/configuration/acme/dns01" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>configure the other provider</a>. Inside this section, you include a <code>tokenSecretRef</code> to reference the <code>lets-encrypt-do-dns</code> <code>access-token</code> field of the <code>Secret</code> you created earlier. cert-manager will use this access token when creating DNS records on your behalf.</p><p>Once you’ve saved your issuer file, apply it to the cluster using <code>kubectl apply</code></p><p>The output will confirm that the <code>ClusterIssuer</code>, named <code>letsencrypt-issuer</code>, has been created:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-f</span> lets-encrypt-issuer.yaml</span>
<span class="line"><span class="token comment"># clusterissuer.cert-manager.io/letsencrypt-issuer created</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>In this section, you set up cert-manager and configured it to issue certificates from Let’s Encrypt. However, no certificates are being requested, nothing is serving your website, and you don’t have a website service running in your cluster. In the next section, you’ll set up Traefik as the <a href="https://en.wikipedia.org/wiki/Reverse_proxy" target="_blank" rel="noopener noreferrer"><i class="vp-icon fa-brands fa-wikipedia-w" sizing="height"></i>proxy</a> between the outside world and your websites.</p><hr><h2 id="step-3-—-using-a-load-balancer-with-traefik" tabindex="-1"><a class="header-anchor" href="#step-3-—-using-a-load-balancer-with-traefik"><span>Step 3 — Using a Load Balancer with Traefik</span></a></h2><p><a href="https://traefik.io/traefik/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Traefik</a> is an open-source <a href="https://en.wikipedia.org/wiki/Reverse_proxy" target="_blank" rel="noopener noreferrer"><i class="vp-icon fa-brands fa-wikipedia-w" sizing="height"></i>proxy</a> service designed to integrate with Kubernetes for website traffic and other network traffic coming in and out of your cluster. As your network traffic grows, you may want to increase the number of Traefik instances running in your cluster to spread out resource usage across different Kubernetes nodes. To use a single address to refer to multiple service instances like this, you can use a <a href="https://en.wikipedia.org/wiki/Load_balancing_(computing)" target="_blank" rel="noopener noreferrer"><i class="vp-icon fa-brands fa-wikipedia-w" sizing="height"></i>load balancer</a> to accept the network connections and send them to the different Traefik instances, in effect balacing the network traffic load.</p><p>In this section, you’ll install Traefik into your cluster and prepare it to be used with the certificates managed by cert-manager and the website you’ll add in Step 5. You will also set up a load balancer, which will send incoming network traffic to your Traefik service from outside your cluster, as well as prepare you to handle multiple instance of Traefik, should you choose to run them.</p><p>First, create a namespace called <code>traefik</code> where you’ll install Traefik. To do this, open a file named <i class="vp-icon iconfont icon-yaml" sizing="height"></i><code>traefik-ns.yaml</code>:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">nano</span> traefik-ns.yaml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Enter a Kubernetes <code>Namespace</code> resource:</p><blockquote><p>.<i class="vp-icon fas fa-folder-open" sizing="height"></i><code>tutorial-cluster-config/</code><i class="vp-icon iconfont icon-yaml" sizing="height"></i><code>traefik-ns.yaml</code></p></blockquote><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Namespace</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> traefik</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>After saving your file, apply it to your cluster using <code>kubectl apply</code>.</p><p>Once your command runs, the cluster’s output will confirm that the namespace has been created:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl apply <span class="token parameter variable">-f</span> traefik-ns.yaml</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># namespace/traefik created</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>After creating the <code>traefik</code> namespace, you will install the Traefik service itself. For this, you’ll use a utility called <a href="https://helm.sh/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Helm</a>. Helm is a package manager for Kubernetes that makes installing Kubernetes services similar to installing an app on your computer. In Helm, a package is called a <a href="https://helm.sh/docs/topics/charts/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>chart</a>.</p><p>First, you’ll need to add the <code>traefik</code> Helm repository to your available repositories, which will allow Helm to find the <code>traefik</code> package.</p><p>Once the command completes, you’ll receive confirmation that the <code>traefik</code> repository has been added to your computer’s Helm repositories</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">helm repo <span class="token function">add</span> traefik https://helm.traefik.io/traefik</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># &quot;traefik&quot; has been added to your repositories</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next, update your chart repositories.</p><p>The output will confirm that the traefik chart repository has been updated:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">helm repo update</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># Hang tight while we grab the latest from your chart repositories...</span></span>
<span class="line"><span class="token comment"># ...Successfully got an update from the &quot;traefik&quot; chart repository</span></span>
<span class="line"><span class="token comment"># Update Complete. ⎈Happy Helming!⎈</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally, install <code>traefik</code> into the <code>traefik</code> namespace you created in your cluster.</p><p>Once you run the command, output similar to the following will print to the screen:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">helm <span class="token function">install</span> <span class="token parameter variable">--namespace</span><span class="token operator">=</span>traefik traefik traefik/traefik</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># NAME: traefik</span></span>
<span class="line"><span class="token comment"># LAST DEPLOYED: Sun Oct  2 16:32:57 2022</span></span>
<span class="line"><span class="token comment"># NAMESPACE: traefik</span></span>
<span class="line"><span class="token comment"># STATUS: deployed</span></span>
<span class="line"><span class="token comment"># REVISION: 1</span></span>
<span class="line"><span class="token comment"># TEST SUITE: None</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>There are a lot of <code>traefik</code>s in this command, so let’s go over what each one does. The first <code>traefik</code> in your command, with <code>--namespace=traefik</code>, tells Helm to install Traefik in the <code>traefik</code> namespace you created earlier. Next, the highlighted <code>traefik</code> is the name you want to give to this installation of Traefik in your cluster. This way, if you have multiple installations of Traefik in the same cluster, you can give them different names, such as <code>traefik-website1</code> and <code>traefik-website2</code>. Since you’ll only have one Traefik installation in your cluster right now, you can just use the name <code>traefik</code>. The third <code>traefik/</code> is the repository you added earlier and want to install from. Finally, the last <code>traefik</code> is the name of the chart you want to install.</p><p>Once the Helm chart is installed, Traefik will begin downloading on your cluster. To see whether Traefik is up and running, run <code>kubectl get all</code> to see all the Traefik resources created in the <code>traefik</code> namespace.</p><p>Your output will appear similar to the output below:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">kubectl get <span class="token parameter variable">-n</span> traefik all</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># NAME                           READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span class="token comment"># pod/traefik-858bb8459f-k4ztp   1/1     Running   0          94s</span></span>
<span class="line"><span class="token comment"># </span></span>
<span class="line"><span class="token comment"># NAME              TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                      AGE</span></span>
<span class="line"><span class="token comment"># service/traefik   LoadBalancer   10.245.77.251   &lt;pending&gt;     80:31981/TCP,443:30188/TCP   94s</span></span>
<span class="line"><span class="token comment"># </span></span>
<span class="line"><span class="token comment"># NAME                      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span class="token comment"># deployment.apps/traefik   1/1     1            1           94s</span></span>
<span class="line"><span class="token comment"># </span></span>
<span class="line"><span class="token comment"># NAME                                 DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span class="token comment"># replicaset.apps/traefik-858bb8459f   1         1         1       94s</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Depending on your cluster and when you ran the previous command, some of the names and ages may be different. If you see <code>&lt;pending&gt;</code> under <code>EXTERNAL-IP</code> for your <code>service/traefik</code>, keep running the <code>kubectl get -n traefik all</code> command until an IP address is listed. The <code>EXTERNAL-IP</code> is the IP address the load balancer is available from on the internet. Once an IP address is listed, make note of that IP address as your <code>traefik_ip_address</code>. You’ll use this address in the next section to set up your domain.</p><p>In this section, you installed Traefik into your cluster and have an <code>EXTERNAL-IP</code> you can direct your website traffic to. In the next section, you’ll make the changes to your DNS to send traffic from your domain to the load balancer.</p><hr><h2 id="step-4-—-accessing-traefik-with-your-domain" tabindex="-1"><a class="header-anchor" href="#step-4-—-accessing-traefik-with-your-domain"><span>Step 4 — Accessing Traefik with Your Domain</span></a></h2><p>Now that you have Traefik set up in your cluster and accessible on the internet with a load balancer, you’ll need to update your domain’s DNS to point to your Traefik load balancer. Before you continue, be sure your domain is <a href="https://docs.digitalocean.com/products/networking/dns/how-to/add-domains/" target="_blank" rel="noopener noreferrer">added to your DigitalOcean account</a>. cert-manager will need to be able to update DNS settings for your domain using the access token you set up earlier. You’ll use doctl to set up your domain’s DNS records to point to Traefik’s load balancer.</p><div class="hint-container tip"><p class="hint-container-title">Note</p><p>This section assumes you’re using DigitalOcean as your DNS host. If you’re using a DNS host other than DigitalOcean, you’ll still create the same DNS record types with the same values, but you’ll need to refer to your DNS host’s documentation for how to add them.</p></div><p>First, create a DNS A record for your domain named <code>tutorial-proxy.your_domain</code> that points to your <code>traefik_ip_address</code>.</p><p>After running the command, you’ll receive confirmation that your record has been created:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">doctl compute domain records create your_domain --record-name tutorial-proxy --record-type A --record-data traefik_ip_address</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># ID           Type    Name              Data                  Priority    Port    TTL     Weight</span></span>
<span class="line"><span class="token comment"># 12345678     A       tutorial-proxy    traefik_ip_address    0           0       1800    0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A DNS <code>A</code> record tells the DNS to point a given hostname to a specific IP address. In this case, tutorial-proxy.<code>your_domain</code> will point to <code>traefik_ip_address</code>. So, if someone requests the website at tutorial-proxy.<code>your_domain</code>, the DNS servers will direct them to <code>traefik_ip_address</code>.</p><p>Now, create a <code>CNAME</code>-type DNS record named <code>tutorial-service.your_domain</code> and direct it to tutorial-proxy.<code>your_domain</code>. Since you’ll likely have several services running in your cluster at some point, using an A record to point each domain to your Traefik proxy could be a lot of work if you ever need to change your proxy’s IP address. Using a <code>CNAME</code> tells DNS to use the address of the domain it’s pointing to. In this case, the domain is <code>tutorial-proxy.your_domain</code>, so you only need to update your one A record to point to a new IP address instead of multiple A records.</p><p>To create the <code>CNAME</code> record, use the <code>doctl</code> command again. Be sure to include the trailing period (<code>.</code>) in <code>--record-data</code>.</p><p>After running the command, you will see output similar to the following:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">doctl compute domain records create your_domain <span class="token punctuation">\</span></span>
<span class="line">  --record-name tutorial-service <span class="token punctuation">\</span></span>
<span class="line">  --record-type CNAME <span class="token punctuation">\</span></span>
<span class="line">  --record-data tutorial-proxy.your_domain</span>
<span class="line"></span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># ID           Type     Name                Data                          Priority    Port    TTL     Weight</span></span>
<span class="line"><span class="token comment"># 12345679     CNAME    tutorial-service    tutorial-proxy.your_domain    0           0       1800    0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This will create your <code>tutorial-service.your_domain</code> CNAME DNS record pointing to tutorial-proxy.<code>your_domain</code>. Now, when someone requests <code>tutorial-service.your_domain</code>, the DNS server will tell them to connect to the IP address <code>tutorial-proxy.your_domain</code> is pointing to. The trailing <code>.</code> in the <code>--record-data</code> tells the DNS server that it’s the end of the domain being provided and it shouldn’t append any other information on the end, similar to how a period (<code>.</code>) is used to end a sentence.</p><p>Since DigitalOcean is your primary DNS server, you can query the server directly to determine whether it’s set up correctly instead of waiting for other DNS servers on the internet to be updated. To verify your settings are coming through the DNS servers correctly, use the <code>dig</code> command to view what <code>ns1.digitalocean.com</code>, DigitalOcean’s primary DNS server, thinks the records should be:</p><div class="hint-container tip"><p class="hint-container-title">Note</p><p>If you are using a DNS host other than DigitalOcean, replace <code>ns1.digitalocean.com</code> in this command with one of the DNS servers your DNS host had you set up on your domain.</p></div><p><a href="https://linux.die.net/man/1/dig" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i><code>dig</code></a> is a utility that connects directly to DNS servers to “dig” into the DNS records to find the one you’re looking for. In this case, you provide <code>@ns1.digitalocean.com</code> to tell <code>dig</code> you want to query the ns1.digitalocean.com server for its DNS records. The <code>+noall +answer</code> options tell <code>dig</code> to only output a shorter response. (You can remove these two options if you want more information about the DNS query.) For more about <code>dig</code>, check out our guide to <a href="https://docs.digitalocean.com/tutorials/use-dig/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Retrieve DNS Information Using Dig</a>.</p><p>Next, using <code>+domain=your_domain</code> tells <code>dig</code> to add <code>.your_domain</code> to the end of any hostnames provided to the command. Finally, <code>tutorial-proxy</code> and <code>tutorial-service</code> are the hostnames to look up. Since you’re using the <code>+domain</code> option, you don’t need to use the full phrase <code>tutorial-proxy.your_domain</code>, as it will automatically be added on the end.</p><p>You should receive output similar to the following, with your own values for <code>your_domain</code> and <code>traefik_ip_address</code>:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">dig</span> @ns1.digitalocean.com +noall +answer +domain<span class="token operator">=</span>your_domain tutorial-proxy tutorial-service</span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># tutorial-proxy.your_domain.	1662	IN	A	traefik_ip_address</span></span>
<span class="line"><span class="token comment"># tutorial-service.your_domain. 1800	IN	CNAME	tutorial-proxy.your_domain.</span></span>
<span class="line"><span class="token comment"># tutorial-proxy.your_domain.	1800	IN	A	traefik_ip_address</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The first line of the output shows that <code>tutorial-proxy.your_domain</code> is an <code>A</code> (<code>IN A</code>) record that points to <code>traefik_ip_address</code>. The second confirms that <code>tutorial-service.your_domain</code> is a <code>CNAME</code> (<code>IN CNAME</code>) record that points to <code>tutorial-proxy.your_domain</code>. Finally, the last line is the query <code>dig</code> runs to find the address your <code>CNAME</code> record points to. Since it’s <code>tutorial-proxy.your_domain</code>, it will show the same <code>A</code> record IP address as before.</p><p>In this section, you added an <code>A</code>-type DNS record and a <code>CNAME</code>-type DNS record to your domain so that network clients, such as browsers, know where to go to connect to your Traefik service. In the next section, you’ll set up a temporary web server in your cluster to complete your configuration.</p><hr><h2 id="step-5-—-creating-your-web-service" tabindex="-1"><a class="header-anchor" href="#step-5-—-creating-your-web-service"><span>Step 5 — Creating Your Web Service</span></a></h2><hr><h2 id="step-6-—-making-your-web-service-available-and-secure" tabindex="-1"><a class="header-anchor" href="#step-6-—-making-your-web-service-available-and-secure"><span>Step 6 — Making Your Web Service Available and Secure</span></a></h2><hr><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2><p>In this tutorial, you installed a few different services in your Kubernetes cluster to make it easier to run a website with secure certificates. You installed the cert-manager service to handle the lifecycle of TLS certificates issued from Let’s Encrypt. You installed Traefik to make your websites available outside your cluster and to use the TLS certificates issued by Let’s Encrypt. Lastly, you created an Nginx website in your cluster to test your cert-manager and Traefik configurations.</p><p>Now that you have cert-manager and Traefik configured in your cluster, you could also set up more websites with different <code>Ingress</code> resources to serve many websites from the same cluster with a single cert-manager and Traefik installation.</p><p>You can read the <a href="https://doc.traefik.io/traefik/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>Traefik Proxy documentation</a> for more about the different functionalities Traefik can provide in your cluster. <a href="https://cert-manager.io/docs/" target="_blank" rel="noopener noreferrer"><i class="vp-icon fas fa-globe" sizing="height"></i>cert-manager</a> also has extensive documentation on how to use it with other types of Let’s Encrypt challenges, as well as sources other than Let’s Encrypt.</p><p>To continue configuring your Kubernetes cluster, check out our other <a href="https://digitalocean.com/community/tags/kubernetes" target="_blank" rel="noopener noreferrer">tutorials on Kubernetes</a>.</p></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/chanhi2000/articles/edit/main/src/digitalocean.com/how-to-secure-your-site-in-kubernetes-with-cert-manager-traefik-and-let-s-encrypt.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/bookshelf/devops/k8s/articles/" aria-label="/devops/k8s/articles/"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->/devops/k8s/articles/</div></a><a class="route-link auto-link next" href="/bookshelf/digitalocean.com/how-to-run-serverless-workloads-with-knative-on-digitalocean-kubernetes.html" aria-label="How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes"><div class="hint">Next<span class="arrow end"></span></div><div class="link">How To Run Serverless Workloads with Knative on DigitalOcean Kubernetes<i class="vp-icon iconfont icon-k8s" sizing="height"></i></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">MIT Licensed | Copyright © 2022-present <a href="https://github.com/chanhi2000">Chan Hee Lee</a></div><!----></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/bookshelf/assets/app-BVguHYKu.js" defer></script>
  </body>
</html>
