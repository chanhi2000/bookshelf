<!doctype html>
<html lang="ko-KR" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.99" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°","image":["https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/1.png","https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/2.png","https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/3.png","https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/4.png","https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/5.png","https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/6.png","https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/7.png","https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/8.png","https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/9.png"],"dateModified":null,"author":[]}</script><meta property="og:url" content="https://chanhi2000.github.io/bookshelf/d2.naver.com/1203723.html"><meta property="og:site_name" content="ğŸ“šBookshelf"><meta property="og:title" content="Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°"><meta property="og:description" content="Article(s) > Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°"><meta property="og:type" content="article"><meta property="og:image" content="https://chanhi2000.github.io/bookshelf/assets/image/d2.naver.com/1203723/1.png"><meta property="og:locale" content="ko-KR"><meta property="article:tag" content="virtual-tread"><meta property="article:tag" content="jni"><meta property="article:tag" content="c++"><meta property="article:tag" content="cpp"><meta property="article:tag" content="spring"><meta property="article:tag" content="java"><meta property="article:tag" content="d2.naver.com"><meta property="article:tag" content="blog"><link rel="icon" href="/bookshelf/assets/icon/favicon.svg"><title>Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸° | ğŸ“šBookshelf</title><meta name="description" content="Article(s) > Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°">
    <link rel="preload" href="/bookshelf/assets/style-Bhb-QcDa.css" as="style"><link rel="stylesheet" href="/bookshelf/assets/style-Bhb-QcDa.css">
    
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/bookshelf/" aria-label="Take me home"><img class="vp-nav-logo" src="/bookshelf/assets/icon/favicon.svg" alt><!----><span class="vp-site-name hide-in-pad">ğŸ“šBookshelf</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/bookshelf/news.html" aria-label><!--[--><i class="vp-icon fas fa-rss" sizing="height"></i><!--]--><!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-keyboard" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/hackingwithswift.com/" aria-label="hackingwithswift.com"><!--[--><img class="vp-icon" src="https://hackingwithswift.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->hackingwithswift.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fcc/" aria-label="freecodecamp.org"><!--[--><img class="vp-icon" src="https://cdn.freecodecamp.org/universal/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->freecodecamp.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kodeco.com/" aria-label="kodeco.com"><!--[--><img class="vp-icon" src="https://kodeco.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->kodeco.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.kotzilla.io/" aria-label="blog.kotzilla.io"><!--[--><img class="vp-icon" src="https://blog.kotzilla.io/hubfs/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.kotzilla.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kt.academy/" aria-label="kt.academy"><!--[--><img class="vp-icon" src="https://kt.academy/logo.png" alt aria-hidden no-view sizing="both"><!--]-->kt.academy<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/droidcon.com/" aria-label="droidcon.com"><!--[--><img class="vp-icon" src="https://droidcon.com/wp-content/uploads/2021/07/favicon-300x300.png" alt aria-hidden no-view sizing="both"><!--]-->droidcon.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/outcomeschool.com/" aria-label="outcomeschool.com"><!--[--><img class="vp-icon" src="https://outcomeschool.com/static/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->outcomeschool.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/frontendmasters.com/" aria-label="frontendmasters.com"><!--[--><img class="vp-icon" src="https://frontendmasters.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->frontendmasters.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tricks.com/" aria-label="css-tricks.com"><!--[--><img class="vp-icon" src="https://css-tricks.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->css-tricks.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="smashingmagazine.com"><!--[--><img class="vp-icon" src="https://smashingmagazine.com/images/favicon/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->smashingmagazine.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="oddbird.net"><!--[--><img class="vp-icon" src="https://oddbird.net/safari-pinned-tab.svg" alt aria-hidden no-view sizing="both"><!--]-->oddbird.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/zeroheight.com/" aria-label="zeroheight.com"><!--[--><img class="vp-icon" src="https://zeroheight.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->zeroheight.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/typescript.tv/" aria-label="typescript.tv"><!--[--><img class="vp-icon" src="https://typescript.tv/_astro/android-chrome-192x192.BhQ8hcWh.png" alt aria-hidden no-view sizing="both"><!--]-->typescript.tv<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.logrocket.com/" aria-label="blog.logrocket.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/blog.logrocket.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.logrocket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/realpython.com/" aria-label="realpython.com"><!--[--><img class="vp-icon" src="https://realpython.com/static/favicon.68cbf4197b0c.png" alt aria-hidden no-view sizing="both"><!--]-->realpython.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/digitalocean.com/" aria-label="digitalocean.com"><!--[--><img class="vp-icon" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt aria-hidden no-view sizing="both"><!--]-->digitalocean.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/antonioleiva.com/" aria-label="antonioleiva.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/antonioleiva.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->antonioleiva.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/johnnyreilly.com/" aria-label="johnnyreilly.com"><!--[--><img class="vp-icon" src="https://johnnyreilly.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->johnnyreilly.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/code-maze.com/" aria-label="code-maze.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/code-maze.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->code-maze.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/milanjovanovic.tech/" aria-label="milanjovanovic.tech"><!--[--><img class="vp-icon" src="https://milanjovanovic.tech/profile_favicon.png" alt aria-hidden no-view sizing="both"><!--]-->milanjovanovic.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/shopify.engineering/" aria-label="shopify.engineering"><!--[--><img class="vp-icon" src="https://cdn.shopify.com/static/shopify-favicon.png" alt aria-hidden no-view sizing="both"><!--]-->shopify.engineering<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devtoolstips.org/" aria-label="devtoolstips.org"><!--[--><img class="vp-icon" src="https://devtoolstips.org/assets/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devtoolstips.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/piccalil.li/" aria-label="piccalil.li"><!--[--><img class="vp-icon" src="https://piccalil.li/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->piccalil.li<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/sitepoint.com/" aria-label="sitepoint.com"><!--[--><img class="vp-icon" src="https://sitepoint.com/favicons/512x512.png" alt aria-hidden no-view sizing="both"><!--]-->sitepoint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/event-driven.io/" aria-label="event-driven.io"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/event-driven.io/favicon.jfif" alt aria-hidden no-view sizing="both"><!--]-->event-driven.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/packagemain.tech/" aria-label="packagemain.tech"><!--[--><img class="vp-icon" src="https://substack-post-media.s3.amazonaws.com/public/images/2ea54e25-eaa6-4630-bfc0-10b8cfdce894/apple-touch-icon-1024x1024.png" alt aria-hidden no-view sizing="both"><!--]-->packagemain.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/gosolve.io/" aria-label="gosolve.io"><!--[--><img class="vp-icon" src="https://gosolve.io/wp-content/uploads/2022/03/cropped-ikona1-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->gosolve.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/bram.us/" aria-label="bram.us"><!--[--><img class="vp-icon" src="https://bram.us/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->bram.us<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/una.im/" aria-label="una.im"><!--[--><img class="vp-icon" src="https://una.im/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->una.im<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/joshwcomeau.com/" aria-label="joshwcomeau.com"><!--[--><img class="vp-icon" src="https://joshwcomeau.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->joshwcomeau.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tip.com/" aria-label="css-tip.com"><!--[--><img class="vp-icon" src="https://css-tip.com/img/fav.png" alt aria-hidden no-view sizing="both"><!--]-->css-tip.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/nerdy.dev/" aria-label="nerdy.dev"><!--[--><img class="vp-icon" src="https://nerdy.dev/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->nerdy.dev<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/towardsdatascience.com/" aria-label="towardsdatascience.com"><!--[--><img class="vp-icon" src="https://cdn-images-1.medium.com/v2/resize:fill:128:128/1*VzTUkfeGymHP4Bvav-T-lA.png" alt aria-hidden no-view sizing="both"><!--]-->towardsdatascience.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/douggregor.net/" aria-label="douggregor.net"><!--[--><i class="vp-icon fas fa-globe" sizing="both"></i><!--]-->douggregor.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/bookshelf/d2.naver.com/" aria-label="d2.naver.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/d2.naver.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->d2.naver.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakao.com/" aria-label="tech.kakao.com"><!--[--><img class="vp-icon" src="https://www.kakaocorp.com/page/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakao.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakaopay.com/" aria-label="tech.kakaopay.com"><!--[--><img class="vp-icon" src="https://tech.kakaopay.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakaopay.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fe-developers.kakaoent.com/" aria-label="fe-developers.kakaoent.com"><!--[--><img class="vp-icon" src="https://fe-developers.kakaoent.com/favicon-32x32.png?v=44803cb16c1e2debd3984cf2e8cb2ded" alt aria-hidden no-view sizing="both"><!--]-->fe-developers.kakaoent.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/yozm.wishket.com/" aria-label="yozm.wishket.com"><!--[--><img class="vp-icon" src="https://yozm.wishket.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->yozm.wishket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/popit.kr/" aria-label="popit.kr"><!--[--><img class="vp-icon" src="https://popit.kr/wp-content/uploads/2016/08/favicon_32x32.png" alt aria-hidden no-view sizing="both"><!--]-->popit.kr<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devkuma.com/" aria-label="devkuma.com"><!--[--><img class="vp-icon" src="https://devkuma.com/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devkuma.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.gangnamunni.com/" aria-label="blog.gangnamunni.com"><!--[--><img class="vp-icon" src="https://blog.gangnamunni.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->blog.gangnamunni.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/codingeverybody.kr/" aria-label="codingeverybody.kr"><!--[--><img class="vp-icon" src="https://codingeverybody.kr/wp-content/uploads/cropped-favicon-origin-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->codingeverybody.kr<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-network-wired" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tecmint.com/" aria-label="tecmint.com"><!--[--><img class="vp-icon" src="https://tecmint.com/wp-content/uploads/2020/07/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tecmint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/docker.com/" aria-label="docker.com"><!--[--><img class="vp-icon" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->docker.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/learnkube.com/" aria-label="learnkube.com"><!--[--><img class="vp-icon" src="https://static.learnkube.com/f7e5160d4744cf05c46161170b5c11c9.svg" alt aria-hidden no-view sizing="both"><!--]-->learnkube.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/itsfoss.com/" aria-label="itsfoss.com"><!--[--><img class="vp-icon" src="https://itsfoss.com/content/images/size/w256h256/2022/12/android-chrome-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->itsfoss.com<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/chanhi2000/bookshelf" target="_blank" rel="noopener noreferrer" aria-label="Github"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><!----></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><img class="vp-icon" src="/bookshelf/assets/image/d2.naver.com/favicon.ico" alt aria-hidden no-view sizing="both"><span class="vp-sidebar-title">d2.naver.com</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2025</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">2024</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/8149881.html" aria-label="GitHub Actionsë¥¼ ì´ìš©í•œ ì½”ë“œ ë¦¬ë·° ë¬¸í™” ê°œì„ ê¸°"><!--[--><i class="vp-icon iconfont icon-github" sizing="both"></i><!--]-->GitHub Actionsë¥¼ ì´ìš©í•œ ì½”ë“œ ë¦¬ë·° ë¬¸í™” ê°œì„ ê¸°<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/7989422.html" aria-label="ì‹¤ì‹œê°„ ê´‘ê³  ì‚¬ìš©ì ID ë§¤í•‘"><!--[--><i class="vp-icon fa-brands fa-python" sizing="both"></i><!--]-->ì‹¤ì‹œê°„ ê´‘ê³  ì‚¬ìš©ì ID ë§¤í•‘<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1623894.html" aria-label="ë„¤ì´ë²„ ê²€ìƒ‰ SRE - ì§€ì§„ê³¼ ë¹„ìƒ ëŒ€ì‘ ì‹œìŠ¤í…œ"><!--[--><i class="vp-icon fas fa-pen-ruler" sizing="both"></i><!--]-->ë„¤ì´ë²„ ê²€ìƒ‰ SRE - ì§€ì§„ê³¼ ë¹„ìƒ ëŒ€ì‘ ì‹œìŠ¤í…œ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/0281668.html" aria-label="ë„¤ì´ë²„ ê²€ìƒ‰ SRE - ìƒìœ„ ë ˆë²¨ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ"><!--[--><i class="vp-icon fas fa-pen-ruler" sizing="both"></i><!--]-->ë„¤ì´ë²„ ê²€ìƒ‰ SRE - ìƒìœ„ ë ˆë²¨ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/5088940.html" aria-label="infer, neverë§Œ ë³´ë©´ ë‘ë ¤ì›Œì§€ëŠ” ë‹¹ì‹ ì„ ìœ„í•œ íƒ€ì… ì¶”ë¡  - ì‘ìš© ë¬¸ì œ"><!--[--><i class="vp-icon iconfont icon-typescript" sizing="both"></i><!--]-->infer, neverë§Œ ë³´ë©´ ë‘ë ¤ì›Œì§€ëŠ” ë‹¹ì‹ ì„ ìœ„í•œ íƒ€ì… ì¶”ë¡  - ì‘ìš© ë¬¸ì œ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/3713986.html" aria-label="infer, neverë§Œ ë³´ë©´ ë‘ë ¤ì›Œì§€ëŠ” ë‹¹ì‹ ì„ ìœ„í•œ íƒ€ì… ì¶”ë¡  - ê³ ê¸‰ íƒ€ì… ì¶”ë¡ "><!--[--><i class="vp-icon iconfont icon-typescript" sizing="both"></i><!--]-->infer, neverë§Œ ë³´ë©´ ë‘ë ¤ì›Œì§€ëŠ” ë‹¹ì‹ ì„ ìœ„í•œ íƒ€ì… ì¶”ë¡  - ê³ ê¸‰ íƒ€ì… ì¶”ë¡ <!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/9283310.html" aria-label="infer, neverë§Œ ë³´ë©´ ë‘ë ¤ì›Œì§€ëŠ” ë‹¹ì‹ ì„ ìœ„í•œ íƒ€ì… ì¶”ë¡  - ê¸°ì´ˆ íƒ€ì… ì´ë¡ "><!--[--><i class="vp-icon iconfont icon-typescript" sizing="both"></i><!--]-->infer, neverë§Œ ë³´ë©´ ë‘ë ¤ì›Œì§€ëŠ” ë‹¹ì‹ ì„ ìœ„í•œ íƒ€ì… ì¶”ë¡  - ê¸°ì´ˆ íƒ€ì… ì´ë¡ <!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/7321313.html" aria-label="ì‹œê°„ì€ ê¸ˆì´ë‹¤: LLMì„ ì´ìš©í•œ AI ì½”ë“œ ë¦¬ë·° ë„ì…ê¸°"><!--[--><i class="vp-icon fas fa-language" sizing="both"></i><!--]-->ì‹œê°„ì€ ê¸ˆì´ë‹¤: LLMì„ ì´ìš©í•œ AI ì½”ë“œ ë¦¬ë·° ë„ì…ê¸°<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/7282210.html" aria-label="ë³´ë‚¼ ë¡œê·¸ê°€ 1000ê°œê°€ ë˜ëŠ”ë™ì•ˆ ê²ªì—ˆë˜ ê³ ë¯¼ë“¤"><!--[--><i class="vp-icon fa-brands fa-android" sizing="both"></i><!--]-->ë³´ë‚¼ ë¡œê·¸ê°€ 1000ê°œê°€ ë˜ëŠ”ë™ì•ˆ ê²ªì—ˆë˜ ê³ ë¯¼ë“¤<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/2905424.html" aria-label="Kubernetesì—ì„œ DNS ë‹¤ë£¨ëŠ” ë°©ë²• - ë„ë©”ì¸ì„ ì°¾ì•„ì„œ"><!--[--><i class="vp-icon iconfont icon-k8s" sizing="both"></i><!--]-->Kubernetesì—ì„œ DNS ë‹¤ë£¨ëŠ” ë°©ë²• - ë„ë©”ì¸ì„ ì°¾ì•„ì„œ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/8011540.html" aria-label="Writing Path: MBTI Jì²˜ëŸ¼ ì²´ê³„ì ìœ¼ë¡œ ê¸€ì“°ëŠ” AI"><!--[--><i class="vp-icon fas fa-language" sizing="both"></i><!--]-->Writing Path: MBTI Jì²˜ëŸ¼ ì²´ê³„ì ìœ¼ë¡œ ê¸€ì“°ëŠ” AI<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/7030870.html" aria-label="ë””ìì¸ì‹œìŠ¤í…œì„ ê°œë°œì—ì„œ ì ìš© í•˜ëŠ”ë²•"><!--[--><i class="vp-icon fa-brands fa-figma" sizing="both"></i><!--]-->ë””ìì¸ì‹œìŠ¤í…œì„ ê°œë°œì—ì„œ ì ìš© í•˜ëŠ”ë²•<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/0623656.html" aria-label="DESIGN SYSTEM FOR Android: From Figma to Jetpack Compose"><!--[--><i class="vp-icon fa-brands fa-figma" sizing="both"></i><!--]-->DESIGN SYSTEM FOR Android: From Figma to Jetpack Compose<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/0680815.html" aria-label="ì‹¤ì‹œê°„ ê´‘ê³  ì‚¬ìš©ì ID ë§¤í•‘"><!--[--><i class="vp-icon iconfont icon-apachespark" sizing="both"></i><!--]-->ì‹¤ì‹œê°„ ê´‘ê³  ì‚¬ìš©ì ID ë§¤í•‘<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/7472830.html" aria-label="infer, neverë§Œ ë³´ë©´ ë‘ë ¤ì›Œì§€ëŠ” ë‹¹ì‹ ì„ ìœ„í•œ ê³ ê¸‰ TypeScript"><!--[--><i class="vp-icon iconfont icon-typescript" sizing="both"></i><!--]-->infer, neverë§Œ ë³´ë©´ ë‘ë ¤ì›Œì§€ëŠ” ë‹¹ì‹ ì„ ìœ„í•œ ê³ ê¸‰ TypeScript<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/5564264.html" aria-label="ì¿ ë²„ë„¤í‹°ìŠ¤ ë„¤ì´í‹°ë¸Œ ì‚¬ì´ë“œì¹´ ì»¨í…Œì´ë„ˆ (Sidecar Containers)"><!--[--><i class="vp-icon iconfont icon-k8s" sizing="both"></i><!--]-->ì¿ ë²„ë„¤í‹°ìŠ¤ ë„¤ì´í‹°ë¸Œ ì‚¬ì´ë“œì¹´ ì»¨í…Œì´ë„ˆ (Sidecar Containers)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/2461452.html" aria-label="UX ì›ì¹™ì— ë”°ë¥¸ NELO 4.0 ê°œë°œê¸°"><!--[--><i class="vp-icon fas fa-pen-ruler" sizing="both"></i><!--]-->UX ì›ì¹™ì— ë”°ë¥¸ NELO 4.0 ê°œë°œê¸°<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/8113611.html" aria-label="ë„¤ì´ë²„ í†µí•© ê²€ìƒ‰ì˜ ì›¹ ì„±ëŠ¥ - ëª¨ë‹ˆí„°ë§ê³¼ ì„±ëŠ¥ ê°œì„ "><!--[--><i class="vp-icon fas fa-gauge" sizing="both"></i><!--]-->ë„¤ì´ë²„ í†µí•© ê²€ìƒ‰ì˜ ì›¹ ì„±ëŠ¥ - ëª¨ë‹ˆí„°ë§ê³¼ ì„±ëŠ¥ ê°œì„ <!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/6507662.html" aria-label="Golang, ê·¸ëŒ€ë“¤ì€ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€ - 4. error í•¸ë“¤ë§"><!--[--><i class="vp-icon fa-brands fa-golang" sizing="both"></i><!--]-->Golang, ê·¸ëŒ€ë“¤ì€ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€ - 4. error í•¸ë“¤ë§<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/2690202.html" aria-label="Golang, ê·¸ëŒ€ë“¤ì€ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€ - 3. error ë˜í•‘"><!--[--><i class="vp-icon fa-brands fa-golang" sizing="both"></i><!--]-->Golang, ê·¸ëŒ€ë“¤ì€ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€ - 3. error ë˜í•‘<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/6178029.html" aria-label="Golang, ê·¸ëŒ€ë“¤ì€ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€ - 2. MongoDB Go Driver ì¶”ìƒí™”"><!--[--><i class="vp-icon fa-brands fa-golang" sizing="both"></i><!--]-->Golang, ê·¸ëŒ€ë“¤ì€ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€ - 2. MongoDB Go Driver ì¶”ìƒí™”<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/8588537.html" aria-label="Golang, ê·¸ëŒ€ë“¤ì€ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€ - 1. ë“¤ì–´ê°€ë©°"><!--[--><i class="vp-icon fa-brands fa-golang" sizing="both"></i><!--]-->Golang, ê·¸ëŒ€ë“¤ì€ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€ - 1. ë“¤ì–´ê°€ë©°<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/9581727.html" aria-label="ì¼ 3,000ë§Œ ê±´ì˜ ë„¤ì´ë²„í˜ì´ ì£¼ë¬¸ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” Kafka ì‹œìŠ¤í…œì˜ ë¬´ì¤‘ë‹¨ ì „í™˜ ì‚¬ë¡€"><!--[--><i class="vp-icon iconfont icon-apachekafka" sizing="both"></i><!--]-->ì¼ 3,000ë§Œ ê±´ì˜ ë„¤ì´ë²„í˜ì´ ì£¼ë¬¸ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” Kafka ì‹œìŠ¤í…œì˜ ë¬´ì¤‘ë‹¨ ì „í™˜ ì‚¬ë¡€<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/bookshelf/d2.naver.com/1203723.html" aria-label="Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°"><!--[--><i class="vp-icon iconfont icon-spring" sizing="both"></i><!--]-->Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/8404108.html" aria-label="í”„ë¡œíŒŒì¼ë§ ì ìš©ê¸° - ë‹¹ì‹ ì˜ Go ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì¢€ ë” ë‚˜ì•„ì§ˆ ìˆ˜ ìˆë‹¤"><!--[--><i class="vp-icon fa-brands fa-golang" sizing="both"></i><!--]-->í”„ë¡œíŒŒì¼ë§ ì ìš©ê¸° - ë‹¹ì‹ ì˜ Go ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì¢€ ë” ë‚˜ì•„ì§ˆ ìˆ˜ ìˆë‹¤<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2023</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2022</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2021</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2020</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2019</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2018</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2017</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1329.html" aria-label="Java Garbage Collection"><!--[--><i class="vp-icon fa-brands fa-java" sizing="both"></i><!--]-->Java Garbage Collection<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1336.html" aria-label="WebSocketê³¼ Socket.io"><!--[--><i class="vp-icon fa-brands fa-java" sizing="both"></i><!--]-->WebSocketê³¼ Socket.io<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1341.html" aria-label="Spring-Test-MVC í”„ë¡œì íŠ¸ ì†Œê°œ"><!--[--><i class="vp-icon iconfont icon-spring" sizing="both"></i><!--]-->Spring-Test-MVC í”„ë¡œì íŠ¸ ì†Œê°œ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/994.html" aria-label="AMIGO - í–‰ìœ„ ê¸°ë°˜ ì•…ì„±ì½”ë“œ íƒì§€"><!--[--><i class="vp-icon fas fa-shield-halved" sizing="both"></i><!--]-->AMIGO - í–‰ìœ„ ê¸°ë°˜ ì•…ì„±ì½”ë“œ íƒì§€<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1011.html" aria-label="Git vs. Mercurial"><!--[--><i class="vp-icon iconfont icon-git" sizing="both"></i><!--]-->Git vs. Mercurial<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1016.html" aria-label="Hadoopê³¼ MongoDBë¥¼ ì´ìš©í•œ ë¡œê·¸ë¶„ì„ì‹œìŠ¤í…œ"><!--[--><i class="vp-icon iconfont icon-hadoop" sizing="both"></i><!--]-->Hadoopê³¼ MongoDBë¥¼ ì´ìš©í•œ ë¡œê·¸ë¶„ì„ì‹œìŠ¤í…œ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1039.html" aria-label="NoSQL ê°€ìš©ì„±ê³¼ ìš´ì˜ ì•ˆì •ì„±"><!--[--><i class="vp-icon iconfont icon-apachecassandra" sizing="both"></i><!--]-->NoSQL ê°€ìš©ì„±ê³¼ ìš´ì˜ ì•ˆì •ì„±<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1042.html" aria-label="ë¶„ì‚° ê³ ì† ì €ì¥ì†Œ nStore"><!--[--><i class="vp-icon fas fa-database" sizing="both"></i><!--]-->ë¶„ì‚° ê³ ì† ì €ì¥ì†Œ nStore<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1052.html" aria-label="RTCS ì‹¤ì‹œê°„ ì›¹ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ë„ì „"><!--[--><i class="vp-icon fa-brands fa-js" sizing="both"></i><!--]-->RTCS ì‹¤ì‹œê°„ ì›¹ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ë„ì „<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/d2.naver.com/1062.html" aria-label="uMonì˜ ì´í•´"><!--[--><i class="vp-icon fas fa-pen-ruler" sizing="both"></i><!--]-->uMonì˜ ì´í•´<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon iconfont icon-spring" sizing="height"></i>Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°</h1><div class="page-info"><!----><!----><!----><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 7 min</span><meta property="timeRequired" content="PT7M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8" role>Java</span><span class="page-category-item color1" role>Spring</span><span class="page-category-item color6" role>C++</span><span class="page-category-item color4" role>Java Native Interface</span><span class="page-category-item color8" role>Article(s)</span><!--]--><meta property="articleSection" content="Java,Spring,C++,Java Native Interface,Article(s)"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8" role>blog</span><span class="page-tag-item color8" role>d2.naver.com</span><span class="page-tag-item color8" role>java</span><span class="page-tag-item color8" role>spring</span><span class="page-tag-item color4" role>cpp</span><span class="page-tag-item color8" role>c++</span><span class="page-tag-item color6" role>jni</span><span class="page-tag-item color4" role>virtual-tread</span><!--]--><meta property="keywords" content="blog,d2.naver.com,java,spring,cpp,c++,jni,virtual-tread"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="frontmatter-title-á„€á…ªá†«á„…á…§á†«" tabindex="-1"><a class="header-anchor" href="#frontmatter-title-á„€á…ªá†«á„…á…§á†«"><span>Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸° ê´€ë ¨</span></a></h1><a class="route-link vp-card" href="/bookshelf/programming/java-spring/articles/" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="https://chanhi2000.github.io/images/ico-wind.svg" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Spring > Article(s)</div><hr><div class="vp-card-desc">Article(s)</div></div></a><nav class="table-of-contents"><ul><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#jni" class="router-link-active router-link-exact-active">JNI</a></li><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#java-á„‰á…³á„…á…¦á„ƒá…³" class="router-link-active router-link-exact-active">Java ìŠ¤ë ˆë“œ</a></li><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#virtualthread-virtual-thread" class="router-link-active router-link-exact-active">virtualthread&quot;&gt;Virtual Thread</a><ul><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#virtual-thread-concepts" class="router-link-active router-link-exact-active">Virtual Thread concepts</a></li><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#virtual-thread-states" class="router-link-active router-link-exact-active">Virtual Thread states</a></li><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#virtual-thread-pinning" class="router-link-active router-link-exact-active">Virtual Thread pinning</a></li><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#virtual-thread-blocking" class="router-link-active router-link-exact-active">Virtual Thread blocking</a></li></ul></li><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#á„†á…¡á„á…µá„†á…§" class="router-link-active router-link-exact-active">ë§ˆì¹˜ë©°</a></li><li><a aria-current="page" href="/bookshelf/d2.naver.com/1203723.html#á„á…¡á†·á„€á…©-á„Œá…¡á„…á…­" class="router-link-active router-link-exact-active">ì°¸ê³  ìë£Œ</a></li></ul></nav><hr><div class="vp-site-info" data-name="Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸° | NAVER D2"><a class="vp-site-info-navigator no-external-link-icon" title="Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸° | NAVER D2" href="https://d2.naver.com/helloworld/1203723" target="_blank"></a><div class="vp-site-info-preview" style="background:url(/bookshelf/assets/image/d2.naver.com/1203723/banner.png) center/cover no-repeat;"></div><div class="vp-site-info-detail"><img class="vp-site-info-logo" src="/assets/image/d2.naver.com/favicon.ico" alt loading="lazy" no-view><div class="vp-site-info-name">Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸° | NAVER D2</div><div class="vp-site-info-desc">Virtual Threadì˜ ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°</div></div><!----></div><div></div><p>JDKì— ì •ì‹ ë„ì…ëœ Virtual ThreadëŠ” ê¸°ì¡´ì˜ KLT(kernel-level thread)ì™€ ULT(user-level thread)ë¥¼ 1:1 ë§¤í•‘í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” JVMì˜ ìŠ¤ë ˆë“œ ëª¨ë¸ì„ ê°œì„ í•œ, ì—¬ëŸ¬ ê°œì˜ ê°€ìƒ ìŠ¤ë ˆë“œë¥¼ í•˜ë‚˜ì˜ ë„¤ì´í‹°ë¸Œ ìŠ¤ë ˆë“œì— í• ë‹¹í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ëª¨ë¸ì…ë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” Virtual Threadê°€ ê¸°ì¡´ ìŠ¤ë ˆë“œ ëª¨ë¸ê³¼ ì–´ë–¤ ì ì´ ë‹¤ë¥¸ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p><h2 id="jni" tabindex="-1"><a class="header-anchor" href="#jni"><span>JNI</span></a></h2><p>Java Native Interface(ì´í•˜ JNI)ëŠ” C, C++ì²˜ëŸ¼ ì¸í„°í”„ë¦¬í„° ì—†ì´ OSê°€ ë°”ë¡œ ì½ì„ ìˆ˜ ìˆëŠ” í˜•íƒœì˜ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¥¼ JVMì´ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë‹¤. ì‰½ê²Œ ë§í•´, JVMì—ì„œ ë‹¤ë¥¸ ì–¸ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•œë‹¤. ì´ JNI ë•ë¶„ì— Javaê°€ ë¨¸ì‹  í”Œë«í¼ì— ìƒê´€ì—†ì´ ë™ì‘í•  ìˆ˜ ìˆë‹¤. ì´ í˜¸ì¶œì€ Javaì—ì„œ ë©”ì„œë“œ ì•ì— <code>native</code> í‚¤ì›Œë“œë¥¼ ë¶™ì—¬ í•´ë‹¹ ë©”ì„œë“œê°€ JNIë¥¼ ì‚¬ìš©í•¨ì„ ë‚˜íƒ€ë‚¸ë‹¤.</p><p>ì§ì ‘ ì‚¬ìš©í•˜ë©´ì„œ ì´í•´í•´ ë³´ì(macOS ê¸°ì¤€).</p><p>hoyoungjnië¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¥¼ ë™ì ìœ¼ë¡œ ì½ì–´ì˜¤ê²Œ í•˜ê³ , hyNativeMethodì˜ ë©”ì„œë“œëŠ” JNIë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„ ì–¸í•œë‹¤.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HoyoungJNI</span> <span class="token punctuation">{</span>  </span>
<span class="line">  <span class="token keyword">public</span> <span class="token class-name">HoyoungJNI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">hyNativeMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var0<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">HoyoungJNI</span> var1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HoyoungJNI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    var1<span class="token punctuation">.</span><span class="token function">hyNativeMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">static</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token string">&quot;hoyoungjni&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>hyNativeMethodë¥¼ êµ¬í˜„í•´ ë³´ì. í—¤ë” íŒŒì¼ì„ ë§Œë“ ë‹¤.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">javac HoyoungJNI.java</span>
<span class="line">javah <span class="token parameter variable">-classpath</span> <span class="token variable">${ê²½ë¡œ}</span> org.example.HoyoungJNI</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;jni.h&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_Included_org_example_HoyoungJNI</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_Included_org_example_HoyoungJNI</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span></span>
<span class="line"><span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span>  </span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></span>
<span class="line"></span>
<span class="line">JNIEXPORT <span class="token keyword">void</span> JNICALL <span class="token function">Java_org_example_HoyoungJNI_hyNativeMethod</span>  </span>
<span class="line">  <span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span><span class="token punctuation">,</span> jobject<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ì´ë¥¼ êµ¬í˜„í•œë‹¤.</p><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;jni.h&gt;</span></span></span>
<span class="line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;org_example_HoyoungJNI.h&quot;</span></span></span>
<span class="line"></span>
<span class="line">JNIEXPORT <span class="token keyword">void</span> JNICALL <span class="token function">Java_org_example_HoyoungJNI_hyNativeMethod</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>  </span>
<span class="line">       <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;JNIëŠ” ì´ë ‡ê²Œ ë™ì‘í•´ìš”&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ì»´íŒŒì¼í•œë‹¤.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">gcc -I<span class="token variable">$JAVA_HOME</span>/include -I<span class="token variable">$JAVA_HOME</span>/include/darwin -I<span class="token string">&quot;<span class="token variable">${ë§Œë“ javahí—¤ë”íŒŒì¼ê²½ë¡œ}</span>&quot;</span> <span class="token parameter variable">-shared</span> <span class="token parameter variable">-m64</span>  <span class="token variable">${ê²½ë¡œ}</span>/HoyoungJNI.c <span class="token parameter variable">-o</span> libhoyoungjni.dylib  </span>
<span class="line"><span class="token comment">#</span></span>
<span class="line"><span class="token comment"># The filename of a dynamic library normally contains the libraryâ€™s name with the lib prefix and the .dylib extension</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>.<a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/DynamicLibraryDesignGuidelines.html" target="_blank" rel="noopener noreferrer"><i class="vp-icon fa-brands fa-apple" sizing="height"></i>Dynamic Library Design Guidelines</a>ì˜ ë‹¤ìŒ ê·œì•½ì— ë”°ë¼ ì•ì˜ <code>lib</code>ì™€ ë’¤ì˜ <code>.dylib</code>ë¥¼ ì œì™¸í•œ <code>hoyoungjni</code>ê°€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë¦„ìœ¼ë¡œ ì¸ì‹ëœë‹¤.</p><p>ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒŒì¼ì„ ë§Œë“¤ì—ˆìœ¼ë‹ˆ, í™˜ê²½ë³€ìˆ˜ë¥¼ ì£¼ì…í•˜ì—¬ ì‹¤í–‰í•´ ë³´ì.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># JNIëŠ” ì´ë ‡ê²Œ ë™ì‘í•´ìš”</span></span>
<span class="line"><span class="token function">java</span> <span class="token parameter variable">-Djava.library.path</span><span class="token operator">=</span><span class="token variable">${dylibíŒŒì¼ê²½ë¡œ}</span>  <span class="token parameter variable">-classpath</span> <span class="token variable">${classpath}</span> org.example.HoyoungJNI</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ì¦‰, ì´ë ‡ê²Œ JVMì€ JNIë¥¼ ì‚¬ìš©í•˜ì—¬ ë³„ë„ ì¸í„°í”„ë¦¬í„° ì—†ì´ Cë¡œ ì‘ì„±ëœ ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.</p><h2 id="java-á„‰á…³á„…á…¦á„ƒá…³" tabindex="-1"><a class="header-anchor" href="#java-á„‰á…³á„…á…¦á„ƒá…³"><span>Java ìŠ¤ë ˆë“œ</span></a></h2><p>JavaëŠ” <code>java.util.concurrent.ExecutorService</code>ë¥¼ ë‘ì–´ JVM ë‚´ë¶€ì—ì„œ ìŠ¤ë ˆë“œë¥¼ ê´€ë¦¬/ì‹¤í–‰í•œë‹¤. ì—¬ëŸ¬ <code>ExecutorService</code> ì¤‘ <code>ThreadPoolExecutor</code>ë¡œ ì‹¤ì œ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ë˜ëŠ” ë¶€ë¶„ë§Œ ê°„ë‹¨íˆ ì‚´í´ë³´ì.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token class-name">ThreadPoolExecutor</span> threadPoolExecutor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span></span>
<span class="line">  <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">threadPoolExecutor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>submit</code>ì„ í•˜ë©´ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ” ê±¸ê¹Œ?</p><p>ë‹¤ìŒì€ <code>ThreadPoolExecutor</code>ì˜ <code>execute</code> í•¨ìˆ˜ì˜ ì¼ë¶€ì´ë‹¤.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token doc-comment comment">/**</span>
<span class="line"> * java.util.concurrent.ThreadPoolExecutor.java</span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  <span class="token keyword">int</span> c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token comment">// í˜„ì¬ RUNNUNG ìƒíƒœì¸ ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ê°€ì ¸ì˜¤ê³ </span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">workerCountOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> corePoolSize<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">addWorker</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment">// í’€ ìˆ˜ë³´ë‹¤ ì‘ìœ¼ë©´ ì›Œì»¤ì— ì¶”ê°€í•œë‹¤.</span></span>
<span class="line">      <span class="token keyword">return</span><span class="token punctuation">;</span></span>
<span class="line">    c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">addWorker</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> firstTask<span class="token punctuation">,</span> <span class="token keyword">boolean</span> core<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ThreadPoolExecutorê°€ ì‹¤í–‰í•´ë„ ëœë‹¤ê³  íŒë‹¨í•˜ë©´</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>workerAdded<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    container<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// ì‹¤í–‰í•œë‹¤.</span></span>
<span class="line">    workerStarted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ì›Œì»¤ì— ì¶”ê°€ëœ ìŠ¤ë ˆë“œëŠ” ê²°êµ­ <code>Thread.start</code>ë¥¼ ì‹¤í–‰í•œë‹¤.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token doc-comment comment">/**</span>
<span class="line"> * java.lang.Thread.java</span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">start0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ì‹¤ì œ ì‹¤í–‰ì€ ê²°êµ­ JNIë¥¼ í†µí•œë‹¤.</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// zero status corresponds to state &quot;NEW&quot;.</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>holder<span class="token punctuation">.</span>threadStatus <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalThreadStateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">start0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ì¦‰, <code>ExecutorService</code>ì˜ ìŠ¤ì¼€ì¤„ë§ ì •ì±…ì— ë”°ë¼ JNIë¡œ ìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ì´ë‹¤.</p><p>JDK 21ì„ ê¸°ì¤€ìœ¼ë¡œ ì‚´í´ë³´ì.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/native/libjava/Thread.c#L39" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code> - <i class="vp-icon fas fa-folder-open" sizing="height"></i><code>/src/java.base/share/native/libjava/</code><i class="vp-icon iconfont icon-c" sizing="height"></i><code>Thread.c</code></a>)</p></blockquote><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line"><span class="token keyword">static</span> JNINativeMethod methods<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  </span>
<span class="line">  <span class="token punctuation">{</span><span class="token string">&quot;start0&quot;</span><span class="token punctuation">,</span>           <span class="token string">&quot;()V&quot;</span><span class="token punctuation">,</span>        <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>JVM_StartThread<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token string">&quot;setPriority0&quot;</span><span class="token punctuation">,</span>     <span class="token string">&quot;(I)V&quot;</span><span class="token punctuation">,</span>       <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>JVM_SetThreadPriority<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>start0</code>ëŠ” <code>JVM_StartThread</code> ë©”ì„œë“œì´ê³  <code>JavaThread</code>ë¥¼ ìƒì„±í•œë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/hotspot/share/prims/jvm.cpp#L2928" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code> - <i class="vp-icon fas fa-folder-open" sizing="height"></i><code>/src/hotspot/share/prims/</code><i class="vp-icon iconfont icon-cpp" sizing="height"></i><code>jvm.cpp</code></a>)</p></blockquote><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line"><span class="token function">JVM_ENTRY</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">,</span> <span class="token function">JVM_StartThread</span><span class="token punctuation">(</span>JNIEnv<span class="token operator">*</span> env<span class="token punctuation">,</span> jobject jthread<span class="token punctuation">)</span><span class="token punctuation">)</span>  </span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  native_thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">JavaThread</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>thread_entry<span class="token punctuation">,</span> sz<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">JVM_END</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>JavaThread</code>ëŠ” <code>Thread</code>ì˜ í•˜ìœ„ í´ë˜ìŠ¤ì´ë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/hotspot/share/runtime/javaThread.hpp#L78" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code> - <i class="vp-icon fas fa-folder-open" sizing="height"></i><code>src/hotspot/share/runtime/</code><i class="vp-icon iconfont icon-cpp" sizing="height"></i><code>javaThread.hpp</code></a>)</p></blockquote><div class="language-cpp line-numbers-mode" data-highlighter="prismjs" data-ext="cpp"><pre><code class="language-cpp"><span class="line"><span class="token keyword">class</span> <span class="token class-name">JavaThread</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Thread</span></span> <span class="token punctuation">{</span>  </span>
<span class="line">  <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">VMStructs</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">JVMCIVMStructs</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">WhiteBox</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ê²°êµ­, Java ë‹¨ì˜ <code>ExecutorService</code>ë¥¼ í†µí•´ ìŠ¤ì¼€ì¤„ë§ë˜ëŠ” ì—¬ëŸ¬ <code>java.lang.Thread</code> ê°ì²´ëŠ” JVMì— ì¡´ì¬í•˜ëŠ” start0 í•¨ìˆ˜ë¥¼ JNIë¥¼ í†µí•´ í˜¸ì¶œí•˜ê³ , ê° ë¨¸ì‹  OSì— ë§ê²Œ ì„¤ì¹˜ëœ JVMì€ ì»¤ë„ ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ì–´ ì‹¤í–‰í•œë‹¤. ì´ëŸ¬í•œ ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ í˜¸ì¶œì€ JVM ë‚´ì—ì„œ ìŠ¤íƒê³¼ ë¶„ë¦¬ë˜ì–´ ìˆëŠ” ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œ ìŠ¤íƒì„ ì‚¬ìš©í•œë‹¤.</p><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/1.png" alt="ì¶œì²˜: https://usemynotes.com/what-is-jvm-jit/" tabindex="0" loading="lazy"><figcaption>ì¶œì²˜: https://usemynotes.com/what-is-jvm-jit/</figcaption></figure><p>ì¦‰, ìŠ¤ì¼€ì¤„ë§ì€ Javaì—ì„œ, ì‹¤ì œ ì‹¤í–‰ì€ JNIë¥¼ í†µí•´ ì»¤ë„ì—ì„œ ì‹¤í–‰ëœë‹¤. Javaì˜ ìŠ¤ë ˆë“œ ëª¨ë¸ì„ ë„ì‹í™”í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Heapì— ì¡´ì¬í•˜ëŠ” ë§ì€ ULT ì¤‘ í•˜ë‚˜ê°€ JVMì˜ ìŠ¤ì¼€ì¤„ë§ì— ë”°ë¼ KLTì— ë§¤í•‘ë˜ì–´ ì‹¤í–‰í•˜ëŠ” í˜•íƒœê°€ ê¸°ì¡´ì˜ Java ìŠ¤ë ˆë“œ ëª¨ë¸ì´ë‹¤.</p><h2 id="virtualthread-virtual-thread" tabindex="-1"><a class="header-anchor" href="#virtualthread-virtual-thread"><span>virtualthread&quot;&gt;Virtual Thread</span></a></h2><p>ê¸°ì¡´ì˜ Java ìŠ¤ë ˆë“œë¥¼ ì•Œì•„ë³´ì•˜ìœ¼ë‹ˆ ì´ì œ JDK 21ì— ìƒˆë¡œ ë„ì…ëœ Virtual Threadë¥¼ ì•Œì•„ë³´ì.</p><h3 id="virtual-thread-concepts" tabindex="-1"><a class="header-anchor" href="#virtual-thread-concepts"><span>Virtual Thread concepts</span></a></h3><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/3.png" alt="ì¶œì²˜: https://jenkov.com/tutorials/java-concurrency/java-virtual-threads.html" tabindex="0" loading="lazy"><figcaption>ì¶œì²˜: https://jenkov.com/tutorials/java-concurrency/java-virtual-threads.html</figcaption></figure><p>Virtual ThreadëŠ” ê¸°ì¡´ KLT(1) : ULT(1)ì˜ êµ¬ì¡°ê°€ ì•„ë‹Œ KLT(1) : ULT(1) : Virtual Thread(N)ì˜ êµ¬ì¡°ë¡œ ì‚¬ìš©ëœë‹¤. KLTì™€ Virtual Thread ì‚¬ì´ì˜ ULTëŠ” í”Œë«í¼ ìŠ¤ë ˆë“œë¼ê³  í•œë‹¤.</p><p>ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ Heapì— ìˆ˜ë§ì€ Virtual Threadë¥¼ í• ë‹¹í•´ë†“ê³ , í”Œë«í¼ ìŠ¤ë ˆë“œì— ëŒ€ìƒ Virtual Threadë¥¼ ë§ˆìš´íŠ¸/ì–¸ë§ˆìš´íŠ¸í•˜ì—¬ ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ì„ ìˆ˜í–‰í•œë‹¤. ë”°ë¼ì„œ ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ ë¹„ìš©ì´ ì‘ì•„ì§ˆ ìˆ˜ ë°–ì— ì—†ë‹¤.</p><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ìŠ¤ë ˆë“œì˜ í¬ê¸°ì™€ ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ ë¹„ìš©ì´ ë§ì´ ê°ì†Œí•œ ëª¨ë¸ì´ê¸° ë•Œë¬¸ì— Spring MVC/Tomcat ë“±ì˜ ëª¨ë¸ì´ Netty/WebFluxì— ë¹„í•´ ê°€ì§„ ë‹¨ì ì´ ë§ì´ í¬ì„ë˜ì—ˆë‹¤.</p><h3 id="virtual-thread-states" tabindex="-1"><a class="header-anchor" href="#virtual-thread-states"><span>Virtual Thread states</span></a></h3><p>Virtual Threadì—ëŠ” 9ê°œì˜ ìƒíƒœê°€ ìˆë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/VirtualThread.java#L91" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code> - <i class="vp-icon fas fa-folder-open" sizing="height"></i><code>/src/java.base/share/classes/java/lang/</code><i class="vp-icon fa-brands fa-java" sizing="height"></i><code>VirtualThread.java</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token doc-comment comment">/**</span>
<span class="line"> * Virtual thread state and transitions:</span>
<span class="line"> *</span>
<span class="line"> *      NEW -&gt; STARTED         // Thread.start</span>
<span class="line"> *  STARTED -&gt; TERMINATED      // failed to start</span>
<span class="line"> *  STARTED -&gt; RUNNING         // first run</span>
<span class="line"> *</span>
<span class="line"> *  RUNNING -&gt; PARKING         // Thread attempts to park</span>
<span class="line"> *  PARKING -&gt; PARKED          // cont.yield successful, thread is parked</span>
<span class="line"> *  PARKING -&gt; PINNED          // cont.yield failed, thread is pinned</span>
<span class="line"> *</span>
<span class="line"> *   PARKED -&gt; RUNNABLE        // unpark or interrupted</span>
<span class="line"> *   PINNED -&gt; RUNNABLE        // unpark or interrupted</span>
<span class="line"> *</span>
<span class="line"> * RUNNABLE -&gt; RUNNING         // continue execution</span>
<span class="line"> *</span>
<span class="line"> *  RUNNING -&gt; YIELDING        // Thread.yield</span>
<span class="line"> * YIELDING -&gt; RUNNABLE        // yield successful</span>
<span class="line"> * YIELDING -&gt; RUNNING         // yield failed</span>
<span class="line"> *</span>
<span class="line"> *  RUNNING -&gt; TERMINATED      // done</span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">NEW</span>      <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">STARTED</span>  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">RUNNABLE</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>     <span class="token comment">// runnable-unmounted</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">RUNNING</span>  <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>     <span class="token comment">// runnable-mounted</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">PARKING</span>  <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">PARKED</span>   <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>     <span class="token comment">// unmounted</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">PINNED</span>   <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>     <span class="token comment">// mounted</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">YIELDING</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>     <span class="token comment">// Thread.yield</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TERMINATED</span> <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span>  <span class="token comment">// final state</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ë‹¤ìŒê³¼ ê°™ì´ Virtual Threadì˜ ìƒíƒœì— ë”°ë¼ í”Œë«í¼ ìŠ¤ë ˆë“œì— ë§ˆìš´íŠ¸/ì–¸ë§ˆìš´íŠ¸í•´ ì‹¤í–‰ì„ ê´€ë¦¬í•œë‹¤.</p><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>í”Œë«í¼ ìŠ¤ë ˆë“œì— ì–¸ë§ˆìš´íŠ¸/ë§ˆìš´íŠ¸í•  ë•Œì—ëŠ” park/unpark ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/BaseVirtualThread.java#L30" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code> - <i class="vp-icon fas fa-folder-open" sizing="height"></i><code>/src/java.base/share/classes/java/lang/</code><i class="vp-icon fa-brands fa-java" sizing="height"></i><code>BaseVirtualThread.java</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">sealed</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">BaseVirtualThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span>  </span>
<span class="line">        <span class="token keyword">permits</span> <span class="token class-name">VirtualThread</span><span class="token punctuation">,</span> <span class="token class-name">ThreadBuilders<span class="token punctuation">.</span>BoundVirtualThread</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">  <span class="token doc-comment comment">/**</span>
<span class="line">   * Initializes a virtual Thread.</span>
<span class="line">   *</span>
<span class="line">   * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hljs-doctag<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>@param name thread name, can be null</span>
<span class="line">   * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hljs-doctag<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>@param characteristics thread characteristics</span>
<span class="line">   * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hljs-doctag<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>@param bound true when bound to an OS thread</span>
<span class="line">   */</span></span>
<span class="line">  <span class="token class-name">BaseVirtualThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> characteristics<span class="token punctuation">,</span> <span class="token keyword">boolean</span> bound<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> characteristics<span class="token punctuation">,</span> bound<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token doc-comment comment">/**</span>
<span class="line">   * Parks the current virtual thread until the parking permit is available or</span>
<span class="line">   * the thread is interrupted.</span>
<span class="line">   *</span>
<span class="line">   * The behavior of this method when the current thread is not this thread</span>
<span class="line">   * is not defined.</span>
<span class="line">   */</span></span>
<span class="line">  <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token doc-comment comment">/**</span>
<span class="line">   * Parks current virtual thread up to the given waiting time until the parking</span>
<span class="line">   * permit is available or the thread is interrupted.</span>
<span class="line">   *</span>
<span class="line">   * The behavior of this method when the current thread is not this thread</span>
<span class="line">   * is not defined.</span>
<span class="line">   */</span></span>
<span class="line">  <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">parkNanos</span><span class="token punctuation">(</span><span class="token keyword">long</span> nanos<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token doc-comment comment">/**</span>
<span class="line">   * Makes available the parking permit to the given this virtual thread.</span>
<span class="line">   */</span></span>
<span class="line">  <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">unpark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ìœ„ ìƒíƒœ ê·¸ë¦¼ì²˜ëŸ¼ Virtual Threadì˜ <code>state</code>ë¥¼ ë³€ê²½ì‹œì¼œê°€ë©° ìƒíƒœë¥¼ ê´€ë¦¬í•œë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/VirtualThread.java#L581" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code> - <i class="vp-icon fas fa-folder-open" sizing="height"></i><code>/src/java.base/share/classes/java/lang/</code><i class="vp-icon fa-brands fa-java" sizing="height"></i><code>VirtualThread.java</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@Override</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  <span class="token comment">// park on the carrier thread when pinned</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>yielded<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">parkOnCarrierThread</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">parkOnCarrierThread</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> timed<span class="token punctuation">,</span> <span class="token keyword">long</span> nanos<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">assert</span> <span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">RUNNING</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  <span class="token function">setState</span><span class="token punctuation">(</span><span class="token constant">PINNED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// RUNNING -&gt; PINNED ë¡œ ì „í™˜</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>í”Œë«í¼ ìŠ¤ë ˆë“œì— ë§ˆìš´íŠ¸í•˜ì—¬ ì‹¤í–‰í•˜ëŠ” <code>unpark</code> ë©”ì„œë“œë¥¼ ë³´ì.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/VirtualThread.java#L733" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code> - <i class="vp-icon fas fa-folder-open" sizing="height"></i><code>/src/java.base/share/classes/java/lang/</code><i class="vp-icon fa-brands fa-java" sizing="height"></i><code>VirtualThread.java</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">void</span> <span class="token function">unpark</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token constant">PARKED</span> <span class="token operator">&amp;</span> <span class="token function">compareAndSetState</span><span class="token punctuation">(</span><span class="token constant">PARKED</span><span class="token punctuation">,</span> <span class="token constant">RUNNABLE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentThread <span class="token keyword">instanceof</span> <span class="token class-name">VirtualThread</span> vthread<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      vthread<span class="token punctuation">.</span><span class="token function">switchToCarrierThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token function">submitRunContinuation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token function">switchToVirtualThread</span><span class="token punctuation">(</span>vthread<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">submitRunContinuation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">submitRunContinuation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    scheduler<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>runContinuation<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RejectedExecutionException</span> ree<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">submitFailed</span><span class="token punctuation">(</span>ree<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">throw</span> ree<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ë³´ë‹¤ì‹œí”¼ <code>scheduler</code>ë¡œ ì‹¤ì œ ì‹¤í–‰ì„ ë„˜ê¸°ë©°, <code>scheduler</code>ëŠ” <code>ForkJoinPool</code>ì´ë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/VirtualThread.java#L1113" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code> - <i class="vp-icon fas fa-folder-open" sizing="height"></i><code>/src/java.base/share/classes/java/lang/</code><i class="vp-icon fa-brands fa-java" sizing="height"></i><code>VirtualThread.java</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ForkJoinPool</span> <span class="token function">createDefaultScheduler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token class-name">ForkJoinWorkerThreadFactory</span> factory <span class="token operator">=</span> pool <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ForkJoinWorkerThread</span><span class="token punctuation">&gt;</span></span> pa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">CarrierThread</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Virtual ThreadëŠ” í”Œë«í¼ ìŠ¤ë ˆë“œë¥¼ ì°¸ì¡°í•˜ê³  ìˆìœ¼ë©° ì´ëŠ” <code>carrierThread</code>ë¼ê³  í•œë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/VirtualThread.java#L131" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token comment">// carrier thread when mounted, accessed by VM</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token class-name">Thread</span> carrierThread<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ì¦‰, JVMì´ ì§ì ‘ ì ‘ê·¼í•˜ëŠ” ìŠ¤ë ˆë“œëŠ” í”Œë«í¼ ìŠ¤ë ˆë“œì´ë©°, í”Œë«í¼ ìŠ¤ë ˆë“œì— ë§ˆìš´íŠ¸í•˜ì—¬ ì‹¤í–‰í•˜ëŠ” ê³¼ì •ì€ <code>carrierThread</code>ì— ì‹¤í–‰ ëŒ€ìƒ Virtual Threadë¥¼ í• ë‹¹í•˜ëŠ” ë°©ì‹ì´ë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/VirtualThread.java#L351" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  carrier<span class="token punctuation">.</span><span class="token function">setCurrentThread</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// -&gt; í”Œë«í¼ ìŠ¤ë ˆë“œì— ì‹¤í–‰í•  Virtual Thread í• ë‹¹</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token class-name">Thread</span> carrier <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>carrierThread<span class="token punctuation">;</span></span>
<span class="line">  carrier<span class="token punctuation">.</span><span class="token function">setCurrentThread</span><span class="token punctuation">(</span>carrier<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>interruptLock<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">setCarrierThread</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// -&gt; Virtual Threadì—ì„œ Virtual Thread ì œê±°</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  carrier<span class="token punctuation">.</span><span class="token function">clearInterrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Virtual ThreadëŠ” í”Œë«í¼ ìŠ¤ë ˆë“œë¥¼ ì°¸ì¡°í•˜ê³  ìˆìœ¼ë©° ì‹¤ì œ ì‹¤í–‰ ì‹œì—ëŠ” í”Œë«í¼ ìŠ¤ë ˆë“œì— ë§ˆìš´íŠ¸ë˜ì–´ <code>ForkJoinPool</code>ì˜ íì— ë“¤ì–´ê°€ ìŠ¤ì¼€ì¤„ë§ëœë‹¤.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">private</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ForkJoinTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">poolSubmit</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> signalIfEmpty<span class="token punctuation">,</span>  </span>
<span class="line">                                       <span class="token class-name">ForkJoinTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> task<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token class-name">WorkQueue</span> q<span class="token punctuation">;</span> <span class="token class-name">Thread</span> t<span class="token punctuation">;</span> <span class="token class-name">ForkJoinWorkerThread</span> wt<span class="token punctuation">;</span></span>
<span class="line">  <span class="token class-name">U</span><span class="token punctuation">.</span><span class="token function">storeStoreFence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ensure safely publishable</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>task <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">ForkJoinWorkerThread</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span></span>
<span class="line">      <span class="token punctuation">(</span>wt <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ForkJoinWorkerThread</span><span class="token punctuation">)</span>t<span class="token punctuation">)</span><span class="token punctuation">.</span>pool <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span></span>
<span class="line">      q <span class="token operator">=</span> wt<span class="token punctuation">.</span>workQueue<span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">      task<span class="token punctuation">.</span><span class="token function">markPoolSubmission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      q <span class="token operator">=</span> <span class="token function">submissionQueue</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> signalIfEmpty<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> task<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="virtual-thread-pinning" tabindex="-1"><a class="header-anchor" href="#virtual-thread-pinning"><span>Virtual Thread pinning</span></a></h3><p>Virtual Threadì˜ ì¥ì ì€, JVMì´ ìì²´ì ìœ¼ë¡œ Virtual Threadë¥¼ ìŠ¤ì¼€ì¤„ë§í•˜ê³  ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ ë¹„ìš©ì´ ì¤„ì–´ë“¤ì–´ íš¨ìœ¨ì ìœ¼ë¡œ ìš´ì˜í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ Virtual Threadê°€ í”Œë«í¼ ìŠ¤ë ˆë“œì— ê³ ì •ë˜ì–´ ì¥ì ì„ í™œìš©í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ê°€ ìˆë‹¤. Virtual Thread ë‚´ì—ì„œ synchronized blockì„ ì‚¬ìš©í•˜ê±°ë‚˜, JNIë¥¼ í†µí•´ ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ë‹¤.</p><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/6.png" alt="ì¶œì²˜: https://docs.oracle.com/en/java/javase/21/core/virtual-threads.html#GUID-704A716D-0662-4BC7-8C7F-66EE74B1EDAD" tabindex="0" loading="lazy"><figcaption>ì¶œì²˜: https://docs.oracle.com/en/java/javase/21/core/virtual-threads.html#GUID-704A716D-0662-4BC7-8C7F-66EE74B1EDAD</figcaption></figure><p>Virtual ThreadëŠ” <a href="https://spring.io/blog/2023/09/09/all-together-now-spring-boot-3-2-graalvm-native-images-java-21-and-virtual" target="_blank" rel="noopener noreferrer">Spring Boot 3.2.xì—ì„œ ê³µì‹ì ìœ¼ë¡œ ì§€ì›</a>í•˜ì§€ë§Œ <a href="https://spring.io/blog/2022/10/11/embracing-virtual-threads" target="_blank" rel="noopener noreferrer">2.xì—ì„œë„ ë³„ë„ë¡œ ì„¤ì •í•´ì„œ ì‚¬ìš©</a>í•  ìˆ˜ ìˆë‹¤</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@Bean</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token class-name">TomcatProtocolHandlerCustomizer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">protocolHandlerVirtualThreadExecutorCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> protocolHandler <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      protocolHandler<span class="token punctuation">.</span><span class="token function">setExecutor</span><span class="token punctuation">(</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newVirtualThreadPerTaskExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ë‹¤ë§Œ, ê³µì‹ ë¸”ë¡œê·¸ì— ë”°ë¥´ë©´ Spring ë¡œì§ ë‚´ì— ë§ì€ <code>synchronized</code>ê°€ ìˆì–´ íš¨ìœ¨ì´ ì¢‹ì§€ ì•Šë‹¤.</p><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/7.png" alt="ì¶œì²˜: https://spring.io/blog/2022/10/11/embracing-virtual-threads#mitigating-limitations" tabindex="0" loading="lazy"><figcaption>ì¶œì²˜: https://spring.io/blog/2022/10/11/embracing-virtual-threads#mitigating-limitations</figcaption></figure><p>ì‹¤ì œë¡œ Spring Boot 2.7.17ì—ì„œ Virtual Threadë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•˜ê³  <code>-Djdk.tracePinnedThreads=short</code> ì˜µì…˜ê³¼ í•¨ê»˜ êµ¬ë™í•œ í›„ <code>synchronized</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¡œê·¸ë¥¼ ë§ì´ ë³¼ ìˆ˜ ìˆë‹¤.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token annotation punctuation">@Operation</span><span class="token punctuation">(</span>summary <span class="token operator">=</span> <span class="token string">&quot;í…ŒìŠ¤íŠ¸&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;í…ŒìŠ¤íŠ¸&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000l</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;HELLO&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line">Thread<span class="token punctuation">[</span><span class="token comment">#185,ForkJoinPool-1-worker-1,5,CarrierThreads]  </span></span>
<span class="line">    com.example.test.TestController.test(TestController.java<span class="token punctuation">:</span>22) &lt;== monitors<span class="token punctuation">:</span><span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ë˜í•œ Spring êµ¬ë™ ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ë¡œê·¸ë„ ë³¼ ìˆ˜ ìˆë‹¤.</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line">Thread<span class="token punctuation">[</span><span class="token comment">#184,ForkJoinPool-1-worker-2,5,CarrierThreads]  </span></span>
<span class="line">    com.mysql.cj.protocol.ReadAheadInputStream.read(ReadAheadInputStream.java<span class="token punctuation">:</span>180) &lt;== monitors<span class="token punctuation">:</span><span class="token number">1</span></span>
<span class="line">    com.mysql.cj.jdbc.ConnectionImpl.commit(ConnectionImpl.java<span class="token punctuation">:</span>791) &lt;== monitors<span class="token punctuation">:</span><span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>MySQL íŒ¨í‚¤ì§€ì— ì‚¬ìš©ëœ <code>synchronized</code>ê°€ pinningì„ ìœ ë°œí•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤.</p><p>ë”°ë¼ì„œ Springì€ <code>synchronized</code>ë¥¼ <code>ReentrantLock</code>ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ê°€ê³  ìˆë‹¤.</p><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/8.png" alt="ì¶œì²˜: https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.2.0-M2-Release-Notes#support-for-virtual-threads" tabindex="0" loading="lazy"><figcaption>ì¶œì²˜: https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.2.0-M2-Release-Notes#support-for-virtual-threads</figcaption></figure><p>ê·¸ ë°–ì—ë„ ë§ì€ ì§„ì˜ì—ì„œ Virtual Threadë¥¼ ì§€ì›í•˜ê¸° ìœ„í•´ <code>synchronized</code>ì—ì„œ <code>ReentrantLock</code>ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ì§„í–‰ë˜ê³  ìˆë‹¤.</p><ul><li><a href="https://github.com/mysql/mysql-connector-j/pull/95" target="_blank" rel="noopener noreferrer"><code>MySQL</code> (<i class="vp-icon iconfont icon-github" sizing="height"></i><code>mysql/mysql-connector-j</code>)</a></li><li><a href="https://github.com/f4b6a3/uuid-creator/commit/3e684b1dec472b51a641bbd1762b33c9ea62bc77" target="_blank" rel="noopener noreferrer"><code>UUId</code> (<i class="vp-icon iconfont icon-github" sizing="height"></i><code>f4b6a3/uuid-creator</code>)</a></li></ul><p><code>synchronized</code>ê°€ ë§ì´ ë‚¨ì•„ìˆëŠ” Spring Boot 2.xì—ì„œëŠ” Virtual Threadë¥¼ ì˜ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ì—¬ëŸ¬ ì˜ì¡´ ëª¨ë“ˆì˜ ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ì„ í–‰ë˜ì–´ì•¼ í•  ê²ƒ ê°™ë‹¤. ì•ìœ¼ë¡œ ë¯¸ë˜ Java ë²„ì „ì—ì„œëŠ” <code>synchronized</code>ëŠ” ì ì  ì‚¬ë¼ì§ˆ ê²ƒìœ¼ë¡œ ì˜ˆìƒí•œë‹¤.</p><h3 id="virtual-thread-blocking" tabindex="-1"><a class="header-anchor" href="#virtual-thread-blocking"><span>Virtual Thread blocking</span></a></h3><p>ê¸°ì¡´ Java ìŠ¤ë ˆë“œëŠ” sleep ì‹¤í–‰ ì‹œ blocking ìƒíƒœê°€ ë˜ë©° ë‹¤ë¥¸ ìŠ¤ë ˆë“œì™€ ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ì„ í•œë‹¤. Virtual Threadì˜ sleepì„ ì‚´í´ë³´ì.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/Thread.java#L498" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token keyword">long</span> millis<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>millis <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;timeout value is negative&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">long</span> nanos <span class="token operator">=</span> <span class="token constant">MILLISECONDS</span><span class="token punctuation">.</span><span class="token function">toNanos</span><span class="token punctuation">(</span>millis<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token class-name">ThreadSleepEvent</span> event <span class="token operator">=</span> <span class="token function">beforeSleep</span><span class="token punctuation">(</span>nanos<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">VirtualThread</span> vthread<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        vthread<span class="token punctuation">.</span><span class="token function">sleepNanos</span><span class="token punctuation">(</span>nanos<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">sleep0</span><span class="token punctuation">(</span>nanos<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">afterSleep</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ê¸°ì¡´ ìŠ¤ë ˆë“œì˜ ê²½ìš° sleep0 JNI í˜¸ì¶œë¡œ KLTì™€ í•¨ê»˜ block ìƒíƒœë¡œ ë³€ê²½ë˜ê³  Virtual Threadì˜ ê²½ìš° ë‹¤ë¥¸ ë™ì‘ì„ í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/VirtualThread.java#L791" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token keyword">void</span> <span class="token function">sleepNanos</span><span class="token punctuation">(</span><span class="token keyword">long</span> nanos<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  <span class="token function">parkNanos</span><span class="token punctuation">(</span>remainingNanos<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>(<a href="https://github.com/openjdk/jdk21/blob/master/src/java.base/share/classes/java/lang/VirtualThread.java#L628" target="_blank" rel="noopener noreferrer"><i class="vp-icon iconfont icon-github" sizing="height"></i><code>openjdk/jdk21</code></a>)</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@Override</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">parkNanos</span><span class="token punctuation">(</span><span class="token keyword">long</span> nanos<span class="token punctuation">)</span> <span class="token punctuation">{</span>  </span>
<span class="line">  <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  <span class="token keyword">boolean</span> yielded <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> unparker <span class="token operator">=</span> <span class="token function">scheduleUnpark</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">unpark</span><span class="token punctuation">,</span> nanos<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token function">setState</span><span class="token punctuation">(</span><span class="token constant">PARKING</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    yielded <span class="token operator">=</span> <span class="token function">yieldContinuation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// may throw</span></span>
<span class="line">    <span class="token comment">/* ... ìƒëµ ... */</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token comment">/* ... ìƒëµ ... */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">yieldContinuation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// unmount</span></span>
<span class="line">  <span class="token function">notifyJvmtiUnmount</span><span class="token punctuation">(</span><span class="token comment">/*hide*/</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">Continuation</span><span class="token punctuation">.</span><span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token constant">VTHREAD_SCOPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// re-mount</span></span>
<span class="line">    <span class="token function">mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">notifyJvmtiMount</span><span class="token punctuation">(</span><span class="token comment">/*hide*/</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ìŠ¤ë ˆë“œë¥¼ ì–¸ë§ˆìš´íŠ¸/parkí•˜ê³  ë‹¤ì‹œ ë§ˆìš´íŠ¸/unparkí•˜ëŠ” ê²ƒì€ Futureë¡œ ëŒë¦¬ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì¦‰, ëª…ì‹œì ì¸ KLTì˜ sleep/blockì„ ìˆ˜í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤.</p><p>Spring MVC Tomcat í•˜ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì. Virtual Threadë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” Tomcatì˜ threadsë¥¼ 1ë¡œ ì„¤ì •í•˜ì—¬ ì»¤ë„ ìŠ¤ë ˆë“œë¥¼ í•˜ë‚˜ë§Œ ì‚¬ìš©í•˜ê²Œ í•˜ê³ , Virtual Threadì—ì„œë„ ì»¤ë„ ìŠ¤ë ˆë“œë¥¼ í•˜ë‚˜ë§Œ ì‚¬ìš©í•˜ê²Œ í•˜ì—¬ ì²˜ë¦¬ëŸ‰ì„ ë¹„êµí•´ ë³´ê² ë‹¤. ë˜í•œ í˜¸ì¶œì€ 100ê°œì˜ ìš”ì²­ì„ ë™ì‹œì— ë³´ë‚´ ë³´ê² ë‹¤.</p><p>ë‹¤ìŒ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•œë‹¤.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java"><pre><code class="language-java"><span class="line"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token annotation punctuation">@Operation</span><span class="token punctuation">(</span>summary <span class="token operator">=</span> <span class="token string">&quot;í…ŒìŠ¤íŠ¸&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;í…ŒìŠ¤íŠ¸&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000l</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Tomcatì€ ë‹¤ìŒ ì„¤ì •ìœ¼ë¡œ ìŠ¤ë ˆë“œë¥¼ ì œí•œí•œë‹¤.</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">server</span><span class="token punctuation">:</span>  </span>
<span class="line">  <span class="token key atrule">tomcat</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">threads</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">max</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Virtual ThreadëŠ” ê°€ì´ë“œì— ë”°ë¼ ë‹¤ìŒ í™˜ê²½ë³€ìˆ˜ë¥¼ í†µí•´ ìŠ¤ë ˆë“œë¥¼ ì œí•œí•œë‹¤.</p><figure><img src="/bookshelf/assets/image/d2.naver.com/1203723/9.png" alt="ì¶œì²˜: https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html" tabindex="0" loading="lazy"><figcaption>ì¶œì²˜: https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html</figcaption></figure><p>Virtual Threadë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì€ í™˜ê²½ì—ì„œëŠ” 100ê°œì˜ í˜¸ì¶œì´ ë™ì‹œì— ë°œìƒí–ˆìœ¼ë‚˜, Tomcat ìŠ¤ë ˆë“œê°€ 1ì´ë¯€ë¡œ í˜¸ì¶œ ì²˜ë¦¬ì— ìµœëŒ€ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1000</mn><mi>m</mi><mi>s</mi><mo>Ã—</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">1000ms\times{100}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1000</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">100</span></span></span></span></span> ì˜ ì²˜ë¦¬ ì‹œê°„ì´ ê±¸ë¦¬ê³  1TPSì˜ ì²˜ë¦¬ëŸ‰ì„ ë„˜ì§€ ëª»í•œë‹¤. ì¦‰, ë™ì‹œì„±ì´ ê±°ì˜ ì—†ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;"># reqs</th><th style="text-align:left;"># fails</th><th style="text-align:left;">Avg</th><th style="text-align:left;">Min</th><th style="text-align:left;">Max</th><th style="text-align:left;">Median</th><th style="text-align:left;">req/s</th><th style="text-align:left;">failures/s</th></tr></thead><tbody><tr><td style="text-align:left;">GET /test</td><td style="text-align:left;">23</td><td style="text-align:left;">0(0.00%)</td><td style="text-align:left;">11986</td><td style="text-align:left;">1021</td><td style="text-align:left;">22943</td><td style="text-align:left;">12000</td><td style="text-align:left;">0.99</td><td style="text-align:left;">0.00</td></tr></tbody></table><p>Virtual Threadë¥¼ ì‚¬ìš©í•œ í™˜ê²½ì—ì„œëŠ” ë†’ì€ TPS ì²˜ë¦¬ëŸ‰ì„ ë³´ì¸ë‹¤. 100ê°œì˜ í˜¸ì¶œì´ ë™ì‹œì— ë°œìƒí–ˆìœ¼ë‚˜, non-blocking ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ ìµœëŒ€ ì²˜ë¦¬ ì‹œê°„ ë˜í•œ 1000l ì •ë„ë‹¤. ë˜í•œ ë¡œê·¸ì—ì„œ ì»¤ë„ ìŠ¤ë ˆë“œëŠ” í•˜ë‚˜ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;"># reqs</th><th style="text-align:left;"># fails</th><th style="text-align:left;">Avg</th><th style="text-align:left;">Min</th><th style="text-align:left;">Max</th><th style="text-align:left;">Median</th><th style="text-align:left;">req/s</th><th style="text-align:left;">failures/s</th></tr></thead><tbody><tr><td style="text-align:left;">GET /test</td><td style="text-align:left;">928</td><td style="text-align:left;">0(0.00%)</td><td style="text-align:left;">1005</td><td style="text-align:left;">1001</td><td style="text-align:left;">1031</td><td style="text-align:left;">1001</td><td style="text-align:left;">89.19</td><td style="text-align:left;">0.00</td></tr></tbody></table><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line">2024<span class="token punctuation">-</span>02<span class="token punctuation">-</span>05 13<span class="token punctuation">:</span>17<span class="token punctuation">:</span>26.329  INFO 70581 <span class="token punctuation">---</span> <span class="token punctuation">[</span>               <span class="token punctuation">]</span> VirtualThread<span class="token punctuation">[</span><span class="token comment">#312]/runnable@ForkJoinPool-1-worker-1  </span></span>
<span class="line">2024<span class="token punctuation">-</span>02<span class="token punctuation">-</span>05 13<span class="token punctuation">:</span>17<span class="token punctuation">:</span>26.336  INFO 70581 <span class="token punctuation">---</span> <span class="token punctuation">[</span>               <span class="token punctuation">]</span> VirtualThread<span class="token punctuation">[</span><span class="token comment">#313]/runnable@ForkJoinPool-1-worker-1  </span></span>
<span class="line">2024<span class="token punctuation">-</span>02<span class="token punctuation">-</span>05 13<span class="token punctuation">:</span>17<span class="token punctuation">:</span>26.339  INFO 70581 <span class="token punctuation">---</span> <span class="token punctuation">[</span>               <span class="token punctuation">]</span> VirtualThread<span class="token punctuation">[</span><span class="token comment">#314]/runnable@ForkJoinPool-1-worker-1  </span></span>
<span class="line">2024<span class="token punctuation">-</span>02<span class="token punctuation">-</span>05 13<span class="token punctuation">:</span>17<span class="token punctuation">:</span>26.349  INFO 70581 <span class="token punctuation">---</span> <span class="token punctuation">[</span>               <span class="token punctuation">]</span> VirtualThread<span class="token punctuation">[</span><span class="token comment">#315]/runnable@ForkJoinPool-1-worker-1  </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ë”°ë¼ì„œ Tomcat, Spring MVC í•˜ì—ì„œë„ Netty/WebFluxì™€ ì²˜ë¦¬ ë°©ì‹ê³¼ íš¨ìœ¨ì´ ê°™ìœ¼ë©°, ë„¤íŠ¸ì›Œí¬ I/Oì²˜ëŸ¼ CPUë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ìŠ¤ë ˆë“œ blocking í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ë©´ ì¢‹ì€ íš¨ìœ¨ì„ ë³´ì—¬ì¤„ ìˆ˜ ìˆë‹¤ê³  íŒë‹¨í•  ìˆ˜ ìˆë‹¤.</p><hr><h2 id="á„†á…¡á„á…µá„†á…§" tabindex="-1"><a class="header-anchor" href="#á„†á…¡á„á…µá„†á…§"><span>ë§ˆì¹˜ë©°</span></a></h2><p>CPU intensive í™˜ê²½ì´ ì•„ë‹Œ, ë„¤íŠ¸ì›Œí¬ I/Oê°€ ë‹¤ìˆ˜ ë°œìƒí•˜ëŠ” ì›¹ì„œë²„ í™˜ê²½ì—ì„œëŠ” í•˜ë‚˜ì˜ í˜¸ì¶œì— í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë¥¼ ì ìœ í•˜ëŠ” ê¸°ì¡´ Spring MVC/Tomcat ëª¨ë¸ì€ í° ë¶€ë‹´ìœ¼ë¡œ ì‘ìš©í–ˆê³ , non-blocking single thread ëª¨ë¸ì¸ Netty/WebFlux ëª¨ë¸ì´ ê·¸ ë‹¨ì ì„ í•´ê²°í•˜ë©° ë¶€ìƒí–ˆë‹¤. í•˜ì§€ë§Œ í•™ìŠµì´ ì–´ë µê³ , ìˆ™ë ¨ë„ê°€ ë¶€ì¡±í•´ blockì„ í•œ ë²ˆì´ë¼ë„ ì˜ëª» ì‚¬ìš©í•˜ëŠ” ìˆœê°„ ì „ì²´ ì„œë¹„ìŠ¤ê°€ ë§ê°€ì§€ê¸° ë•Œë¬¸ì— ì‰½ê²Œ ë„ì…í•˜ê¸´ ì‰½ì§€ ì•Šë‹¤ê³  ìƒê°í•œë‹¤. ë ˆê±°ì‹œ ì„œë¹„ìŠ¤ì˜ ê²½ìš° webfluxë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ê¸°ë„ ì–´ë ¤ìš¸ ê²ƒì´ë‹¤.</p><p>Virtual Threadì˜ ë“±ì¥ì€ non-blocking single thread ëª¨ë¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ê³  ë§í•˜ê³  ìˆë‹¤. ì‹¤ì œë¡œ CPU intensive í™˜ê²½ì´ ì•„ë‹ˆë¼ë©´ non-blocking single thread ëª¨ë¸ë§Œí¼ì´ë‚˜ íš¨ìœ¨ì„ ì˜ ë‚´ê³  ìˆë‹¤.</p><p>ì¶”í›„ ë§ì€ Java ì§„ì˜ì—ì„œ synchronizedë¥¼ ì œê±°í•˜ëŠ” ë“±, Virtual Threadë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì¤€ë¹„ê°€ ëœë‹¤ë©´ Java ì§„ì˜ì˜ non-blocking single thread ëª¨ë¸ì˜ ìë¦¬ì— Virtual Threadê°€ ë“¤ì–´ê°ˆì§€ë„ ëª¨ë¥´ê² ë‹¤.</p><hr><h2 id="á„á…¡á†·á„€á…©-á„Œá…¡á„…á…­" tabindex="-1"><a class="header-anchor" href="#á„á…¡á†·á„€á…©-á„Œá…¡á„…á…­"><span>ì°¸ê³  ìë£Œ</span></a></h2><a class="vp-card" href="https://github.com/openjdk/jdk21" target="_blank" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="https://avatars.githubusercontent.com/u/41768318?s=200&amp;v=4" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">openjdk/jdk21</div><hr><div class="vp-card-desc">https://openjdk.org/projects/jdk/21 released 2023-09-19</div></div></a><a class="vp-card" href="https://docs.oracle.com/en/java/javase/21" target="_blank" style="background:rgba(0,104,140,0.2);"><img class="vp-card-logo" src="https://docs.oracle.com/sp_common/site-template/ohc-common/img/favicon.ico" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">JDK 21 Documentation - Home</div><hr><div class="vp-card-desc">The documentation for JDK 21 includes developer guides, API documentation, and release notes.</div></div></a><a class="vp-card" href="https://spring.io/blog" target="_blank" style="background:rgba(109,179,63,0.2);"><img class="vp-card-logo" src="https://spring.io/favicon.svg?v=96334d577af708644f6f0495dd1c7bc8" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Spring | Blog</div><hr><div class="vp-card-desc">Level up your Java code and explore what Spring can do for you.</div></div></a><a class="vp-card" href="https://usemynotes.com/what-is-jvm-jit/" target="_blank" style="background:rgba(45,201,151,0.2);"><img class="vp-card-logo" src="https://usemynotes.com/wp-content/uploads/2020/10/cropped-fevicon-2-192x192.png" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">What is JVM (Java Virtual Machine)? - UseMyNotes</div><hr><div class="vp-card-desc">In this tutorial, we will unfold two of the most important questions of the Java programming environment i.e What is JVM (Java Virtual Machine)? and What is</div></div></a><a class="vp-card" href="https://jenkov.com/tutorials/java-concurrency/java-virtual-threads.html" target="_blank" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="https://jenkov.com/favicon.ico" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Java Virtual Threads</div><hr><div class="vp-card-desc">From Java 19 virtual threads were added to Java. This tutorial explains how to create Java virtual threads, and how they differ from system threads in Java</div></div></a></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/chanhi2000/bookshelf/edit/main/src/d2.naver.com/1203723.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/bookshelf/programming/java-spring/articles/" aria-label="/programming/java-spring/articles/"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->/programming/java-spring/articles/</div></a><a class="route-link auto-link next" href="/bookshelf/d2.naver.com/8404108.html" aria-label="í”„ë¡œíŒŒì¼ë§ ì ìš©ê¸° - ë‹¹ì‹ ì˜ Go ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì¢€ ë” ë‚˜ì•„ì§ˆ ìˆ˜ ìˆë‹¤"><div class="hint">Next<span class="arrow end"></span></div><div class="link">í”„ë¡œíŒŒì¼ë§ ì ìš©ê¸° - ë‹¹ì‹ ì˜ Go ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì¢€ ë” ë‚˜ì•„ì§ˆ ìˆ˜ ìˆë‹¤<i class="vp-icon fa-brands fa-golang" sizing="height"></i></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">MIT Licensed | Copyright Â© 2022-present <a href="https://github.com/chanhi2000">Chan Hee Lee</a></div><!----></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/bookshelf/assets/app-BItykJLQ.js" defer></script>
  </body>
</html>
