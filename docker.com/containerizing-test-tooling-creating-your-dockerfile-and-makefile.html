<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Containerizing Test Tooling: Creating your file and Makefile","image":["https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png"],"datePublished":"2019-06-05T00:00:00.000Z","dateModified":null,"author":[{"@type":"Person","name":"Veronika Alex","url":"https://docker.com/author/veronika-alex/"}]}</script><meta property="og:url" content="https://chanhi2000.github.io/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html"><meta property="og:site_name" content="📚Bookshelf"><meta property="og:title" content="Containerizing Test Tooling: Creating your file and Makefile"><meta property="og:description" content="Article(s) > Containerizing Test Tooling: Creating your file and Makefile"><meta property="og:type" content="article"><meta property="og:image" content="https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png"><meta property="og:locale" content="en-US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:src" content="https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png"><meta name="twitter:image:alt" content="Containerizing Test Tooling: Creating your file and Makefile"><meta property="article:author" content="Veronika Alex"><meta property="article:tag" content="docker"><meta property="article:tag" content="devops"><meta property="article:tag" content="docker.com"><meta property="article:tag" content="blog"><meta property="article:published_time" content="2019-06-05T00:00:00.000Z"><link rel="icon" href="/bookshelf/assets/icon/favicon.svg"><title>Containerizing Test Tooling: Creating your file and Makefile | 📚Bookshelf</title><meta name="description" content="Article(s) > Containerizing Test Tooling: Creating your file and Makefile">
    <link rel="preload" href="/bookshelf/assets/style-DmRYlEXZ.css" as="style"><link rel="stylesheet" href="/bookshelf/assets/style-DmRYlEXZ.css">
    
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/bookshelf/" aria-label="Take me home"><img class="vp-nav-logo" src="/bookshelf/assets/icon/favicon.svg" alt><!----><span class="vp-site-name hide-in-pad">📚Bookshelf</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/bookshelf/news.html" aria-label><!--[--><i class="vp-icon fas fa-rss" sizing="height"></i><!--]--><!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-keyboard" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/hackingwithswift.com/" aria-label="hackingwithswift.com"><!--[--><img class="vp-icon" src="https://hackingwithswift.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->hackingwithswift.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fcc/" aria-label="freecodecamp.org"><!--[--><img class="vp-icon" src="https://cdn.freecodecamp.org/universal/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->freecodecamp.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kodeco.com/" aria-label="kodeco.com"><!--[--><img class="vp-icon" src="https://kodeco.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->kodeco.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.kotzilla.io/" aria-label="blog.kotzilla.io"><!--[--><img class="vp-icon" src="https://blog.kotzilla.io/hubfs/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.kotzilla.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/kt.academy/" aria-label="kt.academy"><!--[--><img class="vp-icon" src="https://kt.academy/logo.png" alt aria-hidden no-view sizing="both"><!--]-->kt.academy<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/droidcon.com/" aria-label="droidcon.com"><!--[--><img class="vp-icon" src="https://droidcon.com/wp-content/uploads/2021/07/favicon-300x300.png" alt aria-hidden no-view sizing="both"><!--]-->droidcon.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/outcomeschool.com/" aria-label="outcomeschool.com"><!--[--><img class="vp-icon" src="https://outcomeschool.com/static/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->outcomeschool.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/frontendmasters.com/" aria-label="frontendmasters.com"><!--[--><img class="vp-icon" src="https://frontendmasters.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->frontendmasters.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/css-tricks.com/" aria-label="css-tricks.com"><!--[--><img class="vp-icon" src="https://css-tricks.com/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->css-tricks.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/smashingmagazine.com/" aria-label="smashingmagazine.com"><!--[--><img class="vp-icon" src="https://smashingmagazine.com/images/favicon/favicon.svg" alt aria-hidden no-view sizing="both"><!--]-->smashingmagazine.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.logrocket.com/" aria-label="blog.logrocket.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/blog.logrocket.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->blog.logrocket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/realpython.com/" aria-label="realpython.com"><!--[--><img class="vp-icon" src="https://realpython.com/static/favicon.68cbf4197b0c.png" alt aria-hidden no-view sizing="both"><!--]-->realpython.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/digitalocean.com/" aria-label="digitalocean.com"><!--[--><img class="vp-icon" src="https://digitalocean.com/_next/static/media/favicon.594d6067.ico" alt aria-hidden no-view sizing="both"><!--]-->digitalocean.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/antonioleiva.com/" aria-label="antonioleiva.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/antonioleiva.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->antonioleiva.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/johnnyreilly.com/" aria-label="johnnyreilly.com"><!--[--><img class="vp-icon" src="https://johnnyreilly.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->johnnyreilly.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/code-maze.com/" aria-label="code-maze.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/code-maze.com/favicon.png" alt aria-hidden no-view sizing="both"><!--]-->code-maze.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/milanjovanovic.tech/" aria-label="milanjovanovic.tech"><!--[--><img class="vp-icon" src="https://milanjovanovic.tech/profile_favicon.png" alt aria-hidden no-view sizing="both"><!--]-->milanjovanovic.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/shopify.engineering/" aria-label="shopify.engineering"><!--[--><img class="vp-icon" src="https://cdn.shopify.com/static/shopify-favicon.png" alt aria-hidden no-view sizing="both"><!--]-->shopify.engineering<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devtoolstips.org/" aria-label="devtoolstips.org"><!--[--><img class="vp-icon" src="https://devtoolstips.org/assets/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devtoolstips.org<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/piccalil.li/" aria-label="piccalil.li"><!--[--><img class="vp-icon" src="https://piccalil.li/favicons/apple-touch-icon.png" alt aria-hidden no-view sizing="both"><!--]-->piccalil.li<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/sitepoint.com/" aria-label="sitepoint.com"><!--[--><img class="vp-icon" src="https://sitepoint.com/favicons/512x512.png" alt aria-hidden no-view sizing="both"><!--]-->sitepoint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/event-driven.io/" aria-label="event-driven.io"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/event-driven.io/favicon.jfif" alt aria-hidden no-view sizing="both"><!--]-->event-driven.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/packagemain.tech/" aria-label="packagemain.tech"><!--[--><img class="vp-icon" src="https://substack-post-media.s3.amazonaws.com/public/images/2ea54e25-eaa6-4630-bfc0-10b8cfdce894/apple-touch-icon-1024x1024.png" alt aria-hidden no-view sizing="both"><!--]-->packagemain.tech<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/gosolve.io/" aria-label="gosolve.io"><!--[--><img class="vp-icon" src="https://gosolve.io/wp-content/uploads/2022/03/cropped-ikona1-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->gosolve.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/towardsdatascience.com/" aria-label="towardsdatascience.com"><!--[--><img class="vp-icon" src="https://cdn-images-1.medium.com/v2/resize:fill:128:128/1*VzTUkfeGymHP4Bvav-T-lA.png" alt aria-hidden no-view sizing="both"><!--]-->towardsdatascience.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/douggregor.net/" aria-label="douggregor.net"><!--[--><i class="vp-icon fas fa-globe" sizing="both"></i><!--]-->douggregor.net<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/d2.naver.com/" aria-label="d2.naver.com"><!--[--><img class="vp-icon" src="/bookshelf/assets/image/d2.naver.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->d2.naver.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakao.com/" aria-label="tech.kakao.com"><!--[--><img class="vp-icon" src="https://www.kakaocorp.com/page/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakao.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tech.kakaopay.com/" aria-label="tech.kakaopay.com"><!--[--><img class="vp-icon" src="https://tech.kakaopay.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tech.kakaopay.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/fe-developers.kakaoent.com/" aria-label="fe-developers.kakaoent.com"><!--[--><img class="vp-icon" src="https://fe-developers.kakaoent.com/favicon-32x32.png?v=44803cb16c1e2debd3984cf2e8cb2ded" alt aria-hidden no-view sizing="both"><!--]-->fe-developers.kakaoent.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/yozm.wishket.com/" aria-label="yozm.wishket.com"><!--[--><img class="vp-icon" src="https://yozm.wishket.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->yozm.wishket.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/popit.kr/" aria-label="popit.kr"><!--[--><img class="vp-icon" src="https://popit.kr/wp-content/uploads/2016/08/favicon_32x32.png" alt aria-hidden no-view sizing="both"><!--]-->popit.kr<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/devkuma.com/" aria-label="devkuma.com"><!--[--><img class="vp-icon" src="https://devkuma.com/favicons/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->devkuma.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/blog.gangnamunni.com/" aria-label="blog.gangnamunni.com"><!--[--><img class="vp-icon" src="https://blog.gangnamunni.com/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->blog.gangnamunni.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/codingeverybody.kr/" aria-label="codingeverybody.kr"><!--[--><img class="vp-icon" src="https://codingeverybody.kr/wp-content/uploads/cropped-favicon-origin-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->codingeverybody.kr<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label><!--[--><i class="vp-icon fas fa-network-wired" sizing="height"></i><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/tecmint.com/" aria-label="tecmint.com"><!--[--><img class="vp-icon" src="https://tecmint.com/wp-content/uploads/2020/07/favicon.ico" alt aria-hidden no-view sizing="both"><!--]-->tecmint.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/bookshelf/docker.com/" aria-label="docker.com"><!--[--><img class="vp-icon" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->docker.com<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/learnk8s.io/" aria-label="learnk8s.io"><!--[--><img class="vp-icon" src="https://static.learnk8s.io/f7e5160d4744cf05c46161170b5c11c9.svg" alt aria-hidden no-view sizing="both"><!--]-->learnk8s.io<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/bookshelf/itsfoss.com/" aria-label="itsfoss.com"><!--[--><img class="vp-icon" src="https://itsfoss.com/content/images/size/w256h256/2022/12/android-chrome-192x192.png" alt aria-hidden no-view sizing="both"><!--]-->itsfoss.com<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/chanhi2000/articles" target="_blank" rel="noopener noreferrer" aria-label="Github"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-appearance-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-appearance-dropdown"><!----></div></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><img class="vp-icon" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" alt aria-hidden no-view sizing="both"><span class="vp-sidebar-title">docker.com</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2025</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2024</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2023</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2022</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2021</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2020</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">2019</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/new-filesharing-implementation-in-docker-desktop-windows.html" aria-label="New Filesharing Implementation in Docker Desktop Windows Improves Developer Inner Loop UXDocker"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->New Filesharing Implementation in Docker Desktop Windows Improves Developer Inner Loop UXDocker<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/depend-on-docker-for-kubeflow.html" aria-label="Depend on Docker for Kubeflow"><!--[--><i class="vp-icon iconfont icon-k8s" sizing="both"></i><!--]-->Depend on Docker for Kubeflow<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/developing-docker-windows-app-wsl2.html" aria-label="Developing Docker-Powered Apps on Windows with WSL 2"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Developing Docker-Powered Apps on Windows with WSL 2<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/keep-nodejs-rockin-in-docker.html" aria-label="Top 4 Tactics To Keep Node.js Rockin’ in Docker"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Top 4 Tactics To Keep Node.js Rockin’ in Docker<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/road-to-containing-iscsi.html" aria-label="Road to containing iSCSI"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Road to containing iSCSI<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/intro-guide-to-dockerfile-best-practices.html" aria-label="Intro Guide to Dockerfile file Best Practices"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Intro Guide to Dockerfile file Best Practices<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/getting-started-with-docker-for-arm-on-linux.html" aria-label="Getting started with Docker for Arm on Linux"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Getting started with Docker for Arm on Linux<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html" aria-label="Containerizing Test Tooling: Creating your file and Makefile"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Containerizing Test Tooling: Creating your file and Makefile<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/whats-in-a-container-platform.html" aria-label="What&#39;s in a Container Platform?"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->What&#39;s in a Container Platform?<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/multi-arch-images.html" aria-label="Building Multi-Arch Images for Arm and x86 with  Desktop"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Building Multi-Arch Images for Arm and x86 with  Desktop<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/happy-pi-day-docker-raspberry-pi.html" aria-label="Happy Pi Day with  and Raspberry Pi"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Happy Pi Day with  and Raspberry Pi<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/bookshelf/docker.com/addressing-time-drift-in-docker-desktop-for-mac.html" aria-label="Addressing Time Drift in Docker Desktop for Mac"><!--[--><i class="vp-icon fa-brands fa-docker" sizing="both"></i><!--]-->Addressing Time Drift in Docker Desktop for Mac<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2018</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2017</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2016</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2015</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2013</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon fa-brands fa-docker" sizing="height"></i>Containerizing Test Tooling: Creating your file and Makefile</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://docker.com/author/veronika-alex/" target="_blank" rel="noopener noreferrer">Veronika Alex</a></span><span property="author" content="Veronika Alex"></span></span><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">6/5/19</span><meta property="datePublished" content="2019-06-05T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 10 min</span><meta property="timeRequired" content="PT10M"></span><span class="page-category-info" aria-label="Category🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color2" role>DevOps</span><span class="page-category-item color8" role>Docker</span><span class="page-category-item color8" role>Article(s)</span><!--]--><meta property="articleSection" content="DevOps,Docker,Article(s)"></span><span class="page-tag-info" aria-label="Tag🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color8" role>blog</span><span class="page-tag-item color5" role>docker.com</span><span class="page-tag-item color7" role>devops</span><span class="page-tag-item color2" role>docker</span><!--]--><meta property="keywords" content="blog,docker.com,devops,docker"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="frontmatter-title-관련" tabindex="-1"><a class="header-anchor" href="#frontmatter-title-관련"><span>Containerizing Test Tooling: Creating your file and Makefile 관련</span></a></h1><a class="route-link vp-card" href="/bookshelf/devops/docker/articles/" style="background:rgba(10,10,10,0.2);"><img class="vp-card-logo" src="/bookshelf/images/ico-wind.svg" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Docker > Article(s)</div><hr><div class="vp-card-desc">Article(s)</div></div></a><nav class="table-of-contents"><ul><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#the-tooling" class="router-link-active router-link-exact-active">The Tooling</a><ul><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#system-toolbox" class="router-link-active router-link-exact-active">System toolbox</a></li><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#unit-tests" class="router-link-active router-link-exact-active">Unit tests</a></li><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#integration-tests" class="router-link-active router-link-exact-active">Integration tests</a></li></ul></li><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#creating-the-dockerfile" class="router-link-active router-link-exact-active">Creating the Dockerfile</a></li><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#creating-the-makefile" class="router-link-active router-link-exact-active">Creating the Makefile</a></li><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#install-targets" class="router-link-active router-link-exact-active">Install Targets</a></li><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#docker-targets" class="router-link-active router-link-exact-active">Docker Targets</a></li><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#test-targets" class="router-link-active router-link-exact-active">Test Targets</a></li><li><a aria-current="page" href="/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html#how-to-run-the-containerized-tests" class="router-link-active router-link-exact-active">How to Run the Containerized Tests</a></li></ul></nav><hr><div class="vp-site-info" data-name="Containerizing Test Tooling: Creating your file and Makefile"><a class="vp-site-info-navigator no-external-link-icon" title="Containerizing Test Tooling: Creating your file and Makefile" href="https://docker.com/blog/containerizing-test-tooling-creating-your-dockerfile-and-makefile" target="_blank"></a><div class="vp-site-info-preview" style="background:url(https://docker.com/app/uploads/2024/02/docker-default-meta-image-1110x583.png) center/cover no-repeat;"></div><div class="vp-site-info-detail"><img class="vp-site-info-logo" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" alt loading="lazy" no-view><div class="vp-site-info-name">Containerizing Test Tooling: Creating your file and Makefile</div><div class="vp-site-info-desc">Learn from Docker experts to simplify and advance your app development and management with Docker. Stay up to date on Docker events and new version</div></div><!----></div><p>We hear a lot about the benefits of containerizing applications, but we do not often hear about the benefits of containerizing the tests of those applications or applications whose purpose is to test an entire system. Running an application’s tests inside containers allows us a greater sense of assurance that our applications are running as expected. Furthermore, packaging tests as a Docker image allows us to quickly run tests across multiple machines and ensure a consistent environment. In this post we’ll go through containerizing a test tooling application as well as containerizing the tooling’s unit and integration tests to demonstrate these benefits.</p><hr><h2 id="the-tooling" tabindex="-1"><a class="header-anchor" href="#the-tooling"><span>The Tooling</span></a></h2><p>The test tooling to be containerized is a set of tools used to stress test the Docker EE stack, which includes the Docker Engine, Universal Control Pane, and Docker Trusted Registry across a current matrix of five operating systems with different configurations. The tooling itself has several key properties:</p><ol><li>Written in Python 3 in its own virtual Python environment</li><li>Uses 2 external client binaries</li><li>Has 3 dependencies on external config files to run the system tests</li><li>Passes its own unit and integration tests</li><li>Collects logs on all system tests</li></ol><p>These properties exist whether the tooling is containerized or not, but we’ll see how containerizing this tooling makes development, code management, and collaboration easier. There is a lot of “test” lingo in this post, so to start from a common base I’ll explain what each type of testing represents for our purposes.</p><h3 id="system-toolbox" tabindex="-1"><a class="header-anchor" href="#system-toolbox"><span>System toolbox</span></a></h3><p>The actual application/tooling. You can think of this as the full application we are going to containerize.</p><h3 id="unit-tests" tabindex="-1"><a class="header-anchor" href="#unit-tests"><span>Unit tests</span></a></h3><p>These are the unit tests for our application. Any external dependencies are mocked; we are going to run our unit tests inside of a container.</p><h3 id="integration-tests" tabindex="-1"><a class="header-anchor" href="#integration-tests"><span>Integration tests</span></a></h3><p>These are the integration tests that rely on a live system. These tests will also be run inside of a container.</p><hr><h2 id="creating-the-dockerfile" tabindex="-1"><a class="header-anchor" href="#creating-the-dockerfile"><span>Creating the Dockerfile</span></a></h2><div class="code-block-with-title"><div class="code-block-title-bar" data-title="Dockerfile"><span>Dockerfile</span></div><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code class="language-docker"><span class="line"><span class="token instruction"><span class="token keyword">FROM</span> python:3.7.1</span></span>
<span class="line"> </span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./client-binaries/Linux/&lt;binary_1&gt; /usr/local/bin/&lt;binary_1&gt;</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./client-binaries/Linux/docker-18.09.4 /usr/bin/docker</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /system_toolbox</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./pip-requirements/requirements.txt ./proj/requirements.txt</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> pip install -r ./proj/requirements.txt</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./integration-tests ./integration-tests</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./test-cases ./test-cases</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./sut-configs ./sut-configs</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./&lt;binary_1&gt;-configs ./&lt;binary_1&gt;-configs</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./toolbox ./toolbox</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./Makefile ./Makefile</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./README.md ./README.md</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./setup.py ./setup.py</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> make install-dev</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>In order to run any application in a container, it needs to be based off of an image. Since the current project we are working with is written in Python 3, we will build off of the official maintained Python image by using the <code>FROM python:3.7.1</code> directive. This is our parent, sometimes referred to as the base, image. We are using the 3.7.1 version of the image which gives us a Debian Linux — also known as stretch — OS. This is because part of our tooling relies on an SSH client which the Alpine Linux version does not include, and because we would like to have the convenience of being able to install Paramiko, the Python SSH module, via Python’s package manager pip.</p><p>As mentioned previously, our project relies on two external client binaries. We include these in our Dockerfile using the <code>COPY &lt;src&gt; &lt;dst&gt;</code> directive. This command will copy the binaries to the filesystem of the image at the specified destination path. A note here about the difference between using <code>COPY</code> and its alternative command <code>ADD</code>. Using <code>COPY</code> is the Docker best-practices approach, whereas <code>ADD</code> has some additional functionality such as moving a tar archive from the source path which will be automatically unpacked as a directory inside of the Docker image. So for our purposes of copying over files or directories and not over-engineering our Dockerfile, <code>COPY</code> is the appropriate command.</p><p>All of our commands beyond adding the client binaries are going to be inside <code>/system_toolbox</code>; therefore, we add a <code>WORKDIR</code> directive set to <code>/system_toolbox</code>. This will set the current working directory in the container to be <code>/system_toolbox</code> and it allows us to clean up some additional text in our Dockerfile. For example, we could write lines 6-16 of the Dockerfile like so:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="Dockerfile"><span>Dockerfile</span></div><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code class="language-docker"><span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./integration-tests /system_toolbox/integration-tests</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./test-cases /system_toolbox/test-cases</span></span>
<span class="line"> </span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./sut-configs /system_toolbox/sut-configs</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./&lt;binary_1&gt;-configs /system_toolbox/&lt;binary_1&gt;-configs</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./toolbox /system_toolbox/toolbox</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>This will work; however, it’s difficult to read and if there is a change to the parent directory structure, you will have to go in and change this path in every line. Instead we can use the <code>WORKDIR</code> directive to shorten each statement like so:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="Dockerfile"><span>Dockerfile</span></div><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code class="language-docker"><span class="line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /system_toolbox</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./pip-requirements/requirements.txt ./proj/requirements.txt</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> pip install -r ./proj/requirements.txt</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./integration-tests ./integration-tests</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./test-cases ./test-cases</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./sut-configs ./sut-configs</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./&lt;binary_1&gt;-configs ./&lt;binary_1&gt;-configs</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./toolbox ./toolbox</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>Once the working directory is set, all of the following commands will be executed from that directory unless the working directory is changed. The next two lines in the Dockerfile:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="Dockerfile"><span>Dockerfile</span></div><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code class="language-docker"><span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./pip-requirements/requirements.txt ./proj/requirements.txt</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> pip install -r ./proj/requirements.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><p>copy over the Python requirements file and install all of these requirements using the <code>RUN</code> directive. By invoking RUN in this manner, the command following <code>RUN</code> is executed in a shell, which will default to <code>/bin/sh -c</code> in a Linux container.</p><p>The following Dockerfile lines are used by our tooling to set up tests, library code, and necessary configuration files:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="Dockerfile"><span>Dockerfile</span></div><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code class="language-docker"><span class="line"><span class="token comment"># integration tests to test the tool’s code accuracy</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./integration-tests ./integration-tests</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># system test cases that our tooling runs</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./test-cases ./test-cases</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># config files for our tooling</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./sut-configs ./sut-configs</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># config files for our tooling</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./&lt;binary_1&gt;-configs ./&lt;binary_1&gt;-configs</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># the tooling library</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./toolbox ./toolbox</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>And finally, the last two lines of the Dockerfile:</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="Dockerfile"><span>Dockerfile</span></div><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code class="language-docker"><span class="line"><span class="token instruction"><span class="token keyword">COPY</span> ./setup.py ./setup.py</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> make install-dev</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><p>copy over the Python setup script to package our tooling and run <code>make install-dev</code>, the details of which will be explained in the <code>Makefile</code> section.</p><hr><h2 id="creating-the-makefile" tabindex="-1"><a class="header-anchor" href="#creating-the-makefile"><span>Creating the Makefile</span></a></h2><p>Creating a <code>Makefile</code> is often an adventure. In this section we will walk through some of the major components that allow us to run our tooling. We will also look at the unit and integration tests that test our tooling inside of containers. This portion of our <code>Makefile</code> is broken into four sections: Install targets, Docker targets, Test targets, and Utilities. The <code>Makefile</code> excerpt below is followed by an explanation of the first three sections since Utilities target does a version check.</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="Makefile"><span>Makefile</span></div><div class="language-makefile line-numbers-mode" data-highlighter="prismjs" data-ext="makefile"><pre><code class="language-makefile"><span class="line">MAJOR<span class="token operator">?=</span>0</span>
<span class="line">MINOR<span class="token operator">?=</span>1</span>
<span class="line"> </span>
<span class="line">VERSION<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>MAJOR<span class="token punctuation">)</span>.<span class="token variable">$</span><span class="token punctuation">(</span>MINOR<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">APP_NAME <span class="token operator">=</span> <span class="token string">&quot;system-toolbox&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Our docker Hub account name</span></span>
<span class="line"><span class="token comment"># HUB_NAMESPACE = &quot;&lt;hub_name&lt;&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># location of Dockerfiles</span></span>
<span class="line">DOCKER_FILE_DIR <span class="token operator">=</span> <span class="token string">&quot;dockerfiles&quot;</span></span>
<span class="line">DOCKERFILE <span class="token operator">=</span> <span class="token string">&quot;${DOCKER_FILE_DIR}/Dockerfile&quot;</span></span>
<span class="line"></span>
<span class="line">IMAGE_NAME <span class="token operator">=</span> <span class="token string">&quot;${APP_NAME}&quot;</span></span>
<span class="line">CUR_DIR <span class="token operator">=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">shell</span> echo <span class="token string">&quot;${PWD}&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># For python format checker. Default is 78</span></span>
<span class="line">PEP8_MAX_LINE_LENGTH <span class="token operator">=</span> 99</span>
<span class="line"></span>
<span class="line"><span class="token comment"># unit testing options</span></span>
<span class="line">NOSETEST_OPTS <span class="token operator">=</span> --verbosity<span class="token operator">=</span>2 -<span class="token keyword">-include</span><span class="token operator">=</span><span class="token string">&#39;.*_test.py&#39;</span> --detailed-errors --where<span class="token operator">=</span>toolbox</span>
<span class="line">COVERAGE_OPTS <span class="token operator">=</span> --with-coverage --cover-package<span class="token operator">=</span>toolbox --cover-html --cover-inclusive --cover-tests --cover-erase \ </span>
<span class="line">--cover-html-dir<span class="token operator">=</span>../test-results/unit-test-code-coverage</span>
<span class="line"></span>
<span class="line"><span class="token comment">#################################</span></span>
<span class="line"><span class="token comment"># Install targets</span></span>
<span class="line"><span class="token comment">#################################</span></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> install-dev</span>
<span class="line"><span class="token target symbol">install-dev</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line">  <span class="token operator">@</span>pip install -e .</span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> pip-freeze</span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line">  <span class="token operator">@</span>pip freeze <span class="token operator">|</span> grep -v system_toolbox &lt; pip-requirements/requirements.txt</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">#################################</span></span>
<span class="line"><span class="token comment"># Docker targets</span></span>
<span class="line"><span class="token comment">#################################</span></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> clean-image</span>
<span class="line"><span class="token target symbol">clean-image</span><span class="token punctuation">:</span> version-check</span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line"><span class="token target symbol">  @docker rmi <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span>latest  <span class="token operator">|</span><span class="token operator">|</span> true</span>
<span class="line"><span class="token target symbol">  @docker rmi <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">{</span>VERSION<span class="token punctuation">}</span>  <span class="token operator">|</span><span class="token operator">|</span> true</span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> image</span>
<span class="line"><span class="token target symbol">image</span><span class="token punctuation">:</span> version-check</span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line"><span class="token target symbol">  @docker build -t <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">{</span>VERSION<span class="token punctuation">}</span> -f ./<span class="token variable">$</span><span class="token punctuation">{</span>DOCKERFILE<span class="token punctuation">}</span> .</span>
<span class="line"><span class="token target symbol">  @docker tag <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">{</span>VERSION<span class="token punctuation">}</span> <span class="token variable">$</span><span class="token punctuation">{</span>HUB_NAMESPACE<span class="token punctuation">}</span>/<span class="token variable">$</span><span class="token punctuation">{</span>IMAGE_NAME<span class="token punctuation">}</span><span class="token punctuation">:</span>latest</span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&#39;Done.&#39;</span></span>
<span class="line">  <span class="token operator">@</span>docker images --format <span class="token string">&#39;{{.Repository}}:{{.Tag}}\t\t Built: {{.CreatedSince}}\t\tSize: {{.Size}}&#39;</span> <span class="token operator">|</span> \ </span>
<span class="line"><span class="token target symbol">    grep <span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">{</span>VERSION<span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> push</span>
<span class="line"><span class="token target symbol">push</span><span class="token punctuation">:</span> clean-image image</span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line"><span class="token target symbol">  @docker push <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span><span class="token variable">$</span><span class="token punctuation">{</span>VERSION<span class="token punctuation">}</span></span>
<span class="line"><span class="token target symbol">  @docker push <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span>latest</span>
<span class="line"></span>
<span class="line"><span class="token comment">#################################</span></span>
<span class="line"><span class="token comment"># test targets</span></span>
<span class="line"><span class="token comment">#################################</span></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> test-unit</span>
<span class="line"><span class="token target symbol">test-unit</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line">  nosetests <span class="token variable">$</span><span class="token punctuation">{</span>NOSETEST_OPTS<span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> check-fmt</span>
<span class="line"><span class="token comment">#check-fmt: image</span></span>
<span class="line"><span class="token target symbol">check-fmt</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line">  pycodestyle --filename<span class="token operator">=</span><span class="token string">&#39;*.py&#39;</span> --exclude<span class="token operator">=</span><span class="token string">&#39;*.sh,*.md,*.txt,Makefile,*.swp&#39;</span> --max-line-length<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">{</span>PEP8_MAX_LINE_LENGTH<span class="token punctuation">}</span> *</span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> test-static</span>
<span class="line"><span class="token target symbol">test-static</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line">  pylint -d duplicate-code test-cases</span>
<span class="line">  pylint  toolbox</span>
<span class="line">  pylint integration-tests</span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> test-all</span>
<span class="line"><span class="token target symbol">test-all</span><span class="token punctuation">:</span> check-fmt test-static test-unit</span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> test-container</span>
<span class="line"><span class="token target symbol">test-container</span><span class="token punctuation">:</span> image</span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line"><span class="token target symbol">  @docker run --rm --name toolbox-unit-tests <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span>latest make test-all</span>
<span class="line"><span class="token target symbol">  @docker run --rm --name toolbox-int --volume <span class="token variable">$</span>{CUR_DIR}/results</span><span class="token punctuation">:</span>/root/logs -e REGISTRY_USERNAME<span class="token operator">=</span>foo -e REGISTRY_PASSWORD<span class="token operator">=</span>bar \ </span>
<span class="line"><span class="token target symbol">    <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span>latest python ./integration-tests/testbed_validation.py</span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> integration-static</span>
<span class="line"><span class="token target symbol">integration-static</span><span class="token punctuation">:</span> image</span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line"><span class="token target symbol">  @docker run --rm --name toolbox-int --volume <span class="token variable">$</span>{CUR_DIR}/results</span><span class="token punctuation">:</span>/root/logs -e REGISTRY_USERNAME<span class="token operator">=</span>foo -e REGISTRY_PASSWORD<span class="token operator">=</span>bar \ </span>
<span class="line"><span class="token target symbol">    <span class="token variable">$</span>{HUB_NAMESPACE}/<span class="token variable">$</span>{IMAGE_NAME}</span><span class="token punctuation">:</span>latest python ./integration-tests/testbed_validation.py</span>
<span class="line">    <span class="token comment">#@python ./integration-tests/testbed_validation.py</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> integration-testbed-survey</span>
<span class="line"><span class="token target symbol">integration-testbed-survey</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line">  <span class="token operator">@</span>python ./integration-tests/testbed_validation.py --topology-filter<span class="token operator">=</span>poc_ --sut-filter<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">{</span>TESTBED_SURVEY_SUT<span class="token punctuation">}</span> \ </span>
<span class="line">    --create-system <span class="token variable">$</span><span class="token punctuation">{</span>INTEGRATION_PERSONA<span class="token punctuation">}</span> <span class="token variable">$</span><span class="token punctuation">{</span>DRY_RUN<span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">#################################</span></span>
<span class="line"><span class="token comment"># Utilities</span></span>
<span class="line"><span class="token comment">#################################</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> version-check</span>
<span class="line"><span class="token target symbol">version-check</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token operator">@</span>echo <span class="token string">&quot;+ $@&quot;</span></span>
<span class="line">  if [ -z <span class="token string">&quot;${VERSION}&quot;</span> ]<span class="token punctuation">;</span> then \</span>
<span class="line">    echo <span class="token string">&quot;VERSION is not set&quot;</span> <span class="token punctuation">;</span> \</span>
<span class="line">    false <span class="token punctuation">;</span> \</span>
<span class="line">  <span class="token keyword">else</span> \</span>
<span class="line">    echo <span class="token string">&quot;VERSION is ${VERSION}&quot;</span><span class="token punctuation">;</span> \</span>
<span class="line">    fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><hr><h2 id="install-targets" tabindex="-1"><a class="header-anchor" href="#install-targets"><span>Install Targets</span></a></h2><p>The install target has two components. The first, <code>install-dev</code>, is executed from the Dockerfile. When <code>RUN make install-dev</code> is executed in the Dockerfile it runs <code>pip install -e .</code> inside of the container. This is a fun command, and it took me some digging to really grasp the details.</p><p>We will take a little aside into Python virtual environments here in order to grasp the convenience of this command. When you’re creating a Python application, it’s common to have a <i class="vp-icon fa-brands fa-python" sizing="height"></i><code>setup.py</code> file that provides a description of your application that can be consumed by Distutils, which is a mechanism to distribute Python packages and extensions. More specifically from the Python docs “The setup script is the centre of all activity in building, distributing, and installing modules using the Distutils. The main purpose of the setup script is to describe your module distribution to the Distutils, so that the various commands that operate on your modules do the right thing.”</p><p>But often when using Python, you want to set everything up to run in a virtual environment. It can be a bit cumbersome to have to repeat <code>python setup.py install</code> after every code change to link your working directory back to your virtual environment, so you can run <code>pip install -e .</code> in the directory where <i class="vp-icon fa-brands fa-python" sizing="height"></i><code>setup.py</code> lives. This creates a sudo-symlink between the files where you are making changes and the package in the virtual environment so you have the up-to-date version of your Python application to run.</p><p>The second portion of the Install target, <code>pip-freeze</code>, is fun and slightly easier to grasp. Not necessary to run tests inside of a container, but a handy command to know when developing in Python. When your application accumulates a decent number of packages, it can sometimes be difficult to manage all of the versions on your own in <i class="vp-icon fas fa-file-lines" sizing="height"></i><code>requirements.txt</code>. This command is a great way to obtain all of the package versions that are compatible with your application and automatically update the <i class="vp-icon fas fa-file-lines" sizing="height"></i><code>requirements.txt</code> for your application.</p><hr><h2 id="docker-targets" tabindex="-1"><a class="header-anchor" href="#docker-targets"><span>Docker Targets</span></a></h2><p>The Docker targets will walk through creating and maintaining your image. The first <code>clean-image</code> will run the <code>version-check</code> as a prerequisite and then remove both the latest and chosen version. Getting an error that the image does not exists when we try to remove it should not result in our test tooling shutting down here; therefore, we use the <code>command || true</code> syntax. This boolean function will always return true, which protects against our script from unnecessarily aborting.</p><p>For building and tagging our image we use the <code>image</code> target. This will also perform a prerequisite version check then build the image with the specified <code>HUB_NAMESPACE</code>, <code>IMAGE_NAME</code>, and <code>VERSION</code> from the Dockerfile we created earlier. Then the image is tagged and then <code>docker images</code> is run to confirm that the image was built and tagged correctly.</p><p>And finally, for pushing our image, both <code>clean-image</code> and <code>image</code> are prerequisites. Then both the most recent version as well as the latest tagged images are pushed to Docker Hub. If you are logged into Docker Hub then the push will complete automatically, otherwise you will have to enter your login credentials during this step.</p><hr><h2 id="test-targets" tabindex="-1"><a class="header-anchor" href="#test-targets"><span>Test Targets</span></a></h2><p>The test targets section covers the targets for unit tests, integration tests, and the system tooling for running the application locally and running it in a container.</p><p>The first target <code>test-unit</code> runs our unit tests against our system test code using the Nose testing package for Python, <code>check-fmt</code> uses the Python format-checking package Pycodestyle to check our toolbox code for style conventions, and <code>test-static</code> will run a run the Python linter, Pylint, against our system test cases, our system toolbox code, and our integration tests.</p><p>The last two targets are the ones that will run our tests in a container using the image we created earlier with our Dockerfile. The target <code>test-container</code> will run our unit tests followed by our integration tests. The command:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker</span> run <span class="token parameter variable">--rm</span> <span class="token parameter variable">--name</span> toolbox-unit-tests <span class="token variable">${HUB_NAMESPACE}</span>/<span class="token variable">${IMAGE_NAME}</span>:latest <span class="token function">make</span> test-all</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>uses <code>docker run</code> with the <code>--rm</code> flag to remove the container once the process completes, the <code>--name</code> flag to provide the container with a specific name, <code>:latest</code> to select the latest version of our image <code>${HUB_NAMESPACE}/${IMAGE_NAME}</code>, and sends the command <code>make test-all</code>, which from our <code>Makefile</code> will run <code>check-fmt</code>, <code>test-static</code>, and <code>test-unit</code>.</p><p>The integration tests are run by calling:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">docker</span> run <span class="token parameter variable">--rm</span> <span class="token parameter variable">--name</span> toolbox-int <span class="token parameter variable">--volume</span> <span class="token variable">${CUR_DIR}</span>/results:/root/logs <span class="token parameter variable">-e</span> <span class="token assign-left variable">REGISTRY_USERNAME</span><span class="token operator">=</span>foo <span class="token parameter variable">-e</span> <span class="token assign-left variable">REGISTRY_PASSWORD</span><span class="token operator">=</span>bar <span class="token punctuation">\</span></span>
<span class="line"><span class="token variable">${HUB_NAMESPACE}</span>/<span class="token variable">${IMAGE_NAME}</span>:latest python ./integration-tests/testbed_validation.py</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>This will run the integration tests against the system toolbox. It will also create a Docker volume to transfer any log files created from our application to our local machine to be viewed once the container is removed. Lastly, running <code>integration-static</code> will run solely the static integration tests inside of a container while <code>integration-testbed-survey</code> will run the integration tests with a live system.</p><hr><h2 id="how-to-run-the-containerized-tests" tabindex="-1"><a class="header-anchor" href="#how-to-run-the-containerized-tests"><span>How to Run the Containerized Tests</span></a></h2><p>After this setup we are now able to reap the rewards of our work. We’ll walk through how to run all of our tests inside containers. Let’s say we want to run some system tests against our toolbox. If someone happened to make some toolbox library changes during this time as well, maybe a version of a package changed or they added some library functionality that unknowingly conflicts with another PR in the pipeline, this could lead to the always-fun “…. well it works on my machine” response.</p><p>In order to mitigate this, we can run <code>make test-container</code> which will first run the unit tests from an image that we are confident is fully functioning since it is pushed to our Docker Hub repository. Secondly it will run our integration tests also against a reliable image. This ensures that our tests are run in the same environment across machines which generally leads to faster development and a more enjoyable coding experience. We can also access all of the log files produced by the application while it was running in a container since we have created a volume to link the <code>/root/logs</code> directory to <code>${CUR_DIR}/results</code>.</p><p>Going forward, the ability to run different tests in containers gives us a lot of flexibility. In addition to being able to run tests in consistent environments across different machines and avoid potential conflicts, it fits well into setting up an automatic Jenkins job to run these tests routinely while maintaining consistency in the source code as well as the test code.</p><!-- TODO: add ARTICLE CARD --><a class="vp-card" href="https://chanhi2000.github.io/bookshelf/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.html" target="_blank" style="background:rgba(29,99,237,0.2);"><img class="vp-card-logo" src="https://docker.com/app/uploads/2024/02/cropped-docker-logo-favicon-192x192.png" loading="lazy" no-view><div class="vp-card-content"><div class="vp-card-title">Containerizing Test Tooling: Creating your file and Makefile</div><hr><div class="vp-card-desc">Learn from Docker experts to simplify and advance your app development and management with Docker. Stay up to date on Docker events and new version</div></div></a></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/chanhi2000/articles/edit/main/src/docker.com/containerizing-test-tooling-creating-your-dockerfile-and-makefile.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/bookshelf/devops/docker/articles/" aria-label="/devops/docker/articles/"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->/devops/docker/articles/</div></a><a class="route-link auto-link next" href="/bookshelf/docker.com/whats-in-a-container-platform.html" aria-label="What&#39;s in a Container Platform?"><div class="hint">Next<span class="arrow end"></span></div><div class="link">What&#39;s in a Container Platform?<i class="vp-icon fa-brands fa-docker" sizing="height"></i></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">MIT Licensed | Copyright © 2022-present <a href="https://github.com/chanhi2000">Chan Hee Lee</a></div><div class="vp-copyright">Copyright © 2025 Veronika Alex </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/bookshelf/assets/app-BVguHYKu.js" defer></script>
  </body>
</html>
